/*
 Copyright (c) 2013 Autodesk Inc.  Copyright (c) 2013 Autodesk Inc.  Copyright (c) 2014 Autodesk Inc.  Copyright (c) 2014 Autodesk Inc.  Copyright (c) 2014 Autodesk Inc.  Copyright (c) 2013 Autodesk Inc.  Copyright (c) 2013 Autodesk Inc.  Copyright (c) 2013 Autodesk Inc.  Copyright (c) 2013 Autodesk Inc.  Copyright (c) 2013 Autodesk Inc.  Copyright (c) 2013 Autodesk Inc.  Copyright (c) 2014 Autodesk Inc.  Copyright (c) 2014 Autodesk Inc. */
var IS_CONCAT_BUILD=!0,BUILD_LMV_WORKER_URL="lmvworker.min.js",LMV_WORKER_URL=BUILD_LMV_WORKER_URL,ENABLE_DEBUG=!1,ENABLE_TRACE=!1,ENABLE_INLINE_WORKER=!0;AutodeskNamespace=function(a){var b=this;a=a.split(".");for(var c=0;c<a.length;++c)b[a[c]]=b[a[c]]||{},b=b[a[c]];return b};var _isIE11=!!navigator.userAgent.match(/Trident\/7\./);
"undefined"!==typeof window&&_isIE11&&function(){function a(a,c){c=c||{bubbles:!1,cancelable:!1,detail:void 0};var d=document.createEvent("CustomEvent");d.initCustomEvent(a,c.bubbles,c.cancelable,c.detail);return d}a.prototype=window.CustomEvent.prototype;window.CustomEvent=a}();
ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=function(a,b){!b||b>this.byteLength?b=this.byteLength:0>b&&(b=this.byteLength+b,0>b&&(b=0));0>a&&(a=this.byteLength+a,0>a&&(a=0));if(b<=a)return new ArrayBuffer;for(var c=b-a,d=new Uint8Array(this,a,c),f=new Uint8Array(c),g=0;g<c;g++)f[g]=d[g];return f.buffer});"undefined"!==typeof window&&(window.BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder);
function launchFullscreen(a,b){a.requestFullscreen?a.requestFullscreen(b):a.mozRequestFullScreen?a.mozRequestFullScreen(b):a.webkitRequestFullscreen?a.webkitRequestFullscreen(b):a.msRequestFullscreen&&a.msRequestFullscreen(b)}function exitFullscreen(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()}
function inFullscreen(){return document.fullscreenEnabled||document.mozFullScreenElement||document.webkitIsFullScreen||document.msFullscreenElement?!0:!1}function fullscreenElement(){return document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement}function isFullscreenAvailable(a){return a.requestFullscreen||a.mozRequestFullScreen||a.webkitRequestFullscreen||a.msRequestFullscreen}
function getAndroidVersion(a){a=a||navigator.userAgent;return(a=a.match(/Android\s([0-9\.]*)/))?a[1]:!1}function isTouchDevice(){return"ontouchstart"in window}function isIOSDevice(){return/ip(ad|hone|od)/.test(navigator.userAgent.toLowerCase())}function isAndroidDevice(){return-1!==navigator.userAgent.toLowerCase().indexOf("android")}function touchStartToClick(a){a.preventDefault();a.stopPropagation();a.target.click()}
"undefined"!==typeof window&&!function(a,b,c,d){function f(a,b,c){return Array.isArray(a)?(g(a,c[b],c),!0):!1}function g(a,b,c){var f;if(a)if(a.forEach)a.forEach(b,c);else if(a.length!==d)for(f=0;f<a.length;)b.call(c,a[f],f,a),f++;else for(f in a)a.hasOwnProperty(f)&&b.call(c,a[f],f,a)}function h(a,b,c){for(var f=Object.keys(b),g=0;g<f.length;)(!c||c&&a[f[g]]===d)&&(a[f[g]]=b[f[g]]),g++;return a}function k(a,b){return h(a,b,!0)}function l(a,b,c){var d=b.prototype;b=a.prototype=Object.create(d);b.constructor=
a;b._super=d;c&&h(b,c)}function m(a,b){return function(){return a.apply(b,arguments)}}function p(a,b){return typeof a==Ta?a.apply(b?b[0]||d:d,b):a}function n(a,b,c){g(v(b),function(b){a.addEventListener(b,c,!1)})}function q(a,b,c){g(v(b),function(b){a.removeEventListener(b,c,!1)})}function r(a,b){for(;a;){if(a==b)return!0;a=a.parentNode}return!1}function v(a){return a.trim().split(/\s+/g)}function s(a,b,c){if(a.indexOf&&!c)return a.indexOf(b);for(var d=0;d<a.length;){if(c&&a[d][c]==b||!c&&a[d]===
b)return d;d++}return-1}function w(a){return Array.prototype.slice.call(a,0)}function z(a,b,c){for(var d=[],f=[],g=0;g<a.length;){var h=b?a[g][b]:a[g];0>s(f,h)&&d.push(a[g]);f[g]=h;g++}return c&&(d=b?d.sort(function(a,c){return a[b]>c[b]}):d.sort()),d}function D(a,b){for(var c,f,g=b[0].toUpperCase()+b.slice(1),h=0;h<Ga.length;){if(c=Ga[h],f=c?c+g:b,f in a)return f;h++}return d}function A(a){a=a.ownerDocument;return a.defaultView||a.parentWindow}function E(a,b){var c=this;this.manager=a;this.callback=
b;this.element=a.element;this.target=a.options.inputTarget;this.domHandler=function(b){p(a.options.enable,[a])&&c.handler(b)};this.init()}function N(a){var b=a.options.inputClass;return new (b?b:Ma?F:Va?R:Na?S:K)(a,H)}function H(a,b,c){var f=c.pointers.length,g=c.changedPointers.length,h=b&sa&&0===f-g,f=b&(da|pa)&&0===f-g;c.isFirst=!!h;c.isFinal=!!f;h&&(a.session={});c.eventType=b;b=a.session;h=c.pointers;f=h.length;b.firstInput||(b.firstInput=J(c));1<f&&!b.firstMultiple?b.firstMultiple=J(c):1===
f&&(b.firstMultiple=!1);var g=b.firstInput,k=(f=b.firstMultiple)?f.center:g.center,l=c.center=G(h);c.timeStamp=Ha();c.deltaTime=c.timeStamp-g.timeStamp;c.angle=C(k,l);c.distance=M(k,l);var g=c.center,k=b.offsetDelta||{},l=b.prevDelta||{},m=b.prevInput||{};(c.eventType===sa||m.eventType===da)&&(l=b.prevDelta={x:m.deltaX||0,y:m.deltaY||0},k=b.offsetDelta={x:g.x,y:g.y});c.deltaX=l.x+(g.x-k.x);c.deltaY=l.y+(g.y-k.y);c.offsetDirection=I(c.deltaX,c.deltaY);c.scale=f?M(h[0],h[1],lb)/M(f.pointers[0],f.pointers[1],
lb):1;c.rotation=f?C(h[1],h[0],lb)-C(f.pointers[1],f.pointers[0],lb):0;k=b.lastInterval||c;h=c.timeStamp-k.timeStamp;c.eventType!=pa&&(h>Wa||k.velocity===d)?(g=k.deltaX-c.deltaX,k=k.deltaY-c.deltaY,l=g/h||0,m=k/h||0,h=l,f=m,l=qa(l)>qa(m)?l:m,g=I(g,k),b.lastInterval=c):(l=k.velocity,h=k.velocityX,f=k.velocityY,g=k.direction);c.velocity=l;c.velocityX=h;c.velocityY=f;c.direction=g;b=a.element;r(c.srcEvent.target,b)&&(b=c.srcEvent.target);c.target=b;a.emit("hammer.input",c);a.recognize(c);a.session.prevInput=
c}function J(a){for(var b=[],c=0;c<a.pointers.length;)b[c]={clientX:xa(a.pointers[c].clientX),clientY:xa(a.pointers[c].clientY)},c++;return{timeStamp:Ha(),pointers:b,center:G(b),deltaX:a.deltaX,deltaY:a.deltaY}}function G(a){var b=a.length;if(1===b)return{x:xa(a[0].clientX),y:xa(a[0].clientY)};for(var c=0,d=0,f=0;b>f;)c+=a[f].clientX,d+=a[f].clientY,f++;return{x:xa(c/b),y:xa(d/b)}}function I(a,b){return a===b?Oa:qa(a)>=qa(b)?0<a?va:Ka:0<b?Ca:ab}function M(a,b,c){c||(c=Cb);var d=b[c[0]]-a[c[0]];a=
b[c[1]]-a[c[1]];return Math.sqrt(d*d+a*a)}function C(a,b,c){c||(c=Cb);return 180*Math.atan2(b[c[1]]-a[c[1]],b[c[0]]-a[c[0]])/Math.PI}function K(){this.evEl=za;this.evWin=ya;this.allow=!0;this.pressed=!1;E.apply(this,arguments)}function F(){this.evEl=t;this.evWin=wb;E.apply(this,arguments);this.store=this.manager.session.pointerEvents=[]}function B(){this.evTarget=mb;this.evWin=Xa;this.started=!1;E.apply(this,arguments)}function R(){this.evTarget=nb;this.targetIds={};E.apply(this,arguments)}function Y(a,
b){var c=w(a.touches),d=this.targetIds;if(b&(sa|Ia)&&1===c.length)return d[c[0].identifier]=!0,[c,c];var f,g=w(a.changedTouches),h=[],k=this.target;if(f=c.filter(function(a){return r(a.target,k)}),b===sa)for(c=0;c<f.length;)d[f[c].identifier]=!0,c++;for(c=0;c<g.length;)d[g[c].identifier]&&h.push(g[c]),b&(da|pa)&&delete d[g[c].identifier],c++;return h.length?[z(f.concat(h),"identifier",!0),h]:void 0}function S(){E.apply(this,arguments);var a=m(this.handler,this);this.touch=new R(this.manager,a);this.mouse=
new K(this.manager,a)}function P(a,b){this.manager=a;this.set(b)}function ba(a){if(-1<a.indexOf(Pa))return Pa;var b=-1<a.indexOf(ob),c=-1<a.indexOf(qb);return b&&c?ob+" "+qb:b||c?b?ob:qb:-1<a.indexOf(pb)?pb:Ua}function U(a){this.id=Ya++;this.manager=null;this.options=k(a||{},this.defaults);this.options.enable=this.options.enable===d?!0:this.options.enable;this.state=rb;this.simultaneous={};this.requireFail=[]}function W(a){return a==ab?"down":a==Ca?"up":a==va?"left":a==Ka?"right":""}function aa(a,
b){var c=b.manager;return c?c.get(a):a}function V(){U.apply(this,arguments)}function Q(){V.apply(this,arguments);this.pY=this.pX=null}function ka(){V.apply(this,arguments)}function ca(){U.apply(this,arguments);this._input=this._timer=null}function Z(){V.apply(this,arguments)}function la(){V.apply(this,arguments)}function Aa(){U.apply(this,arguments);this.pCenter=this.pTime=!1;this._input=this._timer=null;this.count=0}function ja(a,b){return b=b||{},b.recognizers=b.recognizers===d?ja.defaults.preset:
b.recognizers,new ea(a,b)}function ea(a,b){b=b||{};this.options=k(b,ja.defaults);this.options.inputTarget=this.options.inputTarget||a;this.handlers={};this.session={};this.recognizers=[];this.element=a;this.input=N(this);this.touchAction=new P(this,this.options.touchAction);Da(this,!0);g(b.recognizers,function(a){var b=this.add(new a[0](a[1]));a[2]&&b.recognizeWith(a[2]);a[3]&&b.requireFailure(a[3])},this)}function Da(a,b){var c=a.element;g(a.options.cssProps,function(a,d){c.style[D(c.style,d)]=b?
a:""})}function fa(a,c){var d=b.createEvent("Event");d.initEvent(a,!0,!0);d.gesture=c;c.target.dispatchEvent(d)}var Ga=" webkit moz MS ms o".split(" "),bb=b.createElement("div"),Ta="function",xa=Math.round,qa=Math.abs,Ha=Date.now,Ya=1,fb=/mobile|tablet|ip(ad|hone|od)|android/i,Na="ontouchstart"in a,Ma=D(a,"PointerEvent")!==d,Va=Na&&fb.test(navigator.userAgent),Wa=25,sa=1,Ia=2,da=4,pa=8,Oa=1,va=2,Ka=4,Ca=8,ab=16,Qa=va|Ka,wa=Ca|ab,gb=Qa|wa,Cb=["x","y"],lb=["clientX","clientY"];E.prototype={handler:function(){},
init:function(){this.evEl&&n(this.element,this.evEl,this.domHandler);this.evTarget&&n(this.target,this.evTarget,this.domHandler);this.evWin&&n(A(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&q(this.element,this.evEl,this.domHandler);this.evTarget&&q(this.target,this.evTarget,this.domHandler);this.evWin&&q(A(this.element),this.evWin,this.domHandler)}};var sb={mousedown:sa,mousemove:Ia,mouseup:da},za="mousedown",ya="mousemove mouseup";l(K,E,{handler:function(a){var b=sb[a.type];
b&sa&&0===a.button&&(this.pressed=!0);b&Ia&&1!==a.which&&(b=da);this.pressed&&this.allow&&(b&da&&(this.pressed=!1),this.callback(this.manager,b,{pointers:[a],changedPointers:[a],pointerType:"mouse",srcEvent:a}))}});var cb={pointerdown:sa,pointermove:Ia,pointerup:da,pointercancel:pa,pointerout:pa},tb={2:"touch",3:"pen",4:"mouse",5:"kinect"},t="pointerdown",wb="pointermove pointerup pointercancel";a.MSPointerEvent&&(t="MSPointerDown",wb="MSPointerMove MSPointerUp MSPointerCancel");l(F,E,{handler:function(a){var b=
this.store,c=!1,d=a.type.toLowerCase().replace("ms",""),d=cb[d],f=tb[a.pointerType]||a.pointerType,g="touch"==f,h=s(b,a.pointerId,"pointerId");d&sa&&(0===a.button||g)?0>h&&(b.push(a),h=b.length-1):d&(da|pa)&&(c=!0);0>h||(b[h]=a,this.callback(this.manager,d,{pointers:b,changedPointers:[a],pointerType:f,srcEvent:a}),c&&b.splice(h,1))}});var ub={touchstart:sa,touchmove:Ia,touchend:da,touchcancel:pa},mb="touchstart",Xa="touchstart touchmove touchend touchcancel";l(B,E,{handler:function(a){var b=ub[a.type];
if(b===sa&&(this.started=!0),this.started){var c,d=w(a.touches);c=w(a.changedTouches);c=(b&(da|pa)&&(d=z(d.concat(c),"identifier",!0)),[d,c]);b&(da|pa)&&0===c[0].length-c[1].length&&(this.started=!1);this.callback(this.manager,b,{pointers:c[0],changedPointers:c[1],pointerType:"touch",srcEvent:a})}}});var Ra={touchstart:sa,touchmove:Ia,touchend:da,touchcancel:pa},nb="touchstart touchmove touchend touchcancel";l(R,E,{handler:function(a){var b=Ra[a.type],c=Y.call(this,a,b);c&&this.callback(this.manager,
b,{pointers:c[0],changedPointers:c[1],pointerType:"touch",srcEvent:a})}});l(S,E,{handler:function(a,b,c){var d="mouse"==c.pointerType;if("touch"==c.pointerType)this.mouse.allow=!1;else if(d&&!this.mouse.allow)return;b&(da|pa)&&(this.mouse.allow=!0);this.callback(a,b,c)},destroy:function(){this.touch.destroy();this.mouse.destroy()}});var jb=D(bb.style,"touchAction"),Sa=jb!==d,Ua="auto",pb="manipulation",Pa="none",ob="pan-x",qb="pan-y";P.prototype={set:function(a){"compute"==a&&(a=this.compute());Sa&&
(this.manager.element.style[jb]=a);this.actions=a.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var a=[];return g(this.manager.recognizers,function(b){p(b.options.enable,[b])&&(a=a.concat(b.getTouchAction()))}),ba(a.join(" "))},preventDefaults:function(a){if(!Sa){var b=a.srcEvent;a=a.offsetDirection;if(this.manager.session.prevented)return void b.preventDefault();var c=this.actions,d=-1<c.indexOf(Pa),f=-1<c.indexOf(qb),c=-1<c.indexOf(ob);return d||
f&&a&Qa||c&&a&wa?this.preventSrc(b):void 0}},preventSrc:function(a){this.manager.session.prevented=!0;a.preventDefault()}};var rb=1,Ja=2,db=4,Ea=8,Ba=Ea,vb=16;U.prototype={defaults:{},set:function(a){return h(this.options,a),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(a){if(f(a,"recognizeWith",this))return this;var b=this.simultaneous;return a=aa(a,this),b[a.id]||(b[a.id]=a,a.recognizeWith(this)),this},dropRecognizeWith:function(a){return f(a,"dropRecognizeWith",this)?
this:(a=aa(a,this),delete this.simultaneous[a.id],this)},requireFailure:function(a){if(f(a,"requireFailure",this))return this;var b=this.requireFail;return a=aa(a,this),-1===s(b,a)&&(b.push(a),a.requireFailure(this)),this},dropRequireFailure:function(a){if(f(a,"dropRequireFailure",this))return this;a=aa(a,this);a=s(this.requireFail,a);return-1<a&&this.requireFail.splice(a,1),this},hasRequireFailures:function(){return 0<this.requireFail.length},canRecognizeWith:function(a){return!!this.simultaneous[a.id]},
emit:function(a){function b(f){c.manager.emit(c.options.event+(f?d&vb?"cancel":d&Ea?"end":d&db?"move":d&Ja?"start":"":""),a)}var c=this,d=this.state;Ea>d&&b(!0);b();d>=Ea&&b(!0)},tryEmit:function(a){return this.canEmit()?this.emit(a):void(this.state=32)},canEmit:function(){for(var a=0;a<this.requireFail.length;){if(!(this.requireFail[a].state&(32|rb)))return!1;a++}return!0},recognize:function(a){a=h({},a);return p(this.options.enable,[this,a])?(this.state&(Ba|vb|32)&&(this.state=rb),this.state=this.process(a),
void(this.state&(Ja|db|Ea|vb)&&this.tryEmit(a))):(this.reset(),void(this.state=32))},process:function(){},getTouchAction:function(){},reset:function(){}};l(V,U,{defaults:{pointers:1},attrTest:function(a){var b=this.options.pointers;return 0===b||a.pointers.length===b},process:function(a){var b=this.state,c=a.eventType,d=b&(Ja|db);a=this.attrTest(a);return d&&(c&pa||!a)?b|vb:d||a?c&da?b|Ea:b&Ja?b|db:Ja:32}});l(Q,V,{defaults:{event:"pan",threshold:10,pointers:1,direction:gb},getTouchAction:function(){var a=
this.options.direction,b=[];return a&Qa&&b.push(qb),a&wa&&b.push(ob),b},directionTest:function(a){var b=this.options,c=!0,d=a.distance,f=a.direction,g=a.deltaX,h=a.deltaY;return f&b.direction||(b.direction&Qa?(f=0===g?Oa:0>g?va:Ka,c=g!=this.pX,d=Math.abs(a.deltaX)):(f=0===h?Oa:0>h?Ca:ab,c=h!=this.pY,d=Math.abs(a.deltaY))),a.direction=f,c&&d>b.threshold&&f&b.direction},attrTest:function(a){return V.prototype.attrTest.call(this,a)&&(this.state&Ja||!(this.state&Ja)&&this.directionTest(a))},emit:function(a){this.pX=
a.deltaX;this.pY=a.deltaY;var b=W(a.direction);b&&this.manager.emit(this.options.event+b,a);this._super.emit.call(this,a)}});l(ka,V,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Pa]},attrTest:function(a){return this._super.attrTest.call(this,a)&&(Math.abs(a.scale-1)>this.options.threshold||this.state&Ja)},emit:function(a){(this._super.emit.call(this,a),1!==a.scale)&&this.manager.emit(this.options.event+(1>a.scale?"in":"out"),a)}});l(ca,U,{defaults:{event:"press",
pointers:1,time:500,threshold:5},getTouchAction:function(){return[Ua]},process:function(a){var b=this.options,c=a.pointers.length===b.pointers,d=a.distance<b.threshold,f=a.deltaTime>b.time;if(this._input=a,!d||!c||a.eventType&(da|pa)&&!f)this.reset();else if(a.eventType&sa)this.reset(),this._timer=setTimeout(m(function(){this.state=Ba;this.tryEmit()},this),b.time);else if(a.eventType&da)return Ba;return 32},reset:function(){clearTimeout(this._timer)},emit:function(a){this.state===Ba&&(a&&a.eventType&
da?this.manager.emit(this.options.event+"up",a):(this._input.timeStamp=Ha(),this.manager.emit(this.options.event,this._input)))}});l(Z,V,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Pa]},attrTest:function(a){return this._super.attrTest.call(this,a)&&(Math.abs(a.rotation)>this.options.threshold||this.state&Ja)}});l(la,V,{defaults:{event:"swipe",threshold:10,velocity:0.65,direction:Qa|wa,pointers:1},getTouchAction:function(){return Q.prototype.getTouchAction.call(this)},
attrTest:function(a){var b,c=this.options.direction;return c&(Qa|wa)?b=a.velocity:c&Qa?b=a.velocityX:c&wa&&(b=a.velocityY),this._super.attrTest.call(this,a)&&c&a.direction&&a.distance>this.options.threshold&&qa(b)>this.options.velocity&&a.eventType&da},emit:function(a){var b=W(a.direction);b&&this.manager.emit(this.options.event+b,a);this.manager.emit(this.options.event,a)}});l(Aa,U,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:2,posThreshold:10},getTouchAction:function(){return[pb]},
process:function(a){var b=this.options,c=a.pointers.length===b.pointers,d=a.distance<b.threshold,f=a.deltaTime<b.time;if(this.reset(),a.eventType&sa&&0===this.count)return this.failTimeout();if(d&&f&&c){if(a.eventType!=da)return this.failTimeout();c=this.pTime?a.timeStamp-this.pTime<b.interval:!0;d=!this.pCenter||M(this.pCenter,a.center)<b.posThreshold;this.pTime=a.timeStamp;this.pCenter=a.center;d&&c?this.count+=1:this.count=1;this._input=a;if(0===this.count%b.taps)return this.hasRequireFailures()?
(this._timer=setTimeout(m(function(){this.state=Ba;this.tryEmit()},this),b.interval),Ja):Ba}return 32},failTimeout:function(){return this._timer=setTimeout(m(function(){this.state=32},this),this.options.interval),32},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==Ba&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});ja.VERSION="2.0.4";ja.defaults={domEvents:!1,touchAction:"compute",enable:!0,inputTarget:null,inputClass:null,preset:[[Z,
{enable:!1}],[ka,{enable:!1},["rotate"]],[la,{direction:Qa}],[Q,{direction:Qa},["swipe"]],[Aa],[Aa,{event:"doubletap",taps:2},["tap"]],[ca]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};ea.prototype={set:function(a){return h(this.options,a),a.touchAction&&this.touchAction.update(),a.inputTarget&&(this.input.destroy(),this.input.target=a.inputTarget,this.input.init()),this},stop:function(a){this.session.stopped=
a?2:1},recognize:function(a){var b=this.session;if(!b.stopped){this.touchAction.preventDefaults(a);var c,d=this.recognizers,f=b.curRecognizer;(!f||f&&f.state&Ba)&&(f=b.curRecognizer=null);for(var g=0;g<d.length;)c=d[g],2===b.stopped||f&&c!=f&&!c.canRecognizeWith(f)?c.reset():c.recognize(a),!f&&c.state&(Ja|db|Ea)&&(f=b.curRecognizer=c),g++}},get:function(a){if(a instanceof U)return a;for(var b=this.recognizers,c=0;c<b.length;c++)if(b[c].options.event==a)return b[c];return null},add:function(a){if(f(a,
"add",this))return this;var b=this.get(a.options.event);return b&&this.remove(b),this.recognizers.push(a),a.manager=this,this.touchAction.update(),a},remove:function(a){if(f(a,"remove",this))return this;var b=this.recognizers;return a=this.get(a),b.splice(s(b,a),1),this.touchAction.update(),this},on:function(a,b){var c=this.handlers;return g(v(a),function(a){c[a]=c[a]||[];c[a].push(b)}),this},off:function(a,b){var c=this.handlers;return g(v(a),function(a){b?c[a].splice(s(c[a],b),1):delete c[a]}),
this},emit:function(a,b){this.options.domEvents&&fa(a,b);var c=this.handlers[a]&&this.handlers[a].slice();if(c&&c.length){b.type=a;b.preventDefault=function(){b.srcEvent.preventDefault()};for(var d=0;d<c.length;)c[d](b),d++}},destroy:function(){this.element&&Da(this,!1);this.handlers={};this.session={};this.input.destroy();this.element=null}};h(ja,{INPUT_START:sa,INPUT_MOVE:Ia,INPUT_END:da,INPUT_CANCEL:pa,STATE_POSSIBLE:rb,STATE_BEGAN:Ja,STATE_CHANGED:db,STATE_ENDED:Ea,STATE_RECOGNIZED:Ba,STATE_CANCELLED:vb,
STATE_FAILED:32,DIRECTION_NONE:Oa,DIRECTION_LEFT:va,DIRECTION_RIGHT:Ka,DIRECTION_UP:Ca,DIRECTION_DOWN:ab,DIRECTION_HORIZONTAL:Qa,DIRECTION_VERTICAL:wa,DIRECTION_ALL:gb,Manager:ea,Input:E,TouchAction:P,TouchInput:R,MouseInput:K,PointerEventInput:F,TouchMouseInput:S,SingleTouchInput:B,Recognizer:U,AttrRecognizer:V,Tap:Aa,Pan:Q,Swipe:la,Pinch:ka,Rotate:Z,Press:ca,on:n,off:q,each:g,merge:k,extend:h,inherit:l,bindFn:m,prefixed:D});a[c]=ja}(window,document,"Hammer");AutodeskNamespace("Autodesk.Viewing");
Autodesk.Viewing.ESCAPE_EVENT="escape";Autodesk.Viewing.PROGRESS_UPDATE_EVENT="progress";Autodesk.Viewing.FULLSCREEN_MODE_EVENT="fullScreenMode";Autodesk.Viewing.NAVIGATION_MODE_CHANGED_EVENT="navmode";Autodesk.Viewing.VIEWER_STATE_RESTORED_EVENT="viewerStateRestored";Autodesk.Viewing.VIEWER_RESIZE_EVENT="viewerResize";Autodesk.Viewing.TOOLBAR_CREATED_EVENT="toolbarCreated";Autodesk.Viewing.VIEWER_UNINITIALIZED="viewerUninitialized";
Autodesk.Viewing.Viewer=function(a,b){this.clientContainer=a;this.container=document.createElement("div");this.container.className="adsk-viewing-viewer";this.container.style.height="100%";this.container.style.width="100%";this.container.style.overflow="hidden";this.container.classList.add(isTouchDevice()?"touch":"notouch");this.clientContainer.appendChild(this.container);this.listeners={};this.dockingPanels=[];this.config=b;this.contextMenu=null;this.contextMenuCallbacks={};this.__firefoxLMBfix=!1;
this.screenModeDelegateClass=this.screenModeDelegate=null;this.setScreenModeDelegate(b?b.screenModeDelegate:void 0);this.loadedExtensions={};this.started=!1};Autodesk.Viewing.Viewer.prototype={load:function(a,b){throw"bool load(urn, function(void)) must be implemented.  For more details, read the Viewer class documentation.";}};
Autodesk.Viewing.Viewer.prototype.start=function(){if(this.started)return 0;var a=this.initialize();if(0===a&&(this.started=!0,this.config&&this.config.hasOwnProperty("extensions")))for(var b=this.config.extensions,c=0;c<b.length;++c)this.loadExtension(b[c],this.config);return a};
Autodesk.Viewing.Viewer.prototype.initialize=function(){var a=this;this.onResizeCallback=function(b){a.resize()};window.addEventListener("resize",this.onResizeCallback,!1);if(!this.config||(this.config.hasOwnProperty("disableBrowserContextMenu")?this.config.disableBrowserContextMenu:1))this.onDefaultContextMenu=function(a){a.preventDefault()},this.container.addEventListener("contextmenu",this.onDefaultContextMenu,!1);this.initContextMenu();this.localize()};
Autodesk.Viewing.Viewer.prototype.uninitialize=function(){this.onDefaultContextMenu&&this.container.removeEventListener("contextmenu",this.onDefaultContextMenu,!1);this.container&&this.container.parentNode&&this.container.parentNode.removeChild(this.container);this.container=null;this.screenModeDelegate&&(this.screenModeDelegate.uninitialize(),this.screenModeDelegate=null);this.config=this.clientContainer=null;this.listeners={};this.dockingPanels=[];this.contextMenuCallbacks=this.contextMenu=null;
window.removeEventListener("resize",this.onResizeCallback,!1);this.fireEvent({type:Autodesk.Viewing.VIEWER_UNINITIALIZED})};Autodesk.Viewing.Viewer.prototype.finish=function(){for(var a in this.loadedExtensions)this.unloadExtension(a);this.uninitialize()};Autodesk.Viewing.Viewer.prototype.setUp=function(a){if((this.config=a)&&this.config.hasOwnProperty("extensions")){a=this.config.extensions;for(var b=0;b<a.length;++b)this.loadExtension(a[b],this.config)}};
Autodesk.Viewing.Viewer.prototype.tearDown=function(){for(var a in this.loadedExtensions)this.unloadExtension(a)};Autodesk.Viewing.Viewer.prototype.loadExtension=function(a,b){var c=!1;if(this.isExtensionLoaded(a))stderr("Extension already loaded: "+a);else{var d=Autodesk.Viewing.theExtensionManager.getExtension(a);if(d){if(d=new d(this,b),c=d.load())this.loadedExtensions[a]=d,stderr("Extension loaded: "+a)}else stderr("Extension not found: "+a)}return c};
Autodesk.Viewing.Viewer.prototype.isExtensionLoaded=function(a){return a in this.loadedExtensions};Autodesk.Viewing.Viewer.prototype.getExtension=function(a){return a in this.loadedExtensions?this.loadedExtensions[a]:null};Autodesk.Viewing.Viewer.prototype.unloadExtension=function(a){var b=!1;this.isExtensionLoaded(a)?(b=this.loadedExtensions[a].unload(),stderr("Extension unloaded: "+a),delete this.loadedExtensions[a]):stderr("Extension not found: "+a);return b};
Autodesk.Viewing.Viewer.prototype.localize=function(){Autodesk.Viewing.i18n.localize()};Autodesk.Viewing.Viewer.prototype.addEventListener=function(a,b){"undefined"==typeof this.listeners[a]&&(this.listeners[a]=[]);this.listeners[a].push(b)};Autodesk.Viewing.Viewer.prototype.hasEventListener=function(a,b){if(void 0===this.listeners)return!1;var c=this.listeners;return void 0!==c[a]&&-1!==c[a].indexOf(b)?!0:!1};
Autodesk.Viewing.Viewer.prototype.removeEventListener=function(a,b){if(this.listeners[a]instanceof Array)for(var c=this.listeners[a],d=0,f=c.length;d<f;d++)if(c[d]===b){c.splice(d,1);break}};Autodesk.Viewing.Viewer.prototype.fireEvent=function(a){"string"==typeof a&&(a={type:a});a.target||(a.target=this);if(!a.type)throw Error("event type unknown.");if(this.listeners[a.type]instanceof Array)for(var b=this.listeners[a.type].slice(),c=0;c<b.length;c++)b[c].call(this,a)};
Autodesk.Viewing.Viewer.prototype.getDimensions=function(){if(this.container){var a={};this.getScreenMode()===Autodesk.Viewing.Viewer.ScreenMode.kFullScreen?(a.width=screen.width,a.height=screen.height):a=this.container.getBoundingClientRect();return{width:a.width,height:a.height}}return null};Autodesk.Viewing.Viewer.prototype.getState=function(a){throw"Implement getState() in derived class";};
Autodesk.Viewing.Viewer.prototype.restoreState=function(a,b,c){throw"Implement restoreState() in derived class";};Autodesk.Viewing.Viewer.prototype.setViewFromArray=function(a,b){};Autodesk.Viewing.Viewer.prototype.setViewFromViewBox=function(a,b){};Autodesk.Viewing.Viewer.prototype.setViewFromFile=function(){};Autodesk.Viewing.Viewer.prototype.resize=function(){this.resizePanels()};
Autodesk.Viewing.Viewer.prototype.addPanel=function(a){return-1===this.dockingPanels.indexOf(a)?(this.dockingPanels.push(a),!0):!1};Autodesk.Viewing.Viewer.prototype.removePanel=function(a){a=this.dockingPanels.indexOf(a);return-1<a?(this.dockingPanels.splice(a,1),!0):!1};
Autodesk.Viewing.Viewer.prototype.resizePanels=function(a){var b=a?a.viewer:null;b||(b=this);var c=a?a.dockingPanels:null;c||(c=b.dockingPanels);var d=b.container.getBoundingClientRect(),b=d.top,f=d.bottom,g=d.left,h=d.right,k;a&&a.dimensions?(k=a.dimensions.width,f=d=a.dimensions.height):(k=d.width,d=d.height);for(a=0;a<c.length;++a){var l=c[a].container,m=l.getBoundingClientRect(),p=m.top,p=m.bottom,n=m.left,n=m.right,q=m.width,m=m.height;if(q&&m){k<q&&(q=Math.round(k),l.style.width=q+"px");d<m&&
(m=Math.round(d),l.style.height=m+"px");if(h<n||l.dockRight)n=Math.round(h-q-g),l.style.left=n+"px";if(f<p||l.dockBottom)p=Math.round(f-m-b),0>p&&(p=0),l.style.top=p+"px";l.style.maxWidth=Math.round(k)+"px";l.style.maxHeight=Math.round(d)+"px"}}};Autodesk.Viewing.Viewer.prototype.search=function(a,b,c){};Autodesk.Viewing.Viewer.prototype.setContextMenu=function(a){this.contextMenu&&this.contextMenu.hide();this.contextMenu=a};
Autodesk.Viewing.Viewer.prototype.triggerContextMenu=function(a){return this.contextMenu&&this.preContextMenuShow(a)?(this.contextMenu.show(a),!0):!1};
Autodesk.Viewing.Viewer.prototype.initContextMenu=function(){function a(a){var c=a.button;"buttons"in a&&(!b.__firefoxLMBfix||a.buttons&1?2===c&&a.buttons&1&&(c=0,b.__firefoxLMBfix=!0):(b.__firefoxLMBfix=!1,c=0));a=b.navigation&&b.navigation.getUseLeftHandedInput()?0:2;return c===a?!0:!1}var b=this,c=this.canvas||this.container;c.addEventListener("mousedown",function(c){a(c)&&(b.startX=c.clientX,b.startY=c.clientY)});c.addEventListener("mouseup",function(c){a(c)&&c.clientX===b.startX&&c.clientY===
b.startY&&b.triggerContextMenu(c);return!0},!1)};Autodesk.Viewing.Viewer.prototype.preContextMenuShow=function(a){return!0};Autodesk.Viewing.Viewer.prototype.registerContextMenuCallback=function(a,b){this.contextMenuCallbacks[a]=b};Autodesk.Viewing.Viewer.prototype.unregisterContextMenuCallback=function(a){return a in this.contextMenuCallbacks?(delete this.contextMenuCallbacks[a],!0):!1};
Autodesk.Viewing.Viewer.prototype.runContextMenuCallbacks=function(a,b){for(var c in this.contextMenuCallbacks)if(this.contextMenuCallbacks.hasOwnProperty(c))this.contextMenuCallbacks[c](a,b)};Autodesk.Viewing.Viewer.ScreenMode={kNormal:0,kFullBrowser:1,kFullScreen:2};Autodesk.Viewing.Viewer.prototype.ScreenMode={kNormal:0,kFullBrowser:1,kFullScreen:2};
Autodesk.Viewing.Viewer.prototype.setScreenModeDelegate=function(a){this.screenModeDelegate&&(this.screenModeDelegate.uninitialize(),this.screenModeDelegate=null);this.screenModeDelegateClass=a?a:null===a?Autodesk.Viewing.NullScreenModeDelegate:Autodesk.Viewing.ViewerScreenModeDelegate};Autodesk.Viewing.Viewer.prototype.getScreenModeDelegate=function(){this.screenModeDelegate||(this.screenModeDelegate=new this.screenModeDelegateClass(this));return this.screenModeDelegate};
Autodesk.Viewing.Viewer.prototype.isScreenModeSupported=function(a){return this.getScreenModeDelegate().isModeSupported(a)};Autodesk.Viewing.Viewer.prototype.canChangeScreenMode=function(){return this.isScreenModeSupported(Autodesk.Viewing.Viewer.prototype.kNormal)};Autodesk.Viewing.Viewer.prototype.setScreenMode=function(a){return this.getScreenModeDelegate().setMode(a)};Autodesk.Viewing.Viewer.prototype.getScreenMode=function(){return this.getScreenModeDelegate().getMode()};
Autodesk.Viewing.Viewer.prototype.nextScreenMode=function(){var a=this.getScreenModeDelegate().getNextMode();return void 0!==a?this.setScreenMode(a):!1};Autodesk.Viewing.Viewer.prototype.escapeScreenMode=function(){var a=this.getScreenModeDelegate().getEscapeMode();return void 0!==a?this.setScreenMode(a):!1};
Autodesk.Viewing.ScreenModeDelegate=function(a){this.viewer=a;this.bindFullscreenEventListener=this.fullscreenEventListener.bind(this);this.getMode()===Autodesk.Viewing.Viewer.ScreenMode.kFullScreen&&(document.addEventListener("fullscreenchange",this.bindFullscreenEventListener,!1),document.addEventListener("mozfullscreenchange",this.bindFullscreenEventListener,!1),document.addEventListener("webkitfullscreenchange",this.bindFullscreenEventListener,!1),document.addEventListener("MSFullscreenChange",
this.bindFullscreenEventListener,!1))};Autodesk.Viewing.ScreenModeDelegate.prototype.uninitialize=function(){document.removeEventListener("fullscreenchange",this.bindFullscreenEventListener,!1);document.removeEventListener("mozfullscreenchange",this.bindFullscreenEventListener,!1);document.removeEventListener("webkitfullscreenchange",this.bindFullscreenEventListener,!1);document.removeEventListener("MSFullscreenChange",this.bindFullscreenEventListener,!1);this.viewer=null};
Autodesk.Viewing.ScreenModeDelegate.prototype.isModeSupported=function(a){return!0};Autodesk.Viewing.ScreenModeDelegate.prototype.setMode=function(a){var b=this.getMode();if(a!==b&&this.isModeSupported(a)){this.doScreenModeChange(b,a);if(b!==Autodesk.Viewing.Viewer.ScreenMode.kFullScreen)this.onScreenModeChanged(b,a);return!0}return!1};Autodesk.Viewing.ScreenModeDelegate.prototype.getMode=function(){throw"Implement getMode() in derived class";};
Autodesk.Viewing.ScreenModeDelegate.prototype.getNextMode=function(){var a=this.getMode(),b;a===Autodesk.Viewing.Viewer.ScreenMode.kNormal&&this.isModeSupported(Autodesk.Viewing.Viewer.ScreenMode.kFullBrowser)?b=Autodesk.Viewing.Viewer.ScreenMode.kFullBrowser:a===Autodesk.Viewing.Viewer.ScreenMode.kNormal&&this.isModeSupported(Autodesk.Viewing.Viewer.ScreenMode.kFullScreen)?b=Autodesk.Viewing.Viewer.ScreenMode.kFullScreen:a===Autodesk.Viewing.Viewer.ScreenMode.kFullBrowser&&this.isModeSupported(Autodesk.Viewing.Viewer.ScreenMode.kFullScreen)?
b=Autodesk.Viewing.Viewer.ScreenMode.kFullScreen:a===Autodesk.Viewing.Viewer.ScreenMode.kFullBrowser&&this.isModeSupported(Autodesk.Viewing.Viewer.ScreenMode.kNormal)?b=Autodesk.Viewing.Viewer.ScreenMode.kNormal:a===Autodesk.Viewing.Viewer.ScreenMode.kFullScreen&&this.isModeSupported(Autodesk.Viewing.Viewer.ScreenMode.kNormal)?b=Autodesk.Viewing.Viewer.ScreenMode.kNormal:a===Autodesk.Viewing.Viewer.ScreenMode.kFullScreen&&this.isModeSupported(Autodesk.Viewing.Viewer.ScreenMode.kFullBrowser)&&(b=Autodesk.Viewing.Viewer.ScreenMode.kFullBrowser);
return b};Autodesk.Viewing.ScreenModeDelegate.prototype.getEscapeMode=function(){return this.getMode()!==Autodesk.Viewing.Viewer.ScreenMode.kNormal?Autodesk.Viewing.Viewer.ScreenMode.kNormal:void 0};Autodesk.Viewing.ScreenModeDelegate.prototype.fullscreenEventListener=function(){if(inFullscreen())this.viewer.resize();else{var a=Autodesk.Viewing.Viewer.ScreenMode;this.doScreenModeChange(a.kFullScreen,a.kNormal);this.onScreenModeChanged(a.kFullScreen,a.kNormal)}};
Autodesk.Viewing.ScreenModeDelegate.prototype.doScreenModeChange=function(a,b){throw"Implement doScreenModeChange() in derived class";};
Autodesk.Viewing.ScreenModeDelegate.prototype.onScreenModeChanged=function(a,b){a===Autodesk.Viewing.Viewer.ScreenMode.kFullScreen?(document.removeEventListener("fullscreenchange",this.bindFullscreenEventListener,!1),document.removeEventListener("mozfullscreenchange",this.bindFullscreenEventListener,!1),document.removeEventListener("webkitfullscreenchange",this.bindFullscreenEventListener,!1),document.removeEventListener("MSFullscreenChange",this.bindFullscreenEventListener,!1)):b===Autodesk.Viewing.Viewer.ScreenMode.kFullScreen&&
(document.addEventListener("fullscreenchange",this.bindFullscreenEventListener,!1),document.addEventListener("mozfullscreenchange",this.bindFullscreenEventListener,!1),document.addEventListener("webkitfullscreenchange",this.bindFullscreenEventListener,!1),document.addEventListener("MSFullscreenChange",this.bindFullscreenEventListener,!1));this.viewer.resize();this.viewer.fireEvent({type:Autodesk.Viewing.FULLSCREEN_MODE_EVENT,mode:b})};
Autodesk.Viewing.ViewerScreenModeDelegate=function(a){Autodesk.Viewing.ScreenModeDelegate.call(this,a)};Autodesk.Viewing.ViewerScreenModeDelegate.prototype=Object.create(Autodesk.Viewing.ScreenModeDelegate.prototype);Autodesk.Viewing.ViewerScreenModeDelegate.prototype.constructor=Autodesk.Viewing.ViewerScreenModeDelegate;
Autodesk.Viewing.ViewerScreenModeDelegate.prototype.getMode=function(){return inFullscreen()&&fullscreenElement()===this.viewer.container?Autodesk.Viewing.Viewer.ScreenMode.kFullScreen:this.viewer.container.classList.contains("viewer-fill-browser")?Autodesk.Viewing.Viewer.ScreenMode.kFullBrowser:Autodesk.Viewing.Viewer.ScreenMode.kNormal};Autodesk.Viewing.ViewerScreenModeDelegate.prototype.isModeSupported=function(a){return a===Autodesk.Viewing.Viewer.ScreenMode.kFullScreen?!isIOSDevice():!0};
Autodesk.Viewing.ViewerScreenModeDelegate.prototype.doScreenModeChange=function(a,b){var c=this.viewer.container;switch(b){case Autodesk.Viewing.Viewer.ScreenMode.kNormal:c.classList.remove("viewer-fill-browser");exitFullscreen();break;case Autodesk.Viewing.Viewer.ScreenMode.kFullBrowser:c.classList.add("viewer-fill-browser");break;case Autodesk.Viewing.Viewer.ScreenMode.kFullScreen:c.classList.add("viewer-fill-browser"),launchFullscreen(c)}};
Autodesk.Viewing.ApplicationScreenModeDelegate=function(a){Autodesk.Viewing.ScreenModeDelegate.call(this,a)};Autodesk.Viewing.ApplicationScreenModeDelegate.prototype=Object.create(Autodesk.Viewing.ScreenModeDelegate.prototype);Autodesk.Viewing.ApplicationScreenModeDelegate.prototype.constructor=Autodesk.Viewing.ApplicationScreenModeDelegate;Autodesk.Viewing.ApplicationScreenModeDelegate.prototype.isModeSupported=function(a){return a!==Autodesk.Viewing.Viewer.ScreenMode.kFullBrowser};
Autodesk.Viewing.ApplicationScreenModeDelegate.prototype.getMode=function(){return inFullscreen()&&fullscreenElement()===document.documentElement?Autodesk.Viewing.Viewer.ScreenMode.kFullScreen:Autodesk.Viewing.Viewer.ScreenMode.kNormal};Autodesk.Viewing.ApplicationScreenModeDelegate.prototype.doScreenModeChange=function(a,b){b===Autodesk.Viewing.Viewer.ScreenMode.kNormal?exitFullscreen():b===Autodesk.Viewing.Viewer.ScreenMode.kFullScreen&&launchFullscreen(document.documentElement)};
Autodesk.Viewing.NullScreenModeDelegate=function(a){Autodesk.Viewing.ScreenModeDelegate.call(this,a)};Autodesk.Viewing.NullScreenModeDelegate.prototype=Object.create(Autodesk.Viewing.ScreenModeDelegate.prototype);Autodesk.Viewing.NullScreenModeDelegate.prototype.constructor=Autodesk.Viewing.ScreenModeDelegate;Autodesk.Viewing.NullScreenModeDelegate.prototype.isModeSupported=function(a){return!1};Autodesk.Viewing.NullScreenModeDelegate.prototype.getMode=function(){return Autodesk.Viewing.Viewer.ScreenMode.kNormal};
"use strict";var THREE={REVISION:"69"};"object"===typeof module&&(module.exports=THREE);void 0===Math.sign&&(Math.sign=function(a){return 0>a?-1:0<a?1:0});THREE.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2};THREE.CullFaceNone=0;THREE.CullFaceBack=1;THREE.CullFaceFront=2;THREE.CullFaceFrontBack=3;THREE.FrontFaceDirectionCW=0;THREE.FrontFaceDirectionCCW=1;THREE.BasicShadowMap=0;THREE.PCFShadowMap=1;THREE.PCFSoftShadowMap=2;THREE.FrontSide=0;THREE.BackSide=1;THREE.DoubleSide=2;THREE.NoShading=0;
THREE.FlatShading=1;THREE.SmoothShading=2;THREE.NoColors=0;THREE.FaceColors=1;THREE.VertexColors=2;THREE.NoBlending=0;THREE.NormalBlending=1;THREE.AdditiveBlending=2;THREE.SubtractiveBlending=3;THREE.MultiplyBlending=4;THREE.CustomBlending=5;THREE.AddEquation=100;THREE.SubtractEquation=101;THREE.ReverseSubtractEquation=102;THREE.MinEquation=103;THREE.MaxEquation=104;THREE.ZeroFactor=200;THREE.OneFactor=201;THREE.SrcColorFactor=202;THREE.OneMinusSrcColorFactor=203;THREE.SrcAlphaFactor=204;
THREE.OneMinusSrcAlphaFactor=205;THREE.DstAlphaFactor=206;THREE.OneMinusDstAlphaFactor=207;THREE.DstColorFactor=208;THREE.OneMinusDstColorFactor=209;THREE.SrcAlphaSaturateFactor=210;THREE.MultiplyOperation=0;THREE.MixOperation=1;THREE.AddOperation=2;THREE.UVMapping=function(){};THREE.CubeReflectionMapping=function(){};THREE.CubeRefractionMapping=function(){};THREE.SphericalReflectionMapping=function(){};THREE.SphericalRefractionMapping=function(){};THREE.RepeatWrapping=1E3;
THREE.ClampToEdgeWrapping=1001;THREE.MirroredRepeatWrapping=1002;THREE.NearestFilter=1003;THREE.NearestMipMapNearestFilter=1004;THREE.NearestMipMapLinearFilter=1005;THREE.LinearFilter=1006;THREE.LinearMipMapNearestFilter=1007;THREE.LinearMipMapLinearFilter=1008;THREE.UnsignedByteType=1009;THREE.ByteType=1010;THREE.ShortType=1011;THREE.UnsignedShortType=1012;THREE.IntType=1013;THREE.UnsignedIntType=1014;THREE.FloatType=1015;THREE.UnsignedShort4444Type=1016;THREE.UnsignedShort5551Type=1017;
THREE.UnsignedShort565Type=1018;THREE.AlphaFormat=1019;THREE.RGBFormat=1020;THREE.RGBAFormat=1021;THREE.LuminanceFormat=1022;THREE.LuminanceAlphaFormat=1023;THREE.RGB_S3TC_DXT1_Format=2001;THREE.RGBA_S3TC_DXT1_Format=2002;THREE.RGBA_S3TC_DXT3_Format=2003;THREE.RGBA_S3TC_DXT5_Format=2004;THREE.RGB_PVRTC_4BPPV1_Format=2100;THREE.RGB_PVRTC_2BPPV1_Format=2101;THREE.RGBA_PVRTC_4BPPV1_Format=2102;THREE.RGBA_PVRTC_2BPPV1_Format=2103;
THREE.Color=function(a){return 3===arguments.length?this.setRGB(arguments[0],arguments[1],arguments[2]):this.set(a)};
THREE.Color.prototype={constructor:THREE.Color,r:1,g:1,b:1,set:function(a){a instanceof THREE.Color?this.copy(a):"number"===typeof a?this.setHex(a):"string"===typeof a&&this.setStyle(a);return this},setHex:function(a){a=Math.floor(a);this.r=(a>>16&255)/255;this.g=(a>>8&255)/255;this.b=(a&255)/255;return this},setRGB:function(a,b,c){this.r=a;this.g=b;this.b=c;return this},setHSL:function(a,b,c){if(0===b)this.r=this.g=this.b=c;else{var d=function(a,b,c){0>c&&(c+=1);1<c&&(c-=1);return c<1/6?a+6*(b-a)*
c:0.5>c?b:c<2/3?a+6*(b-a)*(2/3-c):a};b=0.5>=c?c*(1+b):c+b-c*b;c=2*c-b;this.r=d(c,b,a+1/3);this.g=d(c,b,a);this.b=d(c,b,a-1/3)}return this},setStyle:function(a){if(/^rgb\((\d+), ?(\d+), ?(\d+)\)$/i.test(a))return a=/^rgb\((\d+), ?(\d+), ?(\d+)\)$/i.exec(a),this.r=Math.min(255,parseInt(a[1],10))/255,this.g=Math.min(255,parseInt(a[2],10))/255,this.b=Math.min(255,parseInt(a[3],10))/255,this;if(/^rgb\((\d+)\%, ?(\d+)\%, ?(\d+)\%\)$/i.test(a))return a=/^rgb\((\d+)\%, ?(\d+)\%, ?(\d+)\%\)$/i.exec(a),this.r=
Math.min(100,parseInt(a[1],10))/100,this.g=Math.min(100,parseInt(a[2],10))/100,this.b=Math.min(100,parseInt(a[3],10))/100,this;if(/^\#([0-9a-f]{6})$/i.test(a))return a=/^\#([0-9a-f]{6})$/i.exec(a),this.setHex(parseInt(a[1],16)),this;if(/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.test(a))return a=/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(a),this.setHex(parseInt(a[1]+a[1]+a[2]+a[2]+a[3]+a[3],16)),this;if(/^(\w+)$/i.test(a))return this.setHex(THREE.ColorKeywords[a]),this},copy:function(a){this.r=a.r;this.g=
a.g;this.b=a.b;return this},copyGammaToLinear:function(a){this.r=a.r*a.r;this.g=a.g*a.g;this.b=a.b*a.b;return this},copyLinearToGamma:function(a){this.r=Math.sqrt(a.r);this.g=Math.sqrt(a.g);this.b=Math.sqrt(a.b);return this},convertGammaToLinear:function(){var a=this.r,b=this.g,c=this.b;this.r=a*a;this.g=b*b;this.b=c*c;return this},convertLinearToGamma:function(){this.r=Math.sqrt(this.r);this.g=Math.sqrt(this.g);this.b=Math.sqrt(this.b);return this},getHex:function(){return 255*this.r<<16^255*this.g<<
8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(a){a=a||{h:0,s:0,l:0};var b=this.r,c=this.g,d=this.b,f=Math.max(b,c,d),g=Math.min(b,c,d),h,k=(g+f)/2;if(g===f)g=h=0;else{var l=f-g,g=0.5>=k?l/(f+g):l/(2-f-g);switch(f){case b:h=(c-d)/l+(c<d?6:0);break;case c:h=(d-b)/l+2;break;case d:h=(b-c)/l+4}h/=6}a.h=h;a.s=g;a.l=k;return a},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(a,
b,c){var d=this.getHSL();d.h+=a;d.s+=b;d.l+=c;this.setHSL(d.h,d.s,d.l);return this},add:function(a){this.r+=a.r;this.g+=a.g;this.b+=a.b;return this},addColors:function(a,b){this.r=a.r+b.r;this.g=a.g+b.g;this.b=a.b+b.b;return this},addScalar:function(a){this.r+=a;this.g+=a;this.b+=a;return this},multiply:function(a){this.r*=a.r;this.g*=a.g;this.b*=a.b;return this},multiplyScalar:function(a){this.r*=a;this.g*=a;this.b*=a;return this},lerp:function(a,b){this.r+=(a.r-this.r)*b;this.g+=(a.g-this.g)*b;
this.b+=(a.b-this.b)*b;return this},equals:function(a){return a.r===this.r&&a.g===this.g&&a.b===this.b},fromArray:function(a){this.r=a[0];this.g=a[1];this.b=a[2];return this},toArray:function(){return[this.r,this.g,this.b]},clone:function(){return(new THREE.Color).setRGB(this.r,this.g,this.b)}};
THREE.ColorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,
darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,
grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,
lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,
palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,
tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};THREE.Quaternion=function(a,b,c,d){this._x=a||0;this._y=b||0;this._z=c||0;this._w=void 0!==d?d:1};
THREE.Quaternion.prototype={constructor:THREE.Quaternion,_x:0,_y:0,_z:0,_w:0,get x(){return this._x},set x(a){this._x=a;this.onChangeCallback()},get y(){return this._y},set y(a){this._y=a;this.onChangeCallback()},get z(){return this._z},set z(a){this._z=a;this.onChangeCallback()},get w(){return this._w},set w(a){this._w=a;this.onChangeCallback()},set:function(a,b,c,d){this._x=a;this._y=b;this._z=c;this._w=d;this.onChangeCallback();return this},copy:function(a){this._x=a.x;this._y=a.y;this._z=a.z;
this._w=a.w;this.onChangeCallback();return this},setFromEuler:function(a,b){if(!1===a instanceof THREE.Euler)throw Error("THREE.Quaternion: .setFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var c=Math.cos(a._x/2),d=Math.cos(a._y/2),f=Math.cos(a._z/2),g=Math.sin(a._x/2),h=Math.sin(a._y/2),k=Math.sin(a._z/2);"XYZ"===a.order?(this._x=g*d*f+c*h*k,this._y=c*h*f-g*d*k,this._z=c*d*k+g*h*f,this._w=c*d*f-g*h*k):"YXZ"===a.order?(this._x=g*d*f+c*h*k,this._y=c*h*f-g*d*k,this._z=
c*d*k-g*h*f,this._w=c*d*f+g*h*k):"ZXY"===a.order?(this._x=g*d*f-c*h*k,this._y=c*h*f+g*d*k,this._z=c*d*k+g*h*f,this._w=c*d*f-g*h*k):"ZYX"===a.order?(this._x=g*d*f-c*h*k,this._y=c*h*f+g*d*k,this._z=c*d*k-g*h*f,this._w=c*d*f+g*h*k):"YZX"===a.order?(this._x=g*d*f+c*h*k,this._y=c*h*f+g*d*k,this._z=c*d*k-g*h*f,this._w=c*d*f-g*h*k):"XZY"===a.order&&(this._x=g*d*f-c*h*k,this._y=c*h*f-g*d*k,this._z=c*d*k+g*h*f,this._w=c*d*f+g*h*k);if(!1!==b)this.onChangeCallback();return this},setFromAxisAngle:function(a,
b){var c=b/2,d=Math.sin(c);this._x=a.x*d;this._y=a.y*d;this._z=a.z*d;this._w=Math.cos(c);this.onChangeCallback();return this},setFromRotationMatrix:function(a){var b=a.elements,c=b[0];a=b[4];var d=b[8],f=b[1],g=b[5],h=b[9],k=b[2],l=b[6],b=b[10],m=c+g+b;0<m?(c=0.5/Math.sqrt(m+1),this._w=0.25/c,this._x=(l-h)*c,this._y=(d-k)*c,this._z=(f-a)*c):c>g&&c>b?(c=2*Math.sqrt(1+c-g-b),this._w=(l-h)/c,this._x=0.25*c,this._y=(a+f)/c,this._z=(d+k)/c):g>b?(c=2*Math.sqrt(1+g-c-b),this._w=(d-k)/c,this._x=(a+f)/c,this._y=
0.25*c,this._z=(h+l)/c):(c=2*Math.sqrt(1+b-c-g),this._w=(f-a)/c,this._x=(d+k)/c,this._y=(h+l)/c,this._z=0.25*c);this.onChangeCallback();return this},setFromUnitVectors:function(){var a,b;return function(c,d){void 0===a&&(a=new THREE.Vector3);b=c.dot(d)+1;1E-6>b?(b=0,Math.abs(c.x)>Math.abs(c.z)?a.set(-c.y,c.x,0):a.set(0,-c.z,c.y)):a.crossVectors(c,d);this._x=a.x;this._y=a.y;this._z=a.z;this._w=b;this.normalize();return this}}(),inverse:function(){this.conjugate().normalize();return this},conjugate:function(){this._x*=
-1;this._y*=-1;this._z*=-1;this.onChangeCallback();return this},dot:function(a){return this._x*a._x+this._y*a._y+this._z*a._z+this._w*a._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var a=this.length();0===a?(this._z=this._y=this._x=0,this._w=1):(a=1/a,this._x*=a,this._y*=a,this._z*=a,this._w*=a);this.onChangeCallback();return this},
multiply:function(a,b){return void 0!==b?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(a,b)):this.multiplyQuaternions(this,a)},multiplyQuaternions:function(a,b){var c=a._x,d=a._y,f=a._z,g=a._w,h=b._x,k=b._y,l=b._z,m=b._w;this._x=c*m+g*h+d*l-f*k;this._y=d*m+g*k+f*h-c*l;this._z=f*m+g*l+c*k-d*h;this._w=g*m-c*h-d*k-f*l;this.onChangeCallback();return this},multiplyVector3:function(a){console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead.");
return a.applyQuaternion(this)},slerp:function(a,b){if(0===b)return this;if(1===b)return this.copy(a);var c=this._x,d=this._y,f=this._z,g=this._w,h=g*a._w+c*a._x+d*a._y+f*a._z;0>h?(this._w=-a._w,this._x=-a._x,this._y=-a._y,this._z=-a._z,h=-h):this.copy(a);if(1<=h)return this._w=g,this._x=c,this._y=d,this._z=f,this;var k=Math.acos(h),l=Math.sqrt(1-h*h);if(0.0010>Math.abs(l))return this._w=0.5*(g+this._w),this._x=0.5*(c+this._x),this._y=0.5*(d+this._y),this._z=0.5*(f+this._z),this;h=Math.sin((1-b)*
k)/l;k=Math.sin(b*k)/l;this._w=g*h+this._w*k;this._x=c*h+this._x*k;this._y=d*h+this._y*k;this._z=f*h+this._z*k;this.onChangeCallback();return this},equals:function(a){return a._x===this._x&&a._y===this._y&&a._z===this._z&&a._w===this._w},fromArray:function(a,b){void 0===b&&(b=0);this._x=a[b];this._y=a[b+1];this._z=a[b+2];this._w=a[b+3];this.onChangeCallback();return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);a[b]=this._x;a[b+1]=this._y;a[b+2]=this._z;a[b+3]=this._w;return a},
onChange:function(a){this.onChangeCallback=a;return this},onChangeCallback:function(){},clone:function(){return new THREE.Quaternion(this._x,this._y,this._z,this._w)}};THREE.Quaternion.slerp=function(a,b,c,d){return c.copy(a).slerp(b,d)};THREE.Vector2=function(a,b){this.x=a||0;this.y=b||0};
THREE.Vector2.prototype={constructor:THREE.Vector2,set:function(a,b){this.x=a;this.y=b;return this},setX:function(a){this.x=a;return this},setY:function(a){this.y=a;return this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;default:throw Error("index is out of range: "+a);}},getComponent:function(a){switch(a){case 0:return this.x;case 1:return this.y;default:throw Error("index is out of range: "+a);}},copy:function(a){this.x=a.x;this.y=a.y;return this},add:function(a,
b){if(void 0!==b)return console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(a,b);this.x+=a.x;this.y+=a.y;return this},addVectors:function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;return this},addScalar:function(a){this.x+=a;this.y+=a;return this},sub:function(a,b){if(void 0!==b)return console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(a,b);this.x-=a.x;this.y-=a.y;return this},
subVectors:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;return this},multiply:function(a){this.x*=a.x;this.y*=a.y;return this},multiplyScalar:function(a){this.x*=a;this.y*=a;return this},divide:function(a){this.x/=a.x;this.y/=a.y;return this},divideScalar:function(a){0!==a?(a=1/a,this.x*=a,this.y*=a):this.y=this.x=0;return this},min:function(a){this.x>a.x&&(this.x=a.x);this.y>a.y&&(this.y=a.y);return this},max:function(a){this.x<a.x&&(this.x=a.x);this.y<a.y&&(this.y=a.y);return this},clamp:function(a,
b){this.x<a.x?this.x=a.x:this.x>b.x&&(this.x=b.x);this.y<a.y?this.y=a.y:this.y>b.y&&(this.y=b.y);return this},clampScalar:function(){var a,b;return function(c,d){void 0===a&&(a=new THREE.Vector2,b=new THREE.Vector2);a.set(c,c);b.set(d,d);return this.clamp(a,b)}}(),floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);return this},ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);return this},round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this},
roundToZero:function(){this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x);this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y);return this},negate:function(){this.x=-this.x;this.y=-this.y;return this},dot:function(a){return this.x*a.x+this.y*a.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},distanceToSquared:function(a){var b=
this.x-a.x;a=this.y-a.y;return b*b+a*a},setLength:function(a){var b=this.length();0!==b&&a!==b&&this.multiplyScalar(a/b);return this},lerp:function(a,b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;return this},equals:function(a){return a.x===this.x&&a.y===this.y},fromArray:function(a,b){void 0===b&&(b=0);this.x=a[b];this.y=a[b+1];return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);a[b]=this.x;a[b+1]=this.y;return a},clone:function(){return new THREE.Vector2(this.x,this.y)}};
THREE.Vector3=function(a,b,c){this.x=a||0;this.y=b||0;this.z=c||0};
THREE.Vector3.prototype={constructor:THREE.Vector3,set:function(a,b,c){this.x=a;this.y=b;this.z=c;return this},setX:function(a){this.x=a;return this},setY:function(a){this.y=a;return this},setZ:function(a){this.z=a;return this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;case 2:this.z=b;break;default:throw Error("index is out of range: "+a);}},getComponent:function(a){switch(a){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw Error("index is out of range: "+
a);}},copy:function(a){this.x=a.x;this.y=a.y;this.z=a.z;return this},add:function(a,b){if(void 0!==b)return console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(a,b);this.x+=a.x;this.y+=a.y;this.z+=a.z;return this},addScalar:function(a){this.x+=a;this.y+=a;this.z+=a;return this},addVectors:function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;this.z=a.z+b.z;return this},sub:function(a,b){if(void 0!==b)return console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),
this.subVectors(a,b);this.x-=a.x;this.y-=a.y;this.z-=a.z;return this},subVectors:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;this.z=a.z-b.z;return this},multiply:function(a,b){if(void 0!==b)return console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(a,b);this.x*=a.x;this.y*=a.y;this.z*=a.z;return this},multiplyScalar:function(a){this.x*=a;this.y*=a;this.z*=a;return this},multiplyVectors:function(a,b){this.x=a.x*b.x;this.y=
a.y*b.y;this.z=a.z*b.z;return this},applyEuler:function(){var a;return function(b){!1===b instanceof THREE.Euler&&console.error("THREE.Vector3: .applyEuler() now expects a Euler rotation rather than a Vector3 and order.");void 0===a&&(a=new THREE.Quaternion);this.applyQuaternion(a.setFromEuler(b));return this}}(),applyAxisAngle:function(){var a;return function(b,c){void 0===a&&(a=new THREE.Quaternion);this.applyQuaternion(a.setFromAxisAngle(b,c));return this}}(),applyMatrix3:function(a){var b=this.x,
c=this.y,d=this.z;a=a.elements;this.x=a[0]*b+a[3]*c+a[6]*d;this.y=a[1]*b+a[4]*c+a[7]*d;this.z=a[2]*b+a[5]*c+a[8]*d;return this},applyMatrix4:function(a){var b=this.x,c=this.y,d=this.z;a=a.elements;this.x=a[0]*b+a[4]*c+a[8]*d+a[12];this.y=a[1]*b+a[5]*c+a[9]*d+a[13];this.z=a[2]*b+a[6]*c+a[10]*d+a[14];return this},applyProjection:function(a){var b=this.x,c=this.y,d=this.z;a=a.elements;var f=1/(a[3]*b+a[7]*c+a[11]*d+a[15]);this.x=(a[0]*b+a[4]*c+a[8]*d+a[12])*f;this.y=(a[1]*b+a[5]*c+a[9]*d+a[13])*f;this.z=
(a[2]*b+a[6]*c+a[10]*d+a[14])*f;return this},applyQuaternion:function(a){var b=this.x,c=this.y,d=this.z,f=a.x,g=a.y,h=a.z;a=a.w;var k=a*b+g*d-h*c,l=a*c+h*b-f*d,m=a*d+f*c-g*b,b=-f*b-g*c-h*d;this.x=k*a+b*-f+l*-h-m*-g;this.y=l*a+b*-g+m*-f-k*-h;this.z=m*a+b*-h+k*-g-l*-f;return this},project:function(){var a;return function(b){void 0===a&&(a=new THREE.Matrix4);a.multiplyMatrices(b.projectionMatrix,a.getInverse(b.matrixWorld));return this.applyProjection(a)}}(),unproject:function(){var a;return function(b){void 0===
a&&(a=new THREE.Matrix4);a.multiplyMatrices(b.matrixWorld,a.getInverse(b.projectionMatrix));return this.applyProjection(a)}}(),transformDirection:function(a){var b=this.x,c=this.y,d=this.z;a=a.elements;this.x=a[0]*b+a[4]*c+a[8]*d;this.y=a[1]*b+a[5]*c+a[9]*d;this.z=a[2]*b+a[6]*c+a[10]*d;this.normalize();return this},divide:function(a){this.x/=a.x;this.y/=a.y;this.z/=a.z;return this},divideScalar:function(a){0!==a?(a=1/a,this.x*=a,this.y*=a,this.z*=a):this.z=this.y=this.x=0;return this},min:function(a){this.x>
a.x&&(this.x=a.x);this.y>a.y&&(this.y=a.y);this.z>a.z&&(this.z=a.z);return this},max:function(a){this.x<a.x&&(this.x=a.x);this.y<a.y&&(this.y=a.y);this.z<a.z&&(this.z=a.z);return this},clamp:function(a,b){this.x<a.x?this.x=a.x:this.x>b.x&&(this.x=b.x);this.y<a.y?this.y=a.y:this.y>b.y&&(this.y=b.y);this.z<a.z?this.z=a.z:this.z>b.z&&(this.z=b.z);return this},clampScalar:function(){var a,b;return function(c,d){void 0===a&&(a=new THREE.Vector3,b=new THREE.Vector3);a.set(c,c,c);b.set(d,d,d);return this.clamp(a,
b)}}(),floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);this.z=Math.floor(this.z);return this},ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);this.z=Math.ceil(this.z);return this},round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);this.z=Math.round(this.z);return this},roundToZero:function(){this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x);this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y);this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z);
return this},negate:function(){this.x=-this.x;this.y=-this.y;this.z=-this.z;return this},dot:function(a){return this.x*a.x+this.y*a.y+this.z*a.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(a){var b=this.length();0!==b&&a!==b&&this.multiplyScalar(a/
b);return this},lerp:function(a,b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;this.z+=(a.z-this.z)*b;return this},cross:function(a,b){if(void 0!==b)return console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(a,b);var c=this.x,d=this.y,f=this.z;this.x=d*a.z-f*a.y;this.y=f*a.x-c*a.z;this.z=c*a.y-d*a.x;return this},crossVectors:function(a,b){var c=a.x,d=a.y,f=a.z,g=b.x,h=b.y,k=b.z;this.x=d*k-f*h;this.y=f*g-c*k;this.z=c*h-d*g;return this},
projectOnVector:function(){var a,b;return function(c){void 0===a&&(a=new THREE.Vector3);a.copy(c).normalize();b=this.dot(a);return this.copy(a).multiplyScalar(b)}}(),projectOnPlane:function(){var a;return function(b){void 0===a&&(a=new THREE.Vector3);a.copy(this).projectOnVector(b);return this.sub(a)}}(),reflect:function(){var a;return function(b){void 0===a&&(a=new THREE.Vector3);return this.sub(a.copy(b).multiplyScalar(2*this.dot(b)))}}(),angleTo:function(a){a=this.dot(a)/(this.length()*a.length());
return Math.acos(THREE.Math.clamp(a,-1,1))},distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},distanceToSquared:function(a){var b=this.x-a.x,c=this.y-a.y;a=this.z-a.z;return b*b+c*c+a*a},setEulerFromRotationMatrix:function(a,b){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(a,b){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},
getPositionFromMatrix:function(a){console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition().");return this.setFromMatrixPosition(a)},getScaleFromMatrix:function(a){console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale().");return this.setFromMatrixScale(a)},getColumnFromMatrix:function(a,b){console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn().");return this.setFromMatrixColumn(a,
b)},setFromMatrixPosition:function(a){this.x=a.elements[12];this.y=a.elements[13];this.z=a.elements[14];return this},setFromMatrixScale:function(a){var b=this.set(a.elements[0],a.elements[1],a.elements[2]).length(),c=this.set(a.elements[4],a.elements[5],a.elements[6]).length();a=this.set(a.elements[8],a.elements[9],a.elements[10]).length();this.x=b;this.y=c;this.z=a;return this},setFromMatrixColumn:function(a,b){var c=4*a,d=b.elements;this.x=d[c];this.y=d[c+1];this.z=d[c+2];return this},equals:function(a){return a.x===
this.x&&a.y===this.y&&a.z===this.z},fromArray:function(a,b){void 0===b&&(b=0);this.x=a[b];this.y=a[b+1];this.z=a[b+2];return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);a[b]=this.x;a[b+1]=this.y;a[b+2]=this.z;return a},clone:function(){return new THREE.Vector3(this.x,this.y,this.z)}};THREE.Vector4=function(a,b,c,d){this.x=a||0;this.y=b||0;this.z=c||0;this.w=void 0!==d?d:1};
THREE.Vector4.prototype={constructor:THREE.Vector4,set:function(a,b,c,d){this.x=a;this.y=b;this.z=c;this.w=d;return this},setX:function(a){this.x=a;return this},setY:function(a){this.y=a;return this},setZ:function(a){this.z=a;return this},setW:function(a){this.w=a;return this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;case 2:this.z=b;break;case 3:this.w=b;break;default:throw Error("index is out of range: "+a);}},getComponent:function(a){switch(a){case 0:return this.x;
case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw Error("index is out of range: "+a);}},copy:function(a){this.x=a.x;this.y=a.y;this.z=a.z;this.w=void 0!==a.w?a.w:1;return this},add:function(a,b){if(void 0!==b)return console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(a,b);this.x+=a.x;this.y+=a.y;this.z+=a.z;this.w+=a.w;return this},addScalar:function(a){this.x+=a;this.y+=a;this.z+=a;this.w+=a;return this},
addVectors:function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;this.z=a.z+b.z;this.w=a.w+b.w;return this},sub:function(a,b){if(void 0!==b)return console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(a,b);this.x-=a.x;this.y-=a.y;this.z-=a.z;this.w-=a.w;return this},subVectors:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;this.z=a.z-b.z;this.w=a.w-b.w;return this},multiplyScalar:function(a){this.x*=a;this.y*=a;this.z*=a;this.w*=a;return this},applyMatrix4:function(a){var b=
this.x,c=this.y,d=this.z,f=this.w;a=a.elements;this.x=a[0]*b+a[4]*c+a[8]*d+a[12]*f;this.y=a[1]*b+a[5]*c+a[9]*d+a[13]*f;this.z=a[2]*b+a[6]*c+a[10]*d+a[14]*f;this.w=a[3]*b+a[7]*c+a[11]*d+a[15]*f;return this},divideScalar:function(a){0!==a?(a=1/a,this.x*=a,this.y*=a,this.z*=a,this.w*=a):(this.z=this.y=this.x=0,this.w=1);return this},setAxisAngleFromQuaternion:function(a){this.w=2*Math.acos(a.w);var b=Math.sqrt(1-a.w*a.w);1E-4>b?(this.x=1,this.z=this.y=0):(this.x=a.x/b,this.y=a.y/b,this.z=a.z/b);return this},
setAxisAngleFromRotationMatrix:function(a){var b,c,d;a=a.elements;var f=a[0];d=a[4];var g=a[8],h=a[1],k=a[5],l=a[9];c=a[2];b=a[6];var m=a[10];if(0.01>Math.abs(d-h)&&0.01>Math.abs(g-c)&&0.01>Math.abs(l-b)){if(0.1>Math.abs(d+h)&&0.1>Math.abs(g+c)&&0.1>Math.abs(l+b)&&0.1>Math.abs(f+k+m-3))return this.set(1,0,0,0),this;a=Math.PI;f=(f+1)/2;k=(k+1)/2;m=(m+1)/2;d=(d+h)/4;g=(g+c)/4;l=(l+b)/4;f>k&&f>m?0.01>f?(b=0,d=c=0.707106781):(b=Math.sqrt(f),c=d/b,d=g/b):k>m?0.01>k?(b=0.707106781,c=0,d=0.707106781):(c=
Math.sqrt(k),b=d/c,d=l/c):0.01>m?(c=b=0.707106781,d=0):(d=Math.sqrt(m),b=g/d,c=l/d);this.set(b,c,d,a);return this}a=Math.sqrt((b-l)*(b-l)+(g-c)*(g-c)+(h-d)*(h-d));0.0010>Math.abs(a)&&(a=1);this.x=(b-l)/a;this.y=(g-c)/a;this.z=(h-d)/a;this.w=Math.acos((f+k+m-1)/2);return this},min:function(a){this.x>a.x&&(this.x=a.x);this.y>a.y&&(this.y=a.y);this.z>a.z&&(this.z=a.z);this.w>a.w&&(this.w=a.w);return this},max:function(a){this.x<a.x&&(this.x=a.x);this.y<a.y&&(this.y=a.y);this.z<a.z&&(this.z=a.z);this.w<
a.w&&(this.w=a.w);return this},clamp:function(a,b){this.x<a.x?this.x=a.x:this.x>b.x&&(this.x=b.x);this.y<a.y?this.y=a.y:this.y>b.y&&(this.y=b.y);this.z<a.z?this.z=a.z:this.z>b.z&&(this.z=b.z);this.w<a.w?this.w=a.w:this.w>b.w&&(this.w=b.w);return this},clampScalar:function(){var a,b;return function(c,d){void 0===a&&(a=new THREE.Vector4,b=new THREE.Vector4);a.set(c,c,c,c);b.set(d,d,d,d);return this.clamp(a,b)}}(),floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);this.z=Math.floor(this.z);
this.w=Math.floor(this.w);return this},ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);this.z=Math.ceil(this.z);this.w=Math.ceil(this.w);return this},round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);this.z=Math.round(this.z);this.w=Math.round(this.w);return this},roundToZero:function(){this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x);this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y);this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z);this.w=0>this.w?Math.ceil(this.w):
Math.floor(this.w);return this},negate:function(){this.x=-this.x;this.y=-this.y;this.z=-this.z;this.w=-this.w;return this},dot:function(a){return this.x*a.x+this.y*a.y+this.z*a.z+this.w*a.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length())},
setLength:function(a){var b=this.length();0!==b&&a!==b&&this.multiplyScalar(a/b);return this},lerp:function(a,b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;this.z+=(a.z-this.z)*b;this.w+=(a.w-this.w)*b;return this},equals:function(a){return a.x===this.x&&a.y===this.y&&a.z===this.z&&a.w===this.w},fromArray:function(a,b){void 0===b&&(b=0);this.x=a[b];this.y=a[b+1];this.z=a[b+2];this.w=a[b+3];return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);a[b]=this.x;a[b+1]=this.y;a[b+2]=
this.z;a[b+3]=this.w;return a},clone:function(){return new THREE.Vector4(this.x,this.y,this.z,this.w)}};THREE.Euler=function(a,b,c,d){this._x=a||0;this._y=b||0;this._z=c||0;this._order=d||THREE.Euler.DefaultOrder};THREE.Euler.RotationOrders="XYZ YZX ZXY XZY YXZ ZYX".split(" ");THREE.Euler.DefaultOrder="XYZ";
THREE.Euler.prototype={constructor:THREE.Euler,_x:0,_y:0,_z:0,_order:THREE.Euler.DefaultOrder,get x(){return this._x},set x(a){this._x=a;this.onChangeCallback()},get y(){return this._y},set y(a){this._y=a;this.onChangeCallback()},get z(){return this._z},set z(a){this._z=a;this.onChangeCallback()},get order(){return this._order},set order(a){this._order=a;this.onChangeCallback()},set:function(a,b,c,d){this._x=a;this._y=b;this._z=c;this._order=d||this._order;this.onChangeCallback();return this},copy:function(a){this._x=
a._x;this._y=a._y;this._z=a._z;this._order=a._order;this.onChangeCallback();return this},setFromRotationMatrix:function(a,b){var c=THREE.Math.clamp,d=a.elements,f=d[0],g=d[4],h=d[8],k=d[1],l=d[5],m=d[9],p=d[2],n=d[6],d=d[10];b=b||this._order;"XYZ"===b?(this._y=Math.asin(c(h,-1,1)),0.99999>Math.abs(h)?(this._x=Math.atan2(-m,d),this._z=Math.atan2(-g,f)):(this._x=Math.atan2(n,l),this._z=0)):"YXZ"===b?(this._x=Math.asin(-c(m,-1,1)),0.99999>Math.abs(m)?(this._y=Math.atan2(h,d),this._z=Math.atan2(k,l)):
(this._y=Math.atan2(-p,f),this._z=0)):"ZXY"===b?(this._x=Math.asin(c(n,-1,1)),0.99999>Math.abs(n)?(this._y=Math.atan2(-p,d),this._z=Math.atan2(-g,l)):(this._y=0,this._z=Math.atan2(k,f))):"ZYX"===b?(this._y=Math.asin(-c(p,-1,1)),0.99999>Math.abs(p)?(this._x=Math.atan2(n,d),this._z=Math.atan2(k,f)):(this._x=0,this._z=Math.atan2(-g,l))):"YZX"===b?(this._z=Math.asin(c(k,-1,1)),0.99999>Math.abs(k)?(this._x=Math.atan2(-m,l),this._y=Math.atan2(-p,f)):(this._x=0,this._y=Math.atan2(h,d))):"XZY"===b?(this._z=
Math.asin(-c(g,-1,1)),0.99999>Math.abs(g)?(this._x=Math.atan2(n,l),this._y=Math.atan2(h,f)):(this._x=Math.atan2(-m,d),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+b);this._order=b;this.onChangeCallback();return this},setFromQuaternion:function(a,b,c){var d=THREE.Math.clamp,f=a.x*a.x,g=a.y*a.y,h=a.z*a.z,k=a.w*a.w;b=b||this._order;"XYZ"===b?(this._x=Math.atan2(2*(a.x*a.w-a.y*a.z),k-f-g+h),this._y=Math.asin(d(2*(a.x*a.z+a.y*a.w),-1,1)),this._z=Math.atan2(2*
(a.z*a.w-a.x*a.y),k+f-g-h)):"YXZ"===b?(this._x=Math.asin(d(2*(a.x*a.w-a.y*a.z),-1,1)),this._y=Math.atan2(2*(a.x*a.z+a.y*a.w),k-f-g+h),this._z=Math.atan2(2*(a.x*a.y+a.z*a.w),k-f+g-h)):"ZXY"===b?(this._x=Math.asin(d(2*(a.x*a.w+a.y*a.z),-1,1)),this._y=Math.atan2(2*(a.y*a.w-a.z*a.x),k-f-g+h),this._z=Math.atan2(2*(a.z*a.w-a.x*a.y),k-f+g-h)):"ZYX"===b?(this._x=Math.atan2(2*(a.x*a.w+a.z*a.y),k-f-g+h),this._y=Math.asin(d(2*(a.y*a.w-a.x*a.z),-1,1)),this._z=Math.atan2(2*(a.x*a.y+a.z*a.w),k+f-g-h)):"YZX"===
b?(this._x=Math.atan2(2*(a.x*a.w-a.z*a.y),k-f+g-h),this._y=Math.atan2(2*(a.y*a.w-a.x*a.z),k+f-g-h),this._z=Math.asin(d(2*(a.x*a.y+a.z*a.w),-1,1))):"XZY"===b?(this._x=Math.atan2(2*(a.x*a.w+a.y*a.z),k-f+g-h),this._y=Math.atan2(2*(a.x*a.z+a.y*a.w),k+f-g-h),this._z=Math.asin(d(2*(a.z*a.w-a.x*a.y),-1,1))):console.warn("THREE.Euler: .setFromQuaternion() given unsupported order: "+b);this._order=b;if(!1!==c)this.onChangeCallback();return this},reorder:function(){var a=new THREE.Quaternion;return function(b){a.setFromEuler(this);
this.setFromQuaternion(a,b)}}(),equals:function(a){return a._x===this._x&&a._y===this._y&&a._z===this._z&&a._order===this._order},fromArray:function(a){this._x=a[0];this._y=a[1];this._z=a[2];void 0!==a[3]&&(this._order=a[3]);this.onChangeCallback();return this},toArray:function(){return[this._x,this._y,this._z,this._order]},onChange:function(a){this.onChangeCallback=a;return this},onChangeCallback:function(){},clone:function(){return new THREE.Euler(this._x,this._y,this._z,this._order)}};
THREE.Line3=function(a,b){this.start=void 0!==a?a:new THREE.Vector3;this.end=void 0!==b?b:new THREE.Vector3};
THREE.Line3.prototype={constructor:THREE.Line3,set:function(a,b){this.start.copy(a);this.end.copy(b);return this},copy:function(a){this.start.copy(a.start);this.end.copy(a.end);return this},center:function(a){return(a||new THREE.Vector3).addVectors(this.start,this.end).multiplyScalar(0.5)},delta:function(a){return(a||new THREE.Vector3).subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(a,
b){var c=b||new THREE.Vector3;return this.delta(c).multiplyScalar(a).add(this.start)},closestPointToPointParameter:function(){var a=new THREE.Vector3,b=new THREE.Vector3;return function(c,d){a.subVectors(c,this.start);b.subVectors(this.end,this.start);var f=b.dot(b),f=b.dot(a)/f;d&&(f=THREE.Math.clamp(f,0,1));return f}}(),closestPointToPoint:function(a,b,c){a=this.closestPointToPointParameter(a,b);c=c||new THREE.Vector3;return this.delta(c).multiplyScalar(a).add(this.start)},applyMatrix4:function(a){this.start.applyMatrix4(a);
this.end.applyMatrix4(a);return this},equals:function(a){return a.start.equals(this.start)&&a.end.equals(this.end)},clone:function(){return(new THREE.Line3).copy(this)}};THREE.Box2=function(a,b){this.min=void 0!==a?a:new THREE.Vector2(Infinity,Infinity);this.max=void 0!==b?b:new THREE.Vector2(-Infinity,-Infinity)};
THREE.Box2.prototype={constructor:THREE.Box2,set:function(a,b){this.min.copy(a);this.max.copy(b);return this},setFromPoints:function(a){this.makeEmpty();for(var b=0,c=a.length;b<c;b++)this.expandByPoint(a[b]);return this},setFromCenterAndSize:function(){var a=new THREE.Vector2;return function(b,c){var d=a.copy(c).multiplyScalar(0.5);this.min.copy(b).sub(d);this.max.copy(b).add(d);return this}}(),copy:function(a){this.min.copy(a.min);this.max.copy(a.max);return this},makeEmpty:function(){this.min.x=
this.min.y=Infinity;this.max.x=this.max.y=-Infinity;return this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},center:function(a){return(a||new THREE.Vector2).addVectors(this.min,this.max).multiplyScalar(0.5)},size:function(a){return(a||new THREE.Vector2).subVectors(this.max,this.min)},expandByPoint:function(a){this.min.min(a);this.max.max(a);return this},expandByVector:function(a){this.min.sub(a);this.max.add(a);return this},expandByScalar:function(a){this.min.addScalar(-a);
this.max.addScalar(a);return this},containsPoint:function(a){return a.x<this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y?!1:!0},containsBox:function(a){return this.min.x<=a.min.x&&a.max.x<=this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y?!0:!1},getParameter:function(a,b){return(b||new THREE.Vector2).set((a.x-this.min.x)/(this.max.x-this.min.x),(a.y-this.min.y)/(this.max.y-this.min.y))},isIntersectionBox:function(a){return a.max.x<this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>
this.max.y?!1:!0},clampPoint:function(a,b){return(b||new THREE.Vector2).copy(a).clamp(this.min,this.max)},distanceToPoint:function(){var a=new THREE.Vector2;return function(b){return a.copy(b).clamp(this.min,this.max).sub(b).length()}}(),intersect:function(a){this.min.max(a.min);this.max.min(a.max);return this},union:function(a){this.min.min(a.min);this.max.max(a.max);return this},translate:function(a){this.min.add(a);this.max.add(a);return this},equals:function(a){return a.min.equals(this.min)&&
a.max.equals(this.max)},clone:function(){return(new THREE.Box2).copy(this)}};THREE.Box3=function(a,b){this.min=void 0!==a?a:new THREE.Vector3(Infinity,Infinity,Infinity);this.max=void 0!==b?b:new THREE.Vector3(-Infinity,-Infinity,-Infinity)};
THREE.Box3.prototype={constructor:THREE.Box3,set:function(a,b){this.min.copy(a);this.max.copy(b);return this},setFromPoints:function(a){this.makeEmpty();for(var b=0,c=a.length;b<c;b++)this.expandByPoint(a[b]);return this},setFromCenterAndSize:function(){var a=new THREE.Vector3;return function(b,c){var d=a.copy(c).multiplyScalar(0.5);this.min.copy(b).sub(d);this.max.copy(b).add(d);return this}}(),setFromObject:function(){var a=new THREE.Vector3;return function(b){var c=this;b.updateMatrixWorld(!0);
this.makeEmpty();b.traverse(function(b){var f=b.geometry;if(void 0!==f)if(f instanceof THREE.Geometry)for(var g=f.vertices,f=0,h=g.length;f<h;f++)a.copy(g[f]),a.applyMatrix4(b.matrixWorld),c.expandByPoint(a);else if(f instanceof THREE.BufferGeometry&&void 0!==f.attributes.position)for(g=f.attributes.position.array,f=0,h=g.length;f<h;f+=3)a.set(g[f],g[f+1],g[f+2]),a.applyMatrix4(b.matrixWorld),c.expandByPoint(a)});return this}}(),copy:function(a){this.min.copy(a.min);this.max.copy(a.max);return this},
makeEmpty:function(){this.min.x=this.min.y=this.min.z=Infinity;this.max.x=this.max.y=this.max.z=-Infinity;return this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},center:function(a){return(a||new THREE.Vector3).addVectors(this.min,this.max).multiplyScalar(0.5)},size:function(a){return(a||new THREE.Vector3).subVectors(this.max,this.min)},expandByPoint:function(a){this.min.min(a);this.max.max(a);return this},expandByVector:function(a){this.min.sub(a);
this.max.add(a);return this},expandByScalar:function(a){this.min.addScalar(-a);this.max.addScalar(a);return this},containsPoint:function(a){return a.x<this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y||a.z<this.min.z||a.z>this.max.z?!1:!0},containsBox:function(a){return this.min.x<=a.min.x&&a.max.x<=this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y&&this.min.z<=a.min.z&&a.max.z<=this.max.z?!0:!1},getParameter:function(a,b){return(b||new THREE.Vector3).set((a.x-this.min.x)/(this.max.x-
this.min.x),(a.y-this.min.y)/(this.max.y-this.min.y),(a.z-this.min.z)/(this.max.z-this.min.z))},isIntersectionBox:function(a){return a.max.x<this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>this.max.y||a.max.z<this.min.z||a.min.z>this.max.z?!1:!0},clampPoint:function(a,b){return(b||new THREE.Vector3).copy(a).clamp(this.min,this.max)},distanceToPoint:function(){var a=new THREE.Vector3;return function(b){return a.copy(b).clamp(this.min,this.max).sub(b).length()}}(),getBoundingSphere:function(){var a=
new THREE.Vector3;return function(b){b=b||new THREE.Sphere;b.center=this.center();b.radius=0.5*this.size(a).length();return b}}(),intersect:function(a){this.min.max(a.min);this.max.min(a.max);return this},union:function(a){this.min.min(a.min);this.max.max(a.max);return this},applyMatrix4:function(){var a=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3];return function(b){a[0].set(this.min.x,this.min.y,
this.min.z).applyMatrix4(b);a[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(b);a[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(b);a[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(b);a[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(b);a[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(b);a[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(b);a[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(b);this.makeEmpty();this.setFromPoints(a);return this}}(),translate:function(a){this.min.add(a);
this.max.add(a);return this},equals:function(a){return a.min.equals(this.min)&&a.max.equals(this.max)},clone:function(){return(new THREE.Box3).copy(this)}};THREE.Matrix3=function(){this.elements=new Float32Array([1,0,0,0,1,0,0,0,1]);0<arguments.length&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")};
THREE.Matrix3.prototype={constructor:THREE.Matrix3,set:function(a,b,c,d,f,g,h,k,l){var m=this.elements;m[0]=a;m[3]=b;m[6]=c;m[1]=d;m[4]=f;m[7]=g;m[2]=h;m[5]=k;m[8]=l;return this},identity:function(){this.set(1,0,0,0,1,0,0,0,1);return this},copy:function(a){a=a.elements;this.set(a[0],a[3],a[6],a[1],a[4],a[7],a[2],a[5],a[8]);return this},multiplyVector3:function(a){console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead.");return a.applyMatrix3(this)},
multiplyVector3Array:function(a){console.warn("THREE.Matrix3: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead.");return this.applyToVector3Array(a)},applyToVector3Array:function(){var a=new THREE.Vector3;return function(b,c,d){void 0===c&&(c=0);void 0===d&&(d=b.length);for(var f=0;f<d;f+=3,c+=3)a.x=b[c],a.y=b[c+1],a.z=b[c+2],a.applyMatrix3(this),b[c]=a.x,b[c+1]=a.y,b[c+2]=a.z;return b}}(),multiplyScalar:function(a){var b=this.elements;b[0]*=a;b[3]*=a;b[6]*=
a;b[1]*=a;b[4]*=a;b[7]*=a;b[2]*=a;b[5]*=a;b[8]*=a;return this},determinant:function(){var a=this.elements,b=a[0],c=a[1],d=a[2],f=a[3],g=a[4],h=a[5],k=a[6],l=a[7],a=a[8];return b*g*a-b*h*l-c*f*a+c*h*k+d*f*l-d*g*k},getInverse:function(a,b){var c=a.elements,d=this.elements;d[0]=c[10]*c[5]-c[6]*c[9];d[1]=-c[10]*c[1]+c[2]*c[9];d[2]=c[6]*c[1]-c[2]*c[5];d[3]=-c[10]*c[4]+c[6]*c[8];d[4]=c[10]*c[0]-c[2]*c[8];d[5]=-c[6]*c[0]+c[2]*c[4];d[6]=c[9]*c[4]-c[5]*c[8];d[7]=-c[9]*c[0]+c[1]*c[8];d[8]=c[5]*c[0]-c[1]*c[4];
c=c[0]*d[0]+c[1]*d[3]+c[2]*d[6];if(0===c){if(b)throw Error("Matrix3.getInverse(): can't invert matrix, determinant is 0");console.warn("Matrix3.getInverse(): can't invert matrix, determinant is 0");this.identity();return this}this.multiplyScalar(1/c);return this},transpose:function(){var a,b=this.elements;a=b[1];b[1]=b[3];b[3]=a;a=b[2];b[2]=b[6];b[6]=a;a=b[5];b[5]=b[7];b[7]=a;return this},flattenToArrayOffset:function(a,b){var c=this.elements;a[b]=c[0];a[b+1]=c[1];a[b+2]=c[2];a[b+3]=c[3];a[b+4]=c[4];
a[b+5]=c[5];a[b+6]=c[6];a[b+7]=c[7];a[b+8]=c[8];return a},getNormalMatrix:function(a){this.getInverse(a).transpose();return this},transposeIntoArray:function(a){var b=this.elements;a[0]=b[0];a[1]=b[3];a[2]=b[6];a[3]=b[1];a[4]=b[4];a[5]=b[7];a[6]=b[2];a[7]=b[5];a[8]=b[8];return this},fromArray:function(a){this.elements.set(a);return this},toArray:function(){var a=this.elements;return[a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8]]},clone:function(){return(new THREE.Matrix3).fromArray(this.elements)}};
THREE.Matrix4=function(){this.elements=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);0<arguments.length&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")};
THREE.Matrix4.prototype={constructor:THREE.Matrix4,set:function(a,b,c,d,f,g,h,k,l,m,p,n,q,r,v,s){var w=this.elements;w[0]=a;w[4]=b;w[8]=c;w[12]=d;w[1]=f;w[5]=g;w[9]=h;w[13]=k;w[2]=l;w[6]=m;w[10]=p;w[14]=n;w[3]=q;w[7]=r;w[11]=v;w[15]=s;return this},identity:function(){this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return this},copy:function(a){this.elements.set(a.elements);return this},extractPosition:function(a){console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition().");return this.copyPosition(a)},
copyPosition:function(a){var b=this.elements;a=a.elements;b[12]=a[12];b[13]=a[13];b[14]=a[14];return this},extractRotation:function(){var a=new THREE.Vector3;return function(b){var c=this.elements;b=b.elements;var d=1/a.set(b[0],b[1],b[2]).length(),f=1/a.set(b[4],b[5],b[6]).length(),g=1/a.set(b[8],b[9],b[10]).length();c[0]=b[0]*d;c[1]=b[1]*d;c[2]=b[2]*d;c[4]=b[4]*f;c[5]=b[5]*f;c[6]=b[6]*f;c[8]=b[8]*g;c[9]=b[9]*g;c[10]=b[10]*g;return this}}(),makeRotationFromEuler:function(a){!1===a instanceof THREE.Euler&&
console.error("THREE.Matrix: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var b=this.elements,c=a.x,d=a.y,f=a.z,g=Math.cos(c),c=Math.sin(c),h=Math.cos(d),d=Math.sin(d),k=Math.cos(f),f=Math.sin(f);if("XYZ"===a.order){a=g*k;var l=g*f,m=c*k,p=c*f;b[0]=h*k;b[4]=-h*f;b[8]=d;b[1]=l+m*d;b[5]=a-p*d;b[9]=-c*h;b[2]=p-a*d;b[6]=m+l*d;b[10]=g*h}else"YXZ"===a.order?(a=h*k,l=h*f,m=d*k,p=d*f,b[0]=a+p*c,b[4]=m*c-l,b[8]=g*d,b[1]=g*f,b[5]=g*k,b[9]=-c,b[2]=l*c-m,b[6]=p+a*c,
b[10]=g*h):"ZXY"===a.order?(a=h*k,l=h*f,m=d*k,p=d*f,b[0]=a-p*c,b[4]=-g*f,b[8]=m+l*c,b[1]=l+m*c,b[5]=g*k,b[9]=p-a*c,b[2]=-g*d,b[6]=c,b[10]=g*h):"ZYX"===a.order?(a=g*k,l=g*f,m=c*k,p=c*f,b[0]=h*k,b[4]=m*d-l,b[8]=a*d+p,b[1]=h*f,b[5]=p*d+a,b[9]=l*d-m,b[2]=-d,b[6]=c*h,b[10]=g*h):"YZX"===a.order?(a=g*h,l=g*d,m=c*h,p=c*d,b[0]=h*k,b[4]=p-a*f,b[8]=m*f+l,b[1]=f,b[5]=g*k,b[9]=-c*k,b[2]=-d*k,b[6]=l*f+m,b[10]=a-p*f):"XZY"===a.order&&(a=g*h,l=g*d,m=c*h,p=c*d,b[0]=h*k,b[4]=-f,b[8]=d*k,b[1]=a*f+p,b[5]=g*k,b[9]=l*
f-m,b[2]=m*f-l,b[6]=c*k,b[10]=p*f+a);b[3]=0;b[7]=0;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return this},setRotationFromQuaternion:function(a){console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion().");return this.makeRotationFromQuaternion(a)},makeRotationFromQuaternion:function(a){var b=this.elements,c=a.x,d=a.y,f=a.z,g=a.w,h=c+c,k=d+d,l=f+f;a=c*h;var m=c*k,c=c*l,p=d*k,d=d*l,f=f*l,h=g*h,k=g*k,g=g*l;b[0]=1-(p+f);b[4]=m-g;b[8]=c+k;b[1]=m+g;b[5]=1-
(a+f);b[9]=d-h;b[2]=c-k;b[6]=d+h;b[10]=1-(a+p);b[3]=0;b[7]=0;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return this},lookAt:function(){var a=new THREE.Vector3,b=new THREE.Vector3,c=new THREE.Vector3;return function(d,f,g){var h=this.elements;c.subVectors(d,f).normalize();0===c.length()&&(c.z=1);a.crossVectors(g,c).normalize();0===a.length()&&(c.x+=1E-4,a.crossVectors(g,c).normalize());b.crossVectors(c,a);h[0]=a.x;h[4]=b.x;h[8]=c.x;h[1]=a.y;h[5]=b.y;h[9]=c.y;h[2]=a.z;h[6]=b.z;h[10]=c.z;return this}}(),
multiply:function(a,b){return void 0!==b?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(a,b)):this.multiplyMatrices(this,a)},multiplyMatrices:function(a,b){var c=a.elements,d=b.elements,f=this.elements,g=c[0],h=c[4],k=c[8],l=c[12],m=c[1],p=c[5],n=c[9],q=c[13],r=c[2],v=c[6],s=c[10],w=c[14],z=c[3],D=c[7],A=c[11],c=c[15],E=d[0],N=d[4],H=d[8],J=d[12],G=d[1],I=d[5],M=d[9],C=d[13],K=d[2],F=d[6],B=d[10],R=d[14],Y=d[3],
S=d[7],P=d[11],d=d[15];f[0]=g*E+h*G+k*K+l*Y;f[4]=g*N+h*I+k*F+l*S;f[8]=g*H+h*M+k*B+l*P;f[12]=g*J+h*C+k*R+l*d;f[1]=m*E+p*G+n*K+q*Y;f[5]=m*N+p*I+n*F+q*S;f[9]=m*H+p*M+n*B+q*P;f[13]=m*J+p*C+n*R+q*d;f[2]=r*E+v*G+s*K+w*Y;f[6]=r*N+v*I+s*F+w*S;f[10]=r*H+v*M+s*B+w*P;f[14]=r*J+v*C+s*R+w*d;f[3]=z*E+D*G+A*K+c*Y;f[7]=z*N+D*I+A*F+c*S;f[11]=z*H+D*M+A*B+c*P;f[15]=z*J+D*C+A*R+c*d;return this},multiplyToArray:function(a,b,c){var d=this.elements;this.multiplyMatrices(a,b);c[0]=d[0];c[1]=d[1];c[2]=d[2];c[3]=d[3];c[4]=
d[4];c[5]=d[5];c[6]=d[6];c[7]=d[7];c[8]=d[8];c[9]=d[9];c[10]=d[10];c[11]=d[11];c[12]=d[12];c[13]=d[13];c[14]=d[14];c[15]=d[15];return this},multiplyScalar:function(a){var b=this.elements;b[0]*=a;b[4]*=a;b[8]*=a;b[12]*=a;b[1]*=a;b[5]*=a;b[9]*=a;b[13]*=a;b[2]*=a;b[6]*=a;b[10]*=a;b[14]*=a;b[3]*=a;b[7]*=a;b[11]*=a;b[15]*=a;return this},multiplyVector3:function(a){console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead.");
return a.applyProjection(this)},multiplyVector4:function(a){console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead.");return a.applyMatrix4(this)},multiplyVector3Array:function(a){console.warn("THREE.Matrix4: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead.");return this.applyToVector3Array(a)},applyToVector3Array:function(){var a=new THREE.Vector3;return function(b,c,d){void 0===c&&(c=0);void 0===d&&(d=
b.length);for(var f=0;f<d;f+=3,c+=3)a.x=b[c],a.y=b[c+1],a.z=b[c+2],a.applyMatrix4(this),b[c]=a.x,b[c+1]=a.y,b[c+2]=a.z;return b}}(),rotateAxis:function(a){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead.");a.transformDirection(this)},crossVector:function(a){console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead.");return a.applyMatrix4(this)},determinant:function(){var a=this.elements,b=
a[0],c=a[4],d=a[8],f=a[12],g=a[1],h=a[5],k=a[9],l=a[13],m=a[2],p=a[6],n=a[10],q=a[14];return a[3]*(+f*k*p-d*l*p-f*h*n+c*l*n+d*h*q-c*k*q)+a[7]*(+b*k*q-b*l*n+f*g*n-d*g*q+d*l*m-f*k*m)+a[11]*(+b*l*p-b*h*q-f*g*p+c*g*q+f*h*m-c*l*m)+a[15]*(-d*h*m-b*k*p+b*h*n+d*g*p-c*g*n+c*k*m)},transpose:function(){var a=this.elements,b;b=a[1];a[1]=a[4];a[4]=b;b=a[2];a[2]=a[8];a[8]=b;b=a[6];a[6]=a[9];a[9]=b;b=a[3];a[3]=a[12];a[12]=b;b=a[7];a[7]=a[13];a[13]=b;b=a[11];a[11]=a[14];a[14]=b;return this},flattenToArrayOffset:function(a,
b){var c=this.elements;a[b]=c[0];a[b+1]=c[1];a[b+2]=c[2];a[b+3]=c[3];a[b+4]=c[4];a[b+5]=c[5];a[b+6]=c[6];a[b+7]=c[7];a[b+8]=c[8];a[b+9]=c[9];a[b+10]=c[10];a[b+11]=c[11];a[b+12]=c[12];a[b+13]=c[13];a[b+14]=c[14];a[b+15]=c[15];return a},getPosition:function(){var a=new THREE.Vector3;return function(){console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead.");var b=this.elements;return a.set(b[12],b[13],b[14])}}(),setPosition:function(a){var b=
this.elements;b[12]=a.x;b[13]=a.y;b[14]=a.z;return this},getInverse:function(a,b){var c=this.elements,d=a.elements,f=d[0],g=d[4],h=d[8],k=d[12],l=d[1],m=d[5],p=d[9],n=d[13],q=d[2],r=d[6],v=d[10],s=d[14],w=d[3],z=d[7],D=d[11],d=d[15];c[0]=p*s*z-n*v*z+n*r*D-m*s*D-p*r*d+m*v*d;c[4]=k*v*z-h*s*z-k*r*D+g*s*D+h*r*d-g*v*d;c[8]=h*n*z-k*p*z+k*m*D-g*n*D-h*m*d+g*p*d;c[12]=k*p*r-h*n*r-k*m*v+g*n*v+h*m*s-g*p*s;c[1]=n*v*w-p*s*w-n*q*D+l*s*D+p*q*d-l*v*d;c[5]=h*s*w-k*v*w+k*q*D-f*s*D-h*q*d+f*v*d;c[9]=k*p*w-h*n*w-k*l*
D+f*n*D+h*l*d-f*p*d;c[13]=h*n*q-k*p*q+k*l*v-f*n*v-h*l*s+f*p*s;c[2]=m*s*w-n*r*w+n*q*z-l*s*z-m*q*d+l*r*d;c[6]=k*r*w-g*s*w-k*q*z+f*s*z+g*q*d-f*r*d;c[10]=g*n*w-k*m*w+k*l*z-f*n*z-g*l*d+f*m*d;c[14]=k*m*q-g*n*q-k*l*r+f*n*r+g*l*s-f*m*s;c[3]=p*r*w-m*v*w-p*q*z+l*v*z+m*q*D-l*r*D;c[7]=g*v*w-h*r*w+h*q*z-f*v*z-g*q*D+f*r*D;c[11]=h*m*w-g*p*w-h*l*z+f*p*z+g*l*D-f*m*D;c[15]=g*p*q-h*m*q+h*l*r-f*p*r-g*l*v+f*m*v;c=f*c[0]+l*c[4]+q*c[8]+w*c[12];if(0==c){if(b)throw Error("Matrix4.getInverse(): can't invert matrix, determinant is 0");
console.warn("Matrix4.getInverse(): can't invert matrix, determinant is 0");this.identity();return this}this.multiplyScalar(1/c);return this},translate:function(a){console.warn("THREE.Matrix4: .translate() has been removed.")},rotateX:function(a){console.warn("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(a){console.warn("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(a){console.warn("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(a,b){console.warn("THREE.Matrix4: .rotateByAxis() has been removed.")},
scale:function(a){var b=this.elements,c=a.x,d=a.y;a=a.z;b[0]*=c;b[4]*=d;b[8]*=a;b[1]*=c;b[5]*=d;b[9]*=a;b[2]*=c;b[6]*=d;b[10]*=a;b[3]*=c;b[7]*=d;b[11]*=a;return this},getMaxScaleOnAxis:function(){var a=this.elements;return Math.sqrt(Math.max(a[0]*a[0]+a[1]*a[1]+a[2]*a[2],Math.max(a[4]*a[4]+a[5]*a[5]+a[6]*a[6],a[8]*a[8]+a[9]*a[9]+a[10]*a[10])))},makeTranslation:function(a,b,c){this.set(1,0,0,a,0,1,0,b,0,0,1,c,0,0,0,1);return this},makeRotationX:function(a){var b=Math.cos(a);a=Math.sin(a);this.set(1,
0,0,0,0,b,-a,0,0,a,b,0,0,0,0,1);return this},makeRotationY:function(a){var b=Math.cos(a);a=Math.sin(a);this.set(b,0,a,0,0,1,0,0,-a,0,b,0,0,0,0,1);return this},makeRotationZ:function(a){var b=Math.cos(a);a=Math.sin(a);this.set(b,-a,0,0,a,b,0,0,0,0,1,0,0,0,0,1);return this},makeRotationAxis:function(a,b){var c=Math.cos(b),d=Math.sin(b),f=1-c,g=a.x,h=a.y,k=a.z,l=f*g,m=f*h;this.set(l*g+c,l*h-d*k,l*k+d*h,0,l*h+d*k,m*h+c,m*k-d*g,0,l*k-d*h,m*k+d*g,f*k*k+c,0,0,0,0,1);return this},makeScale:function(a,b,c){this.set(a,
0,0,0,0,b,0,0,0,0,c,0,0,0,0,1);return this},compose:function(a,b,c){this.makeRotationFromQuaternion(b);this.scale(c);this.setPosition(a);return this},decompose:function(){var a=new THREE.Vector3,b=new THREE.Matrix4;return function(c,d,f){var g=this.elements,h=a.set(g[0],g[1],g[2]).length(),k=a.set(g[4],g[5],g[6]).length(),l=a.set(g[8],g[9],g[10]).length();0>this.determinant()&&(h=-h);c.x=g[12];c.y=g[13];c.z=g[14];b.elements.set(this.elements);c=1/h;var g=1/k,m=1/l;b.elements[0]*=c;b.elements[1]*=
c;b.elements[2]*=c;b.elements[4]*=g;b.elements[5]*=g;b.elements[6]*=g;b.elements[8]*=m;b.elements[9]*=m;b.elements[10]*=m;d.setFromRotationMatrix(b);f.x=h;f.y=k;f.z=l;return this}}(),makeFrustum:function(a,b,c,d,f,g){var h=this.elements;h[0]=2*f/(b-a);h[4]=0;h[8]=(b+a)/(b-a);h[12]=0;h[1]=0;h[5]=2*f/(d-c);h[9]=(d+c)/(d-c);h[13]=0;h[2]=0;h[6]=0;h[10]=-(g+f)/(g-f);h[14]=-2*g*f/(g-f);h[3]=0;h[7]=0;h[11]=-1;h[15]=0;return this},makePerspective:function(a,b,c,d){a=c*Math.tan(THREE.Math.degToRad(0.5*a));
var f=-a;return this.makeFrustum(f*b,a*b,f,a,c,d)},makeOrthographic:function(a,b,c,d,f,g){var h=this.elements,k=b-a,l=c-d,m=g-f;h[0]=2/k;h[4]=0;h[8]=0;h[12]=-((b+a)/k);h[1]=0;h[5]=2/l;h[9]=0;h[13]=-((c+d)/l);h[2]=0;h[6]=0;h[10]=-2/m;h[14]=-((g+f)/m);h[3]=0;h[7]=0;h[11]=0;h[15]=1;return this},fromArray:function(a){this.elements.set(a);return this},toArray:function(){var a=this.elements;return[a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8],a[9],a[10],a[11],a[12],a[13],a[14],a[15]]},clone:function(){return(new THREE.Matrix4).fromArray(this.elements)}};
THREE.Ray=function(a,b){this.origin=void 0!==a?a:new THREE.Vector3;this.direction=void 0!==b?b:new THREE.Vector3};
THREE.Ray.prototype={constructor:THREE.Ray,set:function(a,b){this.origin.copy(a);this.direction.copy(b);return this},copy:function(a){this.origin.copy(a.origin);this.direction.copy(a.direction);return this},at:function(a,b){return(b||new THREE.Vector3).copy(this.direction).multiplyScalar(a).add(this.origin)},recast:function(){var a=new THREE.Vector3;return function(b){this.origin.copy(this.at(b,a));return this}}(),closestPointToPoint:function(a,b){var c=b||new THREE.Vector3;c.subVectors(a,this.origin);
var d=c.dot(this.direction);return 0>d?c.copy(this.origin):c.copy(this.direction).multiplyScalar(d).add(this.origin)},distanceToPoint:function(){var a=new THREE.Vector3;return function(b){var c=a.subVectors(b,this.origin).dot(this.direction);if(0>c)return this.origin.distanceTo(b);a.copy(this.direction).multiplyScalar(c).add(this.origin);return a.distanceTo(b)}}(),distanceSqToSegment:function(a,b,c,d){var f=a.clone().add(b).multiplyScalar(0.5),g=b.clone().sub(a).normalize(),h=0.5*a.distanceTo(b),
k=this.origin.clone().sub(f);a=-this.direction.dot(g);b=k.dot(this.direction);var l=-k.dot(g),m=k.lengthSq(),p=Math.abs(1-a*a),n,q;0<=p?(k=a*l-b,n=a*b-l,q=h*p,0<=k?n>=-q?n<=q?(h=1/p,k*=h,n*=h,a=k*(k+a*n+2*b)+n*(a*k+n+2*l)+m):(n=h,k=Math.max(0,-(a*n+b)),a=-k*k+n*(n+2*l)+m):(n=-h,k=Math.max(0,-(a*n+b)),a=-k*k+n*(n+2*l)+m):n<=-q?(k=Math.max(0,-(-a*h+b)),n=0<k?-h:Math.min(Math.max(-h,-l),h),a=-k*k+n*(n+2*l)+m):n<=q?(k=0,n=Math.min(Math.max(-h,-l),h),a=n*(n+2*l)+m):(k=Math.max(0,-(a*h+b)),n=0<k?h:Math.min(Math.max(-h,
-l),h),a=-k*k+n*(n+2*l)+m)):(n=0<a?-h:h,k=Math.max(0,-(a*n+b)),a=-k*k+n*(n+2*l)+m);c&&c.copy(this.direction.clone().multiplyScalar(k).add(this.origin));d&&d.copy(g.clone().multiplyScalar(n).add(f));return a},isIntersectionSphere:function(a){return this.distanceToPoint(a.center)<=a.radius},intersectSphere:function(){var a=new THREE.Vector3;return function(b,c){a.subVectors(b.center,this.origin);var d=a.dot(this.direction),f=a.dot(a)-d*d,g=b.radius*b.radius;if(f>g)return null;g=Math.sqrt(g-f);f=d-g;
d+=g;return 0>f&&0>d?null:0>f?this.at(d,c):this.at(f,c)}}(),isIntersectionPlane:function(a){var b=a.distanceToPoint(this.origin);return 0===b||0>a.normal.dot(this.direction)*b?!0:!1},distanceToPlane:function(a){var b=a.normal.dot(this.direction);if(0==b)return 0==a.distanceToPoint(this.origin)?0:null;a=-(this.origin.dot(a.normal)+a.constant)/b;return 0<=a?a:null},intersectPlane:function(a,b){var c=this.distanceToPlane(a);return null===c?null:this.at(c,b)},isIntersectionBox:function(){var a=new THREE.Vector3;
return function(b){return null!==this.intersectBox(b,a)}}(),intersectBox:function(a,b){var c,d,f,g,h;d=1/this.direction.x;g=1/this.direction.y;h=1/this.direction.z;var k=this.origin;0<=d?(c=(a.min.x-k.x)*d,d*=a.max.x-k.x):(c=(a.max.x-k.x)*d,d*=a.min.x-k.x);0<=g?(f=(a.min.y-k.y)*g,g*=a.max.y-k.y):(f=(a.max.y-k.y)*g,g*=a.min.y-k.y);if(c>g||f>d)return null;if(f>c||c!==c)c=f;if(g<d||d!==d)d=g;0<=h?(f=(a.min.z-k.z)*h,h*=a.max.z-k.z):(f=(a.max.z-k.z)*h,h*=a.min.z-k.z);if(c>h||f>d)return null;if(f>c||c!==
c)c=f;if(h<d||d!==d)d=h;return 0>d?null:this.at(0<=c?c:d,b)},intersectTriangle:function(){var a=new THREE.Vector3,b=new THREE.Vector3,c=new THREE.Vector3,d=new THREE.Vector3;return function(f,g,h,k,l){b.subVectors(g,f);c.subVectors(h,f);d.crossVectors(b,c);g=this.direction.dot(d);if(0<g){if(k)return null;k=1}else if(0>g)k=-1,g=-g;else return null;a.subVectors(this.origin,f);f=k*this.direction.dot(c.crossVectors(a,c));if(0>f)return null;h=k*this.direction.dot(b.cross(a));if(0>h||f+h>g)return null;
f=-k*a.dot(d);return 0>f?null:this.at(f/g,l)}}(),applyMatrix4:function(a){this.direction.add(this.origin).applyMatrix4(a);this.origin.applyMatrix4(a);this.direction.sub(this.origin);this.direction.normalize();return this},equals:function(a){return a.origin.equals(this.origin)&&a.direction.equals(this.direction)},clone:function(){return(new THREE.Ray).copy(this)}};THREE.Sphere=function(a,b){this.center=void 0!==a?a:new THREE.Vector3;this.radius=void 0!==b?b:0};
THREE.Sphere.prototype={constructor:THREE.Sphere,set:function(a,b){this.center.copy(a);this.radius=b;return this},setFromPoints:function(){var a=new THREE.Box3;return function(b,c){var d=this.center;void 0!==c?d.copy(c):a.setFromPoints(b).center(d);for(var f=0,g=0,h=b.length;g<h;g++)f=Math.max(f,d.distanceToSquared(b[g]));this.radius=Math.sqrt(f);return this}}(),copy:function(a){this.center.copy(a.center);this.radius=a.radius;return this},empty:function(){return 0>=this.radius},containsPoint:function(a){return a.distanceToSquared(this.center)<=
this.radius*this.radius},distanceToPoint:function(a){return a.distanceTo(this.center)-this.radius},intersectsSphere:function(a){var b=this.radius+a.radius;return a.center.distanceToSquared(this.center)<=b*b},clampPoint:function(a,b){var c=this.center.distanceToSquared(a),d=b||new THREE.Vector3;d.copy(a);c>this.radius*this.radius&&(d.sub(this.center).normalize(),d.multiplyScalar(this.radius).add(this.center));return d},getBoundingBox:function(a){a=a||new THREE.Box3;a.set(this.center,this.center);a.expandByScalar(this.radius);
return a},applyMatrix4:function(a){this.center.applyMatrix4(a);this.radius*=a.getMaxScaleOnAxis();return this},translate:function(a){this.center.add(a);return this},equals:function(a){return a.center.equals(this.center)&&a.radius===this.radius},clone:function(){return(new THREE.Sphere).copy(this)}};
THREE.Frustum=function(a,b,c,d,f,g){this.planes=[void 0!==a?a:new THREE.Plane,void 0!==b?b:new THREE.Plane,void 0!==c?c:new THREE.Plane,void 0!==d?d:new THREE.Plane,void 0!==f?f:new THREE.Plane,void 0!==g?g:new THREE.Plane]};
THREE.Frustum.prototype={constructor:THREE.Frustum,set:function(a,b,c,d,f,g){var h=this.planes;h[0].copy(a);h[1].copy(b);h[2].copy(c);h[3].copy(d);h[4].copy(f);h[5].copy(g);return this},copy:function(a){for(var b=this.planes,c=0;6>c;c++)b[c].copy(a.planes[c]);return this},setFromMatrix:function(a){var b=this.planes,c=a.elements;a=c[0];var d=c[1],f=c[2],g=c[3],h=c[4],k=c[5],l=c[6],m=c[7],p=c[8],n=c[9],q=c[10],r=c[11],v=c[12],s=c[13],w=c[14],c=c[15];b[0].setComponents(g-a,m-h,r-p,c-v).normalize();b[1].setComponents(g+
a,m+h,r+p,c+v).normalize();b[2].setComponents(g+d,m+k,r+n,c+s).normalize();b[3].setComponents(g-d,m-k,r-n,c-s).normalize();b[4].setComponents(g-f,m-l,r-q,c-w).normalize();b[5].setComponents(g+f,m+l,r+q,c+w).normalize();return this},intersectsObject:function(){var a=new THREE.Sphere;return function(b){var c=b.geometry;null===c.boundingSphere&&c.computeBoundingSphere();a.copy(c.boundingSphere);a.applyMatrix4(b.matrixWorld);return this.intersectsSphere(a)}}(),intersectsSphere:function(a){var b=this.planes,
c=a.center;a=-a.radius;for(var d=0;6>d;d++)if(b[d].distanceToPoint(c)<a)return!1;return!0},intersectsBox:function(){var a=new THREE.Vector3,b=new THREE.Vector3;return function(c){for(var d=this.planes,f=0;6>f;f++){var g=d[f];a.x=0<g.normal.x?c.min.x:c.max.x;b.x=0<g.normal.x?c.max.x:c.min.x;a.y=0<g.normal.y?c.min.y:c.max.y;b.y=0<g.normal.y?c.max.y:c.min.y;a.z=0<g.normal.z?c.min.z:c.max.z;b.z=0<g.normal.z?c.max.z:c.min.z;var h=g.distanceToPoint(a),g=g.distanceToPoint(b);if(0>h&&0>g)return!1}return!0}}(),
containsPoint:function(a){for(var b=this.planes,c=0;6>c;c++)if(0>b[c].distanceToPoint(a))return!1;return!0},clone:function(){return(new THREE.Frustum).copy(this)}};THREE.Plane=function(a,b){this.normal=void 0!==a?a:new THREE.Vector3(1,0,0);this.constant=void 0!==b?b:0};
THREE.Plane.prototype={constructor:THREE.Plane,set:function(a,b){this.normal.copy(a);this.constant=b;return this},setComponents:function(a,b,c,d){this.normal.set(a,b,c);this.constant=d;return this},setFromNormalAndCoplanarPoint:function(a,b){this.normal.copy(a);this.constant=-b.dot(this.normal);return this},setFromCoplanarPoints:function(){var a=new THREE.Vector3,b=new THREE.Vector3;return function(c,d,f){d=a.subVectors(f,d).cross(b.subVectors(c,d)).normalize();this.setFromNormalAndCoplanarPoint(d,
c);return this}}(),copy:function(a){this.normal.copy(a.normal);this.constant=a.constant;return this},normalize:function(){var a=1/this.normal.length();this.normal.multiplyScalar(a);this.constant*=a;return this},negate:function(){this.constant*=-1;this.normal.negate();return this},distanceToPoint:function(a){return this.normal.dot(a)+this.constant},distanceToSphere:function(a){return this.distanceToPoint(a.center)-a.radius},projectPoint:function(a,b){return this.orthoPoint(a,b).sub(a).negate()},orthoPoint:function(a,
b){var c=this.distanceToPoint(a);return(b||new THREE.Vector3).copy(this.normal).multiplyScalar(c)},isIntersectionLine:function(a){var b=this.distanceToPoint(a.start);a=this.distanceToPoint(a.end);return 0>b&&0<a||0>a&&0<b},intersectLine:function(){var a=new THREE.Vector3;return function(b,c){var d=c||new THREE.Vector3,f=b.delta(a),g=this.normal.dot(f);if(0==g){if(0==this.distanceToPoint(b.start))return d.copy(b.start)}else return g=-(b.start.dot(this.normal)+this.constant)/g,0>g||1<g?void 0:d.copy(f).multiplyScalar(g).add(b.start)}}(),
coplanarPoint:function(a){return(a||new THREE.Vector3).copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var a=new THREE.Vector3,b=new THREE.Vector3,c=new THREE.Matrix3;return function(d,f){var g=f||c.getNormalMatrix(d),g=a.copy(this.normal).applyMatrix3(g),h=this.coplanarPoint(b);h.applyMatrix4(d);this.setFromNormalAndCoplanarPoint(g,h);return this}}(),translate:function(a){this.constant-=a.dot(this.normal);return this},equals:function(a){return a.normal.equals(this.normal)&&
a.constant==this.constant},clone:function(){return(new THREE.Plane).copy(this)}};
THREE.Math={generateUUID:function(){var a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),b=Array(36),c=0,d;return function(){for(var f=0;36>f;f++)8==f||13==f||18==f||23==f?b[f]="-":14==f?b[f]="4":(2>=c&&(c=33554432+16777216*Math.random()|0),d=c&15,c>>=4,b[f]=a[19==f?d&3|8:d]);return b.join("")}}(),clamp:function(a,b,c){return a<b?b:a>c?c:a},clampBottom:function(a,b){return a<b?b:a},mapLinear:function(a,b,c,d,f){return d+(a-b)*(f-d)/(c-b)},smoothstep:function(a,b,c){if(a<=
b)return 0;if(a>=c)return 1;a=(a-b)/(c-b);return a*a*(3-2*a)},smootherstep:function(a,b,c){if(a<=b)return 0;if(a>=c)return 1;a=(a-b)/(c-b);return a*a*a*(a*(6*a-15)+10)},random16:function(){return(65280*Math.random()+255*Math.random())/65535},randInt:function(a,b){return a+Math.floor(Math.random()*(b-a+1))},randFloat:function(a,b){return a+Math.random()*(b-a)},randFloatSpread:function(a){return a*(0.5-Math.random())},degToRad:function(){var a=Math.PI/180;return function(b){return b*a}}(),radToDeg:function(){var a=
180/Math.PI;return function(b){return b*a}}(),isPowerOfTwo:function(a){return 0===(a&a-1)&&0!==a}};
THREE.Spline=function(a){function b(a,b,c,d,f,g,h){a=0.5*(c-a);d=0.5*(d-b);return(2*(b-c)+a+d)*h+(-3*(b-c)-2*a-d)*g+a*f+b}this.points=a;var c=[],d={x:0,y:0,z:0},f,g,h,k,l,m,p,n,q;this.initFromArray=function(a){this.points=[];for(var b=0;b<a.length;b++)this.points[b]={x:a[b][0],y:a[b][1],z:a[b][2]}};this.getPoint=function(a){f=(this.points.length-1)*a;g=Math.floor(f);h=f-g;c[0]=0===g?g:g-1;c[1]=g;c[2]=g>this.points.length-2?this.points.length-1:g+1;c[3]=g>this.points.length-3?this.points.length-1:
g+2;m=this.points[c[0]];p=this.points[c[1]];n=this.points[c[2]];q=this.points[c[3]];k=h*h;l=h*k;d.x=b(m.x,p.x,n.x,q.x,h,k,l);d.y=b(m.y,p.y,n.y,q.y,h,k,l);d.z=b(m.z,p.z,n.z,q.z,h,k,l);return d};this.getControlPointsArray=function(){var a,b,c=this.points.length,d=[];for(a=0;a<c;a++)b=this.points[a],d[a]=[b.x,b.y,b.z];return d};this.getLength=function(a){var b,c,d,f=0,g=new THREE.Vector3,h=new THREE.Vector3,k=[],l=0;k[0]=0;a||(a=100);c=this.points.length*a;g.copy(this.points[0]);for(a=1;a<c;a++)b=a/
c,d=this.getPoint(b),h.copy(d),l+=h.distanceTo(g),g.copy(d),b*=this.points.length-1,b=Math.floor(b),b!=f&&(k[b]=l,f=b);k[k.length]=l;return{chunks:k,total:l}};this.reparametrizeByArcLength=function(a){var b,c,d,f,g,h,k=[],l=new THREE.Vector3,m=this.getLength();k.push(l.copy(this.points[0]).clone());for(b=1;b<this.points.length;b++){c=m.chunks[b]-m.chunks[b-1];h=Math.ceil(a*c/m.total);f=(b-1)/(this.points.length-1);g=b/(this.points.length-1);for(c=1;c<h-1;c++)d=f+1/h*c*(g-f),d=this.getPoint(d),k.push(l.copy(d).clone());
k.push(l.copy(this.points[b]).clone())}this.points=k}};THREE.Triangle=function(a,b,c){this.a=void 0!==a?a:new THREE.Vector3;this.b=void 0!==b?b:new THREE.Vector3;this.c=void 0!==c?c:new THREE.Vector3};THREE.Triangle.normal=function(){var a=new THREE.Vector3;return function(b,c,d,f){f=f||new THREE.Vector3;f.subVectors(d,c);a.subVectors(b,c);f.cross(a);b=f.lengthSq();return 0<b?f.multiplyScalar(1/Math.sqrt(b)):f.set(0,0,0)}}();
THREE.Triangle.barycoordFromPoint=function(){var a=new THREE.Vector3,b=new THREE.Vector3,c=new THREE.Vector3;return function(d,f,g,h,k){a.subVectors(h,f);b.subVectors(g,f);c.subVectors(d,f);d=a.dot(a);f=a.dot(b);g=a.dot(c);var l=b.dot(b);h=b.dot(c);var m=d*l-f*f;k=k||new THREE.Vector3;if(0==m)return k.set(-2,-1,-1);m=1/m;l=(l*g-f*h)*m;d=(d*h-f*g)*m;return k.set(1-l-d,d,l)}}();
THREE.Triangle.containsPoint=function(){var a=new THREE.Vector3;return function(b,c,d,f){b=THREE.Triangle.barycoordFromPoint(b,c,d,f,a);return 0<=b.x&&0<=b.y&&1>=b.x+b.y}}();
THREE.Triangle.prototype={constructor:THREE.Triangle,set:function(a,b,c){this.a.copy(a);this.b.copy(b);this.c.copy(c);return this},setFromPointsAndIndices:function(a,b,c,d){this.a.copy(a[b]);this.b.copy(a[c]);this.c.copy(a[d]);return this},copy:function(a){this.a.copy(a.a);this.b.copy(a.b);this.c.copy(a.c);return this},area:function(){var a=new THREE.Vector3,b=new THREE.Vector3;return function(){a.subVectors(this.c,this.b);b.subVectors(this.a,this.b);return 0.5*a.cross(b).length()}}(),midpoint:function(a){return(a||
new THREE.Vector3).addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(a){return THREE.Triangle.normal(this.a,this.b,this.c,a)},plane:function(a){return(a||new THREE.Plane).setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(a,b){return THREE.Triangle.barycoordFromPoint(a,this.a,this.b,this.c,b)},containsPoint:function(a){return THREE.Triangle.containsPoint(a,this.a,this.b,this.c)},equals:function(a){return a.a.equals(this.a)&&a.b.equals(this.b)&&a.c.equals(this.c)},
clone:function(){return(new THREE.Triangle).copy(this)}};THREE.Clock=function(a){this.autoStart=void 0!==a?a:!0;this.elapsedTime=this.oldTime=this.startTime=0;this.running=!1};
THREE.Clock.prototype={constructor:THREE.Clock,start:function(){this.oldTime=this.startTime=void 0!==self.performance&&void 0!==self.performance.now?self.performance.now():Date.now();this.running=!0},stop:function(){this.getElapsedTime();this.running=!1},getElapsedTime:function(){this.getDelta();return this.elapsedTime},getDelta:function(){var a=0;this.autoStart&&!this.running&&this.start();if(this.running){var b=void 0!==self.performance&&void 0!==self.performance.now?self.performance.now():Date.now(),
a=0.0010*(b-this.oldTime);this.oldTime=b;this.elapsedTime+=a}return a}};THREE.EventDispatcher=function(){};
THREE.EventDispatcher.prototype={constructor:THREE.EventDispatcher,apply:function(a){a.addEventListener=THREE.EventDispatcher.prototype.addEventListener;a.hasEventListener=THREE.EventDispatcher.prototype.hasEventListener;a.removeEventListener=THREE.EventDispatcher.prototype.removeEventListener;a.dispatchEvent=THREE.EventDispatcher.prototype.dispatchEvent},addEventListener:function(a,b){void 0===this._listeners&&(this._listeners={});var c=this._listeners;void 0===c[a]&&(c[a]=[]);-1===c[a].indexOf(b)&&
c[a].push(b)},hasEventListener:function(a,b){if(void 0===this._listeners)return!1;var c=this._listeners;return void 0!==c[a]&&-1!==c[a].indexOf(b)?!0:!1},removeEventListener:function(a,b){if(void 0!==this._listeners){var c=this._listeners[a];if(void 0!==c){var d=c.indexOf(b);-1!==d&&c.splice(d,1)}}},dispatchEvent:function(a){if(void 0!==this._listeners){var b=this._listeners[a.type];if(void 0!==b){a.target=this;for(var c=[],d=b.length,f=0;f<d;f++)c[f]=b[f];for(f=0;f<d;f++)c[f].call(this,a)}}}};
(function(a){a.Raycaster=function(b,c,g,h){this.ray=new a.Ray(b,c);this.near=g||0;this.far=h||Infinity;this.params={Sprite:{},Mesh:{},PointCloud:{threshold:1},LOD:{},Line:{}}};var b=function(a,b){return a.distance-b.distance},c=function(a,b,g,h){a.raycast(b,g);if(!0===h&&(a=a.children)){h=0;for(var k=a.length;h<k;h++)c(a[h],b,g,!0)}};a.Raycaster.prototype={constructor:a.Raycaster,precision:1E-4,linePrecision:1,set:function(a,b){this.ray.set(a,b)},intersectObject:function(a,f){var g=[];c(a,this,g,
f);g.sort(b);return g},intersectObjects:function(a,f){var g=[];if(!1===a instanceof Array)return console.log("THREE.Raycaster.intersectObjects: objects is not an Array."),g;for(var h=0,k=a.length;h<k;h++)c(a[h],this,g,f);g.sort(b);return g}}})(THREE);
THREE.Object3D=function(a){Object.defineProperty(this,"id",{value:THREE.Object3DIdCount++});this.type="Object3D";this.parent=void 0;this.children=[];if(a)this.matrixAutoUpdate=!1,this.skipModTerms=!0;else{this.up=THREE.Object3D.DefaultUp.clone();a=new THREE.Vector3;var b=new THREE.Euler,c=new THREE.Quaternion,d=new THREE.Vector3(1,1,1);b.onChange(function(){c.setFromEuler(b,!1)});c.onChange(function(){b.setFromQuaternion(c,void 0,!1)});Object.defineProperties(this,{position:{enumerable:!0,value:a},
rotation:{enumerable:!0,value:b},quaternion:{enumerable:!0,value:c},scale:{enumerable:!0,value:d}});this.matrix=new THREE.Matrix4;this.rotationAutoUpdate=this.matrixAutoUpdate=!0;this.skipModTerms=!1}this.renderDepth=null;this.matrixWorld=new THREE.Matrix4;this.matrixWorldNeedsUpdate=!1;this.visible=!0;this.receiveShadow=this.castShadow=!1;this.frustumCulled=!0};THREE.Object3D.DefaultUp=new THREE.Vector3(0,1,0);
THREE.Object3D.prototype={constructor:THREE.Object3D,get eulerOrder(){console.warn("THREE.Object3D: .eulerOrder has been moved to .rotation.order.");return this.rotation.order},set eulerOrder(a){console.warn("THREE.Object3D: .eulerOrder has been moved to .rotation.order.");this.rotation.order=a},get useQuaternion(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set useQuaternion(a){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},
applyMatrix:function(a){this.matrix.multiplyMatrices(a,this.matrix);this.matrix.decompose(this.position,this.quaternion,this.scale)},setRotationFromAxisAngle:function(a,b){this.quaternion.setFromAxisAngle(a,b)},setRotationFromEuler:function(a){this.quaternion.setFromEuler(a,!0)},setRotationFromMatrix:function(a){this.quaternion.setFromRotationMatrix(a)},setRotationFromQuaternion:function(a){this.quaternion.copy(a)},rotateOnAxis:function(){var a=new THREE.Quaternion;return function(b,c){a.setFromAxisAngle(b,
c);this.quaternion.multiply(a);return this}}(),rotateX:function(){var a=new THREE.Vector3(1,0,0);return function(b){return this.rotateOnAxis(a,b)}}(),rotateY:function(){var a=new THREE.Vector3(0,1,0);return function(b){return this.rotateOnAxis(a,b)}}(),rotateZ:function(){var a=new THREE.Vector3(0,0,1);return function(b){return this.rotateOnAxis(a,b)}}(),translateOnAxis:function(){var a=new THREE.Vector3;return function(b,c){a.copy(b).applyQuaternion(this.quaternion);this.position.add(a.multiplyScalar(c));
return this}}(),translate:function(a,b){console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead.");return this.translateOnAxis(b,a)},translateX:function(){var a=new THREE.Vector3(1,0,0);return function(b){return this.translateOnAxis(a,b)}}(),translateY:function(){var a=new THREE.Vector3(0,1,0);return function(b){return this.translateOnAxis(a,b)}}(),translateZ:function(){var a=new THREE.Vector3(0,0,1);return function(b){return this.translateOnAxis(a,
b)}}(),localToWorld:function(a){return a.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var a=new THREE.Matrix4;return function(b){return b.applyMatrix4(a.getInverse(this.matrixWorld))}}(),lookAt:function(){var a=new THREE.Matrix4;return function(b){a.lookAt(b,this.position,this.up);this.quaternion.setFromRotationMatrix(a)}}(),add:function(a){if(1<arguments.length){for(var b=0;b<arguments.length;b++)this.add(arguments[b]);return this}if(a===this)return console.error("THREE.Object3D.add:",
a,"can't be added as a child of itself."),this;a instanceof THREE.Object3D?(void 0!==a.parent&&a.parent.remove(a),a.parent=this,a.dispatchEvent({type:"added"}),this.children||(this.children=[]),this.children.push(a)):console.error("THREE.Object3D.add:",a,"is not an instance of THREE.Object3D.");return this},remove:function(a){if(1<arguments.length)for(var b=0;b<arguments.length;b++)this.remove(arguments[b]);this.children&&(b=this.children.indexOf(a),-1!==b&&(a.parent=void 0,a.dispatchEvent({type:"removed"}),
this.children.splice(b,1)))},getChildByName:function(a,b){console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName().");return this.getObjectByName(a,b)},getObjectById:function(a,b){if(this.id===a)return this;if(this.children)for(var c=0,d=this.children.length;c<d;c++){var f=this.children[c].getObjectById(a,b);if(void 0!==f)return f}},getObjectByName:function(a,b){if(this.name===a)return this;if(this.children)for(var c=0,d=this.children.length;c<d;c++){var f=this.children[c].getObjectByName(a,
b);if(void 0!==f)return f}},getWorldPosition:function(a){a=a||new THREE.Vector3;this.updateMatrixWorld(!0);return a.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(){var a=new THREE.Vector3,b=new THREE.Vector3;return function(c){c=c||new THREE.Quaternion;this.updateMatrixWorld(!0);this.matrixWorld.decompose(a,c,b);return c}}(),getWorldRotation:function(){var a=new THREE.Quaternion;return function(b){b=b||new THREE.Euler;this.getWorldQuaternion(a);return b.setFromQuaternion(a,
this.rotation.order,!1)}}(),getWorldScale:function(){var a=new THREE.Vector3,b=new THREE.Quaternion;return function(c){c=c||new THREE.Vector3;this.updateMatrixWorld(!0);this.matrixWorld.decompose(a,b,c);return c}}(),getWorldDirection:function(){var a=new THREE.Quaternion;return function(b){b=b||new THREE.Vector3;this.getWorldQuaternion(a);return b.set(0,0,1).applyQuaternion(a)}}(),raycast:function(){},traverse:function(a){a(this);if(this.children)for(var b=0,c=this.children.length;b<c;b++)this.children[b].traverse(a)},
traverseVisible:function(a){if(!1!==this.visible&&(a(this),this.children))for(var b=0,c=this.children.length;b<c;b++)this.children[b].traverseVisible(a)},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale);this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(a){!0===this.matrixAutoUpdate&&this.updateMatrix();if(!0===this.matrixWorldNeedsUpdate||!0===a)void 0===this.parent&&this.matrix?this.matrixWorld.copy(this.matrix):this.matrix&&this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,
this.matrix),this.matrixWorldNeedsUpdate=!1,a=!0;if(this.children)for(var b=0,c=this.children.length;b<c;b++)this.children[b].updateMatrixWorld(a)},toJSON:function(){var a={metadata:{version:4.3,type:"Object",generator:"ObjectExporter"}},b={},c=function(c){void 0===a.geometries&&(a.geometries=[]);if(void 0===b[c.uuid]){var d=c.toJSON();delete d.metadata;b[c.uuid]=d;a.geometries.push(d)}return c.uuid},d={},f=function(b){void 0===a.materials&&(a.materials=[]);if(void 0===d[b.uuid]){var c=b.toJSON();
delete c.metadata;d[b.uuid]=c;a.materials.push(c)}return b.uuid},g=function(a){var b={};b.uuid=a.uuid;b.type=a.type;""!==a.name&&(b.name=a.name);a.userData&&"{}"!==JSON.stringify(a.userData)&&(b.userData=a.userData);!0!==a.visible&&(b.visible=a.visible);a instanceof THREE.PerspectiveCamera?(b.fov=a.fov,b.aspect=a.aspect,b.near=a.near,b.far=a.far):a instanceof THREE.OrthographicCamera?(b.left=a.left,b.right=a.right,b.top=a.top,b.bottom=a.bottom,b.near=a.near,b.far=a.far):a instanceof THREE.AmbientLight?
b.color=a.color.getHex():a instanceof THREE.DirectionalLight?(b.color=a.color.getHex(),b.intensity=a.intensity):a instanceof THREE.PointLight?(b.color=a.color.getHex(),b.intensity=a.intensity,b.distance=a.distance):a instanceof THREE.SpotLight?(b.color=a.color.getHex(),b.intensity=a.intensity,b.distance=a.distance,b.angle=a.angle,b.exponent=a.exponent):a instanceof THREE.HemisphereLight?(b.color=a.color.getHex(),b.groundColor=a.groundColor.getHex()):a instanceof THREE.Mesh?(b.geometry=c(a.geometry),
b.material=f(a.material)):a instanceof THREE.Line?(b.geometry=c(a.geometry),b.material=f(a.material)):a instanceof THREE.Sprite&&(b.material=f(a.material));b.matrix=a.matrix.toArray();if(0<a.children.length){b.children=[];for(var d=0;d<a.children.length;d++)b.children.push(g(a.children[d]))}return b};a.object=g(this);return a},clone:function(a,b){void 0===a&&(a=new THREE.Object3D);void 0===b&&(b=!0);a.name=this.name;this.skipModTerms||(a.up.copy(this.up),a.position.copy(this.position),a.quaternion.copy(this.quaternion),
a.scale.copy(this.scale),a.rotationAutoUpdate=this.rotationAutoUpdate,a.matrix.copy(this.matrix),a.matrixAutoUpdate=this.matrixAutoUpdate);a.renderDepth=this.renderDepth;a.matrixWorld.copy(this.matrixWorld);a.matrixWorldNeedsUpdate=this.matrixWorldNeedsUpdate;a.visible=this.visible;a.castShadow=this.castShadow;a.receiveShadow=this.receiveShadow;a.frustumCulled=this.frustumCulled;a.userData=this.userData?JSON.parse(JSON.stringify(this.userData)):void 0;if(!0===b&&this.children)for(var c=0;c<this.children.length;c++)a.add(this.children[c].clone());
return a}};THREE.EventDispatcher.prototype.apply(THREE.Object3D.prototype);THREE.Object3DIdCount=0;THREE.Projector=function(){console.warn("THREE.Projector has been moved to /examples/renderers/Projector.js.");this.projectVector=function(a,b){console.warn("THREE.Projector: .projectVector() is now vector.project().");a.project(b)};this.unprojectVector=function(a,b){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject().");a.unproject(b)};this.pickingRay=function(a,b){console.error("THREE.Projector: .pickingRay() has been removed.")}};
THREE.Face3=function(a,b,c,d,f,g){this.a=a;this.b=b;this.c=c;this.normal=d instanceof THREE.Vector3?d:new THREE.Vector3;this.vertexNormals=d instanceof Array?d:[];this.color=f instanceof THREE.Color?f:new THREE.Color;this.vertexColors=f instanceof Array?f:[];this.vertexTangents=[];this.materialIndex=void 0!==g?g:0};
THREE.Face3.prototype={constructor:THREE.Face3,clone:function(){var a=new THREE.Face3(this.a,this.b,this.c);a.normal.copy(this.normal);a.color.copy(this.color);a.materialIndex=this.materialIndex;for(var b=0,c=this.vertexNormals.length;b<c;b++)a.vertexNormals[b]=this.vertexNormals[b].clone();b=0;for(c=this.vertexColors.length;b<c;b++)a.vertexColors[b]=this.vertexColors[b].clone();b=0;for(c=this.vertexTangents.length;b<c;b++)a.vertexTangents[b]=this.vertexTangents[b].clone();return a}};
THREE.Face4=function(a,b,c,d,f,g,h){console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead.");return new THREE.Face3(a,b,c,f,g,h)};THREE.BufferAttribute=function(a,b){this.array=a;this.itemSize=b;this.needsUpdate=!1};
THREE.BufferAttribute.prototype={constructor:THREE.BufferAttribute,get length(){return this.array.length},copyAt:function(a,b,c){a*=this.itemSize;c*=b.itemSize;for(var d=0,f=this.itemSize;d<f;d++)this.array[a+d]=b.array[c+d]},set:function(a){this.array.set(a);return this},setX:function(a,b){this.array[a*this.itemSize]=b;return this},setY:function(a,b){this.array[a*this.itemSize+1]=b;return this},setZ:function(a,b){this.array[a*this.itemSize+2]=b;return this},setXY:function(a,b,c){a*=this.itemSize;
this.array[a]=b;this.array[a+1]=c;return this},setXYZ:function(a,b,c,d){a*=this.itemSize;this.array[a]=b;this.array[a+1]=c;this.array[a+2]=d;return this},setXYZW:function(a,b,c,d,f){a*=this.itemSize;this.array[a]=b;this.array[a+1]=c;this.array[a+2]=d;this.array[a+3]=f;return this},clone:function(){return new THREE.BufferAttribute(new this.array.constructor(this.array),this.itemSize)}};
THREE.Int8Attribute=function(a,b){console.warn("THREE.Int8Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.");return new THREE.BufferAttribute(a,b)};THREE.Uint8Attribute=function(a,b){console.warn("THREE.Uint8Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.");return new THREE.BufferAttribute(a,b)};
THREE.Uint8ClampedAttribute=function(a,b){console.warn("THREE.Uint8ClampedAttribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.");return new THREE.BufferAttribute(a,b)};THREE.Int16Attribute=function(a,b){console.warn("THREE.Int16Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.");return new THREE.BufferAttribute(a,b)};
THREE.Uint16Attribute=function(a,b){console.warn("THREE.Uint16Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.");return new THREE.BufferAttribute(a,b)};THREE.Int32Attribute=function(a,b){console.warn("THREE.Int32Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.");return new THREE.BufferAttribute(a,b)};
THREE.Uint32Attribute=function(a,b){console.warn("THREE.Uint32Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.");return new THREE.BufferAttribute(a,b)};THREE.Float32Attribute=function(a,b){console.warn("THREE.Float32Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.");return new THREE.BufferAttribute(a,b)};
THREE.Float64Attribute=function(a,b){console.warn("THREE.Float64Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.");return new THREE.BufferAttribute(a,b)};THREE.BufferGeometry=function(){Object.defineProperty(this,"id",{value:THREE.GeometryIdCount++});this.type="BufferGeometry";this.attributes={};this.attributesKeys=[];this.offsets=this.drawcalls=[];this.boundingSphere=this.boundingBox=null};
THREE.BufferGeometry.prototype={constructor:THREE.BufferGeometry,addAttribute:function(a,b,c){!1===b instanceof THREE.BufferAttribute?(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.attributes[a]={array:b,itemSize:c}):(this.attributes[a]=b,this.attributesKeys=Object.keys(this.attributes))},getAttribute:function(a){return this.attributes[a]},addDrawCall:function(a,b,c){this.drawcalls.push({start:a,count:b,index:void 0!==c?c:0})},applyMatrix:function(a){var b=
this.attributes.position;void 0!==b&&(a.applyToVector3Array(b.array),b.needsUpdate=!0);b=this.attributes.normal;void 0!==b&&((new THREE.Matrix3).getNormalMatrix(a).applyToVector3Array(b.array),b.needsUpdate=!0)},center:function(){},fromGeometry:function(a,b){b=b||{vertexColors:THREE.NoColors};var c=a.vertices,d=a.faces,f=a.faceVertexUvs,g=b.vertexColors,h=0<f[0].length,k=3==d[0].vertexNormals.length,l=new Float32Array(9*d.length);this.addAttribute("position",new THREE.BufferAttribute(l,3));var m=
new Float32Array(9*d.length);this.addAttribute("normal",new THREE.BufferAttribute(m,3));if(g!==THREE.NoColors){var p=new Float32Array(9*d.length);this.addAttribute("color",new THREE.BufferAttribute(p,3))}if(!0===h){var n=new Float32Array(6*d.length);this.addAttribute("uv",new THREE.BufferAttribute(n,2))}for(var q=0,r=0,v=0;q<d.length;q++,r+=6,v+=9){var s=d[q],w=c[s.a],z=c[s.b],D=c[s.c];l[v]=w.x;l[v+1]=w.y;l[v+2]=w.z;l[v+3]=z.x;l[v+4]=z.y;l[v+5]=z.z;l[v+6]=D.x;l[v+7]=D.y;l[v+8]=D.z;!0===k?(w=s.vertexNormals[0],
z=s.vertexNormals[1],D=s.vertexNormals[2],m[v]=w.x,m[v+1]=w.y,m[v+2]=w.z,m[v+3]=z.x,m[v+4]=z.y,m[v+5]=z.z,m[v+6]=D.x,m[v+7]=D.y,m[v+8]=D.z):(w=s.normal,m[v]=w.x,m[v+1]=w.y,m[v+2]=w.z,m[v+3]=w.x,m[v+4]=w.y,m[v+5]=w.z,m[v+6]=w.x,m[v+7]=w.y,m[v+8]=w.z);g===THREE.FaceColors?(s=s.color,p[v]=s.r,p[v+1]=s.g,p[v+2]=s.b,p[v+3]=s.r,p[v+4]=s.g,p[v+5]=s.b,p[v+6]=s.r,p[v+7]=s.g,p[v+8]=s.b):g===THREE.VertexColors&&(w=s.vertexColors[0],z=s.vertexColors[1],s=s.vertexColors[2],p[v]=w.r,p[v+1]=w.g,p[v+2]=w.b,p[v+3]=
z.r,p[v+4]=z.g,p[v+5]=z.b,p[v+6]=s.r,p[v+7]=s.g,p[v+8]=s.b);!0===h&&(s=f[0][q][0],w=f[0][q][1],z=f[0][q][2],n[r]=s.x,n[r+1]=s.y,n[r+2]=w.x,n[r+3]=w.y,n[r+4]=z.x,n[r+5]=z.y)}this.computeBoundingSphere();return this},computeBoundingBox:function(){var a=new THREE.Vector3;return function(){null===this.boundingBox&&(this.boundingBox=new THREE.Box3);var b=this.attributes.position.array;if(b){var c=this.boundingBox;c.makeEmpty();for(var d=0,f=b.length;d<f;d+=3)a.set(b[d],b[d+1],b[d+2]),c.expandByPoint(a)}if(void 0===
b||0===b.length)this.boundingBox.min.set(0,0,0),this.boundingBox.max.set(0,0,0);(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.')}}(),computeBoundingSphere:function(){var a=new THREE.Box3,b=new THREE.Vector3;return function(){null===this.boundingSphere&&(this.boundingSphere=new THREE.Sphere);var c=this.attributes.position.array;
if(c){a.makeEmpty();for(var d=this.boundingSphere.center,f=0,g=c.length;f<g;f+=3)b.set(c[f],c[f+1],c[f+2]),a.expandByPoint(b);a.center(d);for(var h=0,f=0,g=c.length;f<g;f+=3)b.set(c[f],c[f+1],c[f+2]),h=Math.max(h,d.distanceToSquared(b));this.boundingSphere.radius=Math.sqrt(h);isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.')}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var a=
this.attributes;if(a.position){var b=a.position.array;if(void 0===a.normal)this.addAttribute("normal",new THREE.BufferAttribute(new Float32Array(b.length),3));else for(var c=a.normal.array,d=0,f=c.length;d<f;d++)c[d]=0;var c=a.normal.array,g,h,k,l=new THREE.Vector3,m=new THREE.Vector3,p=new THREE.Vector3,n=new THREE.Vector3,q=new THREE.Vector3;if(a.index)for(var r=a.index.array,v=0<this.offsets.length?this.offsets:[{start:0,count:r.length,index:0}],s=0,w=v.length;s<w;++s){f=v[s].start;g=v[s].count;
for(var z=v[s].index,d=f,f=f+g;d<f;d+=3)g=3*(z+r[d]),h=3*(z+r[d+1]),k=3*(z+r[d+2]),l.fromArray(b,g),m.fromArray(b,h),p.fromArray(b,k),n.subVectors(p,m),q.subVectors(l,m),n.cross(q),c[g]+=n.x,c[g+1]+=n.y,c[g+2]+=n.z,c[h]+=n.x,c[h+1]+=n.y,c[h+2]+=n.z,c[k]+=n.x,c[k+1]+=n.y,c[k+2]+=n.z}else for(d=0,f=b.length;d<f;d+=9)l.fromArray(b,d),m.fromArray(b,d+3),p.fromArray(b,d+6),n.subVectors(p,m),q.subVectors(l,m),n.cross(q),c[d]=n.x,c[d+1]=n.y,c[d+2]=n.z,c[d+3]=n.x,c[d+4]=n.y,c[d+5]=n.z,c[d+6]=n.x,c[d+7]=n.y,
c[d+8]=n.z;this.normalizeNormals();a.normal.needsUpdate=!0}},computeTangents:function(){function a(a,b,c){n.fromArray(d,3*a);q.fromArray(d,3*b);r.fromArray(d,3*c);v.fromArray(g,2*a);s.fromArray(g,2*b);w.fromArray(g,2*c);z=q.x-n.x;D=r.x-n.x;A=q.y-n.y;E=r.y-n.y;N=q.z-n.z;H=r.z-n.z;J=s.x-v.x;G=w.x-v.x;I=s.y-v.y;M=w.y-v.y;C=1/(J*M-G*I);K.set((M*z-I*D)*C,(M*A-I*E)*C,(M*N-I*H)*C);F.set((J*D-G*z)*C,(J*E-G*A)*C,(J*H-G*N)*C);l[a].add(K);l[b].add(K);l[c].add(K);m[a].add(F);m[b].add(F);m[c].add(F)}function b(a){V.fromArray(f,
3*a);Q.copy(V);ca=l[a];W.copy(ca);W.sub(V.multiplyScalar(V.dot(ca))).normalize();aa.crossVectors(Q,ca);Z=aa.dot(m[a]);ka=0>Z?-1:1;k[4*a]=W.x;k[4*a+1]=W.y;k[4*a+2]=W.z;k[4*a+3]=ka}if(void 0===this.attributes.index||void 0===this.attributes.position||void 0===this.attributes.normal||void 0===this.attributes.uv)console.warn("Missing required attributes (index, position, normal or uv) in BufferGeometry.computeTangents()");else{var c=this.attributes.index.array,d=this.attributes.position.array,f=this.attributes.normal.array,
g=this.attributes.uv.array,h=d.length/3;void 0===this.attributes.tangent&&this.addAttribute("tangent",new THREE.BufferAttribute(new Float32Array(4*h),4));for(var k=this.attributes.tangent.array,l=[],m=[],p=0;p<h;p++)l[p]=new THREE.Vector3,m[p]=new THREE.Vector3;var n=new THREE.Vector3,q=new THREE.Vector3,r=new THREE.Vector3,v=new THREE.Vector2,s=new THREE.Vector2,w=new THREE.Vector2,z,D,A,E,N,H,J,G,I,M,C,K=new THREE.Vector3,F=new THREE.Vector3,B,R,Y,S,P;0===this.drawcalls.length&&this.addDrawCall(0,
c.length,0);var ba=this.drawcalls,p=0;for(R=ba.length;p<R;++p){B=ba[p].start;Y=ba[p].count;var U=ba[p].index,h=B;for(B+=Y;h<B;h+=3)Y=U+c[h],S=U+c[h+1],P=U+c[h+2],a(Y,S,P)}var W=new THREE.Vector3,aa=new THREE.Vector3,V=new THREE.Vector3,Q=new THREE.Vector3,ka,ca,Z,p=0;for(R=ba.length;p<R;++p)for(B=ba[p].start,Y=ba[p].count,U=ba[p].index,h=B,B+=Y;h<B;h+=3)Y=U+c[h],S=U+c[h+1],P=U+c[h+2],b(Y),b(S),b(P)}},computeOffsets:function(a){var b=a;void 0===a&&(b=65535);Date.now();a=this.attributes.index.array;
for(var c=this.attributes.position.array,d=a.length/3,f=new Uint16Array(a.length),g=0,h=0,k=[{start:0,count:0,index:0}],l=k[0],m=0,p=0,n=new Int32Array(6),q=new Int32Array(c.length),r=new Int32Array(c.length),v=0;v<c.length;v++)q[v]=-1,r[v]=-1;for(c=0;c<d;c++){for(var s=p=0;3>s;s++)v=a[3*c+s],-1==q[v]?(n[2*s]=v,n[2*s+1]=-1,p++):q[v]<l.index?(n[2*s]=v,n[2*s+1]=-1,m++):(n[2*s]=v,n[2*s+1]=q[v]);if(h+p>l.index+b)for(l={start:g,count:0,index:h},k.push(l),p=0;6>p;p+=2)s=n[p+1],-1<s&&s<l.index&&(n[p+1]=
-1);for(p=0;6>p;p+=2)v=n[p],s=n[p+1],-1===s&&(s=h++),q[v]=s,r[s]=v,f[g++]=s-l.index,l.count++}this.reorderBuffers(f,r,h);return this.offsets=k},merge:function(){console.log("BufferGeometry.merge(): TODO")},normalizeNormals:function(){for(var a=this.attributes.normal.array,b,c,d,f=0,g=a.length;f<g;f+=3)b=a[f],c=a[f+1],d=a[f+2],b=1/Math.sqrt(b*b+c*c+d*d),a[f]*=b,a[f+1]*=b,a[f+2]*=b},reorderBuffers:function(a,b,c){var d={},f;for(f in this.attributes)"index"!=f&&(d[f]=new this.attributes[f].array.constructor(this.attributes[f].itemSize*
c));for(var g=0;g<c;g++){var h=b[g];for(f in this.attributes)if("index"!=f)for(var k=this.attributes[f].array,l=this.attributes[f].itemSize,m=d[f],p=0;p<l;p++)m[g*l+p]=k[h*l+p]}this.attributes.index.array=a;for(f in this.attributes)"index"!=f&&(this.attributes[f].array=d[f],this.attributes[f].numItems=this.attributes[f].itemSize*c)},toJSON:function(){var a={metadata:{version:4,type:"BufferGeometry",generator:"BufferGeometryExporter"},uuid:this.uuid,type:this.type,data:{attributes:{}}},b=this.attributes,
c=this.offsets,d=this.boundingSphere,f;for(f in b){for(var g=b[f],h=[],k=g.array,l=0,m=k.length;l<m;l++)h[l]=k[l];a.data.attributes[f]={itemSize:g.itemSize,type:g.array.constructor.name,array:h}}0<c.length&&(a.data.offsets=JSON.parse(JSON.stringify(c)));null!==d&&(a.data.boundingSphere={center:d.center.toArray(),radius:d.radius});return a},clone:function(){var a=new THREE.BufferGeometry,b;for(b in this.attributes)a.addAttribute(b,this.attributes[b].clone());b=0;for(var c=this.offsets.length;b<c;b++){var d=
this.offsets[b];a.offsets.push({start:d.start,index:d.index,count:d.count})}return a},dispose:function(){this.dispatchEvent({type:"dispose"})}};THREE.EventDispatcher.prototype.apply(THREE.BufferGeometry.prototype);
THREE.Geometry=function(){Object.defineProperty(this,"id",{value:THREE.GeometryIdCount++});this.uuid=THREE.Math.generateUUID();this.name="";this.type="Geometry";this.vertices=[];this.colors=[];this.faces=[];this.faceVertexUvs=[[]];this.morphTargets=[];this.morphColors=[];this.morphNormals=[];this.skinWeights=[];this.skinIndices=[];this.lineDistances=[];this.boundingSphere=this.boundingBox=null;this.hasTangents=!1;this.dynamic=!0;this.groupsNeedUpdate=this.lineDistancesNeedUpdate=this.colorsNeedUpdate=
this.tangentsNeedUpdate=this.normalsNeedUpdate=this.uvsNeedUpdate=this.elementsNeedUpdate=this.verticesNeedUpdate=!1};
THREE.Geometry.prototype={constructor:THREE.Geometry,applyMatrix:function(a){for(var b=(new THREE.Matrix3).getNormalMatrix(a),c=0,d=this.vertices.length;c<d;c++)this.vertices[c].applyMatrix4(a);c=0;for(d=this.faces.length;c<d;c++){a=this.faces[c];a.normal.applyMatrix3(b).normalize();for(var f=0,g=a.vertexNormals.length;f<g;f++)a.vertexNormals[f].applyMatrix3(b).normalize()}this.boundingBox instanceof THREE.Box3&&this.computeBoundingBox();this.boundingSphere instanceof THREE.Sphere&&this.computeBoundingSphere()},
fromBufferGeometry:function(a){for(var b=this,c=a.attributes,d=c.position.array,f=void 0!==c.index?c.index.array:void 0,g=void 0!==c.normal?c.normal.array:void 0,h=void 0!==c.color?c.color.array:void 0,k=void 0!==c.uv?c.uv.array:void 0,l=[],m=[],p=c=0;c<d.length;c+=3,p+=2)b.vertices.push(new THREE.Vector3(d[c],d[c+1],d[c+2])),void 0!==g&&l.push(new THREE.Vector3(g[c],g[c+1],g[c+2])),void 0!==h&&b.colors.push(new THREE.Color(h[c],h[c+1],h[c+2])),void 0!==k&&m.push(new THREE.Vector2(k[p],k[p+1]));k=
function(a,c,d){var f=void 0!==g?[l[a].clone(),l[c].clone(),l[d].clone()]:[],k=void 0!==h?[b.colors[a].clone(),b.colors[c].clone(),b.colors[d].clone()]:[];b.faces.push(new THREE.Face3(a,c,d,f,k));b.faceVertexUvs[0].push([m[a],m[c],m[d]])};if(void 0!==f)for(c=0;c<f.length;c+=3)k(f[c],f[c+1],f[c+2]);else for(c=0;c<d.length/3;c+=3)k(c,c+1,c+2);this.computeFaceNormals();null!==a.boundingBox&&(this.boundingBox=a.boundingBox.clone());null!==a.boundingSphere&&(this.boundingSphere=a.boundingSphere.clone());
return this},center:function(){this.computeBoundingBox();var a=new THREE.Vector3;a.addVectors(this.boundingBox.min,this.boundingBox.max);a.multiplyScalar(-0.5);this.applyMatrix((new THREE.Matrix4).makeTranslation(a.x,a.y,a.z));this.computeBoundingBox();return a},computeFaceNormals:function(){for(var a=new THREE.Vector3,b=new THREE.Vector3,c=0,d=this.faces.length;c<d;c++){var f=this.faces[c],g=this.vertices[f.a],h=this.vertices[f.b];a.subVectors(this.vertices[f.c],h);b.subVectors(g,h);a.cross(b);a.normalize();
f.normal.copy(a)}},computeVertexNormals:function(a){var b,c,d;d=Array(this.vertices.length);b=0;for(c=this.vertices.length;b<c;b++)d[b]=new THREE.Vector3;if(a){var f,g,h,k=new THREE.Vector3,l=new THREE.Vector3;new THREE.Vector3;new THREE.Vector3;new THREE.Vector3;a=0;for(b=this.faces.length;a<b;a++)c=this.faces[a],f=this.vertices[c.a],g=this.vertices[c.b],h=this.vertices[c.c],k.subVectors(h,g),l.subVectors(f,g),k.cross(l),d[c.a].add(k),d[c.b].add(k),d[c.c].add(k)}else for(a=0,b=this.faces.length;a<
b;a++)c=this.faces[a],d[c.a].add(c.normal),d[c.b].add(c.normal),d[c.c].add(c.normal);b=0;for(c=this.vertices.length;b<c;b++)d[b].normalize();a=0;for(b=this.faces.length;a<b;a++)c=this.faces[a],c.vertexNormals[0]=d[c.a].clone(),c.vertexNormals[1]=d[c.b].clone(),c.vertexNormals[2]=d[c.c].clone()},computeMorphNormals:function(){var a,b,c,d,f;c=0;for(d=this.faces.length;c<d;c++)for(f=this.faces[c],f.__originalFaceNormal?f.__originalFaceNormal.copy(f.normal):f.__originalFaceNormal=f.normal.clone(),f.__originalVertexNormals||
(f.__originalVertexNormals=[]),a=0,b=f.vertexNormals.length;a<b;a++)f.__originalVertexNormals[a]?f.__originalVertexNormals[a].copy(f.vertexNormals[a]):f.__originalVertexNormals[a]=f.vertexNormals[a].clone();var g=new THREE.Geometry;g.faces=this.faces;a=0;for(b=this.morphTargets.length;a<b;a++){if(!this.morphNormals[a]){this.morphNormals[a]={};this.morphNormals[a].faceNormals=[];this.morphNormals[a].vertexNormals=[];f=this.morphNormals[a].faceNormals;var h=this.morphNormals[a].vertexNormals,k,l;c=
0;for(d=this.faces.length;c<d;c++)k=new THREE.Vector3,l={a:new THREE.Vector3,b:new THREE.Vector3,c:new THREE.Vector3},f.push(k),h.push(l)}h=this.morphNormals[a];g.vertices=this.morphTargets[a].vertices;g.computeFaceNormals();g.computeVertexNormals();c=0;for(d=this.faces.length;c<d;c++)f=this.faces[c],k=h.faceNormals[c],l=h.vertexNormals[c],k.copy(f.normal),l.a.copy(f.vertexNormals[0]),l.b.copy(f.vertexNormals[1]),l.c.copy(f.vertexNormals[2])}c=0;for(d=this.faces.length;c<d;c++)f=this.faces[c],f.normal=
f.__originalFaceNormal,f.vertexNormals=f.__originalVertexNormals},computeTangents:function(){var a,b,c,d,f,g,h,k,l,m,p,n,q,r,v,s,w,z=[],D=[];c=new THREE.Vector3;var A=new THREE.Vector3,E=new THREE.Vector3,N=new THREE.Vector3,H=new THREE.Vector3;a=0;for(b=this.vertices.length;a<b;a++)z[a]=new THREE.Vector3,D[a]=new THREE.Vector3;a=0;for(b=this.faces.length;a<b;a++)f=this.faces[a],g=this.faceVertexUvs[0][a],d=f.a,w=f.b,f=f.c,h=this.vertices[d],k=this.vertices[w],l=this.vertices[f],m=g[0],p=g[1],n=g[2],
g=k.x-h.x,q=l.x-h.x,r=k.y-h.y,v=l.y-h.y,k=k.z-h.z,h=l.z-h.z,l=p.x-m.x,s=n.x-m.x,p=p.y-m.y,m=n.y-m.y,n=1/(l*m-s*p),c.set((m*g-p*q)*n,(m*r-p*v)*n,(m*k-p*h)*n),A.set((l*q-s*g)*n,(l*v-s*r)*n,(l*h-s*k)*n),z[d].add(c),z[w].add(c),z[f].add(c),D[d].add(A),D[w].add(A),D[f].add(A);A=["a","b","c","d"];a=0;for(b=this.faces.length;a<b;a++)for(f=this.faces[a],c=0;c<Math.min(f.vertexNormals.length,3);c++)H.copy(f.vertexNormals[c]),d=f[A[c]],w=z[d],E.copy(w),E.sub(H.multiplyScalar(H.dot(w))).normalize(),N.crossVectors(f.vertexNormals[c],
w),d=N.dot(D[d]),d=0>d?-1:1,f.vertexTangents[c]=new THREE.Vector4(E.x,E.y,E.z,d);this.hasTangents=!0},computeLineDistances:function(){for(var a=0,b=this.vertices,c=0,d=b.length;c<d;c++)0<c&&(a+=b[c].distanceTo(b[c-1])),this.lineDistances[c]=a},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new THREE.Box3);this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new THREE.Sphere);this.boundingSphere.setFromPoints(this.vertices)},
merge:function(a,b,c){if(!1===a instanceof THREE.Geometry)console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",a);else{var d,f=this.vertices.length,g=this.vertices,h=a.vertices,k=this.faces,l=a.faces,m=this.faceVertexUvs[0];a=a.faceVertexUvs[0];void 0===c&&(c=0);void 0!==b&&(d=(new THREE.Matrix3).getNormalMatrix(b));for(var p=0,n=h.length;p<n;p++){var q=h[p].clone();void 0!==b&&q.applyMatrix4(b);g.push(q)}p=0;for(n=l.length;p<n;p++){var h=l[p],r,v=h.vertexNormals,s=
h.vertexColors,q=new THREE.Face3(h.a+f,h.b+f,h.c+f);q.normal.copy(h.normal);void 0!==d&&q.normal.applyMatrix3(d).normalize();b=0;for(g=v.length;b<g;b++)r=v[b].clone(),void 0!==d&&r.applyMatrix3(d).normalize(),q.vertexNormals.push(r);q.color.copy(h.color);b=0;for(g=s.length;b<g;b++)r=s[b],q.vertexColors.push(r.clone());q.materialIndex=h.materialIndex+c;k.push(q)}p=0;for(n=a.length;p<n;p++)if(c=a[p],d=[],void 0!==c){b=0;for(g=c.length;b<g;b++)d.push(new THREE.Vector2(c[b].x,c[b].y));m.push(d)}}},mergeVertices:function(){var a=
{},b=[],c=[],d,f=Math.pow(10,4),g,h;g=0;for(h=this.vertices.length;g<h;g++)d=this.vertices[g],d=Math.round(d.x*f)+"_"+Math.round(d.y*f)+"_"+Math.round(d.z*f),void 0===a[d]?(a[d]=g,b.push(this.vertices[g]),c[g]=b.length-1):c[g]=c[a[d]];a=[];g=0;for(h=this.faces.length;g<h;g++)for(f=this.faces[g],f.a=c[f.a],f.b=c[f.b],f.c=c[f.c],f=[f.a,f.b,f.c],d=0;3>d;d++)if(f[d]==f[(d+1)%3]){a.push(g);break}for(g=a.length-1;0<=g;g--)for(f=a[g],this.faces.splice(f,1),c=0,h=this.faceVertexUvs.length;c<h;c++)this.faceVertexUvs[c].splice(f,
1);g=this.vertices.length-b.length;this.vertices=b;return g},toJSON:function(){function a(a,b,c){return c?a|1<<b:a&~(1<<b)}function b(a){var b=a.x.toString()+a.y.toString()+a.z.toString();if(void 0!==m[b])return m[b];m[b]=l.length/3;l.push(a.x,a.y,a.z);return m[b]}function c(a){var b=a.r.toString()+a.g.toString()+a.b.toString();if(void 0!==n[b])return n[b];n[b]=p.length;p.push(a.getHex());return n[b]}function d(a){var b=a.x.toString()+a.y.toString();if(void 0!==r[b])return r[b];r[b]=q.length/2;q.push(a.x,
a.y);return r[b]}var f={metadata:{version:4,type:"BufferGeometry",generator:"BufferGeometryExporter"},uuid:this.uuid,type:this.type};""!==this.name&&(f.name=this.name);if(void 0!==this.parameters){var g=this.parameters,h;for(h in g)void 0!==g[h]&&(f[h]=g[h]);return f}g=[];for(h=0;h<this.vertices.length;h++){var k=this.vertices[h];g.push(k.x,k.y,k.z)}var k=[],l=[],m={},p=[],n={},q=[],r={};for(h=0;h<this.faces.length;h++){var v=this.faces[h],s=void 0!==this.faceVertexUvs[0][h],w=0<v.normal.length(),
z=0<v.vertexNormals.length,D=1!==v.color.r||1!==v.color.g||1!==v.color.b,A=0<v.vertexColors.length,E=0,E=a(E,0,0),E=a(E,1,!1),E=a(E,2,!1),E=a(E,3,s),E=a(E,4,w),E=a(E,5,z),E=a(E,6,D),E=a(E,7,A);k.push(E);k.push(v.a,v.b,v.c);s&&(s=this.faceVertexUvs[0][h],k.push(d(s[0]),d(s[1]),d(s[2])));w&&k.push(b(v.normal));z&&(w=v.vertexNormals,k.push(b(w[0]),b(w[1]),b(w[2])));D&&k.push(c(v.color));A&&(v=v.vertexColors,k.push(c(v[0]),c(v[1]),c(v[2])))}f.data={};f.data.vertices=g;f.data.normals=l;0<p.length&&(f.data.colors=
p);0<q.length&&(f.data.uvs=[q]);f.data.faces=k;return f},clone:function(){for(var a=new THREE.Geometry,b=this.vertices,c=0,d=b.length;c<d;c++)a.vertices.push(b[c].clone());b=this.faces;c=0;for(d=b.length;c<d;c++)a.faces.push(b[c].clone());b=this.faceVertexUvs[0];c=0;for(d=b.length;c<d;c++){for(var f=b[c],g=[],h=0,k=f.length;h<k;h++)g.push(new THREE.Vector2(f[h].x,f[h].y));a.faceVertexUvs[0].push(g)}return a},dispose:function(){this.dispatchEvent({type:"dispose"})}};THREE.EventDispatcher.prototype.apply(THREE.Geometry.prototype);
THREE.GeometryIdCount=0;THREE.Camera=function(){THREE.Object3D.call(this);this.type="Camera";this.matrixWorldInverse=new THREE.Matrix4;this.projectionMatrix=new THREE.Matrix4};THREE.Camera.prototype=Object.create(THREE.Object3D.prototype);THREE.Camera.prototype.getWorldDirection=function(){var a=new THREE.Quaternion;return function(b){b=b||new THREE.Vector3;this.getWorldQuaternion(a);return b.set(0,0,-1).applyQuaternion(a)}}();
THREE.Camera.prototype.lookAt=function(){var a=new THREE.Matrix4;return function(b){a.lookAt(this.position,b,this.up);this.quaternion.setFromRotationMatrix(a)}}();THREE.Camera.prototype.clone=function(a){void 0===a&&(a=new THREE.Camera);THREE.Object3D.prototype.clone.call(this,a);a.matrixWorldInverse.copy(this.matrixWorldInverse);a.projectionMatrix.copy(this.projectionMatrix);return a};
THREE.CubeCamera=function(a,b,c){THREE.Object3D.call(this);this.type="CubeCamera";var d=new THREE.PerspectiveCamera(90,1,a,b);d.up.set(0,-1,0);d.lookAt(new THREE.Vector3(1,0,0));this.add(d);var f=new THREE.PerspectiveCamera(90,1,a,b);f.up.set(0,-1,0);f.lookAt(new THREE.Vector3(-1,0,0));this.add(f);var g=new THREE.PerspectiveCamera(90,1,a,b);g.up.set(0,0,1);g.lookAt(new THREE.Vector3(0,1,0));this.add(g);var h=new THREE.PerspectiveCamera(90,1,a,b);h.up.set(0,0,-1);h.lookAt(new THREE.Vector3(0,-1,0));
this.add(h);var k=new THREE.PerspectiveCamera(90,1,a,b);k.up.set(0,-1,0);k.lookAt(new THREE.Vector3(0,0,1));this.add(k);var l=new THREE.PerspectiveCamera(90,1,a,b);l.up.set(0,-1,0);l.lookAt(new THREE.Vector3(0,0,-1));this.add(l);this.renderTarget=new THREE.WebGLRenderTargetCube(c,c,{format:THREE.RGBFormat,magFilter:THREE.LinearFilter,minFilter:THREE.LinearFilter});this.updateCubeMap=function(a,b){var c=this.renderTarget,q=c.generateMipmaps;c.generateMipmaps=!1;c.activeCubeFace=0;a.render(b,d,c);c.activeCubeFace=
1;a.render(b,f,c);c.activeCubeFace=2;a.render(b,g,c);c.activeCubeFace=3;a.render(b,h,c);c.activeCubeFace=4;a.render(b,k,c);c.generateMipmaps=q;c.activeCubeFace=5;a.render(b,l,c)}};THREE.CubeCamera.prototype=Object.create(THREE.Object3D.prototype);THREE.OrthographicCamera=function(a,b,c,d,f,g){THREE.Camera.call(this);this.type="OrthographicCamera";this.zoom=1;this.left=a;this.right=b;this.top=c;this.bottom=d;this.near=void 0!==f?f:0.1;this.far=void 0!==g?g:2E3;this.updateProjectionMatrix()};
THREE.OrthographicCamera.prototype=Object.create(THREE.Camera.prototype);THREE.OrthographicCamera.prototype.updateProjectionMatrix=function(){var a=(this.right-this.left)/(2*this.zoom),b=(this.top-this.bottom)/(2*this.zoom),c=(this.right+this.left)/2,d=(this.top+this.bottom)/2;this.projectionMatrix.makeOrthographic(c-a,c+a,d+b,d-b,this.near,this.far)};
THREE.OrthographicCamera.prototype.clone=function(){var a=new THREE.OrthographicCamera;THREE.Camera.prototype.clone.call(this,a);a.zoom=this.zoom;a.left=this.left;a.right=this.right;a.top=this.top;a.bottom=this.bottom;a.near=this.near;a.far=this.far;a.projectionMatrix.copy(this.projectionMatrix);return a};
THREE.PerspectiveCamera=function(a,b,c,d){THREE.Camera.call(this);this.type="PerspectiveCamera";this.zoom=1;this.fov=void 0!==a?a:50;this.aspect=void 0!==b?b:1;this.near=void 0!==c?c:0.1;this.far=void 0!==d?d:2E3;this.updateProjectionMatrix()};THREE.PerspectiveCamera.prototype=Object.create(THREE.Camera.prototype);THREE.PerspectiveCamera.prototype.setLens=function(a,b){void 0===b&&(b=24);this.fov=2*THREE.Math.radToDeg(Math.atan(b/(2*a)));this.updateProjectionMatrix()};
THREE.PerspectiveCamera.prototype.setViewOffset=function(a,b,c,d,f,g){this.fullWidth=a;this.fullHeight=b;this.x=c;this.y=d;this.width=f;this.height=g;this.updateProjectionMatrix()};
THREE.PerspectiveCamera.prototype.updateProjectionMatrix=function(){var a=THREE.Math.radToDeg(2*Math.atan(Math.tan(0.5*THREE.Math.degToRad(this.fov))/this.zoom));if(this.fullWidth){var b=this.fullWidth/this.fullHeight,a=Math.tan(THREE.Math.degToRad(0.5*a))*this.near,c=-a,d=b*c,b=Math.abs(b*a-d),c=Math.abs(a-c);this.projectionMatrix.makeFrustum(d+this.x*b/this.fullWidth,d+(this.x+this.width)*b/this.fullWidth,a-(this.y+this.height)*c/this.fullHeight,a-this.y*c/this.fullHeight,this.near,this.far)}else this.projectionMatrix.makePerspective(a,
this.aspect,this.near,this.far)};THREE.PerspectiveCamera.prototype.clone=function(){var a=new THREE.PerspectiveCamera;THREE.Camera.prototype.clone.call(this,a);a.zoom=this.zoom;a.fov=this.fov;a.aspect=this.aspect;a.near=this.near;a.far=this.far;a.projectionMatrix.copy(this.projectionMatrix);return a};THREE.Light=function(a){THREE.Object3D.call(this);this.type="Light";this.color=new THREE.Color(a)};THREE.Light.prototype=Object.create(THREE.Object3D.prototype);
THREE.Light.prototype.clone=function(a){void 0===a&&(a=new THREE.Light);THREE.Object3D.prototype.clone.call(this,a);a.color.copy(this.color);return a};THREE.AmbientLight=function(a){THREE.Light.call(this,a);this.type="AmbientLight"};THREE.AmbientLight.prototype=Object.create(THREE.Light.prototype);THREE.AmbientLight.prototype.clone=function(){var a=new THREE.AmbientLight;THREE.Light.prototype.clone.call(this,a);return a};
THREE.AreaLight=function(a,b){THREE.Light.call(this,a);this.type="AreaLight";this.normal=new THREE.Vector3(0,-1,0);this.right=new THREE.Vector3(1,0,0);this.intensity=void 0!==b?b:1;this.height=this.width=1;this.constantAttenuation=1.5;this.linearAttenuation=0.5;this.quadraticAttenuation=0.1};THREE.AreaLight.prototype=Object.create(THREE.Light.prototype);
THREE.DirectionalLight=function(a,b){THREE.Light.call(this,a);this.type="DirectionalLight";this.position.set(0,1,0);this.target=new THREE.Object3D;this.intensity=void 0!==b?b:1;this.onlyShadow=this.castShadow=!1;this.shadowCameraNear=50;this.shadowCameraFar=5E3;this.shadowCameraLeft=-500;this.shadowCameraTop=this.shadowCameraRight=500;this.shadowCameraBottom=-500;this.shadowCameraVisible=!1;this.shadowBias=0;this.shadowDarkness=0.5;this.shadowMapHeight=this.shadowMapWidth=512;this.shadowCascade=!1;
this.shadowCascadeOffset=new THREE.Vector3(0,0,-1E3);this.shadowCascadeCount=2;this.shadowCascadeBias=[0,0,0];this.shadowCascadeWidth=[512,512,512];this.shadowCascadeHeight=[512,512,512];this.shadowCascadeNearZ=[-1,0.99,0.998];this.shadowCascadeFarZ=[0.99,0.998,1];this.shadowCascadeArray=[];this.shadowMatrix=this.shadowCamera=this.shadowMapSize=this.shadowMap=null};THREE.DirectionalLight.prototype=Object.create(THREE.Light.prototype);
THREE.DirectionalLight.prototype.clone=function(){var a=new THREE.DirectionalLight;THREE.Light.prototype.clone.call(this,a);a.target=this.target.clone();a.intensity=this.intensity;a.castShadow=this.castShadow;a.onlyShadow=this.onlyShadow;a.shadowCameraNear=this.shadowCameraNear;a.shadowCameraFar=this.shadowCameraFar;a.shadowCameraLeft=this.shadowCameraLeft;a.shadowCameraRight=this.shadowCameraRight;a.shadowCameraTop=this.shadowCameraTop;a.shadowCameraBottom=this.shadowCameraBottom;a.shadowCameraVisible=
this.shadowCameraVisible;a.shadowBias=this.shadowBias;a.shadowDarkness=this.shadowDarkness;a.shadowMapWidth=this.shadowMapWidth;a.shadowMapHeight=this.shadowMapHeight;a.shadowCascade=this.shadowCascade;a.shadowCascadeOffset.copy(this.shadowCascadeOffset);a.shadowCascadeCount=this.shadowCascadeCount;a.shadowCascadeBias=this.shadowCascadeBias.slice(0);a.shadowCascadeWidth=this.shadowCascadeWidth.slice(0);a.shadowCascadeHeight=this.shadowCascadeHeight.slice(0);a.shadowCascadeNearZ=this.shadowCascadeNearZ.slice(0);
a.shadowCascadeFarZ=this.shadowCascadeFarZ.slice(0);return a};THREE.HemisphereLight=function(a,b,c){THREE.Light.call(this,a);this.type="HemisphereLight";this.position.set(0,100,0);this.groundColor=new THREE.Color(b);this.intensity=void 0!==c?c:1};THREE.HemisphereLight.prototype=Object.create(THREE.Light.prototype);
THREE.HemisphereLight.prototype.clone=function(){var a=new THREE.HemisphereLight;THREE.Light.prototype.clone.call(this,a);a.groundColor.copy(this.groundColor);a.intensity=this.intensity;return a};THREE.PointLight=function(a,b,c){THREE.Light.call(this,a);this.type="PointLight";this.intensity=void 0!==b?b:1;this.distance=void 0!==c?c:0};THREE.PointLight.prototype=Object.create(THREE.Light.prototype);
THREE.PointLight.prototype.clone=function(){var a=new THREE.PointLight;THREE.Light.prototype.clone.call(this,a);a.intensity=this.intensity;a.distance=this.distance;return a};
THREE.SpotLight=function(a,b,c,d,f){THREE.Light.call(this,a);this.type="SpotLight";this.position.set(0,1,0);this.target=new THREE.Object3D;this.intensity=void 0!==b?b:1;this.distance=void 0!==c?c:0;this.angle=void 0!==d?d:Math.PI/3;this.exponent=void 0!==f?f:10;this.onlyShadow=this.castShadow=!1;this.shadowCameraNear=50;this.shadowCameraFar=5E3;this.shadowCameraFov=50;this.shadowCameraVisible=!1;this.shadowBias=0;this.shadowDarkness=0.5;this.shadowMapHeight=this.shadowMapWidth=512;this.shadowMatrix=
this.shadowCamera=this.shadowMapSize=this.shadowMap=null};THREE.SpotLight.prototype=Object.create(THREE.Light.prototype);
THREE.SpotLight.prototype.clone=function(){var a=new THREE.SpotLight;THREE.Light.prototype.clone.call(this,a);a.target=this.target.clone();a.intensity=this.intensity;a.distance=this.distance;a.angle=this.angle;a.exponent=this.exponent;a.castShadow=this.castShadow;a.onlyShadow=this.onlyShadow;a.shadowCameraNear=this.shadowCameraNear;a.shadowCameraFar=this.shadowCameraFar;a.shadowCameraFov=this.shadowCameraFov;a.shadowCameraVisible=this.shadowCameraVisible;a.shadowBias=this.shadowBias;a.shadowDarkness=
this.shadowDarkness;a.shadowMapWidth=this.shadowMapWidth;a.shadowMapHeight=this.shadowMapHeight;return a};THREE.Cache=function(){this.files={}};THREE.Cache.prototype={constructor:THREE.Cache,add:function(a,b){this.files[a]=b},get:function(a){return this.files[a]},remove:function(a){delete this.files[a]},clear:function(){this.files={}}};
THREE.Loader=function(a){this.statusDomElement=(this.showStatus=a)?THREE.Loader.prototype.addStatusElement():null;this.imageLoader=new THREE.ImageLoader;this.onLoadStart=function(){};this.onLoadProgress=function(){};this.onLoadComplete=function(){}};
THREE.Loader.prototype={constructor:THREE.Loader,crossOrigin:void 0,addStatusElement:function(){var a=document.createElement("div");a.style.position="absolute";a.style.right="0px";a.style.top="0px";a.style.fontSize="0.8em";a.style.textAlign="left";a.style.background="rgba(0,0,0,0.25)";a.style.color="#fff";a.style.width="120px";a.style.padding="0.5em 0.5em 0.5em 0.5em";a.style.zIndex=1E3;a.innerHTML="Loading ...";return a},updateProgress:function(a){var b="Loaded ",b=a.total?b+((100*a.loaded/a.total).toFixed(0)+
"%"):b+((a.loaded/1024).toFixed(2)+" KB");this.statusDomElement.innerHTML=b},extractUrlBase:function(a){a=a.split("/");if(1===a.length)return"./";a.pop();return a.join("/")+"/"},initMaterials:function(a,b){for(var c=[],d=0;d<a.length;++d)c[d]=this.createMaterial(a[d],b);return c},needsTangents:function(a){for(var b=0,c=a.length;b<c;b++)if(a[b]instanceof THREE.ShaderMaterial)return!0;return!1},createMaterial:function(a,b){function c(a){a=Math.log(a)/Math.LN2;return Math.pow(2,Math.round(a))}function d(a,
d,f,h,k,l,s){var w=b+f,z,D=THREE.Loader.Handlers.get(w);null!==D?z=D.load(w):(z=new THREE.Texture,D=g.imageLoader,D.crossOrigin=g.crossOrigin,D.load(w,function(a){if(!1===THREE.Math.isPowerOfTwo(a.width)||!1===THREE.Math.isPowerOfTwo(a.height)){var b=c(a.width),d=c(a.height),f=document.createElement("canvas");f.width=b;f.height=d;f.getContext("2d").drawImage(a,0,0,b,d);z.image=f}else z.image=a;z.needsUpdate=!0}));z.sourceFile=f;h&&(z.repeat.set(h[0],h[1]),1!==h[0]&&(z.wrapS=THREE.RepeatWrapping),
1!==h[1]&&(z.wrapT=THREE.RepeatWrapping));k&&z.offset.set(k[0],k[1]);l&&(f={repeat:THREE.RepeatWrapping,mirror:THREE.MirroredRepeatWrapping},void 0!==f[l[0]]&&(z.wrapS=f[l[0]]),void 0!==f[l[1]]&&(z.wrapT=f[l[1]]));s&&(z.anisotropy=s);a[d]=z}function f(a){return(255*a[0]<<16)+(255*a[1]<<8)+255*a[2]}var g=this,h="MeshLambertMaterial",k={color:15658734,opacity:1,map:null,lightMap:null,normalMap:null,bumpMap:null,wireframe:!1};if(a.shading){var l=a.shading.toLowerCase();"phong"===l?h="MeshPhongMaterial":
"basic"===l&&(h="MeshBasicMaterial")}void 0!==a.blending&&void 0!==THREE[a.blending]&&(k.blending=THREE[a.blending]);if(void 0!==a.transparent||1>a.opacity)k.transparent=a.transparent;void 0!==a.depthTest&&(k.depthTest=a.depthTest);void 0!==a.depthWrite&&(k.depthWrite=a.depthWrite);void 0!==a.visible&&(k.visible=a.visible);void 0!==a.flipSided&&(k.side=THREE.BackSide);void 0!==a.doubleSided&&(k.side=THREE.DoubleSide);void 0!==a.wireframe&&(k.wireframe=a.wireframe);void 0!==a.vertexColors&&("face"===
a.vertexColors?k.vertexColors=THREE.FaceColors:a.vertexColors&&(k.vertexColors=THREE.VertexColors));a.colorDiffuse?k.color=f(a.colorDiffuse):a.DbgColor&&(k.color=a.DbgColor);a.colorSpecular&&(k.specular=f(a.colorSpecular));a.colorAmbient&&(k.ambient=f(a.colorAmbient));a.colorEmissive&&(k.emissive=f(a.colorEmissive));a.transparency&&(k.opacity=a.transparency);a.specularCoef&&(k.shininess=a.specularCoef);a.mapDiffuse&&b&&d(k,"map",a.mapDiffuse,a.mapDiffuseRepeat,a.mapDiffuseOffset,a.mapDiffuseWrap,
a.mapDiffuseAnisotropy);a.mapLight&&b&&d(k,"lightMap",a.mapLight,a.mapLightRepeat,a.mapLightOffset,a.mapLightWrap,a.mapLightAnisotropy);a.mapBump&&b&&d(k,"bumpMap",a.mapBump,a.mapBumpRepeat,a.mapBumpOffset,a.mapBumpWrap,a.mapBumpAnisotropy);a.mapNormal&&b&&d(k,"normalMap",a.mapNormal,a.mapNormalRepeat,a.mapNormalOffset,a.mapNormalWrap,a.mapNormalAnisotropy);a.mapSpecular&&b&&d(k,"specularMap",a.mapSpecular,a.mapSpecularRepeat,a.mapSpecularOffset,a.mapSpecularWrap,a.mapSpecularAnisotropy);a.mapAlpha&&
b&&d(k,"alphaMap",a.mapAlpha,a.mapAlphaRepeat,a.mapAlphaOffset,a.mapAlphaWrap,a.mapAlphaAnisotropy);a.mapBumpScale&&(k.bumpScale=a.mapBumpScale);a.mapNormal?(h=THREE.ShaderLib.normalmap,l=THREE.UniformsUtils.clone(h.uniforms),l.tNormal.value=k.normalMap,a.mapNormalFactor&&l.uNormalScale.value.set(a.mapNormalFactor,a.mapNormalFactor),k.map&&(l.tDiffuse.value=k.map,l.enableDiffuse.value=!0),k.specularMap&&(l.tSpecular.value=k.specularMap,l.enableSpecular.value=!0),k.lightMap&&(l.tAO.value=k.lightMap,
l.enableAO.value=!0),l.diffuse.value.setHex(k.color),l.specular.value.setHex(k.specular),l.ambient.value.setHex(k.ambient),l.shininess.value=k.shininess,void 0!==k.opacity&&(l.opacity.value=k.opacity),h=new THREE.ShaderMaterial({fragmentShader:h.fragmentShader,vertexShader:h.vertexShader,uniforms:l,lights:!0,fog:!0}),k.transparent&&(h.transparent=!0)):h=new THREE[h](k);void 0!==a.DbgName&&(h.name=a.DbgName);return h}};
THREE.Loader.Handlers={handlers:[],add:function(a,b){this.handlers.push(a,b)},get:function(a){for(var b=0,c=this.handlers.length;b<c;b+=2){var d=this.handlers[b+1];if(this.handlers[b].test(a))return d}return null}};THREE.XHRLoader=function(a){this.cache=new THREE.Cache;this.manager=void 0!==a?a:THREE.DefaultLoadingManager};
THREE.XHRLoader.prototype={constructor:THREE.XHRLoader,load:function(a,b,c,d){var f=this,g=f.cache.get(a);void 0!==g?b&&b(g):(g=new XMLHttpRequest,g.open("GET",a,!0),g.addEventListener("load",function(c){f.cache.add(a,this.response);b&&b(this.response);f.manager.itemEnd(a)},!1),void 0!==c&&g.addEventListener("progress",function(a){c(a)},!1),void 0!==d&&g.addEventListener("error",function(a){d(a)},!1),void 0!==this.crossOrigin&&(g.crossOrigin=this.crossOrigin),void 0!==this.responseType&&(g.responseType=
this.responseType),g.send(null),f.manager.itemStart(a))},setResponseType:function(a){this.responseType=a},setCrossOrigin:function(a){this.crossOrigin=a}};THREE.ImageLoader=function(a){this.cache=new THREE.Cache;this.manager=void 0!==a?a:THREE.DefaultLoadingManager};
THREE.ImageLoader.prototype={constructor:THREE.ImageLoader,load:function(a,b,c,d){var f=this,g=f.cache.get(a);if(void 0!==g)b(g);else return g=document.createElement("img"),void 0!==b&&g.addEventListener("load",function(c){f.cache.add(a,this);b(this);f.manager.itemEnd(a)},!1),void 0!==c&&g.addEventListener("progress",function(a){c(a)},!1),void 0!==d&&g.addEventListener("error",function(a){d(a)},!1),void 0!==this.crossOrigin&&(g.crossOrigin=this.crossOrigin),g.src=a,f.manager.itemStart(a),g},setCrossOrigin:function(a){this.crossOrigin=
a}};THREE.LoadingManager=function(a,b,c){var d=this,f=0,g=0;this.onLoad=a;this.onProgress=b;this.onError=c;this.itemStart=function(a){g++};this.itemEnd=function(a){f++;if(void 0!==d.onProgress)d.onProgress(a,f,g);if(f===g&&void 0!==d.onLoad)d.onLoad()}};THREE.DefaultLoadingManager=new THREE.LoadingManager;THREE.TextureLoader=function(a){this.manager=void 0!==a?a:THREE.DefaultLoadingManager};
THREE.TextureLoader.prototype={constructor:THREE.TextureLoader,load:function(a,b,c,d){var f=new THREE.ImageLoader(this.manager);f.setCrossOrigin(this.crossOrigin);f.load(a,function(a){a=new THREE.Texture(a);a.needsUpdate=!0;void 0!==b&&b(a)},c,d)},setCrossOrigin:function(a){this.crossOrigin=a}};THREE.CompressedTextureLoader=function(){this._parser=null};
THREE.CompressedTextureLoader.prototype={constructor:THREE.CompressedTextureLoader,load:function(a,b,c){var d=this,f=[],g=new THREE.CompressedTexture;g.image=f;var h=new THREE.XHRLoader;h.setResponseType("arraybuffer");if(a instanceof Array){var k=0;c=function(c){h.load(a[c],function(a){a=d._parser(a,!0);f[c]={width:a.width,height:a.height,format:a.format,mipmaps:a.mipmaps};k+=1;6===k&&(1==a.mipmapCount&&(g.minFilter=THREE.LinearFilter),g.format=a.format,g.needsUpdate=!0,b&&b(g))})};for(var l=0,m=
a.length;l<m;++l)c(l)}else h.load(a,function(a){a=d._parser(a,!0);if(a.isCubemap)for(var c=a.mipmaps.length/a.mipmapCount,h=0;h<c;h++){f[h]={mipmaps:[]};for(var k=0;k<a.mipmapCount;k++)f[h].mipmaps.push(a.mipmaps[h*a.mipmapCount+k]),f[h].format=a.format,f[h].width=a.width,f[h].height=a.height}else g.image.width=a.width,g.image.height=a.height,g.mipmaps=a.mipmaps;1===a.mipmapCount&&(g.minFilter=THREE.LinearFilter);g.format=a.format;g.needsUpdate=!0;b&&b(g)});return g}};
THREE.Material=function(){Object.defineProperty(this,"id",{value:THREE.MaterialIdCount++});this.uuid=THREE.Math.generateUUID();this.name="";this.type="Material";this.side=THREE.FrontSide;this.opacity=1;this.transparent=!1;this.blending=THREE.NormalBlending;this.blendSrc=THREE.SrcAlphaFactor;this.blendDst=THREE.OneMinusSrcAlphaFactor;this.blendEquation=THREE.AddEquation;this.depthWrite=this.depthTest=!0;this.polygonOffset=!1;this.overdraw=this.alphaTest=this.polygonOffsetUnits=this.polygonOffsetFactor=
0;this.needsUpdate=this.visible=!0};
THREE.Material.prototype={constructor:THREE.Material,setValues:function(a){if(void 0!==a)for(var b in a){var c=a[b];if(void 0===c)console.warn("THREE.Material: '"+b+"' parameter is undefined.");else if(b in this){var d=this[b];d instanceof THREE.Color?d.set(c):d instanceof THREE.Vector3&&c instanceof THREE.Vector3?d.copy(c):this[b]="overdraw"==b?Number(c):c}}},toJSON:function(){var a={metadata:{version:4.2,type:"material",generator:"MaterialExporter"},uuid:this.uuid,type:this.type};""!==this.name&&
(a.name=this.name);this instanceof THREE.MeshBasicMaterial?(a.color=this.color.getHex(),this.vertexColors!==THREE.NoColors&&(a.vertexColors=this.vertexColors),this.blending!==THREE.NormalBlending&&(a.blending=this.blending),this.side!==THREE.FrontSide&&(a.side=this.side)):this instanceof THREE.MeshLambertMaterial?(a.color=this.color.getHex(),a.ambient=this.ambient.getHex(),a.emissive=this.emissive.getHex(),this.vertexColors!==THREE.NoColors&&(a.vertexColors=this.vertexColors),this.blending!==THREE.NormalBlending&&
(a.blending=this.blending),this.side!==THREE.FrontSide&&(a.side=this.side)):this instanceof THREE.MeshPhongMaterial?(a.color=this.color.getHex(),a.ambient=this.ambient.getHex(),a.emissive=this.emissive.getHex(),a.specular=this.specular.getHex(),a.shininess=this.shininess,this.vertexColors!==THREE.NoColors&&(a.vertexColors=this.vertexColors),this.blending!==THREE.NormalBlending&&(a.blending=this.blending),this.side!==THREE.FrontSide&&(a.side=this.side)):this instanceof THREE.MeshNormalMaterial?(this.shading!==
THREE.FlatShading&&(a.shading=this.shading),this.blending!==THREE.NormalBlending&&(a.blending=this.blending),this.side!==THREE.FrontSide&&(a.side=this.side)):this instanceof THREE.MeshDepthMaterial?(this.blending!==THREE.NormalBlending&&(a.blending=this.blending),this.side!==THREE.FrontSide&&(a.side=this.side)):this instanceof THREE.ShaderMaterial?(a.uniforms=this.uniforms,a.vertexShader=this.vertexShader,a.fragmentShader=this.fragmentShader):this instanceof THREE.SpriteMaterial&&(a.color=this.color.getHex());
1>this.opacity&&(a.opacity=this.opacity);!1!==this.transparent&&(a.transparent=this.transparent);!1!==this.wireframe&&(a.wireframe=this.wireframe);return a},clone:function(a){void 0===a&&(a=new THREE.Material);a.name=this.name;a.side=this.side;a.opacity=this.opacity;a.transparent=this.transparent;a.blending=this.blending;a.blendSrc=this.blendSrc;a.blendDst=this.blendDst;a.blendEquation=this.blendEquation;a.depthTest=this.depthTest;a.depthWrite=this.depthWrite;a.polygonOffset=this.polygonOffset;a.polygonOffsetFactor=
this.polygonOffsetFactor;a.polygonOffsetUnits=this.polygonOffsetUnits;a.alphaTest=this.alphaTest;a.overdraw=this.overdraw;a.visible=this.visible;return a},dispose:function(){this.dispatchEvent({type:"dispose"})}};THREE.EventDispatcher.prototype.apply(THREE.Material.prototype);THREE.MaterialIdCount=0;
THREE.LineBasicMaterial=function(a){THREE.Material.call(this);this.type="LineBasicMaterial";this.color=new THREE.Color(16777215);this.linewidth=1;this.linejoin=this.linecap="round";this.vertexColors=THREE.NoColors;this.fog=!0;this.setValues(a)};THREE.LineBasicMaterial.prototype=Object.create(THREE.Material.prototype);
THREE.LineBasicMaterial.prototype.clone=function(){var a=new THREE.LineBasicMaterial;THREE.Material.prototype.clone.call(this,a);a.color.copy(this.color);a.linewidth=this.linewidth;a.linecap=this.linecap;a.linejoin=this.linejoin;a.vertexColors=this.vertexColors;a.fog=this.fog;return a};
THREE.LineDashedMaterial=function(a){THREE.Material.call(this);this.type="LineDashedMaterial";this.color=new THREE.Color(16777215);this.scale=this.linewidth=1;this.dashSize=3;this.gapSize=1;this.vertexColors=!1;this.fog=!0;this.setValues(a)};THREE.LineDashedMaterial.prototype=Object.create(THREE.Material.prototype);
THREE.LineDashedMaterial.prototype.clone=function(){var a=new THREE.LineDashedMaterial;THREE.Material.prototype.clone.call(this,a);a.color.copy(this.color);a.linewidth=this.linewidth;a.scale=this.scale;a.dashSize=this.dashSize;a.gapSize=this.gapSize;a.vertexColors=this.vertexColors;a.fog=this.fog;return a};
THREE.MeshBasicMaterial=function(a){THREE.Material.call(this);this.type="MeshBasicMaterial";this.color=new THREE.Color(16777215);this.envMap=this.alphaMap=this.specularMap=this.lightMap=this.map=null;this.combine=THREE.MultiplyOperation;this.reflectivity=1;this.refractionRatio=0.98;this.fog=!0;this.shading=THREE.SmoothShading;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.vertexColors=THREE.NoColors;this.morphTargets=this.skinning=!1;this.setValues(a)};
THREE.MeshBasicMaterial.prototype=Object.create(THREE.Material.prototype);
THREE.MeshBasicMaterial.prototype.clone=function(){var a=new THREE.MeshBasicMaterial;THREE.Material.prototype.clone.call(this,a);a.color.copy(this.color);a.map=this.map;a.lightMap=this.lightMap;a.specularMap=this.specularMap;a.alphaMap=this.alphaMap;a.envMap=this.envMap;a.combine=this.combine;a.reflectivity=this.reflectivity;a.refractionRatio=this.refractionRatio;a.fog=this.fog;a.shading=this.shading;a.wireframe=this.wireframe;a.wireframeLinewidth=this.wireframeLinewidth;a.wireframeLinecap=this.wireframeLinecap;
a.wireframeLinejoin=this.wireframeLinejoin;a.vertexColors=this.vertexColors;a.skinning=this.skinning;a.morphTargets=this.morphTargets;return a};
THREE.MeshLambertMaterial=function(a){THREE.Material.call(this);this.type="MeshLambertMaterial";this.color=new THREE.Color(16777215);this.ambient=new THREE.Color(16777215);this.emissive=new THREE.Color(0);this.wrapAround=!1;this.wrapRGB=new THREE.Vector3(1,1,1);this.envMap=this.alphaMap=this.specularMap=this.lightMap=this.map=null;this.combine=THREE.MultiplyOperation;this.reflectivity=1;this.refractionRatio=0.98;this.fog=!0;this.shading=THREE.SmoothShading;this.wireframe=!1;this.wireframeLinewidth=
1;this.wireframeLinejoin=this.wireframeLinecap="round";this.vertexColors=THREE.NoColors;this.morphNormals=this.morphTargets=this.skinning=!1;this.setValues(a)};THREE.MeshLambertMaterial.prototype=Object.create(THREE.Material.prototype);
THREE.MeshLambertMaterial.prototype.clone=function(){var a=new THREE.MeshLambertMaterial;THREE.Material.prototype.clone.call(this,a);a.color.copy(this.color);a.ambient.copy(this.ambient);a.emissive.copy(this.emissive);a.wrapAround=this.wrapAround;a.wrapRGB.copy(this.wrapRGB);a.map=this.map;a.lightMap=this.lightMap;a.specularMap=this.specularMap;a.alphaMap=this.alphaMap;a.envMap=this.envMap;a.combine=this.combine;a.reflectivity=this.reflectivity;a.refractionRatio=this.refractionRatio;a.fog=this.fog;
a.shading=this.shading;a.wireframe=this.wireframe;a.wireframeLinewidth=this.wireframeLinewidth;a.wireframeLinecap=this.wireframeLinecap;a.wireframeLinejoin=this.wireframeLinejoin;a.vertexColors=this.vertexColors;a.skinning=this.skinning;a.morphTargets=this.morphTargets;a.morphNormals=this.morphNormals;return a};
THREE.MeshPhongMaterial=function(a){THREE.Material.call(this);this.type="MeshPhongMaterial";this.color=new THREE.Color(16777215);this.ambient=new THREE.Color(16777215);this.emissive=new THREE.Color(0);this.specular=new THREE.Color(1118481);this.shininess=30;this.wrapAround=this.metal=!1;this.wrapRGB=new THREE.Vector3(1,1,1);this.bumpMap=this.lightMap=this.map=null;this.bumpScale=1;this.normalMap=null;this.normalScale=new THREE.Vector2(1,1);this.envMap=this.alphaMap=this.specularMap=null;this.combine=
THREE.MultiplyOperation;this.reflectivity=1;this.refractionRatio=0.98;this.fog=!0;this.shading=THREE.SmoothShading;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.vertexColors=THREE.NoColors;this.morphNormals=this.morphTargets=this.skinning=!1;this.setValues(a)};THREE.MeshPhongMaterial.prototype=Object.create(THREE.Material.prototype);
THREE.MeshPhongMaterial.prototype.clone=function(){var a=new THREE.MeshPhongMaterial;THREE.Material.prototype.clone.call(this,a);a.color.copy(this.color);a.ambient.copy(this.ambient);a.emissive.copy(this.emissive);a.specular.copy(this.specular);a.shininess=this.shininess;a.metal=this.metal;a.wrapAround=this.wrapAround;a.wrapRGB.copy(this.wrapRGB);a.map=this.map;a.lightMap=this.lightMap;a.bumpMap=this.bumpMap;a.bumpScale=this.bumpScale;a.normalMap=this.normalMap;a.normalScale.copy(this.normalScale);
a.specularMap=this.specularMap;a.alphaMap=this.alphaMap;a.envMap=this.envMap;a.combine=this.combine;a.reflectivity=this.reflectivity;a.refractionRatio=this.refractionRatio;a.fog=this.fog;a.shading=this.shading;a.wireframe=this.wireframe;a.wireframeLinewidth=this.wireframeLinewidth;a.wireframeLinecap=this.wireframeLinecap;a.wireframeLinejoin=this.wireframeLinejoin;a.vertexColors=this.vertexColors;a.skinning=this.skinning;a.morphTargets=this.morphTargets;a.morphNormals=this.morphNormals;return a};
THREE.MeshDepthMaterial=function(a){THREE.Material.call(this);this.type="MeshDepthMaterial";this.wireframe=this.morphTargets=!1;this.wireframeLinewidth=1;this.setValues(a)};THREE.MeshDepthMaterial.prototype=Object.create(THREE.Material.prototype);THREE.MeshDepthMaterial.prototype.clone=function(){var a=new THREE.MeshDepthMaterial;THREE.Material.prototype.clone.call(this,a);a.wireframe=this.wireframe;a.wireframeLinewidth=this.wireframeLinewidth;return a};
THREE.MeshNormalMaterial=function(a){THREE.Material.call(this,a);this.type="MeshNormalMaterial";this.shading=THREE.FlatShading;this.wireframe=!1;this.wireframeLinewidth=1;this.morphTargets=!1;this.setValues(a)};THREE.MeshNormalMaterial.prototype=Object.create(THREE.Material.prototype);
THREE.MeshNormalMaterial.prototype.clone=function(){var a=new THREE.MeshNormalMaterial;THREE.Material.prototype.clone.call(this,a);a.shading=this.shading;a.wireframe=this.wireframe;a.wireframeLinewidth=this.wireframeLinewidth;return a};THREE.MeshFaceMaterial=function(a){this.uuid=THREE.Math.generateUUID();this.type="MeshFaceMaterial";this.materials=a instanceof Array?a:[]};
THREE.MeshFaceMaterial.prototype={constructor:THREE.MeshFaceMaterial,toJSON:function(){for(var a={metadata:{version:4.2,type:"material",generator:"MaterialExporter"},uuid:this.uuid,type:this.type,materials:[]},b=0,c=this.materials.length;b<c;b++)a.materials.push(this.materials[b].toJSON());return a},clone:function(){for(var a=new THREE.MeshFaceMaterial,b=0;b<this.materials.length;b++)a.materials.push(this.materials[b].clone());return a}};
THREE.ShaderMaterial=function(a){THREE.Material.call(this);this.type="ShaderMaterial";this.defines={};this.uniforms={};this.attributes=null;this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}";this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}";this.shading=THREE.SmoothShading;this.linewidth=1;this.wireframe=!1;this.wireframeLinewidth=1;this.lights=this.fog=!1;this.vertexColors=THREE.NoColors;this.morphNormals=
this.morphTargets=this.skinning=!1;this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]};this.index0AttributeName=void 0;this.setValues(a)};THREE.ShaderMaterial.prototype=Object.create(THREE.Material.prototype);
THREE.ShaderMaterial.prototype.clone=function(){var a=new THREE.ShaderMaterial;THREE.Material.prototype.clone.call(this,a);a.fragmentShader=this.fragmentShader;a.vertexShader=this.vertexShader;a.uniforms=THREE.UniformsUtils.clone(this.uniforms);a.attributes=this.attributes;a.defines=this.defines;a.shading=this.shading;a.wireframe=this.wireframe;a.wireframeLinewidth=this.wireframeLinewidth;a.fog=this.fog;a.lights=this.lights;a.vertexColors=this.vertexColors;a.skinning=this.skinning;a.morphTargets=
this.morphTargets;a.morphNormals=this.morphNormals;return a};THREE.RawShaderMaterial=function(a){THREE.ShaderMaterial.call(this,a);this.type="RawShaderMaterial"};THREE.RawShaderMaterial.prototype=Object.create(THREE.ShaderMaterial.prototype);THREE.RawShaderMaterial.prototype.clone=function(){var a=new THREE.RawShaderMaterial;THREE.ShaderMaterial.prototype.clone.call(this,a);return a};
THREE.Texture=function(a,b,c,d,f,g,h,k,l){Object.defineProperty(this,"id",{value:THREE.TextureIdCount++});this.uuid=THREE.Math.generateUUID();this.name="";this.image=void 0!==a?a:THREE.Texture.DEFAULT_IMAGE;this.mipmaps=[];this.mapping=void 0!==b?b:THREE.Texture.DEFAULT_MAPPING;this.wrapS=void 0!==c?c:THREE.ClampToEdgeWrapping;this.wrapT=void 0!==d?d:THREE.ClampToEdgeWrapping;this.magFilter=void 0!==f?f:THREE.LinearFilter;this.minFilter=void 0!==g?g:THREE.LinearMipMapLinearFilter;this.anisotropy=
void 0!==l?l:1;this.format=void 0!==h?h:THREE.RGBAFormat;this.type=void 0!==k?k:THREE.UnsignedByteType;this.offset=new THREE.Vector2(0,0);this.repeat=new THREE.Vector2(1,1);this.generateMipmaps=!0;this.premultiplyAlpha=!1;this.flipY=!0;this.unpackAlignment=4;this._needsUpdate=!1;this.onUpdate=null};THREE.Texture.DEFAULT_IMAGE=void 0;THREE.Texture.DEFAULT_MAPPING=new THREE.UVMapping;
THREE.Texture.prototype={constructor:THREE.Texture,get needsUpdate(){return this._needsUpdate},set needsUpdate(a){!0===a&&this.update();this._needsUpdate=a},clone:function(a){void 0===a&&(a=new THREE.Texture);a.image=this.image;a.mipmaps=this.mipmaps.slice(0);a.mapping=this.mapping;a.wrapS=this.wrapS;a.wrapT=this.wrapT;a.magFilter=this.magFilter;a.minFilter=this.minFilter;a.anisotropy=this.anisotropy;a.format=this.format;a.type=this.type;a.offset.copy(this.offset);a.repeat.copy(this.repeat);a.generateMipmaps=
this.generateMipmaps;a.premultiplyAlpha=this.premultiplyAlpha;a.flipY=this.flipY;a.unpackAlignment=this.unpackAlignment;return a},update:function(){this.dispatchEvent({type:"update"})},dispose:function(){this.dispatchEvent({type:"dispose"})}};THREE.EventDispatcher.prototype.apply(THREE.Texture.prototype);THREE.TextureIdCount=0;THREE.CubeTexture=function(a,b,c,d,f,g,h,k,l){THREE.Texture.call(this,a,b,c,d,f,g,h,k,l);this.images=a};THREE.CubeTexture.prototype=Object.create(THREE.Texture.prototype);
THREE.CubeTexture.clone=function(a){void 0===a&&(a=new THREE.CubeTexture);THREE.Texture.prototype.clone.call(this,a);a.images=this.images;return a};THREE.CompressedTexture=function(a,b,c,d,f,g,h,k,l,m,p){THREE.Texture.call(this,null,g,h,k,l,m,d,f,p);this.image={width:b,height:c};this.mipmaps=a;this.generateMipmaps=this.flipY=!1};THREE.CompressedTexture.prototype=Object.create(THREE.Texture.prototype);
THREE.CompressedTexture.prototype.clone=function(){var a=new THREE.CompressedTexture;THREE.Texture.prototype.clone.call(this,a);return a};THREE.DataTexture=function(a,b,c,d,f,g,h,k,l,m,p){THREE.Texture.call(this,null,g,h,k,l,m,d,f,p);this.image={data:a,width:b,height:c}};THREE.DataTexture.prototype=Object.create(THREE.Texture.prototype);THREE.DataTexture.prototype.clone=function(){var a=new THREE.DataTexture;THREE.Texture.prototype.clone.call(this,a);return a};
THREE.VideoTexture=function(a,b,c,d,f,g,h,k,l){THREE.Texture.call(this,a,b,c,d,f,g,h,k,l);this.generateMipmaps=!1;var m=this,p=function(){requestAnimationFrame(p);a.readyState===a.HAVE_ENOUGH_DATA&&(m.needsUpdate=!0)};p()};THREE.VideoTexture.prototype=Object.create(THREE.Texture.prototype);THREE.Group=function(){THREE.Object3D.call(this);this.type="Group"};THREE.Group.prototype=Object.create(THREE.Object3D.prototype);
THREE.PointCloud=function(a,b){THREE.Object3D.call(this);this.type="PointCloud";this.geometry=void 0!==a?a:new THREE.Geometry;this.material=void 0!==b?b:new THREE.PointCloudMaterial({color:16777215*Math.random()});this.sortParticles=!1};THREE.PointCloud.prototype=Object.create(THREE.Object3D.prototype);
THREE.PointCloud.prototype.raycast=function(){var a=new THREE.Matrix4,b=new THREE.Ray;return function(c,d){var f=this,g=f.geometry,h=c.params.PointCloud.threshold;a.getInverse(this.matrixWorld);b.copy(c.ray).applyMatrix4(a);if(null===g.boundingBox||!1!==b.isIntersectionBox(g.boundingBox)){var k=h/((this.scale.x+this.scale.y+this.scale.z)/3),l=new THREE.Vector3,h=function(a,g){var h=b.distanceToPoint(a);if(h<k){var l=b.closestPointToPoint(a);l.applyMatrix4(f.matrixWorld);var m=c.ray.origin.distanceTo(l);
d.push({distance:m,distanceToRay:h,point:l.clone(),index:g,face:null,object:f})}};if(g instanceof THREE.BufferGeometry){var m=g.attributes,p=m.position.array;if(void 0!==m.index){var m=m.index.array,n=g.offsets;0===n.length&&(n=[{start:0,count:m.length,index:0}]);for(var q=0,r=n.length;q<r;++q)for(var v=n[q].start,s=n[q].index,g=v,v=v+n[q].count;g<v;g++){var w=s+m[g];l.fromArray(p,3*w);h(l,w)}}else for(m=p.length/3,g=0;g<m;g++)l.set(p[3*g],p[3*g+1],p[3*g+2]),h(l,g)}else for(l=this.geometry.vertices,
g=0;g<l.length;g++)h(l[g],g)}}}();THREE.PointCloud.prototype.clone=function(a){void 0===a&&(a=new THREE.PointCloud(this.geometry,this.material));a.sortParticles=this.sortParticles;THREE.Object3D.prototype.clone.call(this,a);return a};THREE.ParticleSystem=function(a,b){console.warn("THREE.ParticleSystem has been renamed to THREE.PointCloud.");return new THREE.PointCloud(a,b)};
THREE.Line=function(a,b,c){THREE.Object3D.call(this);this.type="Line";this.geometry=void 0!==a?a:new THREE.Geometry;this.material=void 0!==b?b:new THREE.LineBasicMaterial({color:16777215*Math.random()});this.mode=void 0!==c?c:THREE.LineStrip};THREE.LineStrip=0;THREE.LinePieces=1;THREE.Line.prototype=Object.create(THREE.Object3D.prototype);
THREE.Line.prototype.raycast=function(){var a=new THREE.Matrix4,b=new THREE.Ray,c=new THREE.Sphere;return function(d,f){var g=d.linePrecision,g=g*g,h=this.geometry;null===h.boundingSphere&&h.computeBoundingSphere();c.copy(h.boundingSphere);c.applyMatrix4(this.matrixWorld);if(!1!==d.ray.isIntersectionSphere(c)&&(a.getInverse(this.matrixWorld),b.copy(d.ray).applyMatrix4(a),h instanceof THREE.Geometry))for(var h=h.vertices,k=h.length,l=new THREE.Vector3,m=new THREE.Vector3,p=this.mode===THREE.LineStrip?
1:2,n=0;n<k-1;n+=p)if(!(b.distanceSqToSegment(h[n],h[n+1],m,l)>g)){var q=b.origin.distanceTo(m);q<d.near||q>d.far||f.push({distance:q,point:l.clone().applyMatrix4(this.matrixWorld),face:null,faceIndex:null,object:this})}}}();THREE.Line.prototype.clone=function(a){void 0===a&&(a=new THREE.Line(this.geometry,this.material,this.mode));THREE.Object3D.prototype.clone.call(this,a);return a};
THREE.Mesh=function(a,b,c){THREE.Object3D.call(this,c);this.type="Mesh";this.geometry=void 0!==a?a:new THREE.Geometry;this.material=void 0!==b?b:new THREE.MeshBasicMaterial({color:16777215*Math.random()});this.updateMorphTargets()};THREE.Mesh.prototype=Object.create(THREE.Object3D.prototype);
THREE.Mesh.prototype.updateMorphTargets=function(){if(void 0!==this.geometry.morphTargets&&0<this.geometry.morphTargets.length){this.morphTargetBase=-1;this.morphTargetForcedOrder=[];this.morphTargetInfluences=[];this.morphTargetDictionary={};for(var a=0,b=this.geometry.morphTargets.length;a<b;a++)this.morphTargetInfluences.push(0),this.morphTargetDictionary[this.geometry.morphTargets[a].name]=a}};
THREE.Mesh.prototype.getMorphTargetIndexByName=function(a){if(void 0!==this.morphTargetDictionary[a])return this.morphTargetDictionary[a];console.log("THREE.Mesh.getMorphTargetIndexByName: morph target "+a+" does not exist. Returning 0.");return 0};
THREE.Mesh.prototype.raycast=function(){var a=new THREE.Matrix4,b=new THREE.Ray,c=new THREE.Sphere,d=new THREE.Vector3,f=new THREE.Vector3,g=new THREE.Vector3;return function(h,k){var l=this.geometry;null===l.boundingSphere&&l.computeBoundingSphere();c.copy(l.boundingSphere);c.applyMatrix4(this.matrixWorld);if(!1!==h.ray.isIntersectionSphere(c)&&(a.getInverse(this.matrixWorld),b.copy(h.ray).applyMatrix4(a),null===l.boundingBox||!1!==b.isIntersectionBox(l.boundingBox)))if(l instanceof THREE.BufferGeometry){var m=
this.material;if(void 0!==m){var p=l.attributes,n,q,r=h.precision;if(void 0!==p.index){var v=p.index.array,s=l.vb?l.vb:p.position.array,w=l.vb?l.vbstride:3;(l=l.offsets)&&0!==l.length||(l=[{start:0,count:v.length,index:0}]);for(var z=0,D=l.length;z<D;++z)for(var p=l[z].start,A=l[z].index,E=p,N=p+l[z].count;E<N;E+=3){p=A+v[E];n=A+v[E+1];q=A+v[E+2];d.set(s[p*w],s[p*w+1],s[p*w+2]);f.set(s[n*w],s[n*w+1],s[n*w+2]);g.set(s[q*w],s[q*w+1],s[q*w+2]);var H=m.side===THREE.BackSide?b.intersectTriangle(g,f,d,
!0):b.intersectTriangle(d,f,g,m.side!==THREE.DoubleSide);if(null!==H){H.applyMatrix4(this.matrixWorld);var J=h.ray.origin.distanceTo(H);J<r||J<h.near||J>h.far||k.push({distance:J,point:H,face:new THREE.Face3(p,n,q,THREE.Triangle.normal(d,f,g)),faceIndex:null,object:this})}}}else for(s=l.vb?l.vb:p.position.array,w=l.vb?l.vbstride:3,E=0,N=s.length;E<N;E+=3)p=E,n=E+1,q=E+2,d.set(s[p*w],s[p*w+1],s[p*w+2]),f.set(s[n*w],s[n*w+1],s[n*w+2]),g.set(s[q*w],s[q*w+1],s[q*w+2]),H=m.side===THREE.BackSide?b.intersectTriangle(g,
f,d,!0):b.intersectTriangle(d,f,g,m.side!==THREE.DoubleSide),null!==H&&(H.applyMatrix4(this.matrixWorld),J=h.ray.origin.distanceTo(H),J<r||J<h.near||J>h.far||k.push({distance:J,point:H,face:new THREE.Face3(p,n,q,THREE.Triangle.normal(d,f,g)),faceIndex:null,object:this}))}}else if(l instanceof THREE.Geometry)for(v=this.material instanceof THREE.MeshFaceMaterial,s=!0===v?this.material.materials:null,r=h.precision,w=l.vertices,z=0,D=l.faces.length;z<D;z++)if(A=l.faces[z],m=!0===v?s[A.materialIndex]:
this.material,void 0!==m){p=w[A.a];n=w[A.b];q=w[A.c];if(!0===m.morphTargets){H=l.morphTargets;J=this.morphTargetInfluences;d.set(0,0,0);f.set(0,0,0);g.set(0,0,0);E=0;for(N=H.length;E<N;E++){var G=J[E];if(0!==G){var I=H[E].vertices;d.x+=(I[A.a].x-p.x)*G;d.y+=(I[A.a].y-p.y)*G;d.z+=(I[A.a].z-p.z)*G;f.x+=(I[A.b].x-n.x)*G;f.y+=(I[A.b].y-n.y)*G;f.z+=(I[A.b].z-n.z)*G;g.x+=(I[A.c].x-q.x)*G;g.y+=(I[A.c].y-q.y)*G;g.z+=(I[A.c].z-q.z)*G}}d.add(p);f.add(n);g.add(q);p=d;n=f;q=g}H=m.side===THREE.BackSide?b.intersectTriangle(q,
n,p,!0):b.intersectTriangle(p,n,q,m.side!==THREE.DoubleSide);null!==H&&(H.applyMatrix4(this.matrixWorld),J=h.ray.origin.distanceTo(H),J<r||J<h.near||J>h.far||k.push({distance:J,point:H,face:A,faceIndex:z,object:this}))}}}();THREE.Mesh.prototype.clone=function(a,b){void 0===a&&(a=new THREE.Mesh(this.geometry,this.material));THREE.Object3D.prototype.clone.call(this,a,b);return a};THREE.Bone=function(a){THREE.Object3D.call(this);this.skin=a};THREE.Bone.prototype=Object.create(THREE.Object3D.prototype);
THREE.LOD=function(){THREE.Object3D.call(this);this.objects=[]};THREE.LOD.prototype=Object.create(THREE.Object3D.prototype);THREE.LOD.prototype.addLevel=function(a,b){void 0===b&&(b=0);b=Math.abs(b);for(var c=0;c<this.objects.length&&!(b<this.objects[c].distance);c++);this.objects.splice(c,0,{distance:b,object:a});this.add(a)};THREE.LOD.prototype.getObjectForDistance=function(a){for(var b=1,c=this.objects.length;b<c&&!(a<this.objects[b].distance);b++);return this.objects[b-1].object};
THREE.LOD.prototype.raycast=function(){var a=new THREE.Vector3;return function(b,c){a.setFromMatrixPosition(this.matrixWorld);var d=b.ray.origin.distanceTo(a);this.getObjectForDistance(d).raycast(b,c)}}();
THREE.LOD.prototype.update=function(){var a=new THREE.Vector3,b=new THREE.Vector3;return function(c){if(1<this.objects.length){a.setFromMatrixPosition(c.matrixWorld);b.setFromMatrixPosition(this.matrixWorld);c=a.distanceTo(b);this.objects[0].object.visible=!0;for(var d=1,f=this.objects.length;d<f;d++)if(c>=this.objects[d].distance)this.objects[d-1].object.visible=!1,this.objects[d].object.visible=!0;else break;for(;d<f;d++)this.objects[d].object.visible=!1}}}();
THREE.LOD.prototype.clone=function(a){void 0===a&&(a=new THREE.LOD);THREE.Object3D.prototype.clone.call(this,a);for(var b=0,c=this.objects.length;b<c;b++){var d=this.objects[b].object.clone();d.visible=0===b;a.addLevel(d,this.objects[b].distance)}return a};THREE.Scene=function(a){THREE.Object3D.call(this,a);this.children||(this.children=[]);this.type="Scene";this.overrideMaterial=this.fog=null;this.autoUpdate=!0};THREE.Scene.prototype=Object.create(THREE.Object3D.prototype);
THREE.Scene.prototype.clone=function(a){void 0===a&&(a=new THREE.Scene);THREE.Object3D.prototype.clone.call(this,a);null!==this.fog&&(a.fog=this.fog.clone());null!==this.overrideMaterial&&(a.overrideMaterial=this.overrideMaterial.clone());a.autoUpdate=this.autoUpdate;a.matrixAutoUpdate=this.matrixAutoUpdate;return a};THREE.Fog=function(a,b,c){this.name="";this.color=new THREE.Color(a);this.near=void 0!==b?b:1;this.far=void 0!==c?c:1E3};
THREE.Fog.prototype.clone=function(){return new THREE.Fog(this.color.getHex(),this.near,this.far)};THREE.FogExp2=function(a,b){this.name="";this.color=new THREE.Color(a);this.density=void 0!==b?b:2.5E-4};THREE.FogExp2.prototype.clone=function(){return new THREE.FogExp2(this.color.getHex(),this.density)};THREE.ShaderChunk={};THREE.ShaderChunk.alphatest_fragment="#ifdef ALPHATEST\n\n\tif ( gl_FragColor.a < ALPHATEST ) discard;\n\n#endif\n";THREE.ShaderChunk.lights_lambert_vertex="vLightFront = vec3( 0.0 );\n\n#ifdef DOUBLE_SIDED\n\n\tvLightBack = vec3( 0.0 );\n\n#endif\n\ntransformedNormal = normalize( transformedNormal );\n\n#if MAX_DIR_LIGHTS > 0\n\nfor( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\n\n\tvec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );\n\tvec3 dirVector = normalize( lDirection.xyz );\n\n\tfloat dotProduct = dot( transformedNormal, dirVector );\n\tvec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );\n\n\t#ifdef DOUBLE_SIDED\n\n\t\tvec3 directionalLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n\n\t\t#ifdef WRAP_AROUND\n\n\t\t\tvec3 directionalLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n\n\t\t#endif\n\n\t#endif\n\n\t#ifdef WRAP_AROUND\n\n\t\tvec3 directionalLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\n\t\tdirectionalLightWeighting = mix( directionalLightWeighting, directionalLightWeightingHalf, wrapRGB );\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tdirectionalLightWeightingBack = mix( directionalLightWeightingBack, directionalLightWeightingHalfBack, wrapRGB );\n\n\t\t#endif\n\n\t#endif\n\n\tvLightFront += directionalLightColor[ i ] * directionalLightWeighting;\n\n\t#ifdef DOUBLE_SIDED\n\n\t\tvLightBack += directionalLightColor[ i ] * directionalLightWeightingBack;\n\n\t#endif\n\n}\n\n#endif\n\n#if MAX_POINT_LIGHTS > 0\n\n\tfor( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\n\n\t\tvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\n\t\tvec3 lVector = lPosition.xyz - mvPosition.xyz;\n\n\t\tfloat lDistance = 1.0;\n\t\tif ( pointLightDistance[ i ] > 0.0 )\n\t\t\tlDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\n\n\t\tlVector = normalize( lVector );\n\t\tfloat dotProduct = dot( transformedNormal, lVector );\n\n\t\tvec3 pointLightWeighting = vec3( max( dotProduct, 0.0 ) );\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tvec3 pointLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n\n\t\t\t#ifdef WRAP_AROUND\n\n\t\t\t\tvec3 pointLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n\n\t\t\t#endif\n\n\t\t#endif\n\n\t\t#ifdef WRAP_AROUND\n\n\t\t\tvec3 pointLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\n\t\t\tpointLightWeighting = mix( pointLightWeighting, pointLightWeightingHalf, wrapRGB );\n\n\t\t\t#ifdef DOUBLE_SIDED\n\n\t\t\t\tpointLightWeightingBack = mix( pointLightWeightingBack, pointLightWeightingHalfBack, wrapRGB );\n\n\t\t\t#endif\n\n\t\t#endif\n\n\t\tvLightFront += pointLightColor[ i ] * pointLightWeighting * lDistance;\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tvLightBack += pointLightColor[ i ] * pointLightWeightingBack * lDistance;\n\n\t\t#endif\n\n\t}\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n\tfor( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\n\n\t\tvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\n\t\tvec3 lVector = lPosition.xyz - mvPosition.xyz;\n\n\t\tfloat spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - worldPosition.xyz ) );\n\n\t\tif ( spotEffect > spotLightAngleCos[ i ] ) {\n\n\t\t\tspotEffect = max( pow( max( spotEffect, 0.0 ), spotLightExponent[ i ] ), 0.0 );\n\n\t\t\tfloat lDistance = 1.0;\n\t\t\tif ( spotLightDistance[ i ] > 0.0 )\n\t\t\t\tlDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );\n\n\t\t\tlVector = normalize( lVector );\n\n\t\t\tfloat dotProduct = dot( transformedNormal, lVector );\n\t\t\tvec3 spotLightWeighting = vec3( max( dotProduct, 0.0 ) );\n\n\t\t\t#ifdef DOUBLE_SIDED\n\n\t\t\t\tvec3 spotLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n\n\t\t\t\t#ifdef WRAP_AROUND\n\n\t\t\t\t\tvec3 spotLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n\n\t\t\t\t#endif\n\n\t\t\t#endif\n\n\t\t\t#ifdef WRAP_AROUND\n\n\t\t\t\tvec3 spotLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\n\t\t\t\tspotLightWeighting = mix( spotLightWeighting, spotLightWeightingHalf, wrapRGB );\n\n\t\t\t\t#ifdef DOUBLE_SIDED\n\n\t\t\t\t\tspotLightWeightingBack = mix( spotLightWeightingBack, spotLightWeightingHalfBack, wrapRGB );\n\n\t\t\t\t#endif\n\n\t\t\t#endif\n\n\t\t\tvLightFront += spotLightColor[ i ] * spotLightWeighting * lDistance * spotEffect;\n\n\t\t\t#ifdef DOUBLE_SIDED\n\n\t\t\t\tvLightBack += spotLightColor[ i ] * spotLightWeightingBack * lDistance * spotEffect;\n\n\t\t\t#endif\n\n\t\t}\n\n\t}\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n\tfor( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\n\n\t\tvec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );\n\t\tvec3 lVector = normalize( lDirection.xyz );\n\n\t\tfloat dotProduct = dot( transformedNormal, lVector );\n\n\t\tfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\n\t\tfloat hemiDiffuseWeightBack = -0.5 * dotProduct + 0.5;\n\n\t\tvLightFront += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tvLightBack += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeightBack );\n\n\t\t#endif\n\n\t}\n\n#endif\n\nvLightFront = vLightFront * diffuse + ambient * ambientLightColor + emissive;\n\n#ifdef DOUBLE_SIDED\n\n\tvLightBack = vLightBack * diffuse + ambient * ambientLightColor + emissive;\n\n#endif";
THREE.ShaderChunk.map_particle_pars_fragment="#ifdef USE_MAP\n\n\tuniform sampler2D map;\n\n#endif";THREE.ShaderChunk.default_vertex="vec4 mvPosition;\n\n#ifdef USE_SKINNING\n\n\tmvPosition = modelViewMatrix * skinned;\n\n#endif\n\n#if !defined( USE_SKINNING ) && defined( USE_MORPHTARGETS )\n\n\tmvPosition = modelViewMatrix * vec4( morphed, 1.0 );\n\n#endif\n\n#if !defined( USE_SKINNING ) && ! defined( USE_MORPHTARGETS )\n\n\tmvPosition = modelViewMatrix * vec4( position, 1.0 );\n\n#endif\n\ngl_Position = projectionMatrix * mvPosition;";
THREE.ShaderChunk.map_pars_fragment="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP )\n\n\tvarying vec2 vUv;\n\n#endif\n\n#ifdef USE_MAP\n\n\tuniform sampler2D map;\n\n#endif";THREE.ShaderChunk.skinnormal_vertex="#ifdef USE_SKINNING\n\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\n\t#ifdef USE_MORPHNORMALS\n\n\tvec4 skinnedNormal = skinMatrix * vec4( morphedNormal, 0.0 );\n\n\t#else\n\n\tvec4 skinnedNormal = skinMatrix * vec4( normal, 0.0 );\n\n\t#endif\n\n#endif\n";
THREE.ShaderChunk.logdepthbuf_pars_vertex="#ifdef USE_LOGDEPTHBUF\n\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\n\t\tvarying float vFragDepth;\n\n\t#endif\n\n\tuniform float logDepthBufFC;\n\n#endif";THREE.ShaderChunk.lightmap_pars_vertex="#ifdef USE_LIGHTMAP\n\n\tvarying vec2 vUv2;\n\n#endif";THREE.ShaderChunk.lights_phong_fragment="vec3 normal = normalize( vNormal );\nvec3 viewPosition = normalize( vViewPosition );\n\n#ifdef DOUBLE_SIDED\n\n\tnormal = normal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );\n\n#endif\n\n#ifdef USE_NORMALMAP\n\n\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n\n#elif defined( USE_BUMPMAP )\n\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n\n#endif\n\n#if MAX_POINT_LIGHTS > 0\n\n\tvec3 pointDiffuse = vec3( 0.0 );\n\tvec3 pointSpecular = vec3( 0.0 );\n\n\tfor ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\n\n\t\tvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\n\t\tvec3 lVector = lPosition.xyz + vViewPosition.xyz;\n\n\t\tfloat lDistance = 1.0;\n\t\tif ( pointLightDistance[ i ] > 0.0 )\n\t\t\tlDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\n\n\t\tlVector = normalize( lVector );\n\n\t\t\t\t// diffuse\n\n\t\tfloat dotProduct = dot( normal, lVector );\n\n\t\t#ifdef WRAP_AROUND\n\n\t\t\tfloat pointDiffuseWeightFull = max( dotProduct, 0.0 );\n\t\t\tfloat pointDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\n\n\t\t\tvec3 pointDiffuseWeight = mix( vec3( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );\n\n\t\t#else\n\n\t\t\tfloat pointDiffuseWeight = max( dotProduct, 0.0 );\n\n\t\t#endif\n\n\t\tpointDiffuse += diffuse * pointLightColor[ i ] * pointDiffuseWeight * lDistance;\n\n\t\t\t\t// specular\n\n\t\tvec3 pointHalfVector = normalize( lVector + viewPosition );\n\t\tfloat pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );\n\t\tfloat pointSpecularWeight = specularStrength * max( pow( pointDotNormalHalf, shininess ), 0.0 );\n\n\t\tfloat specularNormalization = ( shininess + 2.0 ) / 8.0;\n\n\t\tvec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVector, pointHalfVector ), 0.0 ), 5.0 );\n\t\tpointSpecular += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * lDistance * specularNormalization;\n\n\t}\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n\tvec3 spotDiffuse = vec3( 0.0 );\n\tvec3 spotSpecular = vec3( 0.0 );\n\n\tfor ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\n\n\t\tvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\n\t\tvec3 lVector = lPosition.xyz + vViewPosition.xyz;\n\n\t\tfloat lDistance = 1.0;\n\t\tif ( spotLightDistance[ i ] > 0.0 )\n\t\t\tlDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );\n\n\t\tlVector = normalize( lVector );\n\n\t\tfloat spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );\n\n\t\tif ( spotEffect > spotLightAngleCos[ i ] ) {\n\n\t\t\tspotEffect = max( pow( max( spotEffect, 0.0 ), spotLightExponent[ i ] ), 0.0 );\n\n\t\t\t\t\t// diffuse\n\n\t\t\tfloat dotProduct = dot( normal, lVector );\n\n\t\t\t#ifdef WRAP_AROUND\n\n\t\t\t\tfloat spotDiffuseWeightFull = max( dotProduct, 0.0 );\n\t\t\t\tfloat spotDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\n\n\t\t\t\tvec3 spotDiffuseWeight = mix( vec3( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );\n\n\t\t\t#else\n\n\t\t\t\tfloat spotDiffuseWeight = max( dotProduct, 0.0 );\n\n\t\t\t#endif\n\n\t\t\tspotDiffuse += diffuse * spotLightColor[ i ] * spotDiffuseWeight * lDistance * spotEffect;\n\n\t\t\t\t\t// specular\n\n\t\t\tvec3 spotHalfVector = normalize( lVector + viewPosition );\n\t\t\tfloat spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );\n\t\t\tfloat spotSpecularWeight = specularStrength * max( pow( spotDotNormalHalf, shininess ), 0.0 );\n\n\t\t\tfloat specularNormalization = ( shininess + 2.0 ) / 8.0;\n\n\t\t\tvec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVector, spotHalfVector ), 0.0 ), 5.0 );\n\t\t\tspotSpecular += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * lDistance * specularNormalization * spotEffect;\n\n\t\t}\n\n\t}\n\n#endif\n\n#if MAX_DIR_LIGHTS > 0\n\n\tvec3 dirDiffuse = vec3( 0.0 );\n\tvec3 dirSpecular = vec3( 0.0 );\n\n\tfor( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\n\n\t\tvec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );\n\t\tvec3 dirVector = normalize( lDirection.xyz );\n\n\t\t\t\t// diffuse\n\n\t\tfloat dotProduct = dot( normal, dirVector );\n\n\t\t#ifdef WRAP_AROUND\n\n\t\t\tfloat dirDiffuseWeightFull = max( dotProduct, 0.0 );\n\t\t\tfloat dirDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\n\n\t\t\tvec3 dirDiffuseWeight = mix( vec3( dirDiffuseWeightFull ), vec3( dirDiffuseWeightHalf ), wrapRGB );\n\n\t\t#else\n\n\t\t\tfloat dirDiffuseWeight = max( dotProduct, 0.0 );\n\n\t\t#endif\n\n\t\tdirDiffuse += diffuse * directionalLightColor[ i ] * dirDiffuseWeight;\n\n\t\t// specular\n\n\t\tvec3 dirHalfVector = normalize( dirVector + viewPosition );\n\t\tfloat dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );\n\t\tfloat dirSpecularWeight = specularStrength * max( pow( dirDotNormalHalf, shininess ), 0.0 );\n\n\t\t/*\n\t\t// fresnel term from skin shader\n\t\tconst float F0 = 0.128;\n\n\t\tfloat base = 1.0 - dot( viewPosition, dirHalfVector );\n\t\tfloat exponential = pow( base, 5.0 );\n\n\t\tfloat fresnel = exponential + F0 * ( 1.0 - exponential );\n\t\t*/\n\n\t\t/*\n\t\t// fresnel term from fresnel shader\n\t\tconst float mFresnelBias = 0.08;\n\t\tconst float mFresnelScale = 0.3;\n\t\tconst float mFresnelPower = 5.0;\n\n\t\tfloat fresnel = mFresnelBias + mFresnelScale * pow( 1.0 + dot( normalize( -viewPosition ), normal ), mFresnelPower );\n\t\t*/\n\n\t\tfloat specularNormalization = ( shininess + 2.0 ) / 8.0;\n\n\t\t// \t\tdirSpecular += specular * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization * fresnel;\n\n\t\tvec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( dirVector, dirHalfVector ), 0.0 ), 5.0 );\n\t\tdirSpecular += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;\n\n\n\t}\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n\tvec3 hemiDiffuse = vec3( 0.0 );\n\tvec3 hemiSpecular = vec3( 0.0 );\n\n\tfor( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\n\n\t\tvec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );\n\t\tvec3 lVector = normalize( lDirection.xyz );\n\n\t\t// diffuse\n\n\t\tfloat dotProduct = dot( normal, lVector );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\n\n\t\tvec3 hemiColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\n\n\t\themiDiffuse += diffuse * hemiColor;\n\n\t\t// specular (sky light)\n\n\t\tvec3 hemiHalfVectorSky = normalize( lVector + viewPosition );\n\t\tfloat hemiDotNormalHalfSky = 0.5 * dot( normal, hemiHalfVectorSky ) + 0.5;\n\t\tfloat hemiSpecularWeightSky = specularStrength * max( pow( max( hemiDotNormalHalfSky, 0.0 ), shininess ), 0.0 );\n\n\t\t// specular (ground light)\n\n\t\tvec3 lVectorGround = -lVector;\n\n\t\tvec3 hemiHalfVectorGround = normalize( lVectorGround + viewPosition );\n\t\tfloat hemiDotNormalHalfGround = 0.5 * dot( normal, hemiHalfVectorGround ) + 0.5;\n\t\tfloat hemiSpecularWeightGround = specularStrength * max( pow( max( hemiDotNormalHalfGround, 0.0 ), shininess ), 0.0 );\n\n\t\tfloat dotProductGround = dot( normal, lVectorGround );\n\n\t\tfloat specularNormalization = ( shininess + 2.0 ) / 8.0;\n\n\t\tvec3 schlickSky = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVector, hemiHalfVectorSky ), 0.0 ), 5.0 );\n\t\tvec3 schlickGround = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVectorGround, hemiHalfVectorGround ), 0.0 ), 5.0 );\n\t\themiSpecular += hemiColor * specularNormalization * ( schlickSky * hemiSpecularWeightSky * max( dotProduct, 0.0 ) + schlickGround * hemiSpecularWeightGround * max( dotProductGround, 0.0 ) );\n\n\t}\n\n#endif\n\nvec3 totalDiffuse = vec3( 0.0 );\nvec3 totalSpecular = vec3( 0.0 );\n\n#if MAX_DIR_LIGHTS > 0\n\n\ttotalDiffuse += dirDiffuse;\n\ttotalSpecular += dirSpecular;\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n\ttotalDiffuse += hemiDiffuse;\n\ttotalSpecular += hemiSpecular;\n\n#endif\n\n#if MAX_POINT_LIGHTS > 0\n\n\ttotalDiffuse += pointDiffuse;\n\ttotalSpecular += pointSpecular;\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n\ttotalDiffuse += spotDiffuse;\n\ttotalSpecular += spotSpecular;\n\n#endif\n\n#ifdef METAL\n\n\tgl_FragColor.xyz = gl_FragColor.xyz * ( emissive + totalDiffuse + ambientLightColor * ambient + totalSpecular );\n\n#else\n\n\tgl_FragColor.xyz = gl_FragColor.xyz * ( emissive + totalDiffuse + ambientLightColor * ambient ) + totalSpecular;\n\n#endif";
THREE.ShaderChunk.fog_pars_fragment="#ifdef USE_FOG\n\n\tuniform vec3 fogColor;\n\n\t#ifdef FOG_EXP2\n\n\t\tuniform float fogDensity;\n\n\t#else\n\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n\n#endif";THREE.ShaderChunk.morphnormal_vertex="#ifdef USE_MORPHNORMALS\n\n\tvec3 morphedNormal = vec3( 0.0 );\n\n\tmorphedNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tmorphedNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tmorphedNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tmorphedNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n\n\tmorphedNormal += normal;\n\n#endif";
THREE.ShaderChunk.envmap_pars_fragment="#ifdef USE_ENVMAP\n\n\tuniform float reflectivity;\n\tuniform samplerCube envMap;\n\tuniform float flipEnvMap;\n\tuniform int combine;\n\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\n\t\tuniform bool useRefract;\n\t\tuniform float refractionRatio;\n\n\t#else\n\n\t\tvarying vec3 vReflect;\n\n\t#endif\n\n#endif";THREE.ShaderChunk.logdepthbuf_fragment="#if defined(USE_LOGDEPTHBUF) && defined(USE_LOGDEPTHBUF_EXT)\n\n\tgl_FragDepthEXT = log2(vFragDepth) * logDepthBufFC * 0.5;\n\n#endif";
THREE.ShaderChunk.normalmap_pars_fragment="#ifdef USE_NORMALMAP\n\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\n\t\t\t// Per-Pixel Tangent Space Normal Mapping\n\t\t\t// http://hacksoflife.blogspot.ch/2009/11/per-pixel-tangent-space-normal-mapping.html\n\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\n\t\tvec3 S = normalize( q0 * st1.t - q1 * st0.t );\n\t\tvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\n\t\tvec3 N = normalize( surf_norm );\n\n\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\tmapN.xy = normalScale * mapN.xy;\n\t\tmat3 tsn = mat3( S, T, N );\n\t\treturn normalize( tsn * mapN );\n\n\t}\n\n#endif\n";
THREE.ShaderChunk.lights_phong_pars_vertex="#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined( USE_ENVMAP )\n\n\tvarying vec3 vWorldPosition;\n\n#endif\n";THREE.ShaderChunk.lightmap_pars_fragment="#ifdef USE_LIGHTMAP\n\n\tvarying vec2 vUv2;\n\tuniform sampler2D lightMap;\n\n#endif";THREE.ShaderChunk.shadowmap_vertex="#ifdef USE_SHADOWMAP\n\n\tfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\n\n\t\tvShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;\n\n\t}\n\n#endif";
THREE.ShaderChunk.lights_phong_vertex="#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined( USE_ENVMAP )\n\n\tvWorldPosition = worldPosition.xyz;\n\n#endif";THREE.ShaderChunk.map_fragment="#ifdef USE_MAP\n\n\tvec4 texelColor = texture2D( map, vUv );\n\n\t#ifdef GAMMA_INPUT\n\n\t\ttexelColor.xyz *= texelColor.xyz;\n\n\t#endif\n\n\tgl_FragColor = gl_FragColor * texelColor;\n\n#endif";THREE.ShaderChunk.lightmap_vertex="#ifdef USE_LIGHTMAP\n\n\tvUv2 = uv2;\n\n#endif";
THREE.ShaderChunk.map_particle_fragment="#ifdef USE_MAP\n\n\tgl_FragColor = gl_FragColor * texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) );\n\n#endif";THREE.ShaderChunk.color_pars_fragment="#ifdef USE_COLOR\n\n\tvarying vec3 vColor;\n\n#endif\n";THREE.ShaderChunk.color_vertex="#ifdef USE_COLOR\n\n\t#ifdef GAMMA_INPUT\n\n\t\tvColor = color * color;\n\n\t#else\n\n\t\tvColor = color;\n\n\t#endif\n\n#endif";THREE.ShaderChunk.skinning_vertex="#ifdef USE_SKINNING\n\n\t#ifdef USE_MORPHTARGETS\n\n\tvec4 skinVertex = bindMatrix * vec4( morphed, 1.0 );\n\n\t#else\n\n\tvec4 skinVertex = bindMatrix * vec4( position, 1.0 );\n\n\t#endif\n\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\tskinned  = bindMatrixInverse * skinned;\n\n#endif\n";
THREE.ShaderChunk.envmap_pars_vertex="#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP ) && ! defined( PHONG )\n\n\tvarying vec3 vReflect;\n\n\tuniform float refractionRatio;\n\tuniform bool useRefract;\n\n#endif\n";THREE.ShaderChunk.linear_to_gamma_fragment="#ifdef GAMMA_OUTPUT\n\n\tgl_FragColor.xyz = sqrt( gl_FragColor.xyz );\n\n#endif";THREE.ShaderChunk.color_pars_vertex="#ifdef USE_COLOR\n\n\tvarying vec3 vColor;\n\n#endif";
THREE.ShaderChunk.lights_lambert_pars_vertex="uniform vec3 ambient;\nuniform vec3 diffuse;\nuniform vec3 emissive;\n\nuniform vec3 ambientLightColor;\n\n#if MAX_DIR_LIGHTS > 0\n\n\tuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\n\tuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n\tuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\n\tuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\n\tuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n\n#endif\n\n#if MAX_POINT_LIGHTS > 0\n\n\tuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\n\tuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\n\tuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n\tuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\n\tuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\n\tuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\n\n#endif\n\n#ifdef WRAP_AROUND\n\n\tuniform vec3 wrapRGB;\n\n#endif\n";
THREE.ShaderChunk.map_pars_vertex="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP )\n\n\tvarying vec2 vUv;\n\tuniform vec4 offsetRepeat;\n\n#endif\n";THREE.ShaderChunk.envmap_fragment="#ifdef USE_ENVMAP\n\n\tvec3 reflectVec;\n\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\n\t\t// http://en.wikibooks.org/wiki/GLSL_Programming/Applying_Matrix_Transformations\n\t\t// Transforming Normal Vectors with the Inverse Transformation\n\n\t\tvec3 worldNormal = normalize( vec3( vec4( normal, 0.0 ) * viewMatrix ) );\n\n\t\tif ( useRefract ) {\n\n\t\t\treflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\n\t\t} else { \n\n\t\t\treflectVec = reflect( cameraToVertex, worldNormal );\n\n\t\t}\n\n\t#else\n\n\t\treflectVec = vReflect;\n\n\t#endif\n\n\t#ifdef DOUBLE_SIDED\n\n\t\tfloat flipNormal = ( -1.0 + 2.0 * float( gl_FrontFacing ) );\n\t\tvec4 cubeColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\n\t#else\n\n\t\tvec4 cubeColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\n\t#endif\n\n\t#ifdef GAMMA_INPUT\n\n\t\tcubeColor.xyz *= cubeColor.xyz;\n\n\t#endif\n\n\tif ( combine == 1 ) {\n\n\t\tgl_FragColor.xyz = mix( gl_FragColor.xyz, cubeColor.xyz, specularStrength * reflectivity );\n\n\t} else if ( combine == 2 ) {\n\n\t\tgl_FragColor.xyz += cubeColor.xyz * specularStrength * reflectivity;\n\n\t} else {\n\n\t\tgl_FragColor.xyz = mix( gl_FragColor.xyz, gl_FragColor.xyz * cubeColor.xyz, specularStrength * reflectivity );\n\n\t}\n\n#endif";
THREE.ShaderChunk.specularmap_pars_fragment="#ifdef USE_SPECULARMAP\n\n\tuniform sampler2D specularMap;\n\n#endif";THREE.ShaderChunk.logdepthbuf_vertex="#ifdef USE_LOGDEPTHBUF\n\n\tgl_Position.z = log2(max(1e-6, gl_Position.w + 1.0)) * logDepthBufFC;\n\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\n#else\n\n\t\tgl_Position.z = (gl_Position.z - 1.0) * gl_Position.w;\n\n\t#endif\n\n#endif";THREE.ShaderChunk.morphtarget_pars_vertex="#ifdef USE_MORPHTARGETS\n\n\t#ifndef USE_MORPHNORMALS\n\n\tuniform float morphTargetInfluences[ 8 ];\n\n\t#else\n\n\tuniform float morphTargetInfluences[ 4 ];\n\n\t#endif\n\n#endif";
THREE.ShaderChunk.specularmap_fragment="float specularStrength;\n\n#ifdef USE_SPECULARMAP\n\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n\n#else\n\n\tspecularStrength = 1.0;\n\n#endif";THREE.ShaderChunk.fog_fragment="#ifdef USE_FOG\n\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\n\t\tfloat depth = gl_FragDepthEXT / gl_FragCoord.w;\n\n\t#else\n\n\t\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;\n\n\t#endif\n\n\t#ifdef FOG_EXP2\n\n\t\tconst float LOG2 = 1.442695;\n\t\tfloat fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );\n\t\tfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );\n\n\t#else\n\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, depth );\n\n\t#endif\n\t\n\tgl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );\n\n#endif";
THREE.ShaderChunk.bumpmap_pars_fragment="#ifdef USE_BUMPMAP\n\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\n\t\t\t// Derivative maps - bump mapping unparametrized surfaces by Morten Mikkelsen\n\t\t\t//\thttp://mmikkelsen3d.blogspot.sk/2011/07/derivative-maps.html\n\n\t\t\t// Evaluate the derivative of the height w.r.t. screen-space using forward differencing (listing 2)\n\n\tvec2 dHdxy_fwd() {\n\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\n\t\treturn vec2( dBx, dBy );\n\n\t}\n\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\n\t\tvec3 vSigmaX = dFdx( surf_pos );\n\t\tvec3 vSigmaY = dFdy( surf_pos );\n\t\tvec3 vN = surf_norm;\t\t// normalized\n\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\n\t}\n\n#endif";
THREE.ShaderChunk.defaultnormal_vertex="vec3 objectNormal;\n\n#ifdef USE_SKINNING\n\n\tobjectNormal = skinnedNormal.xyz;\n\n#endif\n\n#if !defined( USE_SKINNING ) && defined( USE_MORPHNORMALS )\n\n\tobjectNormal = morphedNormal;\n\n#endif\n\n#if !defined( USE_SKINNING ) && ! defined( USE_MORPHNORMALS )\n\n\tobjectNormal = normal;\n\n#endif\n\n#ifdef FLIP_SIDED\n\n\tobjectNormal = -objectNormal;\n\n#endif\n\nvec3 transformedNormal = normalMatrix * objectNormal;";
THREE.ShaderChunk.lights_phong_pars_fragment="uniform vec3 ambientLightColor;\n\n#if MAX_DIR_LIGHTS > 0\n\n\tuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\n\tuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n\tuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\n\tuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\n\tuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n\n#endif\n\n#if MAX_POINT_LIGHTS > 0\n\n\tuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\n\n\tuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\n\tuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n\tuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\n\tuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\n\tuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\n\n\tuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined( USE_ENVMAP )\n\n\tvarying vec3 vWorldPosition;\n\n#endif\n\n#ifdef WRAP_AROUND\n\n\tuniform vec3 wrapRGB;\n\n#endif\n\nvarying vec3 vViewPosition;\nvarying vec3 vNormal;";
THREE.ShaderChunk.skinbase_vertex="#ifdef USE_SKINNING\n\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n\n#endif";THREE.ShaderChunk.map_vertex="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP )\n\n\tvUv = uv * offsetRepeat.zw + offsetRepeat.xy;\n\n#endif";
THREE.ShaderChunk.lightmap_fragment="#ifdef USE_LIGHTMAP\n\n\tgl_FragColor = gl_FragColor * texture2D( lightMap, vUv2 );\n\n#endif";THREE.ShaderChunk.shadowmap_pars_vertex="#ifdef USE_SHADOWMAP\n\n\tvarying vec4 vShadowCoord[ MAX_SHADOWS ];\n\tuniform mat4 shadowMatrix[ MAX_SHADOWS ];\n\n#endif";THREE.ShaderChunk.color_fragment="#ifdef USE_COLOR\n\n\tgl_FragColor = gl_FragColor * vec4( vColor, 1.0 );\n\n#endif";THREE.ShaderChunk.morphtarget_vertex="#ifdef USE_MORPHTARGETS\n\n\tvec3 morphed = vec3( 0.0 );\n\tmorphed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\tmorphed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\tmorphed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\tmorphed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\n\t#ifndef USE_MORPHNORMALS\n\n\tmorphed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\tmorphed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\tmorphed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\tmorphed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\n\t#endif\n\n\tmorphed += position;\n\n#endif";
THREE.ShaderChunk.envmap_vertex="#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP ) && ! defined( PHONG )\n\n\tvec3 worldNormal = mat3( modelMatrix[ 0 ].xyz, modelMatrix[ 1 ].xyz, modelMatrix[ 2 ].xyz ) * objectNormal;\n\tworldNormal = normalize( worldNormal );\n\n\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\n\tif ( useRefract ) {\n\n\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\n\t} else {\n\n\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\n\t}\n\n#endif";
THREE.ShaderChunk.shadowmap_fragment="#ifdef USE_SHADOWMAP\n\n\t#ifdef SHADOWMAP_DEBUG\n\n\t\tvec3 frustumColors[3];\n\t\tfrustumColors[0] = vec3( 1.0, 0.5, 0.0 );\n\t\tfrustumColors[1] = vec3( 0.0, 1.0, 0.8 );\n\t\tfrustumColors[2] = vec3( 0.0, 0.5, 1.0 );\n\n\t#endif\n\n\t#ifdef SHADOWMAP_CASCADE\n\n\t\tint inFrustumCount = 0;\n\n\t#endif\n\n\tfloat fDepth;\n\tvec3 shadowColor = vec3( 1.0 );\n\n\tfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\n\n\t\tvec3 shadowCoord = vShadowCoord[ i ].xyz / vShadowCoord[ i ].w;\n\n\t\t\t\t// if ( something && something ) breaks ATI OpenGL shader compiler\n\t\t\t\t// if ( all( something, something ) ) using this instead\n\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\n\t\t\t\t// don't shadow pixels outside of light frustum\n\t\t\t\t// use just first frustum (for cascades)\n\t\t\t\t// don't shadow pixels behind far plane of light frustum\n\n\t\t#ifdef SHADOWMAP_CASCADE\n\n\t\t\tinFrustumCount += int( inFrustum );\n\t\t\tbvec3 frustumTestVec = bvec3( inFrustum, inFrustumCount == 1, shadowCoord.z <= 1.0 );\n\n\t\t#else\n\n\t\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\n\t\t#endif\n\n\t\tbool frustumTest = all( frustumTestVec );\n\n\t\tif ( frustumTest ) {\n\n\t\t\tshadowCoord.z += shadowBias[ i ];\n\n\t\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\n\t\t\t\t\t\t// Percentage-close filtering\n\t\t\t\t\t\t// (9 pixel kernel)\n\t\t\t\t\t\t// http://fabiensanglard.net/shadowmappingPCF/\n\n\t\t\t\tfloat shadow = 0.0;\n\n\t\t/*\n\t\t\t\t\t\t// nested loops breaks shader compiler / validator on some ATI cards when using OpenGL\n\t\t\t\t\t\t// must enroll loop manually\n\n\t\t\t\tfor ( float y = -1.25; y <= 1.25; y += 1.25 )\n\t\t\t\t\tfor ( float x = -1.25; x <= 1.25; x += 1.25 ) {\n\n\t\t\t\t\t\tvec4 rgbaDepth = texture2D( shadowMap[ i ], vec2( x * xPixelOffset, y * yPixelOffset ) + shadowCoord.xy );\n\n\t\t\t\t\t\t\t\t// doesn't seem to produce any noticeable visual difference compared to simple texture2D lookup\n\t\t\t\t\t\t\t\t//vec4 rgbaDepth = texture2DProj( shadowMap[ i ], vec4( vShadowCoord[ i ].w * ( vec2( x * xPixelOffset, y * yPixelOffset ) + shadowCoord.xy ), 0.05, vShadowCoord[ i ].w ) );\n\n\t\t\t\t\t\tfloat fDepth = unpackDepth( rgbaDepth );\n\n\t\t\t\t\t\tif ( fDepth < shadowCoord.z )\n\t\t\t\t\t\t\tshadow += 1.0;\n\n\t\t\t\t}\n\n\t\t\t\tshadow /= 9.0;\n\n\t\t*/\n\n\t\t\t\tconst float shadowDelta = 1.0 / 9.0;\n\n\t\t\t\tfloat xPixelOffset = 1.0 / shadowMapSize[ i ].x;\n\t\t\t\tfloat yPixelOffset = 1.0 / shadowMapSize[ i ].y;\n\n\t\t\t\tfloat dx0 = -1.25 * xPixelOffset;\n\t\t\t\tfloat dy0 = -1.25 * yPixelOffset;\n\t\t\t\tfloat dx1 = 1.25 * xPixelOffset;\n\t\t\t\tfloat dy1 = 1.25 * yPixelOffset;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n\t\t\t\tshadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\n\n\t\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\n\t\t\t\t\t\t// Percentage-close filtering\n\t\t\t\t\t\t// (9 pixel kernel)\n\t\t\t\t\t\t// http://fabiensanglard.net/shadowmappingPCF/\n\n\t\t\t\tfloat shadow = 0.0;\n\n\t\t\t\tfloat xPixelOffset = 1.0 / shadowMapSize[ i ].x;\n\t\t\t\tfloat yPixelOffset = 1.0 / shadowMapSize[ i ].y;\n\n\t\t\t\tfloat dx0 = -1.0 * xPixelOffset;\n\t\t\t\tfloat dy0 = -1.0 * yPixelOffset;\n\t\t\t\tfloat dx1 = 1.0 * xPixelOffset;\n\t\t\t\tfloat dy1 = 1.0 * yPixelOffset;\n\n\t\t\t\tmat3 shadowKernel;\n\t\t\t\tmat3 depthKernel;\n\n\t\t\t\tdepthKernel[0][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\n\t\t\t\tdepthKernel[0][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\n\t\t\t\tdepthKernel[0][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\n\t\t\t\tdepthKernel[1][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\n\t\t\t\tdepthKernel[1][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\n\t\t\t\tdepthKernel[1][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\n\t\t\t\tdepthKernel[2][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\n\t\t\t\tdepthKernel[2][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\n\t\t\t\tdepthKernel[2][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\n\n\t\t\t\tvec3 shadowZ = vec3( shadowCoord.z );\n\t\t\t\tshadowKernel[0] = vec3(lessThan(depthKernel[0], shadowZ ));\n\t\t\t\tshadowKernel[0] *= vec3(0.25);\n\n\t\t\t\tshadowKernel[1] = vec3(lessThan(depthKernel[1], shadowZ ));\n\t\t\t\tshadowKernel[1] *= vec3(0.25);\n\n\t\t\t\tshadowKernel[2] = vec3(lessThan(depthKernel[2], shadowZ ));\n\t\t\t\tshadowKernel[2] *= vec3(0.25);\n\n\t\t\t\tvec2 fractionalCoord = 1.0 - fract( shadowCoord.xy * shadowMapSize[i].xy );\n\n\t\t\t\tshadowKernel[0] = mix( shadowKernel[1], shadowKernel[0], fractionalCoord.x );\n\t\t\t\tshadowKernel[1] = mix( shadowKernel[2], shadowKernel[1], fractionalCoord.x );\n\n\t\t\t\tvec4 shadowValues;\n\t\t\t\tshadowValues.x = mix( shadowKernel[0][1], shadowKernel[0][0], fractionalCoord.y );\n\t\t\t\tshadowValues.y = mix( shadowKernel[0][2], shadowKernel[0][1], fractionalCoord.y );\n\t\t\t\tshadowValues.z = mix( shadowKernel[1][1], shadowKernel[1][0], fractionalCoord.y );\n\t\t\t\tshadowValues.w = mix( shadowKernel[1][2], shadowKernel[1][1], fractionalCoord.y );\n\n\t\t\t\tshadow = dot( shadowValues, vec4( 1.0 ) );\n\n\t\t\t\tshadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\n\n\t\t\t#else\n\n\t\t\t\tvec4 rgbaDepth = texture2D( shadowMap[ i ], shadowCoord.xy );\n\t\t\t\tfloat fDepth = unpackDepth( rgbaDepth );\n\n\t\t\t\tif ( fDepth < shadowCoord.z )\n\n\t\t// spot with multiple shadows is darker\n\n\t\t\t\t\tshadowColor = shadowColor * vec3( 1.0 - shadowDarkness[ i ] );\n\n\t\t// spot with multiple shadows has the same color as single shadow spot\n\n\t\t// \t\t\t\t\tshadowColor = min( shadowColor, vec3( shadowDarkness[ i ] ) );\n\n\t\t\t#endif\n\n\t\t}\n\n\n\t\t#ifdef SHADOWMAP_DEBUG\n\n\t\t\t#ifdef SHADOWMAP_CASCADE\n\n\t\t\t\tif ( inFrustum && inFrustumCount == 1 ) gl_FragColor.xyz *= frustumColors[ i ];\n\n\t\t\t#else\n\n\t\t\t\tif ( inFrustum ) gl_FragColor.xyz *= frustumColors[ i ];\n\n\t\t\t#endif\n\n\t\t#endif\n\n\t}\n\n\t#ifdef GAMMA_OUTPUT\n\n\t\tshadowColor *= shadowColor;\n\n\t#endif\n\n\tgl_FragColor.xyz = gl_FragColor.xyz * shadowColor;\n\n#endif\n";
THREE.ShaderChunk.worldpos_vertex="#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\n\n\t#ifdef USE_SKINNING\n\n\t\tvec4 worldPosition = modelMatrix * skinned;\n\n\t#endif\n\n\t#if defined( USE_MORPHTARGETS ) && ! defined( USE_SKINNING )\n\n\t\tvec4 worldPosition = modelMatrix * vec4( morphed, 1.0 );\n\n\t#endif\n\n\t#if ! defined( USE_MORPHTARGETS ) && ! defined( USE_SKINNING )\n\n\t\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );\n\n\t#endif\n\n#endif";
THREE.ShaderChunk.shadowmap_pars_fragment="#ifdef USE_SHADOWMAP\n\n\tuniform sampler2D shadowMap[ MAX_SHADOWS ];\n\tuniform vec2 shadowMapSize[ MAX_SHADOWS ];\n\n\tuniform float shadowDarkness[ MAX_SHADOWS ];\n\tuniform float shadowBias[ MAX_SHADOWS ];\n\n\tvarying vec4 vShadowCoord[ MAX_SHADOWS ];\n\n\tfloat unpackDepth( const in vec4 rgba_depth ) {\n\n\t\tconst vec4 bit_shift = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\n\t\tfloat depth = dot( rgba_depth, bit_shift );\n\t\treturn depth;\n\n\t}\n\n#endif";
THREE.ShaderChunk.skinning_pars_vertex="#ifdef USE_SKINNING\n\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\n\t#ifdef BONE_TEXTURE\n\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureWidth;\n\t\tuniform int boneTextureHeight;\n\n\t\tmat4 getBoneMatrix( const in float i ) {\n\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureWidth ) );\n\t\t\tfloat y = floor( j / float( boneTextureWidth ) );\n\n\t\t\tfloat dx = 1.0 / float( boneTextureWidth );\n\t\t\tfloat dy = 1.0 / float( boneTextureHeight );\n\n\t\t\ty = dy * ( y + 0.5 );\n\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\n\t\t\treturn bone;\n\n\t\t}\n\n\t#else\n\n\t\tuniform mat4 boneGlobalMatrices[ MAX_BONES ];\n\n\t\tmat4 getBoneMatrix( const in float i ) {\n\n\t\t\tmat4 bone = boneGlobalMatrices[ int(i) ];\n\t\t\treturn bone;\n\n\t\t}\n\n\t#endif\n\n#endif\n";
THREE.ShaderChunk.logdepthbuf_pars_fragment="#ifdef USE_LOGDEPTHBUF\n\n\tuniform float logDepthBufFC;\n\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\n\t\t#extension GL_EXT_frag_depth : enable\n\t\tvarying float vFragDepth;\n\n\t#endif\n\n#endif";THREE.ShaderChunk.alphamap_fragment="#ifdef USE_ALPHAMAP\n\n\tgl_FragColor.a *= texture2D( alphaMap, vUv ).g;\n\n#endif\n";THREE.ShaderChunk.alphamap_pars_fragment="#ifdef USE_ALPHAMAP\n\n\tuniform sampler2D alphaMap;\n\n#endif\n";
THREE.UniformsUtils={merge:function(a){for(var b={},c=0;c<a.length;c++){var d=this.clone(a[c]),f;for(f in d)b[f]=d[f]}return b},clone:function(a){var b={},c;for(c in a){b[c]={};for(var d in a[c]){var f=a[c][d];b[c][d]=f instanceof THREE.Color||f instanceof THREE.Vector2||f instanceof THREE.Vector3||f instanceof THREE.Vector4||f instanceof THREE.Matrix4||f instanceof THREE.Texture?f.clone():f instanceof Array?f.slice():f}}return b}};
THREE.UniformsLib={common:{diffuse:{type:"c",value:new THREE.Color(15658734)},opacity:{type:"f",value:1},map:{type:"t",value:null},offsetRepeat:{type:"v4",value:new THREE.Vector4(0,0,1,1)},lightMap:{type:"t",value:null},specularMap:{type:"t",value:null},alphaMap:{type:"t",value:null},envMap:{type:"t",value:null},flipEnvMap:{type:"f",value:-1},useRefract:{type:"i",value:0},reflectivity:{type:"f",value:1},refractionRatio:{type:"f",value:0.98},combine:{type:"i",value:0},morphTargetInfluences:{type:"f",
value:0}},bump:{bumpMap:{type:"t",value:null},bumpScale:{type:"f",value:1}},normalmap:{normalMap:{type:"t",value:null},normalScale:{type:"v2",value:new THREE.Vector2(1,1)}},fog:{fogDensity:{type:"f",value:2.5E-4},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2E3},fogColor:{type:"c",value:new THREE.Color(16777215)}},lights:{ambientLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]},directionalLightColor:{type:"fv",value:[]},hemisphereLightDirection:{type:"fv",value:[]},
hemisphereLightSkyColor:{type:"fv",value:[]},hemisphereLightGroundColor:{type:"fv",value:[]},pointLightColor:{type:"fv",value:[]},pointLightPosition:{type:"fv",value:[]},pointLightDistance:{type:"fv1",value:[]},spotLightColor:{type:"fv",value:[]},spotLightPosition:{type:"fv",value:[]},spotLightDirection:{type:"fv",value:[]},spotLightDistance:{type:"fv1",value:[]},spotLightAngleCos:{type:"fv1",value:[]},spotLightExponent:{type:"fv1",value:[]}},particle:{psColor:{type:"c",value:new THREE.Color(15658734)},
opacity:{type:"f",value:1},size:{type:"f",value:1},scale:{type:"f",value:1},map:{type:"t",value:null},fogDensity:{type:"f",value:2.5E-4},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2E3},fogColor:{type:"c",value:new THREE.Color(16777215)}},shadowmap:{shadowMap:{type:"tv",value:[]},shadowMapSize:{type:"v2v",value:[]},shadowBias:{type:"fv1",value:[]},shadowDarkness:{type:"fv1",value:[]},shadowMatrix:{type:"m4v",value:[]}}};
THREE.ShaderLib={basic:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,THREE.UniformsLib.shadowmap]),vertexShader:[THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",THREE.ShaderChunk.map_vertex,
THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.skinbase_vertex,"\t#ifdef USE_ENVMAP",THREE.ShaderChunk.morphnormal_vertex,THREE.ShaderChunk.skinnormal_vertex,THREE.ShaderChunk.defaultnormal_vertex,"\t#endif",THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.logdepthbuf_vertex,THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),
fragmentShader:["uniform vec3 diffuse;\nuniform float opacity;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.alphamap_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.specularmap_pars_fragment,THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {\n\tgl_FragColor = vec4( diffuse, opacity );",THREE.ShaderChunk.logdepthbuf_fragment,
THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.alphamap_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.specularmap_fragment,THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},lambert:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,THREE.UniformsLib.lights,THREE.UniformsLib.shadowmap,
{ambient:{type:"c",value:new THREE.Color(16777215)},emissive:{type:"c",value:new THREE.Color(0)},wrapRGB:{type:"v3",value:new THREE.Vector3(1,1,1)}}]),vertexShader:["#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif",THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.lights_lambert_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,
THREE.ShaderChunk.shadowmap_pars_vertex,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.morphnormal_vertex,THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.skinnormal_vertex,THREE.ShaderChunk.defaultnormal_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.logdepthbuf_vertex,THREE.ShaderChunk.worldpos_vertex,
THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.lights_lambert_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.alphamap_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,
THREE.ShaderChunk.specularmap_pars_fragment,THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {\n\tgl_FragColor = vec4( vec3( 1.0 ), opacity );",THREE.ShaderChunk.logdepthbuf_fragment,THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.alphamap_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.specularmap_fragment,"\t#ifdef DOUBLE_SIDED\n\t\tif ( gl_FrontFacing )\n\t\t\tgl_FragColor.xyz *= vLightFront;\n\t\telse\n\t\t\tgl_FragColor.xyz *= vLightBack;\n\t#else\n\t\tgl_FragColor.xyz *= vLightFront;\n\t#endif",
THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},phong:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.bump,THREE.UniformsLib.normalmap,THREE.UniformsLib.fog,THREE.UniformsLib.lights,THREE.UniformsLib.shadowmap,{ambient:{type:"c",value:new THREE.Color(16777215)},emissive:{type:"c",value:new THREE.Color(0)},
specular:{type:"c",value:new THREE.Color(1118481)},shininess:{type:"f",value:30},wrapRGB:{type:"v3",value:new THREE.Vector3(1,1,1)}}]),vertexShader:["#define PHONG\nvarying vec3 vViewPosition;\nvarying vec3 vNormal;",THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.lights_phong_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,
THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.morphnormal_vertex,THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.skinnormal_vertex,THREE.ShaderChunk.defaultnormal_vertex,"\tvNormal = normalize( transformedNormal );",THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.logdepthbuf_vertex,"\tvViewPosition = -mvPosition.xyz;",
THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.lights_phong_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["#define PHONG\nuniform vec3 diffuse;\nuniform float opacity;\nuniform vec3 ambient;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.alphamap_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,
THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.lights_phong_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.bumpmap_pars_fragment,THREE.ShaderChunk.normalmap_pars_fragment,THREE.ShaderChunk.specularmap_pars_fragment,THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {\n\tgl_FragColor = vec4( vec3( 1.0 ), opacity );",THREE.ShaderChunk.logdepthbuf_fragment,THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.alphamap_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.specularmap_fragment,
THREE.ShaderChunk.lights_phong_fragment,THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},particle_basic:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.particle,THREE.UniformsLib.shadowmap]),vertexShader:["uniform float size;\nuniform float scale;",THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,
THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",THREE.ShaderChunk.color_vertex,"\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\t#ifdef USE_SIZEATTENUATION\n\t\tgl_PointSize = size * ( scale / length( mvPosition.xyz ) );\n\t#else\n\t\tgl_PointSize = size;\n\t#endif\n\tgl_Position = projectionMatrix * mvPosition;",THREE.ShaderChunk.logdepthbuf_vertex,THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 psColor;\nuniform float opacity;",
THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_particle_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {\n\tgl_FragColor = vec4( psColor, opacity );",THREE.ShaderChunk.logdepthbuf_fragment,THREE.ShaderChunk.map_particle_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},dashed:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,
THREE.UniformsLib.fog,{scale:{type:"f",value:1},dashSize:{type:"f",value:1},totalSize:{type:"f",value:2}}]),vertexShader:["uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;",THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",THREE.ShaderChunk.color_vertex,"\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;",THREE.ShaderChunk.logdepthbuf_vertex,
"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tgl_FragColor = vec4( diffuse, opacity );",THREE.ShaderChunk.logdepthbuf_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.fog_fragment,
"}"].join("\n")},depth:{uniforms:{mNear:{type:"f",value:1},mFar:{type:"f",value:2E3},opacity:{type:"f",value:1}},vertexShader:[THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform float mNear;\nuniform float mFar;\nuniform float opacity;",THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {",THREE.ShaderChunk.logdepthbuf_fragment,
"\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tfloat depth = gl_FragDepthEXT / gl_FragCoord.w;\n\t#else\n\t\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;\n\t#endif\n\tfloat color = 1.0 - smoothstep( mNear, mFar, depth );\n\tgl_FragColor = vec4( vec3( color ), opacity );\n}"].join("\n")},normal:{uniforms:{opacity:{type:"f",value:1}},vertexShader:["varying vec3 vNormal;",THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {\n\tvNormal = normalize( normalMatrix * normal );",
THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform float opacity;\nvarying vec3 vNormal;",THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {\n\tgl_FragColor = vec4( 0.5 * normalize( vNormal ) + 0.5, opacity );",THREE.ShaderChunk.logdepthbuf_fragment,"}"].join("\n")},normalmap:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.fog,THREE.UniformsLib.lights,THREE.UniformsLib.shadowmap,{enableAO:{type:"i",
value:0},enableDiffuse:{type:"i",value:0},enableSpecular:{type:"i",value:0},enableReflection:{type:"i",value:0},enableDisplacement:{type:"i",value:0},tDisplacement:{type:"t",value:null},tDiffuse:{type:"t",value:null},tCube:{type:"t",value:null},tNormal:{type:"t",value:null},tSpecular:{type:"t",value:null},tAO:{type:"t",value:null},uNormalScale:{type:"v2",value:new THREE.Vector2(1,1)},uDisplacementBias:{type:"f",value:0},uDisplacementScale:{type:"f",value:1},diffuse:{type:"c",value:new THREE.Color(16777215)},
specular:{type:"c",value:new THREE.Color(1118481)},ambient:{type:"c",value:new THREE.Color(16777215)},shininess:{type:"f",value:30},opacity:{type:"f",value:1},useRefract:{type:"i",value:0},refractionRatio:{type:"f",value:0.98},reflectivity:{type:"f",value:0.5},uOffset:{type:"v2",value:new THREE.Vector2(0,0)},uRepeat:{type:"v2",value:new THREE.Vector2(1,1)},wrapRGB:{type:"v3",value:new THREE.Vector3(1,1,1)}}]),fragmentShader:["uniform vec3 ambient;\nuniform vec3 diffuse;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\nuniform bool enableDiffuse;\nuniform bool enableSpecular;\nuniform bool enableAO;\nuniform bool enableReflection;\nuniform sampler2D tDiffuse;\nuniform sampler2D tNormal;\nuniform sampler2D tSpecular;\nuniform sampler2D tAO;\nuniform samplerCube tCube;\nuniform vec2 uNormalScale;\nuniform bool useRefract;\nuniform float refractionRatio;\nuniform float reflectivity;\nvarying vec3 vTangent;\nvarying vec3 vBinormal;\nvarying vec3 vNormal;\nvarying vec2 vUv;\nuniform vec3 ambientLightColor;\n#if MAX_DIR_LIGHTS > 0\n\tuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\n\tuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n#endif\n#if MAX_HEMI_LIGHTS > 0\n\tuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\n\tuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\n\tuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n#endif\n#if MAX_POINT_LIGHTS > 0\n\tuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\n\tuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\n\tuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n#endif\n#if MAX_SPOT_LIGHTS > 0\n\tuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\n\tuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\n\tuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\n#endif\n#ifdef WRAP_AROUND\n\tuniform vec3 wrapRGB;\n#endif\nvarying vec3 vWorldPosition;\nvarying vec3 vViewPosition;",
THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {",THREE.ShaderChunk.logdepthbuf_fragment,"\tgl_FragColor = vec4( vec3( 1.0 ), opacity );\n\tvec3 specularTex = vec3( 1.0 );\n\tvec3 normalTex = texture2D( tNormal, vUv ).xyz * 2.0 - 1.0;\n\tnormalTex.xy *= uNormalScale;\n\tnormalTex = normalize( normalTex );\n\tif( enableDiffuse ) {\n\t\t#ifdef GAMMA_INPUT\n\t\t\tvec4 texelColor = texture2D( tDiffuse, vUv );\n\t\t\ttexelColor.xyz *= texelColor.xyz;\n\t\t\tgl_FragColor = gl_FragColor * texelColor;\n\t\t#else\n\t\t\tgl_FragColor = gl_FragColor * texture2D( tDiffuse, vUv );\n\t\t#endif\n\t}\n\tif( enableAO ) {\n\t\t#ifdef GAMMA_INPUT\n\t\t\tvec4 aoColor = texture2D( tAO, vUv );\n\t\t\taoColor.xyz *= aoColor.xyz;\n\t\t\tgl_FragColor.xyz = gl_FragColor.xyz * aoColor.xyz;\n\t\t#else\n\t\t\tgl_FragColor.xyz = gl_FragColor.xyz * texture2D( tAO, vUv ).xyz;\n\t\t#endif\n\t}",
THREE.ShaderChunk.alphatest_fragment,"\tif( enableSpecular )\n\t\tspecularTex = texture2D( tSpecular, vUv ).xyz;\n\tmat3 tsb = mat3( normalize( vTangent ), normalize( vBinormal ), normalize( vNormal ) );\n\tvec3 finalNormal = tsb * normalTex;\n\t#ifdef FLIP_SIDED\n\t\tfinalNormal = -finalNormal;\n\t#endif\n\tvec3 normal = normalize( finalNormal );\n\tvec3 viewPosition = normalize( vViewPosition );\n\t#if MAX_POINT_LIGHTS > 0\n\t\tvec3 pointDiffuse = vec3( 0.0 );\n\t\tvec3 pointSpecular = vec3( 0.0 );\n\t\tfor ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\n\t\t\tvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\n\t\t\tvec3 pointVector = lPosition.xyz + vViewPosition.xyz;\n\t\t\tfloat pointDistance = 1.0;\n\t\t\tif ( pointLightDistance[ i ] > 0.0 )\n\t\t\t\tpointDistance = 1.0 - min( ( length( pointVector ) / pointLightDistance[ i ] ), 1.0 );\n\t\t\tpointVector = normalize( pointVector );\n\t\t\t#ifdef WRAP_AROUND\n\t\t\t\tfloat pointDiffuseWeightFull = max( dot( normal, pointVector ), 0.0 );\n\t\t\t\tfloat pointDiffuseWeightHalf = max( 0.5 * dot( normal, pointVector ) + 0.5, 0.0 );\n\t\t\t\tvec3 pointDiffuseWeight = mix( vec3( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );\n\t\t\t#else\n\t\t\t\tfloat pointDiffuseWeight = max( dot( normal, pointVector ), 0.0 );\n\t\t\t#endif\n\t\t\tpointDiffuse += pointDistance * pointLightColor[ i ] * diffuse * pointDiffuseWeight;\n\t\t\tvec3 pointHalfVector = normalize( pointVector + viewPosition );\n\t\t\tfloat pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );\n\t\t\tfloat pointSpecularWeight = specularTex.r * max( pow( pointDotNormalHalf, shininess ), 0.0 );\n\t\t\tfloat specularNormalization = ( shininess + 2.0 ) / 8.0;\n\t\t\tvec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( pointVector, pointHalfVector ), 0.0 ), 5.0 );\n\t\t\tpointSpecular += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * pointDistance * specularNormalization;\n\t\t}\n\t#endif\n\t#if MAX_SPOT_LIGHTS > 0\n\t\tvec3 spotDiffuse = vec3( 0.0 );\n\t\tvec3 spotSpecular = vec3( 0.0 );\n\t\tfor ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\n\t\t\tvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\n\t\t\tvec3 spotVector = lPosition.xyz + vViewPosition.xyz;\n\t\t\tfloat spotDistance = 1.0;\n\t\t\tif ( spotLightDistance[ i ] > 0.0 )\n\t\t\t\tspotDistance = 1.0 - min( ( length( spotVector ) / spotLightDistance[ i ] ), 1.0 );\n\t\t\tspotVector = normalize( spotVector );\n\t\t\tfloat spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );\n\t\t\tif ( spotEffect > spotLightAngleCos[ i ] ) {\n\t\t\t\tspotEffect = max( pow( max( spotEffect, 0.0 ), spotLightExponent[ i ] ), 0.0 );\n\t\t\t\t#ifdef WRAP_AROUND\n\t\t\t\t\tfloat spotDiffuseWeightFull = max( dot( normal, spotVector ), 0.0 );\n\t\t\t\t\tfloat spotDiffuseWeightHalf = max( 0.5 * dot( normal, spotVector ) + 0.5, 0.0 );\n\t\t\t\t\tvec3 spotDiffuseWeight = mix( vec3( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );\n\t\t\t\t#else\n\t\t\t\t\tfloat spotDiffuseWeight = max( dot( normal, spotVector ), 0.0 );\n\t\t\t\t#endif\n\t\t\t\tspotDiffuse += spotDistance * spotLightColor[ i ] * diffuse * spotDiffuseWeight * spotEffect;\n\t\t\t\tvec3 spotHalfVector = normalize( spotVector + viewPosition );\n\t\t\t\tfloat spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );\n\t\t\t\tfloat spotSpecularWeight = specularTex.r * max( pow( spotDotNormalHalf, shininess ), 0.0 );\n\t\t\t\tfloat specularNormalization = ( shininess + 2.0 ) / 8.0;\n\t\t\t\tvec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( spotVector, spotHalfVector ), 0.0 ), 5.0 );\n\t\t\t\tspotSpecular += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * spotDistance * specularNormalization * spotEffect;\n\t\t\t}\n\t\t}\n\t#endif\n\t#if MAX_DIR_LIGHTS > 0\n\t\tvec3 dirDiffuse = vec3( 0.0 );\n\t\tvec3 dirSpecular = vec3( 0.0 );\n\t\tfor( int i = 0; i < MAX_DIR_LIGHTS; i++ ) {\n\t\t\tvec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );\n\t\t\tvec3 dirVector = normalize( lDirection.xyz );\n\t\t\t#ifdef WRAP_AROUND\n\t\t\t\tfloat directionalLightWeightingFull = max( dot( normal, dirVector ), 0.0 );\n\t\t\t\tfloat directionalLightWeightingHalf = max( 0.5 * dot( normal, dirVector ) + 0.5, 0.0 );\n\t\t\t\tvec3 dirDiffuseWeight = mix( vec3( directionalLightWeightingFull ), vec3( directionalLightWeightingHalf ), wrapRGB );\n\t\t\t#else\n\t\t\t\tfloat dirDiffuseWeight = max( dot( normal, dirVector ), 0.0 );\n\t\t\t#endif\n\t\t\tdirDiffuse += directionalLightColor[ i ] * diffuse * dirDiffuseWeight;\n\t\t\tvec3 dirHalfVector = normalize( dirVector + viewPosition );\n\t\t\tfloat dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );\n\t\t\tfloat dirSpecularWeight = specularTex.r * max( pow( dirDotNormalHalf, shininess ), 0.0 );\n\t\t\tfloat specularNormalization = ( shininess + 2.0 ) / 8.0;\n\t\t\tvec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( dirVector, dirHalfVector ), 0.0 ), 5.0 );\n\t\t\tdirSpecular += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;\n\t\t}\n\t#endif\n\t#if MAX_HEMI_LIGHTS > 0\n\t\tvec3 hemiDiffuse = vec3( 0.0 );\n\t\tvec3 hemiSpecular = vec3( 0.0 );\n\t\tfor( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\n\t\t\tvec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );\n\t\t\tvec3 lVector = normalize( lDirection.xyz );\n\t\t\tfloat dotProduct = dot( normal, lVector );\n\t\t\tfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\n\t\t\tvec3 hemiColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\n\t\t\themiDiffuse += diffuse * hemiColor;\n\t\t\tvec3 hemiHalfVectorSky = normalize( lVector + viewPosition );\n\t\t\tfloat hemiDotNormalHalfSky = 0.5 * dot( normal, hemiHalfVectorSky ) + 0.5;\n\t\t\tfloat hemiSpecularWeightSky = specularTex.r * max( pow( max( hemiDotNormalHalfSky, 0.0 ), shininess ), 0.0 );\n\t\t\tvec3 lVectorGround = -lVector;\n\t\t\tvec3 hemiHalfVectorGround = normalize( lVectorGround + viewPosition );\n\t\t\tfloat hemiDotNormalHalfGround = 0.5 * dot( normal, hemiHalfVectorGround ) + 0.5;\n\t\t\tfloat hemiSpecularWeightGround = specularTex.r * max( pow( max( hemiDotNormalHalfGround, 0.0 ), shininess ), 0.0 );\n\t\t\tfloat dotProductGround = dot( normal, lVectorGround );\n\t\t\tfloat specularNormalization = ( shininess + 2.0 ) / 8.0;\n\t\t\tvec3 schlickSky = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVector, hemiHalfVectorSky ), 0.0 ), 5.0 );\n\t\t\tvec3 schlickGround = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVectorGround, hemiHalfVectorGround ), 0.0 ), 5.0 );\n\t\t\themiSpecular += hemiColor * specularNormalization * ( schlickSky * hemiSpecularWeightSky * max( dotProduct, 0.0 ) + schlickGround * hemiSpecularWeightGround * max( dotProductGround, 0.0 ) );\n\t\t}\n\t#endif\n\tvec3 totalDiffuse = vec3( 0.0 );\n\tvec3 totalSpecular = vec3( 0.0 );\n\t#if MAX_DIR_LIGHTS > 0\n\t\ttotalDiffuse += dirDiffuse;\n\t\ttotalSpecular += dirSpecular;\n\t#endif\n\t#if MAX_HEMI_LIGHTS > 0\n\t\ttotalDiffuse += hemiDiffuse;\n\t\ttotalSpecular += hemiSpecular;\n\t#endif\n\t#if MAX_POINT_LIGHTS > 0\n\t\ttotalDiffuse += pointDiffuse;\n\t\ttotalSpecular += pointSpecular;\n\t#endif\n\t#if MAX_SPOT_LIGHTS > 0\n\t\ttotalDiffuse += spotDiffuse;\n\t\ttotalSpecular += spotSpecular;\n\t#endif\n\t#ifdef METAL\n\t\tgl_FragColor.xyz = gl_FragColor.xyz * ( totalDiffuse + ambientLightColor * ambient + totalSpecular );\n\t#else\n\t\tgl_FragColor.xyz = gl_FragColor.xyz * ( totalDiffuse + ambientLightColor * ambient ) + totalSpecular;\n\t#endif\n\tif ( enableReflection ) {\n\t\tvec3 vReflect;\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\t\tif ( useRefract ) {\n\t\t\tvReflect = refract( cameraToVertex, normal, refractionRatio );\n\t\t} else {\n\t\t\tvReflect = reflect( cameraToVertex, normal );\n\t\t}\n\t\tvec4 cubeColor = textureCube( tCube, vec3( -vReflect.x, vReflect.yz ) );\n\t\t#ifdef GAMMA_INPUT\n\t\t\tcubeColor.xyz *= cubeColor.xyz;\n\t\t#endif\n\t\tgl_FragColor.xyz = mix( gl_FragColor.xyz, cubeColor.xyz, specularTex.r * reflectivity );\n\t}",
THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n"),vertexShader:["attribute vec4 tangent;\nuniform vec2 uOffset;\nuniform vec2 uRepeat;\nuniform bool enableDisplacement;\n#ifdef VERTEX_TEXTURES\n\tuniform sampler2D tDisplacement;\n\tuniform float uDisplacementScale;\n\tuniform float uDisplacementBias;\n#endif\nvarying vec3 vTangent;\nvarying vec3 vBinormal;\nvarying vec3 vNormal;\nvarying vec2 vUv;\nvarying vec3 vWorldPosition;\nvarying vec3 vViewPosition;",
THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.skinnormal_vertex,"\t#ifdef USE_SKINNING\n\t\tvNormal = normalize( normalMatrix * skinnedNormal.xyz );\n\t\tvec4 skinnedTangent = skinMatrix * vec4( tangent.xyz, 0.0 );\n\t\tvTangent = normalize( normalMatrix * skinnedTangent.xyz );\n\t#else\n\t\tvNormal = normalize( normalMatrix * normal );\n\t\tvTangent = normalize( normalMatrix * tangent.xyz );\n\t#endif\n\tvBinormal = normalize( cross( vNormal, vTangent ) * tangent.w );\n\tvUv = uv * uRepeat + uOffset;\n\tvec3 displacedPosition;\n\t#ifdef VERTEX_TEXTURES\n\t\tif ( enableDisplacement ) {\n\t\t\tvec3 dv = texture2D( tDisplacement, uv ).xyz;\n\t\t\tfloat df = uDisplacementScale * dv.x + uDisplacementBias;\n\t\t\tdisplacedPosition = position + normalize( normal ) * df;\n\t\t} else {\n\t\t\t#ifdef USE_SKINNING\n\t\t\t\tvec4 skinVertex = bindMatrix * vec4( position, 1.0 );\n\t\t\t\tvec4 skinned = vec4( 0.0 );\n\t\t\t\tskinned += boneMatX * skinVertex * skinWeight.x;\n\t\t\t\tskinned += boneMatY * skinVertex * skinWeight.y;\n\t\t\t\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\t\t\t\tskinned += boneMatW * skinVertex * skinWeight.w;\n\t\t\t\tskinned  = bindMatrixInverse * skinned;\n\t\t\t\tdisplacedPosition = skinned.xyz;\n\t\t\t#else\n\t\t\t\tdisplacedPosition = position;\n\t\t\t#endif\n\t\t}\n\t#else\n\t\t#ifdef USE_SKINNING\n\t\t\tvec4 skinVertex = bindMatrix * vec4( position, 1.0 );\n\t\t\tvec4 skinned = vec4( 0.0 );\n\t\t\tskinned += boneMatX * skinVertex * skinWeight.x;\n\t\t\tskinned += boneMatY * skinVertex * skinWeight.y;\n\t\t\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\t\t\tskinned += boneMatW * skinVertex * skinWeight.w;\n\t\t\tskinned  = bindMatrixInverse * skinned;\n\t\t\tdisplacedPosition = skinned.xyz;\n\t\t#else\n\t\t\tdisplacedPosition = position;\n\t\t#endif\n\t#endif\n\tvec4 mvPosition = modelViewMatrix * vec4( displacedPosition, 1.0 );\n\tvec4 worldPosition = modelMatrix * vec4( displacedPosition, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;",
THREE.ShaderChunk.logdepthbuf_vertex,"\tvWorldPosition = worldPosition.xyz;\n\tvViewPosition = -mvPosition.xyz;\n\t#ifdef USE_SHADOWMAP\n\t\tfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\n\t\t\tvShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;\n\t\t}\n\t#endif\n}"].join("\n")},cube:{uniforms:{tCube:{type:"t",value:null},tFlip:{type:"f",value:-1}},vertexShader:["varying vec3 vWorldPosition;",THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {\n\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );\n\tvWorldPosition = worldPosition.xyz;\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );",
THREE.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform samplerCube tCube;\nuniform float tFlip;\nvarying vec3 vWorldPosition;",THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {\n\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );",THREE.ShaderChunk.logdepthbuf_fragment,"}"].join("\n")},depthRGBA:{uniforms:{},vertexShader:[THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.logdepthbuf_pars_vertex,
"void main() {",THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:[THREE.ShaderChunk.logdepthbuf_pars_fragment,"vec4 pack_depth( const in float depth ) {\n\tconst vec4 bit_shift = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );\n\tconst vec4 bit_mask = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );\n\tvec4 res = mod( depth * bit_shift * vec4( 255 ), vec4( 256 ) ) / vec4( 255 );\n\tres -= res.xxyz * bit_mask;\n\treturn res;\n}\nvoid main() {",
THREE.ShaderChunk.logdepthbuf_fragment,"\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tgl_FragData[ 0 ] = pack_depth( gl_FragDepthEXT );\n\t#else\n\t\tgl_FragData[ 0 ] = pack_depth( gl_FragCoord.z );\n\t#endif\n}"].join("\n")}};
THREE.WebGLRenderTarget=function(a,b,c){this.width=a;this.height=b;c=c||{};this.wrapS=void 0!==c.wrapS?c.wrapS:THREE.ClampToEdgeWrapping;this.wrapT=void 0!==c.wrapT?c.wrapT:THREE.ClampToEdgeWrapping;this.magFilter=void 0!==c.magFilter?c.magFilter:THREE.LinearFilter;this.minFilter=void 0!==c.minFilter?c.minFilter:THREE.LinearMipMapLinearFilter;this.anisotropy=void 0!==c.anisotropy?c.anisotropy:1;this.offset=new THREE.Vector2(0,0);this.repeat=new THREE.Vector2(1,1);this.format=void 0!==c.format?c.format:
THREE.RGBAFormat;this.type=void 0!==c.type?c.type:THREE.UnsignedByteType;this.depthBuffer=void 0!==c.depthBuffer?c.depthBuffer:!0;this.stencilBuffer=void 0!==c.stencilBuffer?c.stencilBuffer:!0;this.generateMipmaps=!0;this.shareDepthFrom=null};
THREE.WebGLRenderTarget.prototype={constructor:THREE.WebGLRenderTarget,setSize:function(a,b){this.width=a;this.height=b},clone:function(){var a=new THREE.WebGLRenderTarget(this.width,this.height);a.wrapS=this.wrapS;a.wrapT=this.wrapT;a.magFilter=this.magFilter;a.minFilter=this.minFilter;a.anisotropy=this.anisotropy;a.offset.copy(this.offset);a.repeat.copy(this.repeat);a.format=this.format;a.type=this.type;a.depthBuffer=this.depthBuffer;a.stencilBuffer=this.stencilBuffer;a.generateMipmaps=this.generateMipmaps;
a.shareDepthFrom=this.shareDepthFrom;return a},dispose:function(){this.dispatchEvent({type:"dispose"})}};THREE.EventDispatcher.prototype.apply(THREE.WebGLRenderTarget.prototype);THREE.WebGLRenderTargetCube=function(a,b,c){THREE.WebGLRenderTarget.call(this,a,b,c);this.activeCubeFace=0};THREE.WebGLRenderTargetCube.prototype=Object.create(THREE.WebGLRenderTarget.prototype);
THREE.WebGLExtensions=function(a){var b={};this.get=function(c){if(void 0!==b[c])return b[c];var d;switch(c){case "OES_texture_float":d=a.getExtension("OES_texture_float");break;case "OES_texture_float_linear":d=a.getExtension("OES_texture_float_linear");break;case "OES_standard_derivatives":d=a.getExtension("OES_standard_derivatives");break;case "EXT_texture_filter_anisotropic":d=a.getExtension("EXT_texture_filter_anisotropic")||a.getExtension("MOZ_EXT_texture_filter_anisotropic")||a.getExtension("WEBKIT_EXT_texture_filter_anisotropic");
break;case "WEBGL_compressed_texture_s3tc":d=a.getExtension("WEBGL_compressed_texture_s3tc")||a.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||a.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case "WEBGL_compressed_texture_pvrtc":d=a.getExtension("WEBGL_compressed_texture_pvrtc")||a.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case "OES_element_index_uint":d=a.getExtension("OES_element_index_uint");break;case "EXT_blend_minmax":d=a.getExtension("EXT_blend_minmax");break;
case "EXT_frag_depth":d=a.getExtension("EXT_frag_depth")}null===d&&console.log("THREE.WebGLRenderer: "+c+" extension not supported.");return b[c]=d}};
THREE.WebGLShader=function(){var a=function(a){a=a.split("\n");for(var c=0;c<a.length;c++)a[c]=c+1+": "+a[c];return a.join("\n")};return function(b,c,d){c=b.createShader(c);b.shaderSource(c,d);b.compileShader(c);!1===b.getShaderParameter(c,b.COMPILE_STATUS)&&console.error("THREE.WebGLShader: Shader couldn't compile.");""!==b.getShaderInfoLog(c)&&(console.warn("THREE.WebGLShader: gl.getShaderInfoLog()",b.getShaderInfoLog(c)),console.warn(a(d)));return c}}();
THREE.ShadowMapPlugin=function(a,b,c,d){function f(a,b,d){if(b.visible){var g=c[b.id];if(g&&b.castShadow&&(!1===b.frustumCulled||!0===p.intersectsObject(b)))for(var h=0,k=g.length;h<k;h++){var l=g[h];b._modelViewMatrix.multiplyMatrices(d.matrixWorldInverse,b.matrixWorld);s.push(l)}h=0;for(k=b.children.length;h<k;h++)f(a,b.children[h],d)}}var g=a.context,h,k,l,m,p=new THREE.Frustum,n=new THREE.Matrix4,q=new THREE.Vector3,r=new THREE.Vector3,v=new THREE.Vector3,s=[],w=THREE.ShaderLib.depthRGBA,z=THREE.UniformsUtils.clone(w.uniforms);
h=new THREE.ShaderMaterial({uniforms:z,vertexShader:w.vertexShader,fragmentShader:w.fragmentShader});k=new THREE.ShaderMaterial({uniforms:z,vertexShader:w.vertexShader,fragmentShader:w.fragmentShader,morphTargets:!0});l=new THREE.ShaderMaterial({uniforms:z,vertexShader:w.vertexShader,fragmentShader:w.fragmentShader,skinning:!0});m=new THREE.ShaderMaterial({uniforms:z,vertexShader:w.vertexShader,fragmentShader:w.fragmentShader,morphTargets:!0,skinning:!0});h._shadowPass=!0;k._shadowPass=!0;l._shadowPass=
!0;m._shadowPass=!0;this.render=function(c,A){if(!1!==a.shadowMapEnabled){var z,w,H,J,G,I,M,C,K=[];J=0;g.clearColor(1,1,1,1);g.disable(g.BLEND);g.enable(g.CULL_FACE);g.frontFace(g.CCW);a.shadowMapCullFace===THREE.CullFaceFront?g.cullFace(g.FRONT):g.cullFace(g.BACK);a.setDepthTest(!0);z=0;for(w=b.length;z<w;z++)if(H=b[z],H.castShadow)if(H instanceof THREE.DirectionalLight&&H.shadowCascade)for(G=0;G<H.shadowCascadeCount;G++){var F;if(H.shadowCascadeArray[G])F=H.shadowCascadeArray[G];else{M=H;var B=
G;F=new THREE.DirectionalLight;F.isVirtual=!0;F.onlyShadow=!0;F.castShadow=!0;F.shadowCameraNear=M.shadowCameraNear;F.shadowCameraFar=M.shadowCameraFar;F.shadowCameraLeft=M.shadowCameraLeft;F.shadowCameraRight=M.shadowCameraRight;F.shadowCameraBottom=M.shadowCameraBottom;F.shadowCameraTop=M.shadowCameraTop;F.shadowCameraVisible=M.shadowCameraVisible;F.shadowDarkness=M.shadowDarkness;F.shadowBias=M.shadowCascadeBias[B];F.shadowMapWidth=M.shadowCascadeWidth[B];F.shadowMapHeight=M.shadowCascadeHeight[B];
F.pointsWorld=[];F.pointsFrustum=[];C=F.pointsWorld;I=F.pointsFrustum;for(var R=0;8>R;R++)C[R]=new THREE.Vector3,I[R]=new THREE.Vector3;C=M.shadowCascadeNearZ[B];M=M.shadowCascadeFarZ[B];I[0].set(-1,-1,C);I[1].set(1,-1,C);I[2].set(-1,1,C);I[3].set(1,1,C);I[4].set(-1,-1,M);I[5].set(1,-1,M);I[6].set(-1,1,M);I[7].set(1,1,M);F.originalCamera=A;I=new THREE.Gyroscope;I.position.copy(H.shadowCascadeOffset);I.add(F);I.add(F.target);A.add(I);H.shadowCascadeArray[G]=F;console.log("Created virtualLight",F)}B=
H;C=G;M=B.shadowCascadeArray[C];M.position.copy(B.position);M.target.position.copy(B.target.position);M.lookAt(M.target);M.shadowCameraVisible=B.shadowCameraVisible;M.shadowDarkness=B.shadowDarkness;M.shadowBias=B.shadowCascadeBias[C];I=B.shadowCascadeNearZ[C];B=B.shadowCascadeFarZ[C];M=M.pointsFrustum;M[0].z=I;M[1].z=I;M[2].z=I;M[3].z=I;M[4].z=B;M[5].z=B;M[6].z=B;M[7].z=B;K[J]=F;J++}else K[J]=H,J++;z=0;for(w=K.length;z<w;z++){H=K[z];H.shadowMap||(G=THREE.LinearFilter,a.shadowMapType===THREE.PCFSoftShadowMap&&
(G=THREE.NearestFilter),H.shadowMap=new THREE.WebGLRenderTarget(H.shadowMapWidth,H.shadowMapHeight,{minFilter:G,magFilter:G,format:THREE.RGBAFormat}),H.shadowMapSize=new THREE.Vector2(H.shadowMapWidth,H.shadowMapHeight),H.shadowMatrix=new THREE.Matrix4);if(!H.shadowCamera){if(H instanceof THREE.SpotLight)H.shadowCamera=new THREE.PerspectiveCamera(H.shadowCameraFov,H.shadowMapWidth/H.shadowMapHeight,H.shadowCameraNear,H.shadowCameraFar);else if(H instanceof THREE.DirectionalLight)H.shadowCamera=new THREE.OrthographicCamera(H.shadowCameraLeft,
H.shadowCameraRight,H.shadowCameraTop,H.shadowCameraBottom,H.shadowCameraNear,H.shadowCameraFar);else{console.error("Unsupported light type for shadow");continue}c.add(H.shadowCamera);!0===c.autoUpdate&&c.updateMatrixWorld()}H.shadowCameraVisible&&!H.cameraHelper&&(H.cameraHelper=new THREE.CameraHelper(H.shadowCamera),c.add(H.cameraHelper));if(H.isVirtual&&F.originalCamera==A){G=A;J=H.shadowCamera;I=H.pointsFrustum;M=H.pointsWorld;q.set(Infinity,Infinity,Infinity);r.set(-Infinity,-Infinity,-Infinity);
for(B=0;8>B;B++)C=M[B],C.copy(I[B]),C.unproject(G),C.applyMatrix4(J.matrixWorldInverse),C.x<q.x&&(q.x=C.x),C.x>r.x&&(r.x=C.x),C.y<q.y&&(q.y=C.y),C.y>r.y&&(r.y=C.y),C.z<q.z&&(q.z=C.z),C.z>r.z&&(r.z=C.z);J.left=q.x;J.right=r.x;J.top=r.y;J.bottom=q.y;J.updateProjectionMatrix()}J=H.shadowMap;I=H.shadowMatrix;G=H.shadowCamera;G.position.setFromMatrixPosition(H.matrixWorld);v.setFromMatrixPosition(H.target.matrixWorld);G.lookAt(v);G.updateMatrixWorld();G.matrixWorldInverse.getInverse(G.matrixWorld);H.cameraHelper&&
(H.cameraHelper.visible=H.shadowCameraVisible);H.shadowCameraVisible&&H.cameraHelper.update();I.set(0.5,0,0,0.5,0,0.5,0,0.5,0,0,0.5,0.5,0,0,0,1);I.multiply(G.projectionMatrix);I.multiply(G.matrixWorldInverse);n.multiplyMatrices(G.projectionMatrix,G.matrixWorldInverse);p.setFromMatrix(n);a.setRenderTarget(J);a.clear();s.length=0;f(c,c,G);H=0;for(J=s.length;H<J;H++)M=s[H],I=M.object,M=M.buffer,B=I.material instanceof THREE.MeshFaceMaterial?I.material.materials[0]:I.material,C=void 0!==I.geometry.morphTargets&&
0<I.geometry.morphTargets.length&&B.morphTargets,R=I instanceof THREE.SkinnedMesh&&B.skinning,C=I.customDepthMaterial?I.customDepthMaterial:R?C?m:l:C?k:h,a.setMaterialFaces(B),M instanceof THREE.BufferGeometry?a.renderBufferDirect(G,b,null,C,M,I):a.renderBuffer(G,b,null,C,M,I);H=0;for(J=d.length;H<J;H++)M=d[H],I=M.object,I.visible&&I.castShadow&&(I._modelViewMatrix.multiplyMatrices(G.matrixWorldInverse,I.matrixWorld),a.renderImmediateObject(G,b,null,h,I))}z=a.getClearColor();w=a.getClearAlpha();g.clearColor(z.r,
z.g,z.b,w);g.enable(g.BLEND);a.shadowMapCullFace===THREE.CullFaceFront&&g.cullFace(g.BACK);a.resetGLState()}}};THREE.DDSLoader=function(){this._parser=THREE.DDSLoader.parse};THREE.DDSLoader.prototype=Object.create(THREE.CompressedTextureLoader.prototype);
THREE.DDSLoader.parse=function(a,b){function c(a){return a.charCodeAt(0)+(a.charCodeAt(1)<<8)+(a.charCodeAt(2)<<16)+(a.charCodeAt(3)<<24)}function d(a,b,c,d){var f=c*d*4;a=new Uint8Array(a,b,f);for(var f=new Uint8Array(f),g=b=0,h=0;h<d;h++)for(var k=0;k<c;k++){var l=a[g];g++;var m=a[g];g++;var n=a[g];g++;var p=a[g];g++;f[b]=n;b++;f[b]=m;b++;f[b]=l;b++;f[b]=p;b++}return f}var f={mipmaps:[],width:0,height:0,format:null,mipmapCount:1},g=c("DXT1"),h=c("DXT3"),k=c("DXT5");if(!a||31>a.byteLength)return console.error("THREE.DDSLoader.parse: Invalid DDS header."),
f;var l=new Int32Array(a,0,31);if(542327876!==l[0])return console.error("THREE.DDSLoader.parse: Invalid magic number in DDS header."),f;if(!l[20]&4)return console.error("THREE.DDSLoader.parse: Unsupported format, must contain a FourCC code."),f;var m=l[21],p=!1;switch(m){case g:g=8;f.format=THREE.RGB_S3TC_DXT1_Format;break;case h:g=16;f.format=THREE.RGBA_S3TC_DXT3_Format;break;case k:g=16;f.format=THREE.RGBA_S3TC_DXT5_Format;break;default:if(32==l[22]&&l[23]&16711680&&l[24]&65280&&l[25]&255&&l[26]&
4278190080)p=!0,g=64,f.format=THREE.RGBAFormat;else return console.error("THREE.DDSLoader.parse: Unsupported FourCC code ",String.fromCharCode(m&255,m>>8&255,m>>16&255,m>>24&255)),f}f.mipmapCount=1;l[2]&131072&&!1!==b&&(f.mipmapCount=Math.max(1,l[7]));f.isCubemap=l[28]&512?!0:!1;f.width=l[4];f.height=l[3];for(var l=l[1]+4,h=f.width,k=f.height,m=f.isCubemap?6:1,n=0;n<m;n++){for(var q=0;q<f.mipmapCount;q++){if(p)var r=d(a,l,h,k),v=r.length;else v=Math.max(4,h)/4*Math.max(4,k)/4*g,r=new Uint8Array(a,
l,v);f.mipmaps.push({data:r,width:h,height:k});l+=v;h=Math.max(0.5*h,1);k=Math.max(0.5*k,1)}h=f.width;k=f.height}return f};
THREE.GeometryUtils={merge:function(a,b,c){console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead.");var d;b instanceof THREE.Mesh&&(b.matrixAutoUpdate&&b.updateMatrix(),d=b.matrix,b=b.geometry);a.merge(b,d,c)},center:function(a){console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead.");return a.center()}};
THREE.ImageUtils={crossOrigin:"",loadTexture:function(a,b,c,d){var f=new THREE.ImageLoader;f.crossOrigin=this.crossOrigin;var g=new THREE.Texture(void 0,b);f.load(a,function(a){g.image=a;g.needsUpdate=!0;c&&c(g)},void 0,function(a){d&&d(a)});g.sourceFile=a;return g},loadTextureCube:function(a,b,c,d){var f=new THREE.ImageLoader;f.crossOrigin=this.crossOrigin;var g=new THREE.CubeTexture([],b);g.flipY=!1;var h=0;b=function(b){f.load(a[b],function(a){g.images[b]=a;h+=1;6===h&&(g.needsUpdate=!0,c&&c(g))})};
d=0;for(var k=a.length;d<k;++d)b(d);return g},loadCompressedTexture:function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},loadCompressedTextureCube:function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")},getNormalMap:function(a,b){var c=function(a){var b=Math.sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2]);return[a[0]/b,a[1]/b,a[2]/b]};b|=1;var d=a.width,f=a.height,g=document.createElement("canvas");
g.width=d;g.height=f;var h=g.getContext("2d");h.drawImage(a,0,0);for(var k=h.getImageData(0,0,d,f).data,l=h.createImageData(d,f),m=l.data,p=0;p<d;p++)for(var n=0;n<f;n++){var q=0>n-1?0:n-1,r=n+1>f-1?f-1:n+1,v=0>p-1?0:p-1,s=p+1>d-1?d-1:p+1,w=[],z=[0,0,k[4*(n*d+p)]/255*b];w.push([-1,0,k[4*(n*d+v)]/255*b]);w.push([-1,-1,k[4*(q*d+v)]/255*b]);w.push([0,-1,k[4*(q*d+p)]/255*b]);w.push([1,-1,k[4*(q*d+s)]/255*b]);w.push([1,0,k[4*(n*d+s)]/255*b]);w.push([1,1,k[4*(r*d+s)]/255*b]);w.push([0,1,k[4*(r*d+p)]/255*
b]);w.push([-1,1,k[4*(r*d+v)]/255*b]);q=[];v=w.length;for(r=0;r<v;r++){var s=w[r],D=w[(r+1)%v],s=[s[0]-z[0],s[1]-z[1],s[2]-z[2]],D=[D[0]-z[0],D[1]-z[1],D[2]-z[2]];q.push(c([s[1]*D[2]-s[2]*D[1],s[2]*D[0]-s[0]*D[2],s[0]*D[1]-s[1]*D[0]]))}w=[0,0,0];for(r=0;r<q.length;r++)w[0]+=q[r][0],w[1]+=q[r][1],w[2]+=q[r][2];w[0]/=q.length;w[1]/=q.length;w[2]/=q.length;z=4*(n*d+p);m[z]=(w[0]+1)/2*255|0;m[z+1]=(w[1]+1)/2*255|0;m[z+2]=255*w[2]|0;m[z+3]=255}h.putImageData(l,0,0);return g},generateDataTexture:function(a,
b,c){var d=a*b,f=new Uint8Array(3*d),g=Math.floor(255*c.r),h=Math.floor(255*c.g);c=Math.floor(255*c.b);for(var k=0;k<d;k++)f[3*k]=g,f[3*k+1]=h,f[3*k+2]=c;a=new THREE.DataTexture(f,a,b,THREE.RGBFormat);a.needsUpdate=!0;return a}};
THREE.SceneUtils={createMultiMaterialObject:function(a,b){for(var c=new THREE.Object3D,d=0,f=b.length;d<f;d++)c.add(new THREE.Mesh(a,b[d]));return c},detach:function(a,b,c){a.applyMatrix(b.matrixWorld);b.remove(a);c.add(a)},attach:function(a,b,c){var d=new THREE.Matrix4;d.getInverse(c.matrixWorld);a.applyMatrix(d);b.remove(a);c.add(a)}};
THREE.FontUtils={faces:{},face:"helvetiker",weight:"normal",style:"normal",size:150,divisions:10,getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch(a){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing.";}},loadFace:function(a){var b=a.familyName.toLowerCase();this.faces[b]=this.faces[b]||{};this.faces[b][a.cssFontWeight]=this.faces[b][a.cssFontWeight]||{};this.faces[b][a.cssFontWeight][a.cssFontStyle]=a;return this.faces[b][a.cssFontWeight][a.cssFontStyle]=
a},drawText:function(a){var b=this.getFace(),c=this.size/b.resolution,d=0,f=String(a).split(""),g=f.length,h=[];for(a=0;a<g;a++){var k=new THREE.Path,k=this.extractGlyphPoints(f[a],b,c,d,k),d=d+k.offset;h.push(k.path)}return{paths:h,offset:d/2}},extractGlyphPoints:function(a,b,c,d,f){var g=[],h,k,l,m,p,n,q,r,v,s,w,z=b.glyphs[a]||b.glyphs["?"];if(z){if(z.o)for(b=z._cachedOutline||(z._cachedOutline=z.o.split(" ")),m=b.length,a=0;a<m;)switch(l=b[a++],l){case "m":l=b[a++]*c+d;p=b[a++]*c;f.moveTo(l,p);
break;case "l":l=b[a++]*c+d;p=b[a++]*c;f.lineTo(l,p);break;case "q":l=b[a++]*c+d;p=b[a++]*c;r=b[a++]*c+d;v=b[a++]*c;f.quadraticCurveTo(r,v,l,p);if(h=g[g.length-1])for(n=h.x,q=h.y,h=1,k=this.divisions;h<=k;h++){var D=h/k;THREE.Shape.Utils.b2(D,n,r,l);THREE.Shape.Utils.b2(D,q,v,p)}break;case "b":if(l=b[a++]*c+d,p=b[a++]*c,r=b[a++]*c+d,v=b[a++]*c,s=b[a++]*c+d,w=b[a++]*c,f.bezierCurveTo(r,v,s,w,l,p),h=g[g.length-1])for(n=h.x,q=h.y,h=1,k=this.divisions;h<=k;h++)D=h/k,THREE.Shape.Utils.b3(D,n,r,s,l),THREE.Shape.Utils.b3(D,
q,v,w,p)}return{offset:z.ha*c,path:f}}}};
THREE.FontUtils.generateShapes=function(a,b){b=b||{};var c=void 0!==b.curveSegments?b.curveSegments:4,d=void 0!==b.font?b.font:"helvetiker",f=void 0!==b.weight?b.weight:"normal",g=void 0!==b.style?b.style:"normal";THREE.FontUtils.size=void 0!==b.size?b.size:100;THREE.FontUtils.divisions=c;THREE.FontUtils.face=d;THREE.FontUtils.weight=f;THREE.FontUtils.style=g;c=THREE.FontUtils.drawText(a).paths;d=[];f=0;for(g=c.length;f<g;f++)Array.prototype.push.apply(d,c[f].toShapes());return d};
(function(a){var b=function(a){for(var b=a.length,f=0,g=b-1,h=0;h<b;g=h++)f+=a[g].x*a[h].y-a[h].x*a[g].y;return 0.5*f};a.Triangulate=function(a,d){var f=a.length;if(3>f)return null;var g=[],h=[],k=[],l,m,p;if(0<b(a))for(m=0;m<f;m++)h[m]=m;else for(m=0;m<f;m++)h[m]=f-1-m;var n=2*f;for(m=f-1;2<f;){if(0>=n--){console.log("Warning, unable to triangulate polygon!");break}l=m;f<=l&&(l=0);m=l+1;f<=m&&(m=0);p=m+1;f<=p&&(p=0);var q;a:{var r=void 0,v=void 0,s=void 0,w=void 0,z=void 0,D=void 0,A=void 0,E=void 0,
r=a[h[l]].x,v=a[h[l]].y,s=a[h[m]].x,w=a[h[m]].y,z=a[h[p]].x,D=a[h[p]].y;if(1E-10>(s-r)*(D-v)-(w-v)*(z-r))q=!1;else{var N=void 0,H=void 0,J=void 0,G=void 0,I=void 0,M=void 0,C=void 0,K=void 0,F=void 0,B=void 0,F=K=C=E=A=void 0,N=z-s,H=D-w,J=r-z,G=v-D,I=s-r,M=w-v;for(q=0;q<f;q++)if(A=a[h[q]].x,E=a[h[q]].y,!(A===r&&E===v||A===s&&E===w||A===z&&E===D)&&(C=A-r,K=E-v,F=A-s,B=E-w,A-=z,E-=D,F=N*B-H*F,C=I*K-M*C,K=J*E-G*A,-1E-10<=F&&-1E-10<=K&&-1E-10<=C)){q=!1;break a}q=!0}}if(q){g.push([a[h[l]],a[h[m]],a[h[p]]]);
k.push([h[l],h[m],h[p]]);l=m;for(p=m+1;p<f;l++,p++)h[l]=h[p];f--;n=2*f}}return d?k:g};a.Triangulate.area=b;return a})(THREE.FontUtils);self._typeface_js={faces:THREE.FontUtils.faces,loadFace:THREE.FontUtils.loadFace};THREE.typeface_js=self._typeface_js;
THREE.Audio=function(a){THREE.Object3D.call(this);this.type="Audio";this.context=a.context;this.source=this.context.createBufferSource();this.gain=this.context.createGain();this.gain.connect(this.context.destination);this.panner=this.context.createPanner();this.panner.connect(this.gain)};THREE.Audio.prototype=Object.create(THREE.Object3D.prototype);
THREE.Audio.prototype.load=function(a){var b=this,c=new XMLHttpRequest;c.open("GET",a,!0);c.responseType="arraybuffer";c.onload=function(a){b.context.decodeAudioData(this.response,function(a){b.source.buffer=a;b.source.connect(b.panner);b.source.start(0)})};c.send();return this};THREE.Audio.prototype.setLoop=function(a){this.source.loop=a};THREE.Audio.prototype.setRefDistance=function(a){this.panner.refDistance=a};THREE.Audio.prototype.setRolloffFactor=function(a){this.panner.rolloffFactor=a};
THREE.Audio.prototype.updateMatrixWorld=function(){var a=new THREE.Vector3;return function(b){THREE.Object3D.prototype.updateMatrixWorld.call(this,b);a.setFromMatrixPosition(this.matrixWorld);this.panner.setPosition(a.x,a.y,a.z)}}();THREE.AudioListener=function(){THREE.Object3D.call(this);this.type="AudioListener";this.context=new (window.AudioContext||window.webkitAudioContext)};THREE.AudioListener.prototype=Object.create(THREE.Object3D.prototype);
THREE.AudioListener.prototype.updateMatrixWorld=function(){var a=new THREE.Vector3,b=new THREE.Quaternion,c=new THREE.Vector3,d=new THREE.Vector3,f=new THREE.Vector3,g=new THREE.Vector3;return function(h){THREE.Object3D.prototype.updateMatrixWorld.call(this,h);h=this.context.listener;this.matrixWorld.decompose(a,b,c);d.set(0,0,-1).applyQuaternion(b);f.subVectors(a,g);h.setPosition(a.x,a.y,a.z);h.setOrientation(d.x,d.y,d.z,this.up.x,this.up.y,this.up.z);h.setVelocity(f.x,f.y,f.z);g.copy(a)}}();
THREE.Curve=function(){};THREE.Curve.prototype.getPoint=function(a){console.log("Warning, getPoint() not implemented!");return null};THREE.Curve.prototype.getPointAt=function(a){a=this.getUtoTmapping(a);return this.getPoint(a)};THREE.Curve.prototype.getPoints=function(a){a||(a=5);var b,c=[];for(b=0;b<=a;b++)c.push(this.getPoint(b/a));return c};THREE.Curve.prototype.getSpacedPoints=function(a){a||(a=5);var b,c=[];for(b=0;b<=a;b++)c.push(this.getPointAt(b/a));return c};
THREE.Curve.prototype.getLength=function(){var a=this.getLengths();return a[a.length-1]};THREE.Curve.prototype.getLengths=function(a){a||(a=this.__arcLengthDivisions?this.__arcLengthDivisions:200);if(this.cacheArcLengths&&this.cacheArcLengths.length==a+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var b=[],c,d=this.getPoint(0),f,g=0;b.push(0);for(f=1;f<=a;f++)c=this.getPoint(f/a),g+=c.distanceTo(d),b.push(g),d=c;return this.cacheArcLengths=b};
THREE.Curve.prototype.updateArcLengths=function(){this.needsUpdate=!0;this.getLengths()};THREE.Curve.prototype.getUtoTmapping=function(a,b){var c=this.getLengths(),d=0,f=c.length,g;g=b?b:a*c[f-1];for(var h=0,k=f-1,l;h<=k;)if(d=Math.floor(h+(k-h)/2),l=c[d]-g,0>l)h=d+1;else if(0<l)k=d-1;else{k=d;break}d=k;if(c[d]==g)return d/(f-1);h=c[d];return(d+(g-h)/(c[d+1]-h))/(f-1)};THREE.Curve.prototype.getTangent=function(a){var b=a-1E-4;a+=1E-4;0>b&&(b=0);1<a&&(a=1);b=this.getPoint(b);return this.getPoint(a).clone().sub(b).normalize()};
THREE.Curve.prototype.getTangentAt=function(a){a=this.getUtoTmapping(a);return this.getTangent(a)};
THREE.Curve.Utils={tangentQuadraticBezier:function(a,b,c,d){return 2*(1-a)*(c-b)+2*a*(d-c)},tangentCubicBezier:function(a,b,c,d,f){return-3*b*(1-a)*(1-a)+3*c*(1-a)*(1-a)-6*a*c*(1-a)+6*a*d*(1-a)-3*a*a*d+3*a*a*f},tangentSpline:function(a,b,c,d,f){return 6*a*a-6*a+(3*a*a-4*a+1)+(-6*a*a+6*a)+(3*a*a-2*a)},interpolate:function(a,b,c,d,f){a=0.5*(c-a);d=0.5*(d-b);var g=f*f;return(2*b-2*c+a+d)*f*g+(-3*b+3*c-2*a-d)*g+a*f+b}};
THREE.Curve.create=function(a,b){a.prototype=Object.create(THREE.Curve.prototype);a.prototype.getPoint=b;return a};THREE.CurvePath=function(){this.curves=[];this.bends=[];this.autoClose=!1};THREE.CurvePath.prototype=Object.create(THREE.Curve.prototype);THREE.CurvePath.prototype.add=function(a){this.curves.push(a)};THREE.CurvePath.prototype.checkConnection=function(){};
THREE.CurvePath.prototype.closePath=function(){var a=this.curves[0].getPoint(0),b=this.curves[this.curves.length-1].getPoint(1);a.equals(b)||this.curves.push(new THREE.LineCurve(b,a))};THREE.CurvePath.prototype.getPoint=function(a){var b=a*this.getLength(),c=this.getCurveLengths();for(a=0;a<c.length;){if(c[a]>=b)return b=c[a]-b,a=this.curves[a],b=1-b/a.getLength(),a.getPointAt(b);a++}return null};THREE.CurvePath.prototype.getLength=function(){var a=this.getCurveLengths();return a[a.length-1]};
THREE.CurvePath.prototype.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var a=[],b=0,c,d=this.curves.length;for(c=0;c<d;c++)b+=this.curves[c].getLength(),a.push(b);return this.cacheLengths=a};
THREE.CurvePath.prototype.getBoundingBox=function(){var a=this.getPoints(),b,c,d,f,g,h;b=c=Number.NEGATIVE_INFINITY;f=g=Number.POSITIVE_INFINITY;var k,l,m,p,n=a[0]instanceof THREE.Vector3;p=n?new THREE.Vector3:new THREE.Vector2;l=0;for(m=a.length;l<m;l++)k=a[l],k.x>b?b=k.x:k.x<f&&(f=k.x),k.y>c?c=k.y:k.y<g&&(g=k.y),n&&(k.z>d?d=k.z:k.z<h&&(h=k.z)),p.add(k);a={minX:f,minY:g,maxX:b,maxY:c};n&&(a.maxZ=d,a.minZ=h);return a};
THREE.CurvePath.prototype.createPointsGeometry=function(a){a=this.getPoints(a,!0);return this.createGeometry(a)};THREE.CurvePath.prototype.createSpacedPointsGeometry=function(a){a=this.getSpacedPoints(a,!0);return this.createGeometry(a)};THREE.CurvePath.prototype.createGeometry=function(a){for(var b=new THREE.Geometry,c=0;c<a.length;c++)b.vertices.push(new THREE.Vector3(a[c].x,a[c].y,a[c].z||0));return b};THREE.CurvePath.prototype.addWrapPath=function(a){this.bends.push(a)};
THREE.CurvePath.prototype.getTransformedPoints=function(a,b){var c=this.getPoints(a),d,f;b||(b=this.bends);d=0;for(f=b.length;d<f;d++)c=this.getWrapPoints(c,b[d]);return c};THREE.CurvePath.prototype.getTransformedSpacedPoints=function(a,b){var c=this.getSpacedPoints(a),d,f;b||(b=this.bends);d=0;for(f=b.length;d<f;d++)c=this.getWrapPoints(c,b[d]);return c};
THREE.CurvePath.prototype.getWrapPoints=function(a,b){var c=this.getBoundingBox(),d,f,g,h,k,l;d=0;for(f=a.length;d<f;d++)g=a[d],h=g.x,k=g.y,l=h/c.maxX,l=b.getUtoTmapping(l,h),h=b.getPoint(l),l=b.getTangent(l),l.set(-l.y,l.x).multiplyScalar(k),g.x=h.x+l.x,g.y=h.y+l.y;return a};THREE.Gyroscope=function(){THREE.Object3D.call(this)};THREE.Gyroscope.prototype=Object.create(THREE.Object3D.prototype);
THREE.Gyroscope.prototype.updateMatrixWorld=function(){var a=new THREE.Vector3,b=new THREE.Quaternion,c=new THREE.Vector3,d=new THREE.Vector3,f=new THREE.Quaternion,g=new THREE.Vector3;return function(h){this.matrixAutoUpdate&&this.updateMatrix();if(this.matrixWorldNeedsUpdate||h)this.parent?(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorld.decompose(d,f,g),this.matrix.decompose(a,b,c),this.matrixWorld.compose(d,b,g)):this.matrixWorld.copy(this.matrix),this.matrixWorldNeedsUpdate=
!1,h=!0;for(var k=0,l=this.children.length;k<l;k++)this.children[k].updateMatrixWorld(h)}}();THREE.Path=function(a){THREE.CurvePath.call(this);this.actions=[];a&&this.fromPoints(a)};THREE.Path.prototype=Object.create(THREE.CurvePath.prototype);THREE.PathActions={MOVE_TO:"moveTo",LINE_TO:"lineTo",QUADRATIC_CURVE_TO:"quadraticCurveTo",BEZIER_CURVE_TO:"bezierCurveTo",CSPLINE_THRU:"splineThru",ARC:"arc",ELLIPSE:"ellipse"};
THREE.Path.prototype.fromPoints=function(a){this.moveTo(a[0].x,a[0].y);for(var b=1,c=a.length;b<c;b++)this.lineTo(a[b].x,a[b].y)};THREE.Path.prototype.moveTo=function(a,b){var c=Array.prototype.slice.call(arguments);this.actions.push({action:THREE.PathActions.MOVE_TO,args:c})};
THREE.Path.prototype.lineTo=function(a,b){var c=Array.prototype.slice.call(arguments),d=this.actions[this.actions.length-1].args,d=new THREE.LineCurve(new THREE.Vector2(d[d.length-2],d[d.length-1]),new THREE.Vector2(a,b));this.curves.push(d);this.actions.push({action:THREE.PathActions.LINE_TO,args:c})};
THREE.Path.prototype.quadraticCurveTo=function(a,b,c,d){var f=Array.prototype.slice.call(arguments),g=this.actions[this.actions.length-1].args,g=new THREE.QuadraticBezierCurve(new THREE.Vector2(g[g.length-2],g[g.length-1]),new THREE.Vector2(a,b),new THREE.Vector2(c,d));this.curves.push(g);this.actions.push({action:THREE.PathActions.QUADRATIC_CURVE_TO,args:f})};
THREE.Path.prototype.bezierCurveTo=function(a,b,c,d,f,g){var h=Array.prototype.slice.call(arguments),k=this.actions[this.actions.length-1].args,k=new THREE.CubicBezierCurve(new THREE.Vector2(k[k.length-2],k[k.length-1]),new THREE.Vector2(a,b),new THREE.Vector2(c,d),new THREE.Vector2(f,g));this.curves.push(k);this.actions.push({action:THREE.PathActions.BEZIER_CURVE_TO,args:h})};
THREE.Path.prototype.splineThru=function(a){var b=Array.prototype.slice.call(arguments),c=this.actions[this.actions.length-1].args,c=[new THREE.Vector2(c[c.length-2],c[c.length-1])];Array.prototype.push.apply(c,a);c=new THREE.SplineCurve(c);this.curves.push(c);this.actions.push({action:THREE.PathActions.CSPLINE_THRU,args:b})};THREE.Path.prototype.arc=function(a,b,c,d,f,g){var h=this.actions[this.actions.length-1].args;this.absarc(a+h[h.length-2],b+h[h.length-1],c,d,f,g)};
THREE.Path.prototype.absarc=function(a,b,c,d,f,g){this.absellipse(a,b,c,c,d,f,g)};THREE.Path.prototype.ellipse=function(a,b,c,d,f,g,h){var k=this.actions[this.actions.length-1].args;this.absellipse(a+k[k.length-2],b+k[k.length-1],c,d,f,g,h)};THREE.Path.prototype.absellipse=function(a,b,c,d,f,g,h){var k=Array.prototype.slice.call(arguments),l=new THREE.EllipseCurve(a,b,c,d,f,g,h);this.curves.push(l);l=l.getPoint(1);k.push(l.x);k.push(l.y);this.actions.push({action:THREE.PathActions.ELLIPSE,args:k})};
THREE.Path.prototype.getSpacedPoints=function(a,b){a||(a=40);for(var c=[],d=0;d<a;d++)c.push(this.getPoint(d/a));return c};
THREE.Path.prototype.getPoints=function(a,b){if(this.useSpacedPoints)return console.log("tata"),this.getSpacedPoints(a,b);a=a||12;var c=[],d,f,g,h,k,l,m,p,n,q,r,v,s;d=0;for(f=this.actions.length;d<f;d++)switch(g=this.actions[d],h=g.action,g=g.args,h){case THREE.PathActions.MOVE_TO:c.push(new THREE.Vector2(g[0],g[1]));break;case THREE.PathActions.LINE_TO:c.push(new THREE.Vector2(g[0],g[1]));break;case THREE.PathActions.QUADRATIC_CURVE_TO:k=g[2];l=g[3];n=g[0];q=g[1];0<c.length?(h=c[c.length-1],r=h.x,
v=h.y):(h=this.actions[d-1].args,r=h[h.length-2],v=h[h.length-1]);for(g=1;g<=a;g++)s=g/a,h=THREE.Shape.Utils.b2(s,r,n,k),s=THREE.Shape.Utils.b2(s,v,q,l),c.push(new THREE.Vector2(h,s));break;case THREE.PathActions.BEZIER_CURVE_TO:k=g[4];l=g[5];n=g[0];q=g[1];m=g[2];p=g[3];0<c.length?(h=c[c.length-1],r=h.x,v=h.y):(h=this.actions[d-1].args,r=h[h.length-2],v=h[h.length-1]);for(g=1;g<=a;g++)s=g/a,h=THREE.Shape.Utils.b3(s,r,n,m,k),s=THREE.Shape.Utils.b3(s,v,q,p,l),c.push(new THREE.Vector2(h,s));break;case THREE.PathActions.CSPLINE_THRU:h=
this.actions[d-1].args;s=[new THREE.Vector2(h[h.length-2],h[h.length-1])];h=a*g[0].length;s=s.concat(g[0]);s=new THREE.SplineCurve(s);for(g=1;g<=h;g++)c.push(s.getPointAt(g/h));break;case THREE.PathActions.ARC:k=g[0];l=g[1];q=g[2];m=g[3];h=g[4];n=!!g[5];r=h-m;v=2*a;for(g=1;g<=v;g++)s=g/v,n||(s=1-s),s=m+s*r,h=k+q*Math.cos(s),s=l+q*Math.sin(s),c.push(new THREE.Vector2(h,s));break;case THREE.PathActions.ELLIPSE:for(k=g[0],l=g[1],q=g[2],p=g[3],m=g[4],h=g[5],n=!!g[6],r=h-m,v=2*a,g=1;g<=v;g++)s=g/v,n||
(s=1-s),s=m+s*r,h=k+q*Math.cos(s),s=l+p*Math.sin(s),c.push(new THREE.Vector2(h,s))}d=c[c.length-1];1E-10>Math.abs(d.x-c[0].x)&&1E-10>Math.abs(d.y-c[0].y)&&c.splice(c.length-1,1);b&&c.push(c[0]);return c};
THREE.Path.prototype.toShapes=function(a,b){function c(a){for(var b=[],c=0,d=a.length;c<d;c++){var f=a[c],g=new THREE.Shape;g.actions=f.actions;g.curves=f.curves;b.push(g)}return b}function d(a,b){for(var c=b.length,d=!1,f=c-1,g=0;g<c;f=g++){var h=b[f],k=b[g],l=k.x-h.x,m=k.y-h.y;if(1E-10<Math.abs(m)){if(0>m&&(h=b[g],l=-l,k=b[f],m=-m),!(a.y<h.y||a.y>k.y))if(a.y==h.y){if(a.x==h.x)return!0}else{f=m*(a.x-h.x)-l*(a.y-h.y);if(0==f)return!0;0>f||(d=!d)}}else if(a.y==h.y&&(k.x<=a.x&&a.x<=h.x||h.x<=a.x&&a.x<=
k.x))return!0}return d}var f=function(a){var b,c,d,f,g=[],h=new THREE.Path;b=0;for(c=a.length;b<c;b++)d=a[b],f=d.args,d=d.action,d==THREE.PathActions.MOVE_TO&&0!=h.actions.length&&(g.push(h),h=new THREE.Path),h[d].apply(h,f);0!=h.actions.length&&g.push(h);return g}(this.actions);if(0==f.length)return[];if(!0===b)return c(f);var g,h,k,l=[];if(1==f.length)return h=f[0],k=new THREE.Shape,k.actions=h.actions,k.curves=h.curves,l.push(k),l;var m=!THREE.Shape.Utils.isClockWise(f[0].getPoints()),m=a?!m:m;
k=[];var p=[],n=[],q=0,r;p[q]=void 0;n[q]=[];var v,s;v=0;for(s=f.length;v<s;v++)h=f[v],r=h.getPoints(),g=THREE.Shape.Utils.isClockWise(r),(g=a?!g:g)?(!m&&p[q]&&q++,p[q]={s:new THREE.Shape,p:r},p[q].s.actions=h.actions,p[q].s.curves=h.curves,m&&q++,n[q]=[]):n[q].push({h:h,p:r[0]});if(!p[0])return c(f);if(1<p.length){v=!1;s=[];h=0;for(f=p.length;h<f;h++)k[h]=[];h=0;for(f=p.length;h<f;h++)for(g=n[h],m=0;m<g.length;m++){q=g[m];r=!0;for(var w=0;w<p.length;w++)d(q.p,p[w].p)&&(h!=w&&s.push({froms:h,tos:w,
hole:m}),r?(r=!1,k[w].push(q)):v=!0);r&&k[h].push(q)}0<s.length&&(v||(n=k))}v=0;for(s=p.length;v<s;v++)for(k=p[v].s,l.push(k),h=n[v],f=0,g=h.length;f<g;f++)k.holes.push(h[f].h);return l};THREE.Shape=function(){THREE.Path.apply(this,arguments);this.holes=[]};THREE.Shape.prototype=Object.create(THREE.Path.prototype);THREE.Shape.prototype.extrude=function(a){return new THREE.ExtrudeGeometry(this,a)};THREE.Shape.prototype.makeGeometry=function(a){return new THREE.ShapeGeometry(this,a)};
THREE.Shape.prototype.getPointsHoles=function(a){var b,c=this.holes.length,d=[];for(b=0;b<c;b++)d[b]=this.holes[b].getTransformedPoints(a,this.bends);return d};THREE.Shape.prototype.getSpacedPointsHoles=function(a){var b,c=this.holes.length,d=[];for(b=0;b<c;b++)d[b]=this.holes[b].getTransformedSpacedPoints(a,this.bends);return d};THREE.Shape.prototype.extractAllPoints=function(a){return{shape:this.getTransformedPoints(a),holes:this.getPointsHoles(a)}};
THREE.Shape.prototype.extractPoints=function(a){return this.useSpacedPoints?this.extractAllSpacedPoints(a):this.extractAllPoints(a)};THREE.Shape.prototype.extractAllSpacedPoints=function(a){return{shape:this.getTransformedSpacedPoints(a),holes:this.getSpacedPointsHoles(a)}};
THREE.Shape.Utils={triangulateShape:function(a,b){function c(a,b,c){return a.x!=b.x?a.x<b.x?a.x<=c.x&&c.x<=b.x:b.x<=c.x&&c.x<=a.x:a.y<b.y?a.y<=c.y&&c.y<=b.y:b.y<=c.y&&c.y<=a.y}function d(a,b,d,f,g){var h=b.x-a.x,k=b.y-a.y,l=f.x-d.x,m=f.y-d.y,n=a.x-d.x,p=a.y-d.y,J=k*l-h*m,G=k*n-h*p;if(1E-10<Math.abs(J)){if(0<J){if(0>G||G>J)return[];l=m*n-l*p;if(0>l||l>J)return[]}else{if(0<G||G<J)return[];l=m*n-l*p;if(0<l||l<J)return[]}if(0==l)return!g||0!=G&&G!=J?[a]:[];if(l==J)return!g||0!=G&&G!=J?[b]:[];if(0==G)return[d];
if(G==J)return[f];g=l/J;return[{x:a.x+g*h,y:a.y+g*k}]}if(0!=G||m*n!=l*p)return[];k=0==h&&0==k;l=0==l&&0==m;if(k&&l)return a.x!=d.x||a.y!=d.y?[]:[a];if(k)return c(d,f,a)?[a]:[];if(l)return c(a,b,d)?[d]:[];0!=h?(a.x<b.x?(h=a,l=a.x,k=b,a=b.x):(h=b,l=b.x,k=a,a=a.x),d.x<f.x?(b=d,J=d.x,m=f,d=f.x):(b=f,J=f.x,m=d,d=d.x)):(a.y<b.y?(h=a,l=a.y,k=b,a=b.y):(h=b,l=b.y,k=a,a=a.y),d.y<f.y?(b=d,J=d.y,m=f,d=f.y):(b=f,J=f.y,m=d,d=d.y));return l<=J?a<J?[]:a==J?g?[]:[b]:a<=d?[b,k]:[b,m]:l>d?[]:l==d?g?[]:[h]:a<=d?[h,k]:
[h,m]}function f(a,b,c,d){var f=b.x-a.x,g=b.y-a.y;b=c.x-a.x;c=c.y-a.y;var h=d.x-a.x;d=d.y-a.y;a=f*c-g*b;f=f*d-g*h;return 1E-10<Math.abs(a)?(b=h*c-d*b,0<a?0<=f&&0<=b:0<=f||0<=b):0<f}var g,h,k,l,m,p={};k=a.concat();g=0;for(h=b.length;g<h;g++)Array.prototype.push.apply(k,b[g]);g=0;for(h=k.length;g<h;g++)m=k[g].x+":"+k[g].y,void 0!==p[m]&&console.log("Duplicate point",m),p[m]=g;g=function(a,b){function c(a,b){var d=k.length-1,g=a-1;0>g&&(g=d);var h=a+1;h>d&&(h=0);d=f(k[a],k[g],k[h],l[b]);if(!d)return!1;
d=l.length-1;g=b-1;0>g&&(g=d);h=b+1;h>d&&(h=0);return f(l[b],l[g],l[h],k[a])?!0:!1}function g(a,b){var c,f;for(c=0;c<k.length;c++)if(f=c+1,f%=k.length,f=d(a,b,k[c],k[f],!0),0<f.length)return!0;return!1}function h(a,c){var f,g,k,l;for(f=0;f<m.length;f++)for(g=b[m[f]],k=0;k<g.length;k++)if(l=k+1,l%=g.length,l=d(a,c,g[k],g[l],!0),0<l.length)return!0;return!1}var k=a.concat(),l,m=[],n,p,H,J,G,I=[],M,C,K,F=0;for(n=b.length;F<n;F++)m.push(F);M=0;for(var B=2*m.length;0<m.length;){B--;if(0>B){console.log("Infinite Loop! Holes left:"+
m.length+", Probably Hole outside Shape!");break}for(p=M;p<k.length;p++){H=k[p];n=-1;for(F=0;F<m.length;F++)if(J=m[F],G=H.x+":"+H.y+":"+J,void 0===I[G]){l=b[J];for(C=0;C<l.length;C++)if(J=l[C],c(p,C)&&!g(H,J)&&!h(H,J)){n=C;m.splice(F,1);M=k.slice(0,p+1);J=k.slice(p);C=l.slice(n);K=l.slice(0,n+1);k=M.concat(C).concat(K).concat(J);M=p;break}if(0<=n)break;I[G]=!0}if(0<=n)break}}return k}(a,b);var n=THREE.FontUtils.Triangulate(g,!1);g=0;for(h=n.length;g<h;g++)for(l=n[g],k=0;3>k;k++)m=l[k].x+":"+l[k].y,
m=p[m],void 0!==m&&(l[k]=m);return n.concat()},isClockWise:function(a){return 0>THREE.FontUtils.Triangulate.area(a)},b2p0:function(a,b){var c=1-a;return c*c*b},b2p1:function(a,b){return 2*(1-a)*a*b},b2p2:function(a,b){return a*a*b},b2:function(a,b,c,d){return this.b2p0(a,b)+this.b2p1(a,c)+this.b2p2(a,d)},b3p0:function(a,b){var c=1-a;return c*c*c*b},b3p1:function(a,b){var c=1-a;return 3*c*c*a*b},b3p2:function(a,b){return 3*(1-a)*a*a*b},b3p3:function(a,b){return a*a*a*b},b3:function(a,b,c,d,f){return this.b3p0(a,
b)+this.b3p1(a,c)+this.b3p2(a,d)+this.b3p3(a,f)}};THREE.LineCurve=function(a,b){this.v1=a;this.v2=b};THREE.LineCurve.prototype=Object.create(THREE.Curve.prototype);THREE.LineCurve.prototype.getPoint=function(a){var b=this.v2.clone().sub(this.v1);b.multiplyScalar(a).add(this.v1);return b};THREE.LineCurve.prototype.getPointAt=function(a){return this.getPoint(a)};THREE.LineCurve.prototype.getTangent=function(a){return this.v2.clone().sub(this.v1).normalize()};
THREE.EllipseCurve=function(a,b,c,d,f,g,h){this.aX=a;this.aY=b;this.xRadius=c;this.yRadius=d;this.aStartAngle=f;this.aEndAngle=g;this.aClockwise=h};THREE.EllipseCurve.prototype=Object.create(THREE.Curve.prototype);
THREE.EllipseCurve.prototype.getPoint=function(a){var b=this.aEndAngle-this.aStartAngle;0>b&&(b+=2*Math.PI);b>2*Math.PI&&(b-=2*Math.PI);a=!0===this.aClockwise?this.aEndAngle+(1-a)*(2*Math.PI-b):this.aStartAngle+a*b;b=new THREE.Vector2;b.x=this.aX+this.xRadius*Math.cos(a);b.y=this.aY+this.yRadius*Math.sin(a);return b};THREE.ArcCurve=function(a,b,c,d,f,g){THREE.EllipseCurve.call(this,a,b,c,c,d,f,g)};THREE.ArcCurve.prototype=Object.create(THREE.EllipseCurve.prototype);
THREE.LineCurve3=THREE.Curve.create(function(a,b){this.v1=a;this.v2=b},function(a){var b=new THREE.Vector3;b.subVectors(this.v2,this.v1);b.multiplyScalar(a);b.add(this.v1);return b});
THREE.AnimationHandler={LINEAR:0,CATMULLROM:1,CATMULLROM_FORWARD:2,add:function(){console.warn("THREE.AnimationHandler.add() has been deprecated.")},get:function(){console.warn("THREE.AnimationHandler.get() has been deprecated.")},remove:function(){console.warn("THREE.AnimationHandler.remove() has been deprecated.")},animations:[],init:function(a){if(!0!==a.initialized){for(var b=0;b<a.hierarchy.length;b++){for(var c=0;c<a.hierarchy[b].keys.length;c++)if(0>a.hierarchy[b].keys[c].time&&(a.hierarchy[b].keys[c].time=
0),void 0!==a.hierarchy[b].keys[c].rot&&!(a.hierarchy[b].keys[c].rot instanceof THREE.Quaternion)){var d=a.hierarchy[b].keys[c].rot;a.hierarchy[b].keys[c].rot=(new THREE.Quaternion).fromArray(d)}if(a.hierarchy[b].keys.length&&void 0!==a.hierarchy[b].keys[0].morphTargets){d={};for(c=0;c<a.hierarchy[b].keys.length;c++)for(var f=0;f<a.hierarchy[b].keys[c].morphTargets.length;f++){var g=a.hierarchy[b].keys[c].morphTargets[f];d[g]=-1}a.hierarchy[b].usedMorphTargets=d;for(c=0;c<a.hierarchy[b].keys.length;c++){var h=
{};for(g in d){for(f=0;f<a.hierarchy[b].keys[c].morphTargets.length;f++)if(a.hierarchy[b].keys[c].morphTargets[f]===g){h[g]=a.hierarchy[b].keys[c].morphTargetsInfluences[f];break}f===a.hierarchy[b].keys[c].morphTargets.length&&(h[g]=0)}a.hierarchy[b].keys[c].morphTargetsInfluences=h}}for(c=1;c<a.hierarchy[b].keys.length;c++)a.hierarchy[b].keys[c].time===a.hierarchy[b].keys[c-1].time&&(a.hierarchy[b].keys.splice(c,1),c--);for(c=0;c<a.hierarchy[b].keys.length;c++)a.hierarchy[b].keys[c].index=c}a.initialized=
!0;return a}},parse:function(a){var b=function(a,c){c.push(a);for(var d=0;d<a.children.length;d++)b(a.children[d],c)},c=[];if(a instanceof THREE.SkinnedMesh)for(var d=0;d<a.skeleton.bones.length;d++)c.push(a.skeleton.bones[d]);else b(a,c);return c},play:function(a){-1===this.animations.indexOf(a)&&this.animations.push(a)},stop:function(a){a=this.animations.indexOf(a);-1!==a&&this.animations.splice(a,1)},update:function(a){for(var b=0;b<this.animations.length;b++)this.animations[b].resetBlendWeights();
for(b=0;b<this.animations.length;b++)this.animations[b].update(a)}};THREE.Animation=function(a,b){this.root=a;this.data=THREE.AnimationHandler.init(b);this.hierarchy=THREE.AnimationHandler.parse(a);this.currentTime=0;this.timeScale=1;this.isPlaying=!1;this.loop=!0;this.weight=0;this.interpolationType=THREE.AnimationHandler.LINEAR};THREE.Animation.prototype.keyTypes=["pos","rot","scl"];
THREE.Animation.prototype.play=function(a,b){this.currentTime=void 0!==a?a:0;this.weight=void 0!==b?b:1;this.isPlaying=!0;this.reset();THREE.AnimationHandler.play(this)};THREE.Animation.prototype.stop=function(){this.isPlaying=!1;THREE.AnimationHandler.stop(this)};
THREE.Animation.prototype.reset=function(){for(var a=0,b=this.hierarchy.length;a<b;a++){var c=this.hierarchy[a];c.matrixAutoUpdate=!0;void 0===c.animationCache&&(c.animationCache={animations:{},blending:{positionWeight:0,quaternionWeight:0,scaleWeight:0}});void 0===c.animationCache.animations[this.data.name]&&(c.animationCache.animations[this.data.name]={},c.animationCache.animations[this.data.name].prevKey={pos:0,rot:0,scl:0},c.animationCache.animations[this.data.name].nextKey={pos:0,rot:0,scl:0},
c.animationCache.animations[this.data.name].originalMatrix=c.matrix);for(var c=c.animationCache.animations[this.data.name],d=0;3>d;d++){for(var f=this.keyTypes[d],g=this.data.hierarchy[a].keys[0],h=this.getNextKeyWith(f,a,1);h.time<this.currentTime&&h.index>g.index;)g=h,h=this.getNextKeyWith(f,a,h.index+1);c.prevKey[f]=g;c.nextKey[f]=h}}};
THREE.Animation.prototype.resetBlendWeights=function(){for(var a=0,b=this.hierarchy.length;a<b;a++){var c=this.hierarchy[a];void 0!==c.animationCache&&(c.animationCache.blending.positionWeight=0,c.animationCache.blending.quaternionWeight=0,c.animationCache.blending.scaleWeight=0)}};
THREE.Animation.prototype.update=function(){var a=[],b=new THREE.Vector3,c=new THREE.Vector3,d=new THREE.Quaternion,f=function(a,b){var c=[],d=[],f,n,q,r,v,s;f=(a.length-1)*b;n=Math.floor(f);f-=n;c[0]=0===n?n:n-1;c[1]=n;c[2]=n>a.length-2?n:n+1;c[3]=n>a.length-3?n:n+2;n=a[c[0]];r=a[c[1]];v=a[c[2]];s=a[c[3]];c=f*f;q=f*c;d[0]=g(n[0],r[0],v[0],s[0],f,c,q);d[1]=g(n[1],r[1],v[1],s[1],f,c,q);d[2]=g(n[2],r[2],v[2],s[2],f,c,q);return d},g=function(a,b,c,d,f,g,q){a=0.5*(c-a);d=0.5*(d-b);return(2*(b-c)+a+d)*
q+(-3*(b-c)-2*a-d)*g+a*f+b};return function(g){if(!1!==this.isPlaying&&(this.currentTime+=g*this.timeScale,0!==this.weight)){g=this.data.length;if(this.currentTime>g||0>this.currentTime)if(this.loop)this.currentTime%=g,0>this.currentTime&&(this.currentTime+=g),this.reset();else{this.stop();return}g=0;for(var k=this.hierarchy.length;g<k;g++)for(var l=this.hierarchy[g],m=l.animationCache.animations[this.data.name],p=l.animationCache.blending,n=0;3>n;n++){var q=this.keyTypes[n],r=m.prevKey[q],v=m.nextKey[q];
if(0<this.timeScale&&v.time<=this.currentTime||0>this.timeScale&&r.time>=this.currentTime){r=this.data.hierarchy[g].keys[0];for(v=this.getNextKeyWith(q,g,1);v.time<this.currentTime&&v.index>r.index;)r=v,v=this.getNextKeyWith(q,g,v.index+1);m.prevKey[q]=r;m.nextKey[q]=v}l.matrixAutoUpdate=!0;l.matrixWorldNeedsUpdate=!0;var s=(this.currentTime-r.time)/(v.time-r.time),w=r[q],z=v[q];0>s&&(s=0);1<s&&(s=1);if("pos"===q)if(this.interpolationType===THREE.AnimationHandler.LINEAR)c.x=w[0]+(z[0]-w[0])*s,c.y=
w[1]+(z[1]-w[1])*s,c.z=w[2]+(z[2]-w[2])*s,r=this.weight/(this.weight+p.positionWeight),l.position.lerp(c,r),p.positionWeight+=this.weight;else{if(this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD)a[0]=this.getPrevKeyWith("pos",g,r.index-1).pos,a[1]=w,a[2]=z,a[3]=this.getNextKeyWith("pos",g,v.index+1).pos,s=0.33*s+0.33,v=f(a,s),r=this.weight/(this.weight+p.positionWeight),p.positionWeight+=this.weight,q=l.position,q.x+=(v[0]-
q.x)*r,q.y+=(v[1]-q.y)*r,q.z+=(v[2]-q.z)*r,this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD&&(s=f(a,1.01*s),b.set(s[0],s[1],s[2]),b.sub(q),b.y=0,b.normalize(),s=Math.atan2(b.x,b.z),l.rotation.set(0,s,0))}else"rot"===q?(THREE.Quaternion.slerp(w,z,d,s),0===p.quaternionWeight?(l.quaternion.copy(d),p.quaternionWeight=this.weight):(r=this.weight/(this.weight+p.quaternionWeight),THREE.Quaternion.slerp(l.quaternion,d,l.quaternion,r),p.quaternionWeight+=this.weight)):"scl"===q&&(c.x=w[0]+
(z[0]-w[0])*s,c.y=w[1]+(z[1]-w[1])*s,c.z=w[2]+(z[2]-w[2])*s,r=this.weight/(this.weight+p.scaleWeight),l.scale.lerp(c,r),p.scaleWeight+=this.weight)}return!0}}}();THREE.Animation.prototype.getNextKeyWith=function(a,b,c){var d=this.data.hierarchy[b].keys;for(c=this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD?c<d.length-1?c:d.length-1:c%d.length;c<d.length;c++)if(void 0!==d[c][a])return d[c];return this.data.hierarchy[b].keys[0]};
THREE.Animation.prototype.getPrevKeyWith=function(a,b,c){var d=this.data.hierarchy[b].keys;for(c=this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD?0<c?c:0:0<=c?c:c+d.length;0<=c;c--)if(void 0!==d[c][a])return d[c];return this.data.hierarchy[b].keys[d.length-1]};
THREE.KeyFrameAnimation=function(a){this.root=a.node;this.data=THREE.AnimationHandler.init(a);this.hierarchy=THREE.AnimationHandler.parse(this.root);this.currentTime=0;this.timeScale=0.0010;this.isPlaying=!1;this.loop=this.isPaused=!0;a=0;for(var b=this.hierarchy.length;a<b;a++){var c=this.data.hierarchy[a].sids,d=this.hierarchy[a];if(this.data.hierarchy[a].keys.length&&c){for(var f=0;f<c.length;f++){var g=c[f],h=this.getNextKeyWith(g,a,0);h&&h.apply(g)}d.matrixAutoUpdate=!1;this.data.hierarchy[a].node.updateMatrix();
d.matrixWorldNeedsUpdate=!0}}};
THREE.KeyFrameAnimation.prototype.play=function(a){this.currentTime=void 0!==a?a:0;if(!1===this.isPlaying){this.isPlaying=!0;var b=this.hierarchy.length,c,d;for(a=0;a<b;a++)c=this.hierarchy[a],d=this.data.hierarchy[a],void 0===d.animationCache&&(d.animationCache={},d.animationCache.prevKey=null,d.animationCache.nextKey=null,d.animationCache.originalMatrix=c.matrix),c=this.data.hierarchy[a].keys,c.length&&(d.animationCache.prevKey=c[0],d.animationCache.nextKey=c[1],this.startTime=Math.min(c[0].time,
this.startTime),this.endTime=Math.max(c[c.length-1].time,this.endTime));this.update(0)}this.isPaused=!1;THREE.AnimationHandler.play(this)};THREE.KeyFrameAnimation.prototype.stop=function(){this.isPaused=this.isPlaying=!1;THREE.AnimationHandler.stop(this);for(var a=0;a<this.data.hierarchy.length;a++){var b=this.hierarchy[a],c=this.data.hierarchy[a];if(void 0!==c.animationCache){var d=c.animationCache.originalMatrix;d.copy(b.matrix);b.matrix=d;delete c.animationCache}}};
THREE.KeyFrameAnimation.prototype.update=function(a){if(!1!==this.isPlaying){this.currentTime+=a*this.timeScale;a=this.data.length;!0===this.loop&&this.currentTime>a&&(this.currentTime%=a);this.currentTime=Math.min(this.currentTime,a);a=0;for(var b=this.hierarchy.length;a<b;a++){var c=this.hierarchy[a],d=this.data.hierarchy[a],f=d.keys,d=d.animationCache;if(f.length){var g=d.prevKey,h=d.nextKey;if(h.time<=this.currentTime){for(;h.time<this.currentTime&&h.index>g.index;)g=h,h=f[g.index+1];d.prevKey=
g;d.nextKey=h}h.time>=this.currentTime?g.interpolate(h,this.currentTime):g.interpolate(h,h.time);this.data.hierarchy[a].node.updateMatrix();c.matrixWorldNeedsUpdate=!0}}}};THREE.KeyFrameAnimation.prototype.getNextKeyWith=function(a,b,c){b=this.data.hierarchy[b].keys;for(c%=b.length;c<b.length;c++)if(b[c].hasTarget(a))return b[c];return b[0]};
THREE.KeyFrameAnimation.prototype.getPrevKeyWith=function(a,b,c){b=this.data.hierarchy[b].keys;for(c=0<=c?c:c+b.length;0<=c;c--)if(b[c].hasTarget(a))return b[c];return b[b.length-1]};
THREE.BoxGeometry=function(a,b,c,d,f,g){function h(a,b,c,d,f,g,h,s){var w,z=k.widthSegments,D=k.heightSegments,A=f/2,E=g/2,N=k.vertices.length;if("x"===a&&"y"===b||"y"===a&&"x"===b)w="z";else if("x"===a&&"z"===b||"z"===a&&"x"===b)w="y",D=k.depthSegments;else if("z"===a&&"y"===b||"y"===a&&"z"===b)w="x",z=k.depthSegments;var H=z+1,J=D+1,G=f/z,I=g/D,M=new THREE.Vector3;M[w]=0<h?1:-1;for(f=0;f<J;f++)for(g=0;g<H;g++){var C=new THREE.Vector3;C[a]=(g*G-A)*c;C[b]=(f*I-E)*d;C[w]=h;k.vertices.push(C)}for(f=
0;f<D;f++)for(g=0;g<z;g++)E=g+H*f,a=g+H*(f+1),b=g+1+H*(f+1),c=g+1+H*f,d=new THREE.Vector2(g/z,1-f/D),h=new THREE.Vector2(g/z,1-(f+1)/D),w=new THREE.Vector2((g+1)/z,1-(f+1)/D),A=new THREE.Vector2((g+1)/z,1-f/D),E=new THREE.Face3(E+N,a+N,c+N),E.normal.copy(M),E.vertexNormals.push(M.clone(),M.clone(),M.clone()),E.materialIndex=s,k.faces.push(E),k.faceVertexUvs[0].push([d,h,A]),E=new THREE.Face3(a+N,b+N,c+N),E.normal.copy(M),E.vertexNormals.push(M.clone(),M.clone(),M.clone()),E.materialIndex=s,k.faces.push(E),
k.faceVertexUvs[0].push([h.clone(),w,A.clone()])}THREE.Geometry.call(this);this.type="BoxGeometry";this.parameters={width:a,height:b,depth:c,widthSegments:d,heightSegments:f,depthSegments:g};this.widthSegments=d||1;this.heightSegments=f||1;this.depthSegments=g||1;var k=this;d=a/2;f=b/2;g=c/2;h("z","y",-1,-1,c,b,d,0);h("z","y",1,-1,c,b,-d,1);h("x","z",1,1,a,c,f,2);h("x","z",1,-1,a,c,-f,3);h("x","y",1,-1,a,b,g,4);h("x","y",-1,-1,a,b,-g,5);this.mergeVertices()};THREE.BoxGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.CircleGeometry=function(a,b,c,d){THREE.Geometry.call(this);this.type="CircleGeometry";this.parameters={radius:a,segments:b,thetaStart:c,thetaLength:d};a=a||50;b=void 0!==b?Math.max(3,b):8;c=void 0!==c?c:0;d=void 0!==d?d:2*Math.PI;var f,g=[];f=new THREE.Vector3;var h=new THREE.Vector2(0.5,0.5);this.vertices.push(f);g.push(h);for(f=0;f<=b;f++){var k=new THREE.Vector3,l=c+f/b*d;k.x=a*Math.cos(l);k.y=a*Math.sin(l);this.vertices.push(k);g.push(new THREE.Vector2((k.x/a+1)/2,(k.y/a+1)/2))}c=new THREE.Vector3(0,
0,1);for(f=1;f<=b;f++)this.faces.push(new THREE.Face3(f,f+1,0,[c.clone(),c.clone(),c.clone()])),this.faceVertexUvs[0].push([g[f].clone(),g[f+1].clone(),h.clone()]);this.computeFaceNormals();this.boundingSphere=new THREE.Sphere(new THREE.Vector3,a)};THREE.CircleGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.CubeGeometry=function(a,b,c,d,f,g){console.warn("THREE.CubeGeometry has been renamed to THREE.BoxGeometry.");return new THREE.BoxGeometry(a,b,c,d,f,g)};
THREE.CylinderGeometry=function(a,b,c,d,f,g){THREE.Geometry.call(this);this.type="CylinderGeometry";this.parameters={radiusTop:a,radiusBottom:b,height:c,radialSegments:d,heightSegments:f,openEnded:g};a=void 0!==a?a:20;b=void 0!==b?b:20;c=void 0!==c?c:100;d=d||8;f=f||1;g=void 0!==g?g:!1;var h=c/2,k,l,m=[],p=[];for(l=0;l<=f;l++){var n=[],q=[],r=l/f,v=r*(b-a)+a;for(k=0;k<=d;k++){var s=k/d,w=new THREE.Vector3;w.x=v*Math.sin(s*Math.PI*2);w.y=-r*c+h;w.z=v*Math.cos(s*Math.PI*2);this.vertices.push(w);n.push(this.vertices.length-
1);q.push(new THREE.Vector2(s,1-r))}m.push(n);p.push(q)}c=(b-a)/c;for(k=0;k<d;k++)for(0!==a?(n=this.vertices[m[0][k]].clone(),q=this.vertices[m[0][k+1]].clone()):(n=this.vertices[m[1][k]].clone(),q=this.vertices[m[1][k+1]].clone()),n.setY(Math.sqrt(n.x*n.x+n.z*n.z)*c).normalize(),q.setY(Math.sqrt(q.x*q.x+q.z*q.z)*c).normalize(),l=0;l<f;l++){var r=m[l][k],v=m[l+1][k],s=m[l+1][k+1],w=m[l][k+1],z=n.clone(),D=n.clone(),A=q.clone(),E=q.clone(),N=p[l][k].clone(),H=p[l+1][k].clone(),J=p[l+1][k+1].clone(),
G=p[l][k+1].clone();this.faces.push(new THREE.Face3(r,v,w,[z,D,E]));this.faceVertexUvs[0].push([N,H,G]);this.faces.push(new THREE.Face3(v,s,w,[D.clone(),A,E.clone()]));this.faceVertexUvs[0].push([H.clone(),J,G.clone()])}if(!1===g&&0<a)for(this.vertices.push(new THREE.Vector3(0,h,0)),k=0;k<d;k++)r=m[0][k],v=m[0][k+1],s=this.vertices.length-1,z=new THREE.Vector3(0,1,0),D=new THREE.Vector3(0,1,0),A=new THREE.Vector3(0,1,0),N=p[0][k].clone(),H=p[0][k+1].clone(),J=new THREE.Vector2(H.x,0),this.faces.push(new THREE.Face3(r,
v,s,[z,D,A])),this.faceVertexUvs[0].push([N,H,J]);if(!1===g&&0<b)for(this.vertices.push(new THREE.Vector3(0,-h,0)),k=0;k<d;k++)r=m[l][k+1],v=m[l][k],s=this.vertices.length-1,z=new THREE.Vector3(0,-1,0),D=new THREE.Vector3(0,-1,0),A=new THREE.Vector3(0,-1,0),N=p[l][k+1].clone(),H=p[l][k].clone(),J=new THREE.Vector2(H.x,1),this.faces.push(new THREE.Face3(r,v,s,[z,D,A])),this.faceVertexUvs[0].push([N,H,J]);this.computeFaceNormals()};THREE.CylinderGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.ExtrudeGeometry=function(a,b){"undefined"!==typeof a&&(THREE.Geometry.call(this),this.type="ExtrudeGeometry",a=a instanceof Array?a:[a],this.addShapeList(a,b),this.computeFaceNormals())};THREE.ExtrudeGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.ExtrudeGeometry.prototype.addShapeList=function(a,b){for(var c=a.length,d=0;d<c;d++)this.addShape(a[d],b)};
THREE.ExtrudeGeometry.prototype.addShape=function(a,b){function c(a,b,c){b||console.log("die");return b.clone().multiplyScalar(c).add(a)}function d(a,b,c){var d=1,d=a.x-b.x,f=a.y-b.y,g=c.x-a.x,h=c.y-a.y,k=d*d+f*f;if(1E-10<Math.abs(d*h-f*g)){var l=Math.sqrt(k),m=Math.sqrt(g*g+h*h),k=b.x-f/l;b=b.y+d/l;g=((c.x-h/m-k)*h-(c.y+g/m-b)*g)/(d*h-f*g);c=k+d*g-a.x;a=b+f*g-a.y;d=c*c+a*a;if(2>=d)return new THREE.Vector2(c,a);d=Math.sqrt(d/2)}else a=!1,1E-10<d?1E-10<g&&(a=!0):-1E-10>d?-1E-10>g&&(a=!0):Math.sign(f)==
Math.sign(h)&&(a=!0),a?(c=-f,a=d,d=Math.sqrt(k)):(c=d,a=f,d=Math.sqrt(k/2));return new THREE.Vector2(c/d,a/d)}function f(a,b){var c,d;for(Q=a.length;0<=--Q;){c=Q;d=Q-1;0>d&&(d=a.length-1);for(var f=0,g=r+2*p,f=0;f<g;f++){var h=W*f,k=W*(f+1),l=b+c+h,h=b+d+h,m=b+d+k,k=b+c+k,l=l+K,h=h+K,m=m+K,k=k+K;C.faces.push(new THREE.Face3(l,h,k,null,null,D));C.faces.push(new THREE.Face3(h,m,k,null,null,D));l=A.generateSideWallUV(C,l,h,m,k);C.faceVertexUvs[0].push([l[0],l[1],l[3]]);C.faceVertexUvs[0].push([l[1],
l[2],l[3]])}}}function g(a,b,c){C.vertices.push(new THREE.Vector3(a,b,c))}function h(a,b,c){a+=K;b+=K;c+=K;C.faces.push(new THREE.Face3(a,b,c,null,null,z));a=A.generateTopUV(C,a,b,c);C.faceVertexUvs[0].push(a)}var k=void 0!==b.amount?b.amount:100,l=void 0!==b.bevelThickness?b.bevelThickness:6,m=void 0!==b.bevelSize?b.bevelSize:l-2,p=void 0!==b.bevelSegments?b.bevelSegments:3,n=void 0!==b.bevelEnabled?b.bevelEnabled:!0,q=void 0!==b.curveSegments?b.curveSegments:12,r=void 0!==b.steps?b.steps:1,v=b.extrudePath,
s,w=!1,z=b.material,D=b.extrudeMaterial,A=void 0!==b.UVGenerator?b.UVGenerator:THREE.ExtrudeGeometry.WorldUVGenerator,E,N,H,J;v&&(s=v.getSpacedPoints(r),w=!0,n=!1,E=void 0!==b.frames?b.frames:new THREE.TubeGeometry.FrenetFrames(v,r,!1),N=new THREE.Vector3,H=new THREE.Vector3,J=new THREE.Vector3);n||(m=l=p=0);var G,I,M,C=this,K=this.vertices.length,v=a.extractPoints(q),q=v.shape,F=v.holes;if(v=!THREE.Shape.Utils.isClockWise(q)){q=q.reverse();I=0;for(M=F.length;I<M;I++)G=F[I],THREE.Shape.Utils.isClockWise(G)&&
(F[I]=G.reverse());v=!1}var B=THREE.Shape.Utils.triangulateShape(q,F),R=q;I=0;for(M=F.length;I<M;I++)G=F[I],q=q.concat(G);var Y,S,P,ba,U,W=q.length,aa,V=B.length,v=[],Q=0;P=R.length;Y=P-1;for(S=Q+1;Q<P;Q++,Y++,S++)Y===P&&(Y=0),S===P&&(S=0),v[Q]=d(R[Q],R[Y],R[S]);var ka=[],ca,Z=v.concat();I=0;for(M=F.length;I<M;I++){G=F[I];ca=[];Q=0;P=G.length;Y=P-1;for(S=Q+1;Q<P;Q++,Y++,S++)Y===P&&(Y=0),S===P&&(S=0),ca[Q]=d(G[Q],G[Y],G[S]);ka.push(ca);Z=Z.concat(ca)}for(Y=0;Y<p;Y++){P=Y/p;ba=l*(1-P);S=m*Math.sin(P*
Math.PI/2);Q=0;for(P=R.length;Q<P;Q++)U=c(R[Q],v[Q],S),g(U.x,U.y,-ba);I=0;for(M=F.length;I<M;I++)for(G=F[I],ca=ka[I],Q=0,P=G.length;Q<P;Q++)U=c(G[Q],ca[Q],S),g(U.x,U.y,-ba)}S=m;for(Q=0;Q<W;Q++)U=n?c(q[Q],Z[Q],S):q[Q],w?(H.copy(E.normals[0]).multiplyScalar(U.x),N.copy(E.binormals[0]).multiplyScalar(U.y),J.copy(s[0]).add(H).add(N),g(J.x,J.y,J.z)):g(U.x,U.y,0);for(P=1;P<=r;P++)for(Q=0;Q<W;Q++)U=n?c(q[Q],Z[Q],S):q[Q],w?(H.copy(E.normals[P]).multiplyScalar(U.x),N.copy(E.binormals[P]).multiplyScalar(U.y),
J.copy(s[P]).add(H).add(N),g(J.x,J.y,J.z)):g(U.x,U.y,k/r*P);for(Y=p-1;0<=Y;Y--){P=Y/p;ba=l*(1-P);S=m*Math.sin(P*Math.PI/2);Q=0;for(P=R.length;Q<P;Q++)U=c(R[Q],v[Q],S),g(U.x,U.y,k+ba);I=0;for(M=F.length;I<M;I++)for(G=F[I],ca=ka[I],Q=0,P=G.length;Q<P;Q++)U=c(G[Q],ca[Q],S),w?g(U.x,U.y+s[r-1].y,s[r-1].x+ba):g(U.x,U.y,k+ba)}(function(){if(n){var a;a=0*W;for(Q=0;Q<V;Q++)aa=B[Q],h(aa[2]+a,aa[1]+a,aa[0]+a);a=r+2*p;a*=W;for(Q=0;Q<V;Q++)aa=B[Q],h(aa[0]+a,aa[1]+a,aa[2]+a)}else{for(Q=0;Q<V;Q++)aa=B[Q],h(aa[2],
aa[1],aa[0]);for(Q=0;Q<V;Q++)aa=B[Q],h(aa[0]+W*r,aa[1]+W*r,aa[2]+W*r)}})();(function(){var a=0;f(R,a);a+=R.length;I=0;for(M=F.length;I<M;I++)G=F[I],f(G,a),a+=G.length})()};
THREE.ExtrudeGeometry.WorldUVGenerator={generateTopUV:function(a,b,c,d){a=a.vertices;b=a[b];c=a[c];d=a[d];return[new THREE.Vector2(b.x,b.y),new THREE.Vector2(c.x,c.y),new THREE.Vector2(d.x,d.y)]},generateSideWallUV:function(a,b,c,d,f){a=a.vertices;b=a[b];c=a[c];d=a[d];f=a[f];return 0.01>Math.abs(b.y-c.y)?[new THREE.Vector2(b.x,1-b.z),new THREE.Vector2(c.x,1-c.z),new THREE.Vector2(d.x,1-d.z),new THREE.Vector2(f.x,1-f.z)]:[new THREE.Vector2(b.y,1-b.z),new THREE.Vector2(c.y,1-c.z),new THREE.Vector2(d.y,
1-d.z),new THREE.Vector2(f.y,1-f.z)]}};THREE.ShapeGeometry=function(a,b){THREE.Geometry.call(this);this.type="ShapeGeometry";!1===a instanceof Array&&(a=[a]);this.addShapeList(a,b);this.computeFaceNormals()};THREE.ShapeGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.ShapeGeometry.prototype.addShapeList=function(a,b){for(var c=0,d=a.length;c<d;c++)this.addShape(a[c],b);return this};
THREE.ShapeGeometry.prototype.addShape=function(a,b){void 0===b&&(b={});var c=b.material,d=void 0===b.UVGenerator?THREE.ExtrudeGeometry.WorldUVGenerator:b.UVGenerator,f,g,h,k=this.vertices.length;f=a.extractPoints(void 0!==b.curveSegments?b.curveSegments:12);var l=f.shape,m=f.holes;if(!THREE.Shape.Utils.isClockWise(l))for(l=l.reverse(),f=0,g=m.length;f<g;f++)h=m[f],THREE.Shape.Utils.isClockWise(h)&&(m[f]=h.reverse());var p=THREE.Shape.Utils.triangulateShape(l,m);f=0;for(g=m.length;f<g;f++)h=m[f],
l=l.concat(h);m=l.length;g=p.length;for(f=0;f<m;f++)h=l[f],this.vertices.push(new THREE.Vector3(h.x,h.y,0));for(f=0;f<g;f++)m=p[f],l=m[0]+k,h=m[1]+k,m=m[2]+k,this.faces.push(new THREE.Face3(l,h,m,null,null,c)),this.faceVertexUvs[0].push(d.generateTopUV(this,l,h,m))};
THREE.LatheGeometry=function(a,b,c,d){THREE.Geometry.call(this);this.type="LatheGeometry";this.parameters={points:a,segments:b,phiStart:c,phiLength:d};b=b||12;c=c||0;d=d||2*Math.PI;for(var f=1/(a.length-1),g=1/b,h=0,k=b;h<=k;h++)for(var l=c+h*g*d,m=Math.cos(l),p=Math.sin(l),l=0,n=a.length;l<n;l++){var q=a[l],r=new THREE.Vector3;r.x=m*q.x-p*q.y;r.y=p*q.x+m*q.y;r.z=q.z;this.vertices.push(r)}c=a.length;h=0;for(k=b;h<k;h++)for(l=0,n=a.length-1;l<n;l++){b=p=l+c*h;d=p+c;var m=p+1+c,p=p+1,q=h*g,r=l*f,v=
q+g,s=r+f;this.faces.push(new THREE.Face3(b,d,p));this.faceVertexUvs[0].push([new THREE.Vector2(q,r),new THREE.Vector2(v,r),new THREE.Vector2(q,s)]);this.faces.push(new THREE.Face3(d,m,p));this.faceVertexUvs[0].push([new THREE.Vector2(v,r),new THREE.Vector2(v,s),new THREE.Vector2(q,s)])}this.mergeVertices();this.computeFaceNormals();this.computeVertexNormals()};THREE.LatheGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.PlaneGeometry=function(a,b,c,d){console.info("THREE.PlaneGeometry: Consider using THREE.PlaneBufferGeometry for lower memory footprint.");THREE.Geometry.call(this);this.type="PlaneGeometry";this.parameters={width:a,height:b,widthSegments:c,heightSegments:d};this.fromBufferGeometry(new THREE.PlaneBufferGeometry(a,b,c,d))};THREE.PlaneGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.PlaneBufferGeometry=function(a,b,c,d){THREE.BufferGeometry.call(this);this.type="PlaneBufferGeometry";this.parameters={width:a,height:b,widthSegments:c,heightSegments:d};var f=a/2,g=b/2;c=c||1;d=d||1;var h=c+1,k=d+1,l=a/c,m=b/d;b=new Float32Array(h*k*3);a=new Float32Array(h*k*3);for(var p=new Float32Array(h*k*2),n=0,q=0,r=0;r<k;r++)for(var v=r*m-g,s=0;s<h;s++)b[n]=s*l-f,b[n+1]=-v,a[n+2]=1,p[q]=s/c,p[q+1]=1-r/d,n+=3,q+=2;n=0;f=new (65535<b.length/3?Uint32Array:Uint16Array)(c*d*6);for(r=0;r<d;r++)for(s=
0;s<c;s++)g=s+h*(r+1),k=s+1+h*(r+1),l=s+1+h*r,f[n]=s+h*r,f[n+1]=g,f[n+2]=l,f[n+3]=g,f[n+4]=k,f[n+5]=l,n+=6;this.addAttribute("index",new THREE.BufferAttribute(f,1));this.addAttribute("position",new THREE.BufferAttribute(b,3));this.addAttribute("normal",new THREE.BufferAttribute(a,3));this.addAttribute("uv",new THREE.BufferAttribute(p,2))};THREE.PlaneBufferGeometry.prototype=Object.create(THREE.BufferGeometry.prototype);
THREE.RingGeometry=function(a,b,c,d,f,g){THREE.Geometry.call(this);this.type="RingGeometry";this.parameters={innerRadius:a,outerRadius:b,thetaSegments:c,phiSegments:d,thetaStart:f,thetaLength:g};a=a||0;b=b||50;f=void 0!==f?f:0;g=void 0!==g?g:2*Math.PI;c=void 0!==c?Math.max(3,c):8;d=void 0!==d?Math.max(1,d):8;var h,k=[],l=a,m=(b-a)/d;for(a=0;a<d+1;a++){for(h=0;h<c+1;h++){var p=new THREE.Vector3,n=f+h/c*g;p.x=l*Math.cos(n);p.y=l*Math.sin(n);this.vertices.push(p);k.push(new THREE.Vector2((p.x/b+1)/2,
(p.y/b+1)/2))}l+=m}b=new THREE.Vector3(0,0,1);for(a=0;a<d;a++)for(f=a*(c+1),h=0;h<c;h++)g=n=h+f,m=n+c+1,p=n+c+2,this.faces.push(new THREE.Face3(g,m,p,[b.clone(),b.clone(),b.clone()])),this.faceVertexUvs[0].push([k[g].clone(),k[m].clone(),k[p].clone()]),g=n,m=n+c+2,p=n+1,this.faces.push(new THREE.Face3(g,m,p,[b.clone(),b.clone(),b.clone()])),this.faceVertexUvs[0].push([k[g].clone(),k[m].clone(),k[p].clone()]);this.computeFaceNormals();this.boundingSphere=new THREE.Sphere(new THREE.Vector3,l)};
THREE.RingGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.SphereGeometry=function(a,b,c,d,f,g,h){THREE.Geometry.call(this);this.type="SphereGeometry";this.parameters={radius:a,widthSegments:b,heightSegments:c,phiStart:d,phiLength:f,thetaStart:g,thetaLength:h};a=a||50;b=Math.max(3,Math.floor(b)||8);c=Math.max(2,Math.floor(c)||6);d=void 0!==d?d:0;f=void 0!==f?f:2*Math.PI;g=void 0!==g?g:0;h=void 0!==h?h:Math.PI;var k,l,m=[],p=[];for(l=0;l<=c;l++){var n=[],q=[];for(k=0;k<=b;k++){var r=k/b,v=l/c,s=new THREE.Vector3;s.x=-a*Math.cos(d+r*f)*Math.sin(g+v*h);
s.y=a*Math.cos(g+v*h);s.z=a*Math.sin(d+r*f)*Math.sin(g+v*h);this.vertices.push(s);n.push(this.vertices.length-1);q.push(new THREE.Vector2(r,1-v))}m.push(n);p.push(q)}for(l=0;l<c;l++)for(k=0;k<b;k++){d=m[l][k+1];f=m[l][k];g=m[l+1][k];h=m[l+1][k+1];var n=this.vertices[d].clone().normalize(),q=this.vertices[f].clone().normalize(),r=this.vertices[g].clone().normalize(),v=this.vertices[h].clone().normalize(),s=p[l][k+1].clone(),w=p[l][k].clone(),z=p[l+1][k].clone(),D=p[l+1][k+1].clone();Math.abs(this.vertices[d].y)===
a?(s.x=(s.x+w.x)/2,this.faces.push(new THREE.Face3(d,g,h,[n,r,v])),this.faceVertexUvs[0].push([s,z,D])):Math.abs(this.vertices[g].y)===a?(z.x=(z.x+D.x)/2,this.faces.push(new THREE.Face3(d,f,g,[n,q,r])),this.faceVertexUvs[0].push([s,w,z])):(this.faces.push(new THREE.Face3(d,f,h,[n,q,v])),this.faceVertexUvs[0].push([s,w,D]),this.faces.push(new THREE.Face3(f,g,h,[q.clone(),r,v.clone()])),this.faceVertexUvs[0].push([w.clone(),z,D.clone()]))}this.computeFaceNormals();this.boundingSphere=new THREE.Sphere(new THREE.Vector3,
a)};THREE.SphereGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.TextGeometry=function(a,b){b=b||{};var c=THREE.FontUtils.generateShapes(a,b);b.amount=void 0!==b.height?b.height:50;void 0===b.bevelThickness&&(b.bevelThickness=10);void 0===b.bevelSize&&(b.bevelSize=8);void 0===b.bevelEnabled&&(b.bevelEnabled=!1);THREE.ExtrudeGeometry.call(this,c,b);this.type="TextGeometry"};THREE.TextGeometry.prototype=Object.create(THREE.ExtrudeGeometry.prototype);
THREE.TubeGeometry=function(a,b,c,d,f){THREE.Geometry.call(this);this.type="TubeGeometry";this.parameters={path:a,segments:b,radius:c,radialSegments:d,closed:f};b=b||64;c=c||1;d=d||8;f=f||!1;var g=[],h,k,l=b+1,m,p,n,q,r=new THREE.Vector3,v,s,w;v=new THREE.TubeGeometry.FrenetFrames(a,b,f);s=v.normals;w=v.binormals;this.tangents=v.tangents;this.normals=s;this.binormals=w;for(v=0;v<l;v++)for(g[v]=[],m=v/(l-1),q=a.getPointAt(m),h=s[v],k=w[v],m=0;m<d;m++)p=m/d*2*Math.PI,n=-c*Math.cos(p),p=c*Math.sin(p),
r.copy(q),r.x+=n*h.x+p*k.x,r.y+=n*h.y+p*k.y,r.z+=n*h.z+p*k.z,g[v][m]=this.vertices.push(new THREE.Vector3(r.x,r.y,r.z))-1;for(v=0;v<b;v++)for(m=0;m<d;m++)l=f?(v+1)%b:v+1,r=(m+1)%d,a=g[v][m],c=g[l][m],l=g[l][r],r=g[v][r],s=new THREE.Vector2(v/b,m/d),w=new THREE.Vector2((v+1)/b,m/d),h=new THREE.Vector2((v+1)/b,(m+1)/d),k=new THREE.Vector2(v/b,(m+1)/d),this.faces.push(new THREE.Face3(a,c,r)),this.faceVertexUvs[0].push([s,w,k]),this.faces.push(new THREE.Face3(c,l,r)),this.faceVertexUvs[0].push([w.clone(),
h,k.clone()]);this.computeFaceNormals();this.computeVertexNormals()};THREE.TubeGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.TubeGeometry.FrenetFrames=function(a,b,c){new THREE.Vector3;var d=new THREE.Vector3;new THREE.Vector3;var f=[],g=[],h=[],k=new THREE.Vector3,l=new THREE.Matrix4;b+=1;var m,p,n;this.tangents=f;this.normals=g;this.binormals=h;for(m=0;m<b;m++)p=m/(b-1),f[m]=a.getTangentAt(p),f[m].normalize();g[0]=new THREE.Vector3;h[0]=new THREE.Vector3;a=Number.MAX_VALUE;m=Math.abs(f[0].x);p=Math.abs(f[0].y);n=Math.abs(f[0].z);m<=a&&(a=m,d.set(1,0,0));p<=a&&(a=p,d.set(0,1,0));n<=a&&d.set(0,0,1);k.crossVectors(f[0],
d).normalize();g[0].crossVectors(f[0],k);h[0].crossVectors(f[0],g[0]);for(m=1;m<b;m++)g[m]=g[m-1].clone(),h[m]=h[m-1].clone(),k.crossVectors(f[m-1],f[m]),1E-4<k.length()&&(k.normalize(),d=Math.acos(THREE.Math.clamp(f[m-1].dot(f[m]),-1,1)),g[m].applyMatrix4(l.makeRotationAxis(k,d))),h[m].crossVectors(f[m],g[m]);if(c)for(d=Math.acos(THREE.Math.clamp(g[0].dot(g[b-1]),-1,1)),d/=b-1,0<f[0].dot(k.crossVectors(g[0],g[b-1]))&&(d=-d),m=1;m<b;m++)g[m].applyMatrix4(l.makeRotationAxis(f[m],d*m)),h[m].crossVectors(f[m],
g[m])};
THREE.PolyhedronGeometry=function(a,b,c,d){function f(a){var b=a.normalize().clone();b.index=l.vertices.push(b)-1;var c=Math.atan2(a.z,-a.x)/2/Math.PI+0.5;a=Math.atan2(-a.y,Math.sqrt(a.x*a.x+a.z*a.z))/Math.PI+0.5;b.uv=new THREE.Vector2(c,1-a);return b}function g(a,b,c){var d=new THREE.Face3(a.index,b.index,c.index,[a.clone(),b.clone(),c.clone()]);l.faces.push(d);w.copy(a).add(b).add(c).divideScalar(3);d=Math.atan2(w.z,-w.x);l.faceVertexUvs[0].push([k(a.uv,a,d),k(b.uv,b,d),k(c.uv,c,d)])}function h(a,b){var c=
Math.pow(2,b);Math.pow(4,b);for(var d=f(l.vertices[a.a]),h=f(l.vertices[a.b]),k=f(l.vertices[a.c]),m=[],n=0;n<=c;n++){m[n]=[];for(var p=f(d.clone().lerp(k,n/c)),q=f(h.clone().lerp(k,n/c)),r=c-n,K=0;K<=r;K++)m[n][K]=0==K&&n==c?p:f(p.clone().lerp(q,K/r))}for(n=0;n<c;n++)for(K=0;K<2*(c-n)-1;K++)d=Math.floor(K/2),0==K%2?g(m[n][d+1],m[n+1][d],m[n][d]):g(m[n][d+1],m[n+1][d+1],m[n+1][d])}function k(a,b,c){0>c&&1===a.x&&(a=new THREE.Vector2(a.x-1,a.y));0===b.x&&0===b.z&&(a=new THREE.Vector2(c/2/Math.PI+0.5,
a.y));return a.clone()}THREE.Geometry.call(this);this.type="PolyhedronGeometry";this.parameters={vertices:a,indices:b,radius:c,detail:d};c=c||1;d=d||0;for(var l=this,m=0,p=a.length;m<p;m+=3)f(new THREE.Vector3(a[m],a[m+1],a[m+2]));a=this.vertices;for(var n=[],q=m=0,p=b.length;m<p;m+=3,q++){var r=a[b[m]],v=a[b[m+1]],s=a[b[m+2]];n[q]=new THREE.Face3(r.index,v.index,s.index,[r.clone(),v.clone(),s.clone()])}for(var w=new THREE.Vector3,m=0,p=n.length;m<p;m++)h(n[m],d);m=0;for(p=this.faceVertexUvs[0].length;m<
p;m++)b=this.faceVertexUvs[0][m],d=b[0].x,a=b[1].x,n=b[2].x,q=Math.max(d,Math.max(a,n)),r=Math.min(d,Math.min(a,n)),0.9<q&&0.1>r&&(0.2>d&&(b[0].x+=1),0.2>a&&(b[1].x+=1),0.2>n&&(b[2].x+=1));m=0;for(p=this.vertices.length;m<p;m++)this.vertices[m].multiplyScalar(c);this.mergeVertices();this.computeFaceNormals();this.boundingSphere=new THREE.Sphere(new THREE.Vector3,c)};THREE.PolyhedronGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.AxisHelper=function(a){a=a||1;var b=new Float32Array([0,0,0,a,0,0,0,0,0,0,a,0,0,0,0,0,0,a]),c=new Float32Array([1,0,0,1,0.6,0,0,1,0,0.6,1,0,0,0,1,0,0.6,1]);a=new THREE.BufferGeometry;a.addAttribute("position",new THREE.BufferAttribute(b,3));a.addAttribute("color",new THREE.BufferAttribute(c,3));b=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors});THREE.Line.call(this,a,b,THREE.LinePieces)};THREE.AxisHelper.prototype=Object.create(THREE.Line.prototype);
THREE.ArrowHelper=function(){var a=new THREE.Geometry;a.vertices.push(new THREE.Vector3(0,0,0),new THREE.Vector3(0,1,0));var b=new THREE.CylinderGeometry(0,0.5,1,5,1);b.applyMatrix((new THREE.Matrix4).makeTranslation(0,-0.5,0));return function(c,d,f,g,h,k){THREE.Object3D.call(this);void 0===g&&(g=16776960);void 0===f&&(f=1);void 0===h&&(h=0.2*f);void 0===k&&(k=0.2*h);this.position.copy(d);this.line=new THREE.Line(a,new THREE.LineBasicMaterial({color:g}));this.line.matrixAutoUpdate=!1;this.add(this.line);
this.cone=new THREE.Mesh(b,new THREE.MeshBasicMaterial({color:g}));this.cone.matrixAutoUpdate=!1;this.add(this.cone);this.setDirection(c);this.setLength(f,h,k)}}();THREE.ArrowHelper.prototype=Object.create(THREE.Object3D.prototype);THREE.ArrowHelper.prototype.setDirection=function(){var a=new THREE.Vector3,b;return function(c){0.99999<c.y?this.quaternion.set(0,0,0,1):-0.99999>c.y?this.quaternion.set(1,0,0,0):(a.set(c.z,0,-c.x).normalize(),b=Math.acos(c.y),this.quaternion.setFromAxisAngle(a,b))}}();
THREE.ArrowHelper.prototype.setLength=function(a,b,c){void 0===b&&(b=0.2*a);void 0===c&&(c=0.2*b);this.line.scale.set(1,a,1);this.line.updateMatrix();this.cone.scale.set(c,b,c);this.cone.position.y=a;this.cone.updateMatrix()};THREE.ArrowHelper.prototype.setColor=function(a){this.line.material.color.set(a);this.cone.material.color.set(a)};
THREE.BoxHelper=function(a){var b=new THREE.BufferGeometry;b.addAttribute("position",new THREE.BufferAttribute(new Float32Array(72),3));THREE.Line.call(this,b,new THREE.LineBasicMaterial({color:16776960}),THREE.LinePieces);void 0!==a&&this.update(a)};THREE.BoxHelper.prototype=Object.create(THREE.Line.prototype);
THREE.BoxHelper.prototype.update=function(a){var b=a.geometry;null===b.boundingBox&&b.computeBoundingBox();var c=b.boundingBox.min,b=b.boundingBox.max,d=this.geometry.attributes.position.array;d[0]=b.x;d[1]=b.y;d[2]=b.z;d[3]=c.x;d[4]=b.y;d[5]=b.z;d[6]=c.x;d[7]=b.y;d[8]=b.z;d[9]=c.x;d[10]=c.y;d[11]=b.z;d[12]=c.x;d[13]=c.y;d[14]=b.z;d[15]=b.x;d[16]=c.y;d[17]=b.z;d[18]=b.x;d[19]=c.y;d[20]=b.z;d[21]=b.x;d[22]=b.y;d[23]=b.z;d[24]=b.x;d[25]=b.y;d[26]=c.z;d[27]=c.x;d[28]=b.y;d[29]=c.z;d[30]=c.x;d[31]=b.y;
d[32]=c.z;d[33]=c.x;d[34]=c.y;d[35]=c.z;d[36]=c.x;d[37]=c.y;d[38]=c.z;d[39]=b.x;d[40]=c.y;d[41]=c.z;d[42]=b.x;d[43]=c.y;d[44]=c.z;d[45]=b.x;d[46]=b.y;d[47]=c.z;d[48]=b.x;d[49]=b.y;d[50]=b.z;d[51]=b.x;d[52]=b.y;d[53]=c.z;d[54]=c.x;d[55]=b.y;d[56]=b.z;d[57]=c.x;d[58]=b.y;d[59]=c.z;d[60]=c.x;d[61]=c.y;d[62]=b.z;d[63]=c.x;d[64]=c.y;d[65]=c.z;d[66]=b.x;d[67]=c.y;d[68]=b.z;d[69]=b.x;d[70]=c.y;d[71]=c.z;this.geometry.attributes.position.needsUpdate=!0;this.geometry.computeBoundingSphere();this.matrix=a.matrixWorld;
this.matrixAutoUpdate=!1};THREE.BoundingBoxHelper=function(a,b){var c=void 0!==b?b:8947848;this.object=a;this.box=new THREE.Box3;THREE.Mesh.call(this,new THREE.BoxGeometry(1,1,1),new THREE.MeshBasicMaterial({color:c,wireframe:!0}))};THREE.BoundingBoxHelper.prototype=Object.create(THREE.Mesh.prototype);THREE.BoundingBoxHelper.prototype.update=function(){this.box.setFromObject(this.object);this.box.size(this.scale);this.box.center(this.position)};
THREE.CameraHelper=function(a){function b(a,b,d){c(a,d);c(b,d)}function c(a,b){d.vertices.push(new THREE.Vector3);d.colors.push(new THREE.Color(b));void 0===g[a]&&(g[a]=[]);g[a].push(d.vertices.length-1)}var d=new THREE.Geometry,f=new THREE.LineBasicMaterial({color:16777215,vertexColors:THREE.FaceColors}),g={};b("n1","n2",16755200);b("n2","n4",16755200);b("n4","n3",16755200);b("n3","n1",16755200);b("f1","f2",16755200);b("f2","f4",16755200);b("f4","f3",16755200);b("f3","f1",16755200);b("n1","f1",16755200);
b("n2","f2",16755200);b("n3","f3",16755200);b("n4","f4",16755200);b("p","n1",16711680);b("p","n2",16711680);b("p","n3",16711680);b("p","n4",16711680);b("u1","u2",43775);b("u2","u3",43775);b("u3","u1",43775);b("c","t",16777215);b("p","c",3355443);b("cn1","cn2",3355443);b("cn3","cn4",3355443);b("cf1","cf2",3355443);b("cf3","cf4",3355443);THREE.Line.call(this,d,f,THREE.LinePieces);this.camera=a;this.matrix=a.matrixWorld;this.matrixAutoUpdate=!1;this.pointMap=g;this.update()};
THREE.CameraHelper.prototype=Object.create(THREE.Line.prototype);
THREE.CameraHelper.prototype.update=function(){var a,b,c=new THREE.Vector3,d=new THREE.Camera,f=function(f,h,k,l){c.set(h,k,l).unproject(d);f=b[f];if(void 0!==f)for(h=0,k=f.length;h<k;h++)a.vertices[f[h]].copy(c)};return function(){a=this.geometry;b=this.pointMap;d.projectionMatrix.copy(this.camera.projectionMatrix);f("c",0,0,-1);f("t",0,0,1);f("n1",-1,-1,-1);f("n2",1,-1,-1);f("n3",-1,1,-1);f("n4",1,1,-1);f("f1",-1,-1,1);f("f2",1,-1,1);f("f3",-1,1,1);f("f4",1,1,1);f("u1",0.7,1.1,-1);f("u2",-0.7,1.1,
-1);f("u3",0,2,-1);f("cf1",-1,0,1);f("cf2",1,0,1);f("cf3",0,-1,1);f("cf4",0,1,1);f("cn1",-1,0,-1);f("cn2",1,0,-1);f("cn3",0,-1,-1);f("cn4",0,1,-1);a.verticesNeedUpdate=!0}}();
THREE.DirectionalLightHelper=function(a,b){THREE.Object3D.call(this);this.light=a;this.light.updateMatrixWorld();this.matrix=a.matrixWorld;this.matrixAutoUpdate=!1;b=b||1;var c=new THREE.Geometry;c.vertices.push(new THREE.Vector3(-b,b,0),new THREE.Vector3(b,b,0),new THREE.Vector3(b,-b,0),new THREE.Vector3(-b,-b,0),new THREE.Vector3(-b,b,0));var d=new THREE.LineBasicMaterial({fog:!1});d.color.copy(this.light.color).multiplyScalar(this.light.intensity);this.lightPlane=new THREE.Line(c,d);this.add(this.lightPlane);
c=new THREE.Geometry;c.vertices.push(new THREE.Vector3,new THREE.Vector3);d=new THREE.LineBasicMaterial({fog:!1});d.color.copy(this.light.color).multiplyScalar(this.light.intensity);this.targetLine=new THREE.Line(c,d);this.add(this.targetLine);this.update()};THREE.DirectionalLightHelper.prototype=Object.create(THREE.Object3D.prototype);
THREE.DirectionalLightHelper.prototype.dispose=function(){this.lightPlane.geometry.dispose();this.lightPlane.material.dispose();this.targetLine.geometry.dispose();this.targetLine.material.dispose()};
THREE.DirectionalLightHelper.prototype.update=function(){var a=new THREE.Vector3,b=new THREE.Vector3,c=new THREE.Vector3;return function(){a.setFromMatrixPosition(this.light.matrixWorld);b.setFromMatrixPosition(this.light.target.matrixWorld);c.subVectors(b,a);this.lightPlane.lookAt(c);this.lightPlane.material.color.copy(this.light.color).multiplyScalar(this.light.intensity);this.targetLine.geometry.vertices[1].copy(c);this.targetLine.geometry.verticesNeedUpdate=!0;this.targetLine.material.color.copy(this.lightPlane.material.color)}}();
THREE.EdgesHelper=function(a,b){var c=void 0!==b?b:16777215,d=[0,0],f={},g=function(a,b){return a-b},h=["a","b","c"],k=new THREE.BufferGeometry,l=a.geometry.clone();l.mergeVertices();l.computeFaceNormals();for(var m=l.vertices,l=l.faces,p=0,n=0,q=l.length;n<q;n++)for(var r=l[n],v=0;3>v;v++){d[0]=r[h[v]];d[1]=r[h[(v+1)%3]];d.sort(g);var s=d.toString();void 0===f[s]?(f[s]={vert1:d[0],vert2:d[1],face1:n,face2:void 0},p++):f[s].face2=n}d=new Float32Array(6*p);g=0;for(s in f)if(h=f[s],void 0===h.face2||
0.9999>l[h.face1].normal.dot(l[h.face2].normal))p=m[h.vert1],d[g++]=p.x,d[g++]=p.y,d[g++]=p.z,p=m[h.vert2],d[g++]=p.x,d[g++]=p.y,d[g++]=p.z;k.addAttribute("position",new THREE.BufferAttribute(d,3));THREE.Line.call(this,k,new THREE.LineBasicMaterial({color:c}),THREE.LinePieces);this.matrix=a.matrixWorld;this.matrixAutoUpdate=!1};THREE.EdgesHelper.prototype=Object.create(THREE.Line.prototype);
THREE.FaceNormalsHelper=function(a,b,c,d){this.object=a;this.size=void 0!==b?b:1;a=void 0!==c?c:16776960;d=void 0!==d?d:1;b=new THREE.Geometry;c=0;for(var f=this.object.geometry.faces.length;c<f;c++)b.vertices.push(new THREE.Vector3,new THREE.Vector3);THREE.Line.call(this,b,new THREE.LineBasicMaterial({color:a,linewidth:d}),THREE.LinePieces);this.matrixAutoUpdate=!1;this.normalMatrix=new THREE.Matrix3;this.update()};THREE.FaceNormalsHelper.prototype=Object.create(THREE.Line.prototype);
THREE.FaceNormalsHelper.prototype.update=function(){var a=this.geometry.vertices,b=this.object,c=b.geometry.vertices,d=b.geometry.faces,f=b.matrixWorld;b.updateMatrixWorld(!0);this.normalMatrix.getNormalMatrix(f);for(var g=b=0,h=d.length;b<h;b++,g+=2){var k=d[b];a[g].copy(c[k.a]).add(c[k.b]).add(c[k.c]).divideScalar(3).applyMatrix4(f);a[g+1].copy(k.normal).applyMatrix3(this.normalMatrix).normalize().multiplyScalar(this.size).add(a[g])}this.geometry.verticesNeedUpdate=!0;return this};
THREE.GridHelper=function(a,b){var c=new THREE.Geometry,d=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors});this.color1=new THREE.Color(4473924);this.color2=new THREE.Color(8947848);for(var f=-a;f<=a;f+=b){c.vertices.push(new THREE.Vector3(-a,0,f),new THREE.Vector3(a,0,f),new THREE.Vector3(f,0,-a),new THREE.Vector3(f,0,a));var g=0===f?this.color1:this.color2;c.colors.push(g,g,g,g)}THREE.Line.call(this,c,d,THREE.LinePieces)};THREE.GridHelper.prototype=Object.create(THREE.Line.prototype);
THREE.GridHelper.prototype.setColors=function(a,b){this.color1.set(a);this.color2.set(b);this.geometry.colorsNeedUpdate=!0};
THREE.HemisphereLightHelper=function(a,b,c,d){THREE.Object3D.call(this);this.light=a;this.light.updateMatrixWorld();this.matrix=a.matrixWorld;this.matrixAutoUpdate=!1;this.colors=[new THREE.Color,new THREE.Color];a=new THREE.SphereGeometry(b,4,2);a.applyMatrix((new THREE.Matrix4).makeRotationX(-Math.PI/2));for(b=0;8>b;b++)a.faces[b].color=this.colors[4>b?0:1];b=new THREE.MeshBasicMaterial({vertexColors:THREE.FaceColors,wireframe:!0});this.lightSphere=new THREE.Mesh(a,b);this.add(this.lightSphere);
this.update()};THREE.HemisphereLightHelper.prototype=Object.create(THREE.Object3D.prototype);THREE.HemisphereLightHelper.prototype.dispose=function(){this.lightSphere.geometry.dispose();this.lightSphere.material.dispose()};
THREE.HemisphereLightHelper.prototype.update=function(){var a=new THREE.Vector3;return function(){this.colors[0].copy(this.light.color).multiplyScalar(this.light.intensity);this.colors[1].copy(this.light.groundColor).multiplyScalar(this.light.intensity);this.lightSphere.lookAt(a.setFromMatrixPosition(this.light.matrixWorld).negate());this.lightSphere.geometry.colorsNeedUpdate=!0}}();
THREE.PointLightHelper=function(a,b){this.light=a;this.light.updateMatrixWorld();var c=new THREE.SphereGeometry(b,4,2),d=new THREE.MeshBasicMaterial({wireframe:!0,fog:!1});d.color.copy(this.light.color).multiplyScalar(this.light.intensity);THREE.Mesh.call(this,c,d);this.matrix=this.light.matrixWorld;this.matrixAutoUpdate=!1};THREE.PointLightHelper.prototype=Object.create(THREE.Mesh.prototype);THREE.PointLightHelper.prototype.dispose=function(){this.geometry.dispose();this.material.dispose()};
THREE.PointLightHelper.prototype.update=function(){this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)};
THREE.SkeletonHelper=function(a){this.bones=this.getBoneList(a);for(var b=new THREE.Geometry,c=0;c<this.bones.length;c++)this.bones[c].parent instanceof THREE.Bone&&(b.vertices.push(new THREE.Vector3),b.vertices.push(new THREE.Vector3),b.colors.push(new THREE.Color(0,0,1)),b.colors.push(new THREE.Color(0,1,0)));c=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors,depthTest:!1,depthWrite:!1,transparent:!0});THREE.Line.call(this,b,c,THREE.LinePieces);this.root=a;this.matrix=a.matrixWorld;
this.matrixAutoUpdate=!1;this.update()};THREE.SkeletonHelper.prototype=Object.create(THREE.Line.prototype);THREE.SkeletonHelper.prototype.getBoneList=function(a){var b=[];a instanceof THREE.Bone&&b.push(a);for(var c=0;c<a.children.length;c++)b.push.apply(b,this.getBoneList(a.children[c]));return b};
THREE.SkeletonHelper.prototype.update=function(){for(var a=this.geometry,b=(new THREE.Matrix4).getInverse(this.root.matrixWorld),c=new THREE.Matrix4,d=0,f=0;f<this.bones.length;f++){var g=this.bones[f];g.parent instanceof THREE.Bone&&(c.multiplyMatrices(b,g.matrixWorld),a.vertices[d].setFromMatrixPosition(c),c.multiplyMatrices(b,g.parent.matrixWorld),a.vertices[d+1].setFromMatrixPosition(c),d+=2)}a.verticesNeedUpdate=!0;a.computeBoundingSphere()};
THREE.SpotLightHelper=function(a){THREE.Object3D.call(this);this.light=a;this.light.updateMatrixWorld();this.matrix=a.matrixWorld;this.matrixAutoUpdate=!1;a=new THREE.CylinderGeometry(0,1,1,8,1,!0);a.applyMatrix((new THREE.Matrix4).makeTranslation(0,-0.5,0));a.applyMatrix((new THREE.Matrix4).makeRotationX(-Math.PI/2));var b=new THREE.MeshBasicMaterial({wireframe:!0,fog:!1});this.cone=new THREE.Mesh(a,b);this.add(this.cone);this.update()};THREE.SpotLightHelper.prototype=Object.create(THREE.Object3D.prototype);
THREE.SpotLightHelper.prototype.dispose=function(){this.cone.geometry.dispose();this.cone.material.dispose()};THREE.SpotLightHelper.prototype.update=function(){var a=new THREE.Vector3,b=new THREE.Vector3;return function(){var c=this.light.distance?this.light.distance:1E4,d=c*Math.tan(this.light.angle);this.cone.scale.set(d,d,c);a.setFromMatrixPosition(this.light.matrixWorld);b.setFromMatrixPosition(this.light.target.matrixWorld);this.cone.lookAt(b.sub(a));this.cone.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)}}();
THREE.VertexNormalsHelper=function(a,b,c,d){this.object=a;this.size=void 0!==b?b:1;b=void 0!==c?c:16711680;d=void 0!==d?d:1;c=new THREE.Geometry;a=a.geometry.faces;for(var f=0,g=a.length;f<g;f++)for(var h=0,k=a[f].vertexNormals.length;h<k;h++)c.vertices.push(new THREE.Vector3,new THREE.Vector3);THREE.Line.call(this,c,new THREE.LineBasicMaterial({color:b,linewidth:d}),THREE.LinePieces);this.matrixAutoUpdate=!1;this.normalMatrix=new THREE.Matrix3;this.update()};THREE.VertexNormalsHelper.prototype=Object.create(THREE.Line.prototype);
THREE.VertexNormalsHelper.prototype.update=function(a){var b=new THREE.Vector3;return function(a){a=["a","b","c","d"];this.object.updateMatrixWorld(!0);this.normalMatrix.getNormalMatrix(this.object.matrixWorld);for(var d=this.geometry.vertices,f=this.object.geometry.vertices,g=this.object.geometry.faces,h=this.object.matrixWorld,k=0,l=0,m=g.length;l<m;l++)for(var p=g[l],n=0,q=p.vertexNormals.length;n<q;n++){var r=p.vertexNormals[n];d[k].copy(f[p[a[n]]]).applyMatrix4(h);b.copy(r).applyMatrix3(this.normalMatrix).normalize().multiplyScalar(this.size);
b.add(d[k]);k+=1;d[k].copy(b);k+=1}this.geometry.verticesNeedUpdate=!0;return this}}();
THREE.VertexTangentsHelper=function(a,b,c,d){this.object=a;this.size=void 0!==b?b:1;b=void 0!==c?c:255;d=void 0!==d?d:1;c=new THREE.Geometry;a=a.geometry.faces;for(var f=0,g=a.length;f<g;f++)for(var h=0,k=a[f].vertexTangents.length;h<k;h++)c.vertices.push(new THREE.Vector3),c.vertices.push(new THREE.Vector3);THREE.Line.call(this,c,new THREE.LineBasicMaterial({color:b,linewidth:d}),THREE.LinePieces);this.matrixAutoUpdate=!1;this.update()};THREE.VertexTangentsHelper.prototype=Object.create(THREE.Line.prototype);
THREE.VertexTangentsHelper.prototype.update=function(a){var b=new THREE.Vector3;return function(a){a=["a","b","c","d"];this.object.updateMatrixWorld(!0);for(var d=this.geometry.vertices,f=this.object.geometry.vertices,g=this.object.geometry.faces,h=this.object.matrixWorld,k=0,l=0,m=g.length;l<m;l++)for(var p=g[l],n=0,q=p.vertexTangents.length;n<q;n++){var r=p.vertexTangents[n];d[k].copy(f[p[a[n]]]).applyMatrix4(h);b.copy(r).transformDirection(h).multiplyScalar(this.size);b.add(d[k]);k+=1;d[k].copy(b);
k+=1}this.geometry.verticesNeedUpdate=!0;return this}}();
THREE.WireframeHelper=function(a,b){var c=void 0!==b?b:16777215,d=[0,0],f={},g=function(a,b){return a-b},h=["a","b","c"],k=new THREE.BufferGeometry;if(a.geometry instanceof THREE.Geometry){for(var l=a.geometry.vertices,m=a.geometry.faces,p=0,n=new Uint32Array(6*m.length),q=0,r=m.length;q<r;q++)for(var v=m[q],s=0;3>s;s++){d[0]=v[h[s]];d[1]=v[h[(s+1)%3]];d.sort(g);var w=d.toString();void 0===f[w]&&(n[2*p]=d[0],n[2*p+1]=d[1],f[w]=!0,p++)}d=new Float32Array(6*p);q=0;for(r=p;q<r;q++)for(s=0;2>s;s++)p=
l[n[2*q+s]],h=6*q+3*s,d[h+0]=p.x,d[h+1]=p.y,d[h+2]=p.z;k.addAttribute("position",new THREE.BufferAttribute(d,3))}else if(a.geometry instanceof THREE.BufferGeometry){if(void 0!==a.geometry.attributes.index){l=a.geometry.attributes.position.array;r=a.geometry.attributes.index.array;m=a.geometry.drawcalls;p=0;0===m.length&&(m=[{count:r.length,index:0,start:0}]);for(var n=new Uint32Array(2*r.length),v=0,z=m.length;v<z;++v)for(var s=m[v].start,w=m[v].count,h=m[v].index,q=s,D=s+w;q<D;q+=3)for(s=0;3>s;s++)d[0]=
h+r[q+s],d[1]=h+r[q+(s+1)%3],d.sort(g),w=d.toString(),void 0===f[w]&&(n[2*p]=d[0],n[2*p+1]=d[1],f[w]=!0,p++);d=new Float32Array(6*p);q=0;for(r=p;q<r;q++)for(s=0;2>s;s++)h=6*q+3*s,p=3*n[2*q+s],d[h+0]=l[p],d[h+1]=l[p+1],d[h+2]=l[p+2]}else for(l=a.geometry.attributes.position.array,p=l.length/3,n=p/3,d=new Float32Array(6*p),q=0,r=n;q<r;q++)for(s=0;3>s;s++)h=18*q+6*s,n=9*q+3*s,d[h+0]=l[n],d[h+1]=l[n+1],d[h+2]=l[n+2],p=9*q+(s+1)%3*3,d[h+3]=l[p],d[h+4]=l[p+1],d[h+5]=l[p+2];k.addAttribute("position",new THREE.BufferAttribute(d,
3))}THREE.Line.call(this,k,new THREE.LineBasicMaterial({color:c}),THREE.LinePieces);this.matrix=a.matrixWorld;this.matrixAutoUpdate=!1};THREE.WireframeHelper.prototype=Object.create(THREE.Line.prototype);THREE.ImmediateRenderObject=function(){THREE.Object3D.call(this);this.render=function(a){}};THREE.ImmediateRenderObject.prototype=Object.create(THREE.Object3D.prototype);
THREE.MorphBlendMesh=function(a,b){THREE.Mesh.call(this,a,b);this.animationsMap={};this.animationsList=[];var c=this.geometry.morphTargets.length;this.createAnimation("__default",0,c-1,c/1);this.setAnimationWeight("__default",1)};THREE.MorphBlendMesh.prototype=Object.create(THREE.Mesh.prototype);
THREE.MorphBlendMesh.prototype.createAnimation=function(a,b,c,d){b={startFrame:b,endFrame:c,length:c-b+1,fps:d,duration:(c-b)/d,lastFrame:0,currentFrame:0,active:!1,time:0,direction:1,weight:1,directionBackwards:!1,mirroredLoop:!1};this.animationsMap[a]=b;this.animationsList.push(b)};
THREE.MorphBlendMesh.prototype.autoCreateAnimations=function(a){for(var b=/([a-z]+)_?(\d+)/,c,d={},f=this.geometry,g=0,h=f.morphTargets.length;g<h;g++){var k=f.morphTargets[g].name.match(b);if(k&&1<k.length){var l=k[1];d[l]||(d[l]={start:Infinity,end:-Infinity});k=d[l];g<k.start&&(k.start=g);g>k.end&&(k.end=g);c||(c=l)}}for(l in d)k=d[l],this.createAnimation(l,k.start,k.end,a);this.firstAnimation=c};
THREE.MorphBlendMesh.prototype.setAnimationDirectionForward=function(a){if(a=this.animationsMap[a])a.direction=1,a.directionBackwards=!1};THREE.MorphBlendMesh.prototype.setAnimationDirectionBackward=function(a){if(a=this.animationsMap[a])a.direction=-1,a.directionBackwards=!0};THREE.MorphBlendMesh.prototype.setAnimationFPS=function(a,b){var c=this.animationsMap[a];c&&(c.fps=b,c.duration=(c.end-c.start)/c.fps)};
THREE.MorphBlendMesh.prototype.setAnimationDuration=function(a,b){var c=this.animationsMap[a];c&&(c.duration=b,c.fps=(c.end-c.start)/c.duration)};THREE.MorphBlendMesh.prototype.setAnimationWeight=function(a,b){var c=this.animationsMap[a];c&&(c.weight=b)};THREE.MorphBlendMesh.prototype.setAnimationTime=function(a,b){var c=this.animationsMap[a];c&&(c.time=b)};THREE.MorphBlendMesh.prototype.getAnimationTime=function(a){var b=0;if(a=this.animationsMap[a])b=a.time;return b};
THREE.MorphBlendMesh.prototype.getAnimationDuration=function(a){var b=-1;if(a=this.animationsMap[a])b=a.duration;return b};THREE.MorphBlendMesh.prototype.playAnimation=function(a){var b=this.animationsMap[a];b?(b.time=0,b.active=!0):console.warn("animation["+a+"] undefined")};THREE.MorphBlendMesh.prototype.stopAnimation=function(a){if(a=this.animationsMap[a])a.active=!1};
THREE.MorphBlendMesh.prototype.update=function(a){for(var b=0,c=this.animationsList.length;b<c;b++){var d=this.animationsList[b];if(d.active){var f=d.duration/d.length;d.time+=d.direction*a;if(d.mirroredLoop){if(d.time>d.duration||0>d.time)d.direction*=-1,d.time>d.duration&&(d.time=d.duration,d.directionBackwards=!0),0>d.time&&(d.time=0,d.directionBackwards=!1)}else d.time%=d.duration,0>d.time&&(d.time+=d.duration);var g=d.startFrame+THREE.Math.clamp(Math.floor(d.time/f),0,d.length-1),h=d.weight;
g!==d.currentFrame&&(this.morphTargetInfluences[d.lastFrame]=0,this.morphTargetInfluences[d.currentFrame]=1*h,this.morphTargetInfluences[g]=0,d.lastFrame=d.currentFrame,d.currentFrame=g);f=d.time%f/f;d.directionBackwards&&(f=1-f);this.morphTargetInfluences[d.currentFrame]=f*h;this.morphTargetInfluences[d.lastFrame]=(1-f)*h}}};AutodeskNamespace("Autodesk.Viewing.Private");var VIEWER2D_NAVIGATION_MODE={PAN:1,ZOOM:2};
Autodesk.Viewing.Private.Viewer2DImpl=function(a,b){this.api=a;this.config=b;this.parent=b.domElement;this.navigationMode=null};Autodesk.Viewing.Private.Viewer2DImpl.prototype.constructor=Autodesk.Viewing.Private.Viewer2DImpl;
Autodesk.Viewing.Private.Viewer2DImpl.prototype.initialize=function(){var a=document.createElement("canvas");a.width=1;a.height=1;this.selCtx=a.getContext("2d");this.selCtx.globalCompositeOperation="copy";this.selCtx.imageSmoothingEnabled=!1;this.container=document.createElement("div");this.container.style.width="100%";this.container.style.height="100%";this.parent.appendChild(this.container);return 0};
Autodesk.Viewing.Private.Viewer2DImpl.prototype.load=function(a){var b=this.config.tileSize?this.config.tileSize:1024,c=this.config.maxZoom?this.config.maxZoom:5,d=a.indexOf("urn:");-1!=d&&(a=a.substr(0,d)+encodeURIComponent(a.substr(d)));var d=[a],f=[];for(a=0;a<d.length;a++){var g=L.tileLayer(d[a]+"/{z}/{x}/c{y}.png",{maxZoom:c,noWrap:!0,continuousWorld:!1,detectRetina:!0,tileSize:b});f.push(g)}var h=this.map=L.map(this.container,{center:new L.LatLng(0,0),zoom:0,zoomControl:!1,attributionControl:!1,
layers:[f[0]]});h.options.crs.scale=function(a){return b*Math.pow(2,a)};c={};for(a=0;a<d.length;a++)c[d[a]]=f[3*a];L.control.layers(c,void 0).addTo(h);c=document.getElementsByClassName("leaflet-control-layers");for(a=0;a<c.length;a++)c[a].style.visibility="hidden";h.on("baselayerchange",function(a){console.log(a);var b=[],c;for(c in h._layers){var d=h._layers[c];d!=a.layer&&b.push(d)}for(c=0;c<b.length;c++)h.removeLayer(b[c]);a.layer.idTileLayer&&(h.addLayer(a.layer.idTileLayer),h.addLayer(a.layer.canvasLayer))});
var k=this,l=!1,m,p,n,q,r;this.mousemove=function(a){if(l&&k.navigationMode===VIEWER2D_NAVIGATION_MODE.ZOOM){var b=a.clientX-m,c=a.clientY-p,c=-c;if(2<Math.abs(b)||2<Math.abs(c))b=Math.abs(b)>Math.abs(c)?b:c,b=Math.round(n+b/r),b=Math.max(h.getMinZoom(),Math.min(b,h.getMaxZoom())),h.setZoomAround(q,b,{animate:!0}),a.preventDefault(),a.stopPropagation()}};h.on("mousedown",function(a){l=!0;if(k.navigationMode===VIEWER2D_NAVIGATION_MODE.ZOOM){m=a.originalEvent.clientX;p=a.originalEvent.clientY;n=h.getZoom();
q=h.getCenter();var b=h.getSize(),b=b.x<b.y?b.x:b.y,c=h.getMaxZoom()-h.getMinZoom();r=b/(2*c);h.scrollWheelZoom.disable();window.addEventListener("mousemove",k.mousemove,!1);a.originalEvent.preventDefault();a.originalEvent.stopPropagation()}});h.on("mouseup",function(a){l=!1;k.navigationMode===VIEWER2D_NAVIGATION_MODE.ZOOM&&(h.scrollWheelZoom.enable(),window.removeEventListener("mousemove",k.mousemove,!1),a.originalEvent.preventDefault(),a.originalEvent.stopPropagation())});this.setNavigationMode(VIEWER2D_NAVIGATION_MODE.PAN);
this.keyup=function(a){var b=document.activeElement.nodeName;if("INPUT"!==b&&"TEXTAREA"!==b){b=!1;if(27===a.keyCode)k.api.fireEvent({type:Autodesk.Viewing.ESCAPE_EVENT}),b=!0;else if(36===a.keyCode||70===a.keyCode||72===a.keyCode)k.goHome(),b=!0;b&&(a.preventDefault(),a.stopPropagation())}};window.addEventListener("keyup",this.keyup,!1);h.fitWorld();return!0};
Autodesk.Viewing.Private.Viewer2DImpl.prototype.uninitialize=function(){window.removeEventListener("mousemove",this.mousemove,!1);window.removeEventListener("keyup",this.keyup,!1);this.map.remove()};Autodesk.Viewing.Private.Viewer2DImpl.prototype.resize=function(){this.map.invalidateSize(!1)};
Autodesk.Viewing.Private.Viewer2DImpl.prototype.setNavigationMode=function(a){var b=!1;this.navigationMode!==a&&(this.navigationMode=a,this.map&&(a===VIEWER2D_NAVIGATION_MODE.PAN?(this.map.dragging.enable(),window.removeEventListener("mousemove",this.mousemove,!1)):a===VIEWER2D_NAVIGATION_MODE.ZOOM&&this.map.dragging.disable()),this.api.fireEvent({type:Autodesk.Viewing.NAVIGATION_MODE_CHANGED_EVENT,value:a}),b=!0);return b};
Autodesk.Viewing.Private.Viewer2DImpl.prototype.goHome=function(){this.map.setView([0,0],0,{reset:!0})};AutodeskNamespace("Autodesk.Viewing.Private");Autodesk.Viewing.Private.inWorkerThread="undefined"!==typeof self&&"undefined"===typeof window;Autodesk.Viewing.Private.RefreshTokenHandler=function(){};Autodesk.Viewing.Private.RefreshTokenHandler.prototype.shouldRefreshToken=function(a,b,c){return 401===a};Autodesk.Viewing.Private.RefreshTokenHandler.prototype.refreshToken=function(a,b){};
Autodesk.Viewing.Private.ViewingServiceRefreshTokenHandler=function(){Autodesk.Viewing.Private.RefreshTokenHandler.call(this)};Autodesk.Viewing.Private.ViewingServiceRefreshTokenHandler.prototype=Object.create(Autodesk.Viewing.Private.RefreshTokenHandler.prototype);Autodesk.Viewing.Private.ViewingServiceRefreshTokenHandler.prototype.constructor=Autodesk.Viewing.Private.ViewingServiceRefreshTokenHandler;
Autodesk.Viewing.Private.ViewingServiceRefreshTokenHandler.prototype.shouldRefreshToken=function(a,b,c){b=!1;401===a?(a="string"===typeof c&&""!==c?JSON.parse(c):c,b=""===c||a.hasOwnProperty("errorCode")&&"AUTH-006"===a.errorCode):b=403===a;return b};
Autodesk.Viewing.Private.ViewingServiceRefreshTokenHandler.prototype.refreshToken=function(a,b){var c=null;Autodesk.Viewing.Private.refreshToken&&(c=Autodesk.Viewing.Private.refreshToken());c?0===Autodesk.Viewing.Private.env.indexOf("Autodesk")?Autodesk.Viewing.Private.setApigeeTokenInCookie(c,a,b):Autodesk.Viewing.Private.setAuthTokenInCookie(c,a,b):b&&b(null)};Autodesk.Viewing.Private.WorkerViewingServiceRefreshTokenHandler=function(){Autodesk.Viewing.Private.ViewingServiceRefreshTokenHandler.call(this)};
Autodesk.Viewing.Private.WorkerViewingServiceRefreshTokenHandler.prototype=Object.create(Autodesk.Viewing.Private.ViewingServiceRefreshTokenHandler.prototype);Autodesk.Viewing.Private.WorkerViewingServiceRefreshTokenHandler.prototype.constructor=Autodesk.Viewing.Private.WorkerViewingServiceRefreshTokenHandler;
Autodesk.Viewing.Private.WorkerViewingServiceRefreshTokenHandler.prototype.refreshToken=function(a,b){Autodesk.Viewing.Private.inWorkerThread?(self.addEventListener("message",function(c){c.data&&c.data.tokenRefreshed?a(c):b(c)}),self.postMessage({refreshToken:!0})):Autodesk.Viewing.Private.ViewingServiceRefreshTokenHandler.prototype.refreshToken.call(this,a,b)};Autodesk.Viewing.Private.Xhr=function(a,b){this.request=new XMLHttpRequest;this.withCredentials=a;this.refreshTokenHandler=b};
Autodesk.Viewing.Private.Xhr.prototype.generateUrl=function(a,b){var c=this.getDefaultQueryParameters();b&&(c+="&"+b);c&&(a=a+"?"+c);return a};Autodesk.Viewing.Private.Xhr.prototype.getDefaultHeaders=function(){return{}};Autodesk.Viewing.Private.Xhr.prototype.getDefaultQueryParameters=function(){return""};Autodesk.Viewing.Private.Xhr.prototype.addHeaders=function(a){var b=this.getDefaultHeaders();if(a)for(var c in a)b[c]=a[c];for(var d in b)this.request.setRequestHeader(d,b[d])};
Autodesk.Viewing.Private.Xhr.prototype.get=function(a,b,c,d){var f=this;d=d?d:{};a=f.generateUrl(a,d?d.queryParams:null);try{var g=d.hasOwnProperty("asynchronous")?d.asynchronous:!0;f.request.open("GET",a,g);d.hasOwnProperty("responseType")&&(f.request.responseType=d.responseType);f.request.withCredentials=f.withCredentials;f.addHeaders(d.hasOwnProperty("headers")?d.headers:[]);var h=function(g){(d.hasOwnProperty("retryOnAuthenticationFail")?d.retryOnAuthenticationFail:1)&&f.refreshTokenHandler&&
f.refreshTokenHandler.shouldRefreshToken(f.request.status,f.request.statusText,"text"===f.request.responseType||""===f.request.responseType?f.request.responseText:"")?f.refreshTokenHandler.refreshToken(function(g){f.request=new XMLHttpRequest;d.retryOnAuthenticationFail=!1;f.get(a,b,c,d)},function(b){c(f.request.status,f.request.statusText,{url:a})}):c(f.request.status,f.request.statusText,{url:a})},k=function(a){200===f.request.status?b(f.request.response?f.request.response:f.request.responseText):
h(a)};g&&(f.request.onload=k,f.request.onerror=h,f.request.ontimeout=h);f.request.send();g||k(null)}catch(l){c(f.request.status,f.request.statusText,{url:a,exception:l})}};
Autodesk.Viewing.Private.ViewingServiceXhr=function(a,b,c){var d=c&&c.hasOwnProperty("refreshTokenHandler")?c.refreshTokenHandler:new Autodesk.Viewing.Private.WorkerViewingServiceRefreshTokenHandler;this.withCredentials=!0;c&&c.hasOwnProperty("withCredentials")&&(this.withCredentials=c.withCredentials);Autodesk.Viewing.Private.Xhr.call(this,this.withCredentials,d);this.api=b;this.baseUrl=a;this.options=c};Autodesk.Viewing.Private.ViewingServiceXhr.prototype=Object.create(Autodesk.Viewing.Private.Xhr.prototype);
Autodesk.Viewing.Private.ViewingServiceXhr.prototype.constructor=Autodesk.Viewing.Private.ViewingServiceXhr;
Autodesk.Viewing.Private.ViewingServiceXhr.prototype.generateUrl=function(a,b){if(0===a.indexOf("urn:")){"items"!==this.api&&(a=a.substr(4));var c=this.options&&this.options.hasOwnProperty("encodeUrn")?this.options.encodeUrn:!0;a="bubbles"===this.api&&0==Autodesk.Viewing.Private.env.indexOf("Autodesk")?this.baseUrl+"/"+(c?encodeURIComponent(a):a):this.baseUrl+"/"+this.api+"/"+(c?encodeURIComponent(a):a)}return Autodesk.Viewing.Private.Xhr.prototype.generateUrl.call(this,a,b)};
var Xhr=function(){var a=function(a,c,d){this.xhr=new XMLHttpRequest;this.errorHandler=a;this.success=!1;this.viewing_url=d;this.auth=c};a.prototype.generateUrl=function(a,c,d){var f=a.indexOf("urn:");0===f&&this.viewing_url&&((d=d&&d.feature?d.feature:null)?"render"==d?(a=a.substr(4),a=this.viewing_url+"/"+d+"/"+encodeURIComponent(a)):"bubbles"==d?(a=a.substr(4),a=this.viewing_url+"/"+d+"/"+encodeURIComponent(a)):"comments"==d?(a=a.substr(4),a=this.viewing_url+"/"+d+"/file/"+encodeURIComponent(a)):
a=this.viewing_url+"/"+d+"/"+encodeURIComponent(a.substr(f)):a=this.viewing_url+"/items/"+encodeURIComponent(a.substr(f)));c&&(a=a+"?"+c);return a};a.prototype.addHeaders=function(a){for(var c in a)this.xhr.setRequestHeader(c,a[c])};a.prototype.get=function(a,c,d,f,g,h){a=this.generateUrl(a,h,{feature:g});try{this.xhr.open("GET",a,!!f),this.xhr.responseType=d,this.success=!1,this.auth&&(this.xhr.withCredentials=!0),f&&(this.xhr.onload=f),this.addHeaders(c),this.xhr.send()}catch(k){return this.errorHandler&&
this.errorHandler.networkFailure(a,k),null}this.errorCheck(a,200);return this.xhr.response};a.prototype.post=function(a,c,d,f,g,h){a=this.generateUrl(a,null,{feature:h});c["Content-Type"]||(c["Content-Type"]="application/json");try{this.xhr.open("POST",a,!!g),this.xhr.responseType=f,this.success=!1,this.auth&&(this.xhr.withCredentials=!0),g&&(this.xhr.onload=g),this.addHeaders(c),this.xhr.send(d)}catch(k){return this.errorHandler&&this.errorHandler.networkFailure(a,k),null}this.errorCheck(a,200,201);
return this.xhr.response};a.prototype.getRange=function(a,c,d,f,g,h){a=this.generateUrl(path);c.Range="bytes="+f+"-"+g;try{this.xhr.open("GET",a,!!h),this.xhr.responseType=d,this.success=!1,this.auth&&(this.xhr.withCredentials=!0),h&&(this.xhr.onload=h),this.addHeaders(c),this.xhr.send()}catch(k){return this.errorHandler&&this.errorHandler.networkFailure(a,k),null}this.errorCheck(a,206);return this.xhr.response};a.prototype.head=function(a){a=this.generateUrl(path);try{this.xhr.open("GET",a,!1),this.success=
!1,this.auth&&(this.xhr.withCredentials=!0),this.addHeaders([]),this.xhr.send()}catch(c){return this.errorHandler&&this.errorHandler.networkFailure(a,c),null}this.errorCheck(a,200);a=[];a["Accept-Ranges"]=this.xhr.getResponseHeader("Accept-Ranges");a["Content-Length"]=this.xhr.getResponseHeader("Content-Length");return a};a.prototype.errorCheck=function(a,c){if(4===this.xhr.readyState&&this.xhr.status){var d;for(d=1;d<arguments.length&&this.xhr.status!==arguments[d];d++);d===arguments.length&&this.errorHandler?
this.errorHandler.unsuccessfulResponse(a,this.xhr.status,this.xhr.statusText):this.success=!0}else this.success=!0};return a}(),XhrErrorHandler=function(){var a=function(a){this.host=a;this.ignoreFileNotFound=!1};a.prototype.networkFailure=function(a,c){this.host.raiseError(Autodesk.Viewing.ErrorCodes.NETWORK_FAILURE,"Network failure",{url:a,exception:c.toString(),stack:c.stack})};a.prototype.unsuccessfulResponse=function(a,c,d){403==c?this.host.raiseError(Autodesk.Viewing.ErrorCodes.NETWORK_ACCESS_DENIED,
"Access denied to remote resource",{url:a,httpStatus:c,httpStatusText:d}):404==c?this.ignoreFileNotFound||this.host.raiseError(Autodesk.Viewing.ErrorCodes.NETWORK_FILE_NOT_FOUND,"Remote resource not found",{url:a,httpStatus:c,httpStatusText:d}):500<=c&&600>c?this.host.raiseError(Autodesk.Viewing.ErrorCodes.NETWORK_SERVER_ERROR,"Server error when accessing resource",{url:a,httpStatus:c,httpStatusText:d}):this.host.raiseError(Autodesk.Viewing.ErrorCodes.NETWORK_UNHANDLED_RESPONSE_CODE,"Unhandled response code from server",
{url:a,httpStatus:c,httpStatusText:d})};return a}();
if("undefined"!==typeof window){var RTCPeerConnection=null,getUserMedia=null,attachMediaStream=null,reattachMediaStream=null,webrtcDetectedBrowser=null,webrtcDetectedVersion=null,trace=function(a){"\n"==a[a.length-1]&&(a=a.substring(0,a.length-1));console.log((performance.now()/1E3).toFixed(3)+": "+a)};navigator.mozGetUserMedia?(webrtcDetectedBrowser="firefox",webrtcDetectedVersion=parseInt(navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]),RTCPeerConnection=mozRTCPeerConnection,RTCSessionDescription=
mozRTCSessionDescription,RTCIceCandidate=mozRTCIceCandidate,getUserMedia=navigator.mozGetUserMedia.bind(navigator),createIceServer=function(a,b,c){var d=null,f=a.split(":");0===f[0].indexOf("stun")?d={url:a}:0!==f[0].indexOf("turn")||-1===a.indexOf("transport=udp")&&-1!==a.indexOf("?transport")||(d={url:a.split("?")[0],credential:c,username:b});return d},attachMediaStream=function(a,b){console.log("Attaching media stream");a.mozSrcObject=b;a.play()},reattachMediaStream=function(a,b){console.log("Reattaching media stream");
a.mozSrcObject=b.mozSrcObject;a.play()},MediaStream.prototype.getVideoTracks=function(){return[]},MediaStream.prototype.getAudioTracks=function(){return[]}):navigator.webkitGetUserMedia?(webrtcDetectedBrowser="chrome",webrtcDetectedVersion=parseInt(navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./)[2]),createIceServer=function(a,b,c){var d=null,f=a.split(":");0===f[0].indexOf("stun")?d={url:a}:0===f[0].indexOf("turn")&&(28>webrtcDetectedVersion?(a=a.split("turn:"),d={url:"turn:"+b+"@"+a[1],credential:c}):
d={url:a,credential:c,username:b});return d},RTCPeerConnection=webkitRTCPeerConnection,getUserMedia=navigator.webkitGetUserMedia.bind(navigator),attachMediaStream=function(a,b){"undefined"!==typeof a.srcObject?a.srcObject=b:"undefined"!==typeof a.mozSrcObject?a.mozSrcObject=b:"undefined"!==typeof a.src?a.src=URL.createObjectURL(b):console.log("Error attaching stream to element.")},reattachMediaStream=function(a,b){a.src=b.src},webkitMediaStream.prototype.getVideoTracks||(webkitMediaStream.prototype.getVideoTracks=
function(){return this.videoTracks},webkitMediaStream.prototype.getAudioTracks=function(){return this.audioTracks}),webkitRTCPeerConnection.prototype.getLocalStreams||(webkitRTCPeerConnection.prototype.getLocalStreams=function(){return this.localStreams},webkitRTCPeerConnection.prototype.getRemoteStreams=function(){return this.remoteStreams})):console.log("Browser does not appear to be WebRTC-capable")}AutodeskNamespace("Autodesk.Viewing.Private");
(function(){var a=Autodesk.Viewing.Private;a.config={userName:""};a.setUserName=function(b){a.config.userName=b};a.MessageClient=function(b){function d(){return a.config.userName&&a.config.userName.length?a.config.userName:q?q.slice(0,5):"Unknown"}function f(a){switch(a.type){case "txt":if(0==a.msg.indexOf("/nick ")){var b=w.getUserById(a.from,a.roomId),c=a.msg.slice(6);c.length&&(b.name=c,b.id==q&&(b.name+=" (you)"));w.dispatchEvent({type:"userListChange",data:a,channelId:a.roomId})}break;case "joinok":b=
s[a.roomId];stderr("joined channel "+a.roomId);b.users=a.users&&a.users.length?a.users:[];for(c=0;c<b.users.length;c++)b.users[c].name&&b.users[c].name.length||(b.users[c].name=b.users[c].id.slice(0,5));var c=d(),f={id:q,name:c+" (you)",isSelf:!0,status:0};b.userSet[q]||(b.users.push(f),b.userSet[q]=f);m||0==f.id.indexOf(c)||w.sendChatMessage("/nick "+c,a.roomId);break;case "join_error":break;case "sessionId":stderr("Connect successful, your id is: "+a.id);q=a.id;break;case "joined":a.userStatus=
"joined";a.user.name&&a.user.name.length||(a.user.name=a.user.id.slice(0,5));a.roomId&&((b=s[a.roomId])?(b.users.push(a.user),stderr(a.user+" joined room "+a.roomId)):stderr("Channel "+a.roomId+" does not exist for socket "+q));break;case "left":a.userStatus="left";stderr(a.user+" left room "+a.room);for(b in s){for(var c=s[b].users,f=-1,g=0;g<c.length;g++)if(c[g].id==a.user){f=g;break}-1!=f&&c.splice(f,1);delete s[b].userSet[a.user]}break;case "camera":case "pointer":break;default:stderr(a)}w.dispatchEvent({type:p[a.type],
data:a,channelId:a.roomId})}function g(a){w.dispatchEvent({type:"socketError",data:a})}function h(){if(r){for(var a in s)r.publish({channel:a,message:{type:"left",data:{type:"left",user:q,room:a}}}),r.unsubscribe({channel:[a,q]});r=null;v=!1;s=[];q=null}}function k(a){r.here_now({channel:s[a].pubnubChannelId,state:!0,callback:function(b){for(var c,d,f=s[a],g=0;g<b.uuids.length;g++)d=b.uuids[g].uuid,f.userSet[d]||(c={id:d,name:b.uuids[g].state.name,isSelf:!1,status:0},f.users.push(c),f.userSet[d]=
c,stderr("Pubnub presence : user id : '"+c.id+"' ; name : '"+c.name+"'"));w.dispatchEvent({type:"userListChange",channelId:a})}})}function l(a,b,c){r.publish({channel:s[c].pubnubChannelId,message:{type:a,senderId:q,data:b}})}var m=!1,p={camera:"cameraChange",pointer:"pointerMove",joystick:"joystick",state:"viewerState",txt:"chatReceived",joinok:"userListChange",sessionId:"connectSucceeded",joined:"userListChange",left:"userListChange","private":"privateMessage",join_error:"socketError"},n,q=m?PUBNUB.uuid():
null,r=m?PUBNUB.init({publish_key:"pub-c-4bcb7d0a-a202-444a-9c70-985b67e049e5",subscribe_key:"sub-c-ef1eb8c4-4a4e-11e4-9e3d-02ee2ddab7fe",uuid:q,ssl:!0}):null,v=!1,s={},w=this;m&&PUBNUB.bind("unload,beforeunload",window,function(){h()});this.connect=function(a){if(!n&&!v)return"undefined"!==typeof window.WebSocket?(m?(q||(q=PUBNUB.uuid()),r||(r=PUBNUB.init({publish_key:"pub-c-4bcb7d0a-a202-444a-9c70-985b67e049e5",subscribe_key:"sub-c-ef1eb8c4-4a4e-11e4-9e3d-02ee2ddab7fe",uuid:q,ssl:!0}),v=!0),w.dispatchEvent({type:"connectSucceeded",
data:{id:q}}),w.join(q)):(this.sessionID=a,n=io.connect(b+"?sessionID="+a,{forceNew:!0}),n.on("message",f),n.on("connect_error",g),n.on("error",g)),!0):!1};this.join=function(a){s[a]={id:a,users:[],userSet:{}};if(m){var b=a.replace(/\//g,"-");s[a].pubnubChannelId=b;r.subscribe({channel:[b,q],message:function(a){a.senderId!=q&&f(a.data)},connect:function(){var b=s[a];stderr("Pubnub user join: "+q);if(!b.userSet[q]){var c={id:q,name:d()+" (you)",isSelf:!0,status:0};b.users.push(c);b.userSet[q]=c}w.dispatchEvent({type:"userListChange",
channelId:a})},state:{name:d(),uuid:q},disconnect:function(){r.unsubscribe({channel:[b,q]})},presence:function(){k(a)},reconnect:function(){},error:function(){}})}else n||this.connect(),n.emit("join",{roomId:a,name:d()})};this.disconnect=function(){n&&(n.disconnect(),n=null,s={},q=null);h()};this.sendMessage=function(a,b,c){b={type:a,from:q,msg:b,roomId:c};m?l(a,b,c):n.emit("message",b)};this.sendPrivateMessage=function(a,b){var c={type:"private",target:a,from:q,msg:b};m?l("private",c,a):n.emit("message",
c)};this.sendChatMessage=function(a,b){var c={type:"txt",from:q,msg:a,roomId:b};m?l("chat",c,b):n.emit("message",c);f(c)};this.getUserById=function(a,b){for(var c=s[b].users,d=0;d<c.length;d++)if(c[d].id==a)return c[d];return null};this.getLocalId=function(){return q};this.getChannelInfo=function(a){return s[a]};this.isConnected=function(){return n||v}};a.MessageClient.prototype.constructor=a.MessageClient;THREE.EventDispatcher.prototype.apply(a.MessageClient.prototype);var b={};a.MessageClient.GetInstance=
function(c){c||(c="Production"==a.env||"AutodeskProduction"==a.env?"https://rtc.api.autodesk.com:443":"Staging"==a.env||"AutodeskStaging"==a.env?"https://rtc-stg.api.autodesk.com:443":"https://rtc-dev.api.autodesk.com:443");var d=b[c];if(d)return d;d=new a.MessageClient(c);return b[c]=d}})();AutodeskNamespace("Autodesk.Viewing.Private");
(function(){var a=Autodesk.Viewing.Private;a.P2PClient=function(a){function c(a){try{p=new RTCPeerConnection(w),p.onicecandidate=function(a){a.candidate?m.sendPrivateMessage(q,{type:"candidate",label:a.candidate.sdpMLineIndex,id:a.candidate.sdpMid,candidate:a.candidate.candidate}):stderr("End of candidates.")},p.ondatachannel=function(a){stderr("Data channel added.");v=a.channel;v.onmessage=h;l.dispatchEvent({type:"dataChannelAdded",data:a.channel})},p.onaddstream=function(a){stderr("Remote stream added.");
l.dispatchEvent({type:"remoteStreamAdded",data:a.stream})},p.onremovestream=function(a){stderr("Remote stream removed. Event: ",a);l.dispatchEvent({type:"remoteStreamRemoved",data:a.stream})},a&&(v=p.createDataChannel("sendDataChannel",{reliable:!1,ordered:!1}),v.onmessage=h)}catch(b){stderr("Failed to create PeerConnection, exception: "+b.message),alert("Cannot create RTCPeerConnection object.")}}function d(a){stderr("createOffer() error: ",e)}function f(a){p.setLocalDescription(a);m.sendPrivateMessage(q,
a);if(s.length){for(a=0;a<s.length;a++)p.addIceCandidate(s[a]);s=[]}}function g(a){a=a.split("\n");for(var b=!1,c=!1,d=!1,f=0;f<a.length;f++)0==a[f].indexOf("a=mid:data")&&(b=!0),0==a[f].indexOf("a=mid:video")&&(d=!0),0==a[f].indexOf("a=mid:audio")&&(c=!0);return b&&!d&&!c}function h(a){a=JSON.parse(a.data);switch(a.type){case "camera":l.dispatchEvent({type:"cameraChange",data:a});break;case "joystick":l.dispatchEvent({type:"joystick",data:a});break;case "state":l.dispatchEvent({type:"viewerState",
data:a})}}function k(){n=!1;p.close();q=r=p=null}var l=this,m=a,p,n=!1,q,r,v,s=[],w={iceServers:[{url:"stun:stun.l.google.com:19302"}]},z={mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}},D={mandatory:{OfferToReceiveAudio:!1,OfferToReceiveVideo:!1}};m.addEventListener("privateMessage",function(a){var b=a.data.msg;stderr("Client received message:"+JSON.stringify(b));"offer"!=b.type||n?"answer"===b.type&&n?p.setRemoteDescription(new RTCSessionDescription(b)):"candidate"===b.type?(a=new RTCIceCandidate({sdpMLineIndex:b.label,
candidate:b.candidate}),n?p.addIceCandidate(a):s.push(a)):"bye"===b&&n&&(l.dispatchEvent({type:"remoteHangup",data:null}),stderr("Session terminated."),k()):(stderr("Received offer. Accepting."),l.receiveCall(a.data))});this.hangup=function(){stderr("Hanging up.");n&&(m.sendPrivateMessage(q,"bye"),k())};this.initUserMedia=function(a){var b={video:!0,audio:!0};window.getUserMedia(b,function(b){stderr("Adding local stream.");a&&a(b);l.dispatchEvent({type:"localStreamAdded",data:b})},function(a){stderr("getUserMedia error: ",
a)});stderr("Getting user media with constraints",b)};this.callUser=function(a,b){q?stderr("Already in a call. Ignoring call request."):(q=a,stderr("Calling user "+q),b?(c(!0),n=!0,stderr("Sending data channel offer to peer"),p.createOffer(f,d)):this.initUserMedia(function(a){r=a;n||"undefined"==typeof r||(c(!1),p.addStream(r),n=!0,stderr("Sending audio/video offer to peer"),p.createOffer(f,d))}))};this.receiveCall=function(a){q=a.from;q||(q=a.senderId);g(a.msg.sdp)?(c(!0),n=!0,p.setRemoteDescription(new RTCSessionDescription(a.msg)),
stderr("Sending data-only answer to peer."),p.createAnswer(f,null,D)):this.initUserMedia(function(b){r=b;n||"undefined"==typeof r||(c(!1),p.addStream(r),n=!0);p.setRemoteDescription(new RTCSessionDescription(a.msg));stderr("Sending audio+video answer to peer.");p.createAnswer(f,null,z)})};this.getCurrentCallTarget=function(){return q};this.dataChannel=function(){return v}};a.P2PClient.prototype.constructor=a.P2PClient;THREE.EventDispatcher.prototype.apply(a.P2PClient.prototype)})();AutodeskNamespace("Autodesk.Viewing.Private");
Autodesk.Viewing.Private.Logger=function(a){this.queue=[];this.console=a.console;this.viewingservice=a.viewingservice;this.webstorage=a.webstorage;this.endpoint=a.endpoint+"/logs/";this.flushThreshold=a.flushThreshold;this.viewingservice&&(this.xhr=new XMLHttpRequest);this.lastFlushTime=Date.now()};Autodesk.Viewing.Private.Logger.prototype.bindURN=function(a){this.urn=a};
Autodesk.Viewing.Private.Logger.prototype.flush=function(){if(this.queue.length){var a=JSON.stringify(this.queue);if(this.viewingservice)try{var b=this.xhr;b.open("POST",this.endpoint+encodeURIComponent(this.urn),!0);b.setRequestHeader("Access-Control-Allow-Credentials","true");b.setRequestHeader("Access-Control-Allow-Origin","*");b.setRequestHeader("Content-Type","text/plain");b.withCredentials=!0;b.send(a)}catch(c){}this.queue=[];this.lastFlushTime=Date.now()}};
Autodesk.Viewing.Private.Logger.prototype.log=function(a,b){this.queue.push(a);(this.queue.length>this.flushThreshold||b)&&this.flush()};
var Autocam=Autocam||function(a,b,c,d,f){function g(b){s=!0;a.target.copy(n.center);a.pivot.copy(n.pivot);a.worldup?a.worldup.copy(n.sceneUpDirection):a.up.copy(n.sceneUpDirection);d&&d(b);s=!1}function h(a,b){var c=new THREE.Vector2(0,0);c.x=a/window.innerWidth;c.y=b/window.innerHeight;return c}function k(a,b,c){var d,f,g,h=0,k=null,l=null,m=n.snapOrbitDeadZone,p=n.orbitMultiplier;"h"==a?(a=n.snapOrbitThresholdH,d=n.snapOrbitAccelerationAX,f=n.snapOrbitAccelerationBX,g=1-n.snapOrbitAccelerationPointX,
l=n.lockDeltaX,k=n.lockedX):(a=n.snapOrbitThresholdV,d=n.snapOrbitAccelerationAY,f=n.snapOrbitAccelerationBY,g=1-n.snapOrbitAccelerationPointY,l=n.lockDeltaY,k=n.lockedY);k?(l+=c,l<-m?h=(l+m)*p*1/f:l>m&&(h=(l-m)*p*1/f)):(h=Math.abs(b)>a?c*p:Math.abs(b)>g*a?0<c*b?c*p*d:c*p*1/d:0<c*b?c*p*f:c*p*1/f,0<h*b&&Math.abs(h)>Math.abs(b)&&(this.lockDeltaX=this.lockDeltaY=0,h=b));return h}function l(a,b){var c=!1,d=window.innerWidth,f=a.x%d,g=window.innerHeight,h=a.y%g,g=0<h?h-b.y:g+h-b.y;30>Math.abs(0<f?f-b.x:
d+f-b.x)&&30>Math.abs(g)&&(c=!0);return c}function m(a,b,c){if(!Y||!a){if(a){var d=new THREE.Vector2;d.x=(b.x-c.x)/window.innerWidth;b.x=c.x+(b.x-c.x)%window.innerWidth;d.y=(b.y-c.y)/window.innerHeight;b.y=c.y+(b.y-c.y)%window.innerHeight}Y=a}}function p(a){var b=n.sceneFrontDirection.clone().cross(n.sceneUpDirection),c=Math.abs(Math.abs(a.dot(n.sceneUpDirection))-1),d=Math.abs(Math.abs(a.dot(n.sceneFrontDirection))-1);a=Math.abs(Math.abs(a.dot(b))-1);return 1E-5>c||1E-5>d||1E-5>a}var n=this,q=null,
r=null,v=null,s=!1;this.camera=a;this.renderer="WEBGL";this.startState={};this.navApi=b;this.orthographicFaces=!1;var w=Date.now(),z,D=!1;this.showPivot=function(a){f&&f(a)};this.setViewCubeContainer=function(a){v=a};this.setWorldUpVector=function(a){!s&&a&&0<a.lengthSq()&&!a.normalize().equals(this.sceneUpDirection)&&(this.sceneUpDirection.copy(a),this.sceneFrontDirection.copy(this.getWorldFrontVector()),this.cubeFront.copy(this.sceneFrontDirection).cross(this.sceneUpDirection).normalize(),q&&requestAnimationFrame(q.render))};
this.getWorldUpVector=function(){return this.sceneUpDirection.clone()};this.getWorldRightVector=function(){var a=this.sceneUpDirection.clone();Math.abs(a.z)<=Math.abs(a.y)?a.set(a.y,-a.x,0):0<=a.z?a.set(a.z,0,-a.x):a.set(-a.z,0,a.x);return a.normalize()};this.getWorldFrontVector=function(){return this.getWorldUpVector().cross(this.getWorldRightVector()).normalize()};this.goToView=function(a){this.navApi.getIsLocked()||(a={position:a.position.clone(),up:a.up.clone(),center:a.center.clone(),pivot:a.pivot.clone(),
fov:a.fov,worldUp:a.worldUp.clone(),isOrtho:a.isOrtho},n.elapsedTime=0,this.animateTransition(a))};this.getCurrentView=function(){return{position:a.position.clone(),up:a.up.clone(),center:this.center.clone(),pivot:this.pivot.clone(),fov:a.fov,worldUp:this.sceneUpDirection.clone(),isOrtho:!1===a.isPerspective}};this.setCurrentViewAsHome=function(a){a?(this.navApi.setRequestFitToView(!0),D=!0):this.homeVector=this.getCurrentView()};this.setHomeViewFrom=function(a){var b=a.pivot?a.pivot:this.center,
c=a.target?a.target:this.pivot,d=a.worldup?a.worldup:this.sceneUpDirection;this.homeVector={position:a.position.clone(),up:a.up.clone(),center:c.clone(),pivot:b.clone(),fov:a.fov,worldUp:d.clone(),isOrtho:!1===a.isPerspective};this.originalHomeVector={position:a.position.clone(),up:a.up.clone(),center:c.clone(),pivot:b.clone(),fov:a.fov,worldUp:d.clone(),worldFront:this.sceneFrontDirection.clone(),isOrtho:!1===a.isPerspective}};this.toPerspective=function(){a.isPerspective||(a.toPerspective(),g(!1))};
this.toOrthographic=function(){a.isPerspective&&(a.toOrthographic(),g(!1))};this.setOrthographicFaces=function(a){this.orthographicFaces=a};this.goHome=function(){this.navApi.getIsLocked()||(this.navApi.setPivotSetFlag(!1),this.goToView(this.homeVector))};this.resetHome=function(){this.homeVector.position.copy(this.originalHomeVector.position);this.homeVector.up.copy(this.originalHomeVector.up);this.homeVector.center.copy(this.originalHomeVector.center);this.homeVector.pivot.copy(this.originalHomeVector.pivot);
this.homeVector.fov=this.originalHomeVector.fov;this.homeVector.worldUp.copy(this.originalHomeVector.worldUp);this.homeVector.isOrtho=this.originalHomeVector.isOrtho;this.goHome()};this.getView=function(){return this.center.clone().sub(a.position)};this.setCameraUp=function(b){var c=this.dir.clone(),d=c.cross(b).normalize();0===d.lengthSq()&&(c.copy(this.dir),b.z>b.y?c.y+=1E-4:c.z+=1E-4,d=c.cross(b).normalize());a.up.copy(d).cross(this.dir).normalize()};(function U(){requestAnimationFrame(U);var a=
Date.now();z=a-w;w=a})();this.ortho=!1;this.center=a.target?a.target.clone():new THREE.Vector3(0,0,0);this.pivot=a.pivot?a.pivot.clone():this.center.clone();this.sceneUpDirection=a.worldup?a.worldup.clone():a.up.clone();this.sceneFrontDirection=this.getWorldFrontVector();this.dir=this.getView();this.setCameraUp(a.up);this.saveCenter=this.center.clone();this.savePivot=this.pivot.clone();this.saveEye=a.position.clone();this.saveUp=a.up.clone();var A,E,N,H;this.cubeFront=this.sceneFrontDirection.clone().cross(this.sceneUpDirection).normalize();
this.setHomeViewFrom(a);var J=new THREE.Quaternion,G=new THREE.Quaternion,I=new THREE.Quaternion,M=new THREE.Quaternion,C,K;this.userPanSpeed=0.5;this.userLookSpeed=2;this.userHeightSpeed=5;this.walkMultiplier=1;this.userZoomSpeed=1.015;this.orbitMultiplier=5;this.currentlyAnimating=!1;this.alignOrbitUpDirection=this.preserveOrbitUpDirection=a.keepSceneUpright=!0;this.doCustomOrbit=this.constrainOrbitVertical=this.constrainOrbitHorizontal=!1;this.snapOrbitDeadZone=0.045;this.snapOrbitThresholdH=this.snapOrbitThresholdV=
THREE.Math.degToRad(15);this.snapOrbitAccelerationAX=this.snapOrbitAccelerationAY=1.5;this.snapOrbitAccelerationBX=this.snapOrbitAccelerationBY=2;this.snapOrbitAccelerationPointX=this.snapOrbitAccelerationPointY=0.5;this.alignDirTable=Array(26);this.alignDirTable[0]=new THREE.Vector3(-1,0,0);this.alignDirTable[1]=new THREE.Vector3(1,0,0);this.alignDirTable[2]=new THREE.Vector3(0,-1,0);this.alignDirTable[3]=new THREE.Vector3(0,1,0);this.alignDirTable[4]=new THREE.Vector3(0,0,-1);this.alignDirTable[5]=
new THREE.Vector3(0,0,1);this.alignDirTable[6]=new THREE.Vector3(-1,-1,0);this.alignDirTable[7]=new THREE.Vector3(-1,1,0);this.alignDirTable[8]=new THREE.Vector3(1,-1,0);this.alignDirTable[9]=new THREE.Vector3(1,1,0);this.alignDirTable[10]=new THREE.Vector3(0,-1,-1);this.alignDirTable[11]=new THREE.Vector3(0,-1,1);this.alignDirTable[12]=new THREE.Vector3(0,1,-1);this.alignDirTable[13]=new THREE.Vector3(0,1,1);this.alignDirTable[14]=new THREE.Vector3(-1,0,-1);this.alignDirTable[15]=new THREE.Vector3(1,
0,-1);this.alignDirTable[16]=new THREE.Vector3(-1,0,1);this.alignDirTable[17]=new THREE.Vector3(1,0,1);this.alignDirTable[18]=new THREE.Vector3(-1,-1,-1);this.alignDirTable[19]=new THREE.Vector3(-1,-1,1);this.alignDirTable[20]=new THREE.Vector3(-1,1,-1);this.alignDirTable[21]=new THREE.Vector3(-1,1,1);this.alignDirTable[22]=new THREE.Vector3(1,-1,-1);this.alignDirTable[23]=new THREE.Vector3(1,-1,1);this.alignDirTable[24]=new THREE.Vector3(1,1,-1);this.alignDirTable[25]=new THREE.Vector3(1,1,1);this.useSnap=
this.combined=!1;this.lockDeltaX=0;this.lockedX=!1;this.lockDeltaY=this.lastSnapRotateX=0;this.lockedY=!1;this.lastSnapRotateY=0;this.lastSnapDir=new THREE.Vector3(0,0,0);this.bottomLimit=this.topLimit=!1;this.maxSceneBound=this.minSceneBound=0;var F={destinationPercent:1,duration:1,zoomToFitScene:!0,useOffAxis:!1};this.shotParams=F;var B,R;this.zoomDelta=new THREE.Vector2;var Y,S=new THREE.Vector3,P=new THREE.Vector3;this.rewindParams={history:[],startTime:void 0,thumbnailSize:56,thumbnailGapSize:12,
maxHistorySize:25,snappingEnabled:!0,timelineIndex:0,timelineIndexSlide:0,open:!1,openLocation:new THREE.Vector2(0,0),openBracket:new THREE.Vector2(0,0),openBracketA:new THREE.Vector2(0,0),openBracketB:new THREE.Vector2(0,0),openLocationOrigin:new THREE.Vector2(0,0),locationOffset:new THREE.Vector2(0,0),snapOffset:new THREE.Vector2(0,0),slideOffset:new THREE.Vector2(0,0),snapped:!0,resetWeights:!1,recordEnabled:!1,elementIsRecording:!1};this.viewCubeMenuOpen=!1;this.menuSize=new THREE.Vector2(0,0);
this.menuOrigin=new THREE.Vector2(0,0);a.lookAt(this.center);this.setCube=function(a){q=a};this.loadObject=function(a,b,c){loader=new THREE.JSONLoader;loader.load(a,function(a,d){var f=new THREE.MeshPhongMaterial(d);mesh=new THREE.Mesh(a,f);mesh.scale=b;mesh.position.copy(c);mesh.geometry.computeBoundingBox();f=mesh.geometry.boundingBox.clone();P.set(f.max.x,f.max.y,f.max.z);S.set(f.min.x,f.min.y,f.min.z);P.multiply(b);S.multiply(b);scene.add(mesh);objects.push(mesh)})};this.sync=function(b){b.isPerspective!==
a.isPerspective&&(b.isPerspective?a.toPerspective():(a.toOrthographic(),b.saveFov&&(a.saveFov=b.saveFov)));a.fov=b.fov;a.position.copy(b.position);b.target&&(this.center.copy(b.target),a.target.copy(b.target));b.pivot&&(this.pivot.copy(b.pivot),a.pivot.copy(b.pivot));this.dir.copy(this.center).sub(a.position);this.setCameraUp(b.up);b=b.worldup?b.worldup:b.up;1E-4<b.distanceToSquared(this.sceneUpDirection)&&this.setWorldUpVector(b);D&&!this.navApi.getTransitionActive()&&(D=!1,this.setCurrentViewAsHome(!1));
q&&requestAnimationFrame(q.render)};this.refresh=function(){q&&q.refreshCube()};THREE.Box2.prototype.setCenter=function(a){var b=new THREE.Vector2(Math.abs(this.max.x-this.min.x)/2,Math.abs(this.max.y-this.min.y)/2);this.min.copy(a).sub(b);this.max.copy(a).add(b);return this};THREE.Box2.prototype.getIcon2DCoords=function(a,b){var c=this.center;b.set((a.x-c.x)/(this.size().x/2),(a.y-c.y)/(this.size().y/2))};THREE.Matrix3.prototype.makeRotationFromQuaternion=function(a){var b=this.elements,c=a.x,d=
a.y,f=a.z,g=a.w,h=c+c,k=d+d,l=f+f;a=c*h;var m=c*k,c=c*l,n=d*k,d=d*l,f=f*l,h=g*h,k=g*k,g=g*l;b[0]=1-(n+f);b[3]=m-g;b[6]=c+k;b[1]=m+g;b[4]=1-(a+f);b[7]=d-h;b[2]=c-k;b[5]=d+h;b[8]=1-(a+n);return this};THREE.Quaternion.prototype.setFromRotationMatrix3=function(a){var b=a.elements,c=b[0];a=b[3];var d=b[6],f=b[1],g=b[4],h=b[7],k=b[2],l=b[5],b=b[8],m=c+g+b;0<m?(c=0.5/Math.sqrt(m+1),this.w=0.25/c,this.x=(l-h)*c,this.y=(d-k)*c,this.z=(f-a)*c):c>g&&c>b?(c=2*Math.sqrt(1+c-g-b),this.w=(l-h)/c,this.x=0.25*c,this.y=
(a+f)/c,this.z=(d+k)/c):g>b?(c=2*Math.sqrt(1+g-c-b),this.w=(d-k)/c,this.x=(a+f)/c,this.y=0.25*c,this.z=(h+l)/c):(c=2*Math.sqrt(1+b-c-g),this.w=(f-a)/c,this.x=(d+k)/c,this.y=(h+l)/c,this.z=0.25*c);return this};THREE.Quaternion.prototype.rotate=function(a){var b=(new THREE.Matrix4).makeRotationFromQuaternion(this).elements,b=(new THREE.Matrix3).set(b[0],b[1],b[2],b[4],b[5],b[6],b[8],b[9],b[10]);return a.applyMatrix3(b)};THREE.Vector3.prototype.findAngleWith=function(a,b){var c=0,d=this.clone().normalize().clone().dot(a.clone().normalize()),
c=this.clone().cross(a).clone().normalize();if(c.clone().length()<Number.MIN_VALUE)c=0<d?0:180;else{b=0<c.clone().dot(b.clone().normalize())?c:-c;var f=(new THREE.Quaternion).setFromAxisAngle(b,90*THREE.Math.degToRad),f=f.clone().rotate(a).clone().normalize().clone().dot(this),c=Math.acos(d)*THREE.Math.radToDeg;Math.abs(c-90)<Number.MIN_VALUE&&(c=90);if(90>c&&0<d*f||90<c&&0>d*f||90==c&&0<f)c*=-1}return c=THREE.Math.degToRad(c)};"contains"in String.prototype||(String.prototype.contains=function(a,
b){return-1!==String.prototype.indexOf.call(this,a,b)});Math.linearClamp=function(a,b,c){return a<=b?0:a>=c?1:(a-b)/(c-b)};Math.easeClamp=function(a,b,c){return a<=b?0:a>=c?1:0.5*(Math.sin(((a-b)/(c-b)-0.5)*Math.PI)+1)};Math.linearInterp=function(a,b,c){return b*(1-a)+c*a};Math.equalityClamp=function(a,b,c){return a<=b?b:a>=c?c:a};Math.round2=function(a){return Math.round(100*a)/100};Math.round1=function(a){return Math.round(10*a)/10};this.animateTransition=function(b){if(b){var c=!1,d=0;this.setCameraOrtho(b.isOrtho);
if(n.elapsedTime>=F.duration)d=1,n.center.copy(b.center),n.pivot.copy(b.pivot),a.position.copy(b.position),a.up.copy(b.up),b.isOrtho||(a.fov=b.fov),(c=!b.worldUp.equals(this.sceneUpDirection))&&this.setWorldUpVector(b.worldUp),this.currentlyAnimating=!1,g(c),this.showPivot(!1),q&&requestAnimationFrame(q.render),this.addHistoryElement(),this.navApi.setTransitionActive(!1);else{this.currentlyAnimating=!0;this.showPivot(!0);this.navApi.setTransitionActive(!0);d=Math.easeClamp(n.elapsedTime/F.duration,
0,F.destinationPercent);oneMinusTime=1-d;n.elapsedTime+=z/500;var c=n.center.clone().multiplyScalar(oneMinusTime).add(b.center.clone().multiplyScalar(d)),f=a.position.clone().multiplyScalar(oneMinusTime).add(b.position.clone().multiplyScalar(d)),h=a.up.clone().multiplyScalar(oneMinusTime).add(b.up.clone().multiplyScalar(d)),k=a.pivot.clone().multiplyScalar(oneMinusTime).add(b.pivot.clone().multiplyScalar(d)),l=this.sceneUpDirection.clone().multiplyScalar(oneMinusTime).add(b.worldUp.clone().multiplyScalar(d)),
d=a.fov*oneMinusTime+b.fov*d;n.center.copy(c);n.pivot.copy(k);a.position.copy(f);a.up.copy(h);b.isOrtho||(a.fov=d);(c=1E-4<l.distanceToSquared(this.sceneUpDirection))&&this.setWorldUpVector(l);a.lookAt(n.center);g(c);q&&requestAnimationFrame(q.render);requestAnimationFrame(function(){n.animateTransition(b)})}}};this.sphericallyInterpolateTransition=function(b){var c,d,f;c=0;this.currentlyAnimating=!0;this.navApi.setTransitionActive(!0);n.elapsedTime>=F.duration?(c=1,this.currentlyAnimating=!1):(c=
Math.easeClamp(n.elapsedTime/F.duration,0,F.destinationPercent),n.elapsedTime+=z/500);1===c?(d=R.position,c=R.center,f=R.up):(f=new THREE.Matrix3,d=J.clone(),d.slerp(G,c),f.makeRotationFromQuaternion(d),d=Math.linearInterp(c,C,K),f=f.elements,c=B.center.clone().multiplyScalar(1-c).add(R.center.clone().multiplyScalar(c)),d=c.clone().sub((new THREE.Vector3(f[0],f[1],f[2])).multiplyScalar(d)),f=new THREE.Vector3(f[3],f[4],f[5]));n.center.copy(c);a.position.copy(d);a.up.copy(f);n.navApi.getUsePivotAlways()||
n.pivot.copy(c);a.lookAt(n.center);!0===this.currentlyAnimating?(this.showPivot(!0),requestAnimationFrame(function(){n.sphericallyInterpolateTransition(b)})):(this.navApi.setTransitionActive(!1),this.showPivot(!1),this.addHistoryElement(),this.orthographicFaces&&this.isFaceView()&&this.setCameraOrtho(!0),b&&b());g(!1);q&&requestAnimationFrame(q.render)};this.getOrientation=function(){if(q){var b=Math.round1(a.up.x),c=Math.round1(a.up.y),d=Math.round1(a.up.z),f=this.sceneFrontDirection.clone(),g=this.sceneUpDirection.clone(),
h=this.sceneFrontDirection.clone().cross(this.sceneUpDirection).normalize();f.x=Math.round1(f.x);f.y=Math.round1(f.y);f.z=Math.round1(f.z);g.x=Math.round1(g.x);g.y=Math.round1(g.y);g.z=Math.round1(g.z);h.x=Math.round1(h.x);h.y=Math.round1(h.y);h.z=Math.round1(h.z);var k=h.clone().multiplyScalar(-1),l=g.clone().multiplyScalar(-1),m=f.clone().multiplyScalar(-1);switch(q.currentFace){case "front":if(g.x==b&&g.y==c&&g.z==d)return"up";if(l.x==b&&l.y==c&&l.z==d)return"down";if(h.x==b&&h.y==c&&h.z==d)return"right";
if(k.x==b&&k.y==c&&k.z==d)return"left";break;case "right":if(g.x==b&&g.y==c&&g.z==d)return"up";if(l.x==b&&l.y==c&&l.z==d)return"down";if(m.x==b&&m.y==c&&m.z==d)return"left";if(f.x==b&&f.y==c&&f.z==d)return"right";break;case "left":if(g.x==b&&g.y==c&&g.z==d)return"up";if(l.x==b&&l.y==c&&l.z==d)return"down";if(f.x==b&&f.y==c&&f.z==d)return"left";if(m.x==b&&m.y==c&&m.z==d)return"right";break;case "back":if(g.x==b&&g.y==c&&g.z==d)return"up";if(l.x==b&&l.y==c&&l.z==d)return"down";if(k.x==b&&k.y==c&&k.z==
d)return"right";if(h.x==b&&h.y==c&&h.z==d)return"left";break;case "top":if(m.x==b&&m.y==c&&m.z==d)return"down";if(f.x==b&&f.y==c&&f.z==d)return"up";if(h.x==b&&h.y==c&&h.z==d)return"right";if(k.x==b&&k.y==c&&k.z==d)return"left";break;case "bottom":if(f.x==b&&f.y==c&&f.z==d)return"down";if(m.x==b&&m.y==c&&m.z==d)return"up";if(h.x==b&&h.y==c&&h.z==d)return"right";if(k.x==b&&k.y==c&&k.z==d)return"left"}}};this.setCameraOrtho=function(b){b&&a.isPerspective&&a.toOrthographic();b||a.isPerspective||a.toPerspective()};
this.resetOrientation=function(){this.setCameraOrtho(this.originalHomeVector.isOrtho);this.sceneUpDirection.copy(this.originalHomeVector.worldUp);this.sceneFrontDirection.copy(this.originalHomeVector.worldFront);this.cubeFront.copy(this.sceneFrontDirection).cross(this.sceneUpDirection).normalize();this.setCameraUp(this.sceneUpDirection);g(!0)};this.setCurrentViewAsFront=function(){q&&(q.currentFace="front");this.sceneUpDirection.copy(a.up.clone());this.sceneFrontDirection.copy(this.getView()).normalize();
this.cubeFront.copy(this.sceneFrontDirection).cross(this.sceneUpDirection).normalize();this.orthographicFaces&&this.setCameraOrtho(!0);g(!0)};this.setCurrentViewAsTop=function(){q&&(q.currentFace="top");this.sceneUpDirection.copy(this.getView()).multiplyScalar(-1).normalize();this.sceneFrontDirection.copy(a.up);this.cubeFront.copy(this.sceneFrontDirection).cross(this.sceneUpDirection).normalize();g(!0)};this.calculateCubeTransform=function(b){var c=this.sceneUpDirection.clone(),d=this.sceneFrontDirection.clone(),
f=this.sceneFrontDirection.clone().cross(this.sceneUpDirection).normalize();B=a.clone();B.center=n.center.clone();B.pivot=n.pivot.clone();R=a.clone();R.center=n.center.clone();R.pivot=n.pivot.clone();var g=new THREE.Vector3(0,0,0);b.contains("back")&&(g=g.add(d));b.contains("front")&&(g=g.sub(d));b.contains("top")&&(g=g.add(c));b.contains("bottom")&&(g=g.sub(c));b.contains("right")&&(g=g.add(f));b.contains("left")&&(g=g.sub(f));b=c;var h=g.clone().normalize();if(1-Math.abs(h.dot(c))<Number.MIN_VALUE)for(var k=
this.getView().normalize(),d=[d.clone(),d.clone().negate(),f.clone(),f.clone().negate()],c=0<h.dot(c)?1:-1,k=k.clone().add(a.up.clone().multiplyScalar(c)).normalize(),f=-2,h=0;4>h;h++){var l=k.dot(d[h]);l>f&&(f=l,b=d[h].multiplyScalar(c))}K=C=this.getView().length();R.position.copy(R.center.clone().add(g.multiplyScalar(K/g.length())));R.up.copy(b);g=B.center.clone().sub(B.position).normalize();b=g.clone().cross(B.up).normalize();d=b.clone().cross(g).normalize();c=new THREE.Matrix3;c.set(g.x,d.x,b.x,
g.y,d.y,b.y,g.z,d.z,b.z);J.setFromRotationMatrix3(c);g=R.center.clone().sub(R.position).normalize();b=g.clone().cross(R.up).normalize();d=b.clone().cross(g).normalize();c.set(g.x,d.x,b.x,g.y,d.y,b.y,g.z,d.z,b.z);I.setFromAxisAngle(g,0);M.setFromAxisAngle(d,0);G.setFromRotationMatrix3(c);G.multiply(I).multiply(M).normalize()};this.centerShot=function(b){if(!B||b)n.elapsedTime=0,B=R=a.clone(),B.center=n.center;b=n.pivot.clone();var c=b.clone().sub(B.position),d=B.center.clone().sub(B.position).normalize(),
f=B.up.clone(),h=d.clone().cross(f).normalize(),f=h.clone().cross(d).normalize(),d=h.clone().multiplyScalar(h.dot(c)),c=f.clone().multiplyScalar(f.dot(c)),c=d.clone().add(c);R.position.copy(B.position.clone().add(c));R.center=b;R.pivot=b;b=0;n.elapsedTime>=F.duration?b=1:(b=Math.easeClamp(n.elapsedTime/F.duration,0,F.destinationPercent),n.elapsedTime+=z/2E3);c=a.position.clone().multiplyScalar(1-b).add(R.position.clone().multiplyScalar(b));f=n.center.clone().multiplyScalar(1-b).add(R.center.clone().multiplyScalar(b));
d=n.pivot.clone().multiplyScalar(1-b).add(R.pivot.clone().multiplyScalar(b));a.position.copy(c);n.center.copy(f);n.pivot.copy(d);a.lookAt(n.center);g(!1);1===b?this.addHistoryElement():requestAnimationFrame(function(){n.centerShot(!1)})};this.levelShot=function(){var b=this.getView(),c=b.length(),d=this.sceneUpDirection.clone(),f=a.up.clone().normalize(),b=b.normalize(),g=b.dot(d);1-Math.abs(g)>Number.MIN_VALUE?(f=b.clone().cross(d),b=d.clone().cross(f),b.normalize()):b=f.clone();b.multiplyScalar(c);
c={center:b.add(a.position),up:d,position:a.position,pivot:n.center.clone().add(b),fov:a.fov,worldUp:d};n.elapsedTime=0;n.animateTransition(c)};this.fitToWindow=function(){var b=this.getView(),c=a.up.clone();b.normalize();c.normalize();R=a.clone();R.center=n.center;var d=c,c=d.clone();if(!(Math.abs(c.clone().dot(b))<Number.MIN_VALUE)&&(b.normalize(),c=d.clone().dot(b),c=b.clone().multiplyScalar(c),c=d.clone().sub(c),c.length()<Number.MIN_VALUE)){for(var d=new THREE.Vector3(0,0,0),c=[new THREE.Vector3(0,
1,0),new THREE.Vector3(1,0,0),new THREE.Vector3(0,0,1),new THREE.Vector3(0,1,1),new THREE.Vector3(1,0,1),new THREE.Vector3(1,1,0),new THREE.Vector3(1,1,1)],f=0;7>f;f++)if(Math.abs(c[f].dot(b))<Number.MIN_VALUE){d=c[f];break}c=d}c.normalize();c.normalize();R.up.copy(c);f=b.clone().cross(c);f.normalize();var g=S.clone(),h=P.clone(),k=[g,h],d=new THREE.Vector3(h.x-g.x,h.y-g.y,h.z-g.z);k[2]=new THREE.Vector3(h.x,g.y,h.z);k[3]=new THREE.Vector3(h.x,g.y,g.z);k[4]=new THREE.Vector3(h.x,h.y,g.z);k[5]=new THREE.Vector3(g.x,
h.y,h.z);k[6]=new THREE.Vector3(g.x,h.y,g.z);k[7]=new THREE.Vector3(g.x,g.y,h.z);for(g=0;8>g;g++)h=k[g].clone().sub(a.position),k[g].setX(h.clone().dot(f)),k[g].setY(h.clone().dot(c)),k[g].setZ(h.clone().dot(b));var g=THREE.Math.degToRad(a.topFov),h=THREE.Math.degToRad(a.bottomFov),l=THREE.Math.degToRad(a.leftFov),m=THREE.Math.degToRad(a.rightFov),p,q,K,r;p=0<=l?Number.MAX_VALUE:Number.MIN_VALUE;q=0<=m?Number.MAX_VALUE:Number.MIN_VALUE;K=0<=g?Number.MAX_VALUE:Number.MIN_VALUE;r=0<=h?Number.MAX_VALUE:
Number.MIN_VALUE;for(var s=1/Math.tan(m),v=-1/Math.tan(l),A=1/Math.tan(g),F=-1/Math.tan(h),w=0;8>w;w++){var D=k[w].clone(),z=D.z-v*D.x;p=0<=l?Math.min(p,z):Math.max(p,z);z=D.z-s*D.x;q=0<=m?Math.min(q,z):Math.max(q,z);z=D.z-A*D.y;K=0<=g?Math.min(K,z):Math.max(K,z);z=D.z-F*D.y;r=0<=h?Math.min(r,z):Math.max(r,z)}k=(q-p)/(v-s);p=v*k+p;r=(r-K)/(A-F);K=A*r+K;A=0;p<=K?(g=(g-h)/2,Math.abs(g)>Number.MIN_VALUE&&(g=1/Math.tan(g),r=r-K/g+p/g),A=p):(g=(m-l)/2,Math.abs(g)>Number.MIN_VALUE&&(g=1/Math.tan(g),k=k-
p/g+K/g),A=K);g=new THREE.Vector3(k,r,A);f=f.clone().multiplyScalar(g.x);c=c.clone().multiplyScalar(g.y);g=b.clone().multiplyScalar(g.z);g=f.clone().add(c.clone().add(g));R.position.add(g);c=d.clone().sub(R.position).dot(b);R.center=R.position.clone().add(b.multiplyScalar(c));R.pivot=d.clone();b={center:R.center,up:R.up,position:R.position,pivot:R.pivot,fov:a.fov,worldUp:n.sceneUpDirection.clone()};n.elapsedTime=0;n.animateTransition(b)};this.updatePivotPosition=function(b){var c;c=new THREE.Vector3(b.x/
window.innerWidth*2-1,2*-(b.y/window.innerHeight)+1,0.5);c=c.unproject(a);c=(new THREE.Raycaster(a.position,c.sub(a.position).normalize())).intersectObjects(objects);if("zoom"==n.mode)if(void 0!==c[0])b=c[0].point,n.pivot.copy(b);else{b.y=Math.abs(b.y-window.innerHeight);var d=a.position;c=n.center.clone().sub(d);var f=a.up,g=c.clone().cross(f),h=c.clone().length(),k=h*Math.tan(THREE.Math.degToRad(a.leftFov)),l=h*Math.tan(THREE.Math.degToRad(a.rightFov)),m=h*Math.tan(THREE.Math.degToRad(a.topFov)),
h=h*Math.tan(THREE.Math.degToRad(a.bottomFov)),k=b.x*(k+l)/window.innerWidth-k;b=b.y*(m+h)/window.innerHeight-h;f=f.clone().normalize().clone().multiplyScalar(b);g=g.clone().normalize().clone().multiplyScalar(k);n.ortho?b=d.clone().add(g).clone().add(f):(b=d,c=c.clone().add(f).clone().add(g));n.pivot.copy(b.clone().add(c))}else void 0!==c[0]?(wheel.cursorImage("pivot"),b=c[0].point,n.isMouseDown||n.pivot.copy(b)):wheel.cursorImage("SWInvalidArea")};this.onDrawHeight=function(b,c,d,f,g){b=new THREE.Vector3(0,
1,0);b=a.position.clone().dot(b);b=Math.linearClamp(b,n.minSceneBound,n.maxSceneBound)-0.5;v&&(v.find("img#updownImageA").remove(),v.prepend('<img src="'+g+'SWheighthandleA.png" id="updownImageA" style="position:fixed; z-index:9999; top:'+(d-86*b)+"px; left:"+c+'px;"/>'),f||v.prepend('<img src="'+g+'SWheighthandleI.png" id="updownImageI" style="position:fixed; z-index:9998; top:'+(d-86*b)+"px; left:"+c+'px;"/>'))};this.drawDropdownMenu=function(a,b,d,f,g,h,k){var l=0;if(r)h.appendChild(r);else{r=
document.createElement("div");r.className="dropDownMenu";r.style.top="100px";r.style.left="-400px";for(var m=0,n=0;n<a.length;n++){var p;if(null===a[n])p=document.createElement("li"),p.style.height="1px",m+=1,p.style.backgroundColor="#E0E0E0";else{var q=Autodesk.Viewing.i18n.translate(a[n]);if(d[n]){p=document.createElement("div");var K=document.createElement("input"),s=document.createElement("label");K.type="checkbox";K.className="dropDownMenuCheck";s.innerHTML=q;s.className="dropDownMenuCheckText";
p.appendChild(K);p.appendChild(s);p.className="dropDownMenuCheckbox"}else p=document.createElement("li"),p.textContent=q,p.className=b[n]?"dropDownMenuItem":"dropDownMenuItemDisabled";p.id="menuItem"+l;l++;m+=25;p.setAttribute("data-i18n",a[n])}r.appendChild(p)}h.appendChild(r);l=r.getBoundingClientRect().width;this.menuSize.x=l;this.menuSize.y=m}for(n=l=0;n<a.length;n++)null!==a[n]&&(d[n]&&(m=document.getElementById("menuItem"+l))&&(m.children[0].checked=d[n]()),l++);a=g-15;d=f+1;g=c.getBoundingClientRect();
d+this.menuSize.x>g.right&&(d=f-this.menuSize.x-1);a+this.menuSize.y>g.bottom&&(a=g.bottom-this.menuSize.y);a-=k.y;d-=k.x;r.style.top=a+"px";r.style.left=d+"px";this.menuOrigin.x=d;this.menuOrigin.y=a};this.removeDropdownMenu=function(a){a.removeChild(r)};this.isFaceView=function(){var b=this.center.clone().sub(a.position).normalize();return p(b)&&p(a.up)};this.startInteraction=function(a,b){this.startCursor=new THREE.Vector2(a,b);this.startState={saveCenter:this.center.clone(),saveEye:this.camera.position.clone(),
savePivot:this.pivot.clone(),saveUp:this.camera.up.clone()};this.lockDeltaX=0;this.lockedX=!1;this.lockDeltaY=this.lastSnapRotateX=0;this.lockedY=!1;this.lastSnapRotateY=0;this.lastSnapDir=new THREE.Vector3(0,0,0)};this.orbit=function(b,c,d,f){if(!this.navApi.getIsLocked()&&!0!==this.currentlyAnimating){var l="wheel";n.orthographicFaces&&!a.isPerspective&&(a.toPerspective(),f&&f.saveEye.copy(this.camera.position));f&&(l="cube");"cube"==l?(this.saveCenter.copy(f.saveCenter),this.saveEye.copy(f.saveEye),
this.savePivot.copy(f.savePivot),this.saveUp.copy(f.saveUp),this.doCustomOrbit=this.useSnap=!0):(this.saveCenter.copy(this.center),this.savePivot.copy(this.pivot),this.saveEye.copy(a.position),this.saveUp.copy(a.up),this.doCustomOrbit=this.useSnap=!1);n.combined&&void 0==E&&(E=this.saveCenter.clone(),A=this.saveEye.clone(),H=this.savePivot.clone(),N=this.saveUp.clone());if(this.preserveOrbitUpDirection){var l=h(b.x-c.x,b.y-c.y),m=h(d.x,d.y);c=this.sceneUpDirection.clone();var p=this.sceneFrontDirection.clone(),
q=this.sceneFrontDirection.clone().cross(this.sceneUpDirection).normalize();d=n.combined?H:this.savePivot;f=n.combined?A:this.saveEye;var K=n.combined?E:this.saveCenter,r=n.combined?N:this.saveUp,s=d.clone().sub(f).normalize(),v=K.clone().sub(f).normalize(),F=v.clone().cross(r);b=f.clone().sub(d).length();f=f.clone().sub(K).length();s=s.clone().multiplyScalar(-1);v=v.clone().multiplyScalar(-1);r=r.clone();this.constrainOrbitHorizontal||(-0.0090>c.dot(this.saveUp)&&(l.x=-l.x,m.x=-m.x),K=0,this.lastSnapRotateX=
K=n.combined?m.x*this.orbitMultiplier:this.useSnap?this.lastSnapRotateX+k("h",0,-m.x):l.x*this.orbitMultiplier,K=(new THREE.Quaternion).setFromAxisAngle(c,-K),s.applyQuaternion(K),v.applyQuaternion(K),F.applyQuaternion(K),r.applyQuaternion(K));this.constrainOrbitVertical||(p=p.clone().multiplyScalar(p.dot(F)),q=q.clone().multiplyScalar(q.dot(F)),q=p.clone().add(q),q.clone().normalize(),F=0,n.combined?F=m.y*this.orbitMultiplier:(m=k("v",0,m.y),F=this.useSnap?this.lastSnapRotateY+m:l.y*this.orbitMultiplier),
l=(new THREE.Quaternion).setFromAxisAngle(q,-F),this.navApi.getOrbitPastWorldPoles()||(m=r.clone(),m.applyQuaternion(l).normalize(),0>c.dot(m)&&(m=v.clone(),m.applyQuaternion(l).normalize(),c=m.angleTo(c),Math.abs(c)>0.5*Math.PI&&(c-=0<c?Math.PI:-Math.PI),F-=c,l.setFromAxisAngle(q,-F))),s.applyQuaternion(l).normalize(),v.applyQuaternion(l).normalize(),r.applyQuaternion(l).normalize(),this.lastSnapRotateY=F);d=s.multiplyScalar(b).add(d);a.position.copy(d);a.up.copy(r);this.center.copy(d);this.center.sub(v.multiplyScalar(f));
n.combined&&(E.copy(this.center),A.copy(a.position),H.copy(this.pivot),N.copy(a.up))}a.lookAt(this.center);g(!1)}};this.endInteraction=function(){};this.look=function(b){if(!this.navApi.getIsLocked()){var c=h(b.x,b.y),d=this.userLookSpeed;b=this.getView();var f=a.up,k=b.clone().cross(f).normalize(),l=this.sceneUpDirection.clone(),c=c.clone();c.x*=Math.PI;c.y*=Math.PI/a.aspect;c.multiplyScalar(d);d=(new THREE.Quaternion).setFromAxisAngle(k,-c.y);if(a.keepSceneUpright&&!this.navApi.getOrbitPastWorldPoles()){var m=
f.clone();m.applyQuaternion(d).normalize();0>m.dot(l)&&(m=b.clone(),m.applyQuaternion(d),m=m.angleTo(l),Math.abs(m)>0.5*Math.PI&&(m-=0<m?Math.PI:-Math.PI),c.y-=m,d.setFromAxisAngle(k,-c.y))}b=d.clone().rotate(b);f=d.clone().rotate(f);f.normalize();k=a.keepSceneUpright?l:f;k=(new THREE.Quaternion).setFromAxisAngle(k,-c.x);b=k.clone().rotate(b);f=k.clone().rotate(f);this.center.copy(b.add(a.position));a.up.copy(f);a.lookAt(this.center);g(!1)}};this.pan=function(b){if(!this.navApi.getIsLocked()){b=h(b.x,
b.y);var c=this.getView(),d=a.up.clone().cross(c),f=c.clone().cross(d);d.normalize();f.normalize();c.normalize();var k=this.pivot.clone().sub(a.position),k=c.clone().dot(k),c=k*(Math.tan(THREE.Math.degToRad(a.leftFov))+Math.tan(THREE.Math.degToRad(a.rightFov))),k=k*(Math.tan(THREE.Math.degToRad(a.topFov))+Math.tan(THREE.Math.degToRad(a.bottomFov))),c=b.x*Math.abs(c);b=b.y*Math.abs(k);k=new THREE.Vector3;d=d.clone().multiplyScalar(c);f=f.clone().multiplyScalar(b);k=d.clone().add(f).clone().multiplyScalar(this.userPanSpeed);
a.position.add(k);this.center.add(k);a.lookAt(this.center);g(!1)}};this.zoom=function(b){if(!this.navApi.getIsLocked()){var c=this.userZoomSpeed,d=Number.MAX_VALUE;b=b.x+b.y;var f=Math.pow(c,b),h=this.pivot.clone().sub(this.pivot.clone().sub(this.saveEye).clone().multiplyScalar(f)),k=h.clone().add(n.D.clone().multiplyScalar(n.D.clone().dot(this.pivot.clone().sub(h).clone())));if(!(f>=d)){if(0<b){Math.pow(c,b-0);if(0>b)return;a.position.copy(h);this.center.copy(k);h.clone().sub(this.saveEye).dot(n.D)>
d&&a.position.copy(this.saveEye.sub(n.D).clone().multiplyScalar(d))}else a.position.copy(h),this.center.copy(k);a.lookAt(this.center);g(!1)}}};this.walk=function(b,c,d,f,k){if(!this.navApi.getIsLocked()){d=this.sceneUpDirection.clone();f=this.sceneFrontDirection.clone();k=this.sceneFrontDirection.clone().cross(this.sceneUpDirection);l(b,c)?(wheel.cursorImage("SWWalk"),m(!0,b,c),x=c.x,y=c.y):m(!1,b,c);x=b.x;y=b.y;var n=h(x-c.x,y-c.y),p=-n.x,q=-n.y,K=0>p?-1:1,n=0>q?-1:1,r=Math.abs(p),s=Math.abs(q),
s=new THREE.Vector2(30,30),s=h(s.x,s.y),r=l(b,c)?0:Math.abs(p)-s.x,s=l(b,c)?0:Math.abs(q)-s.y,r=r/0.25,s=s/0.25,r=1>r?Math.easeClamp(r,0,1):Math.pow(r,1),s=1>s?Math.easeClamp(s,0,1):Math.pow(s,1),p=0<r?r*K:0,n=0<s?s*n:0;b=this.getView();c=b.length();b.normalize();b.clone().cross(a.up).normalize();k=k.clone().multiplyScalar(k.clone().dot(b));k=f.clone().multiplyScalar(f.clone().dot(b)).clone().add(k);k=k.clone().length()>Number.MIN_VALUE?k.normalize():a.up;f=1*n*this.walkMultiplier;n=Math.cos(0.65);
1!=n&&(d.clone().dot(a.up)<-Number.MIN_VALUE&&d.clone().dot(b)<-n||d.clone().dot(a.up)>Number.MIN_VALUE&&d.clone().dot(b)>n)&&(k=-k);p=-p*this.walkMultiplier*0.05;n=a.up;if(d.clone().dot(a.up)<-Number.MIN_VALUE||Math.abs(d.clone().dot(a.up))<Number.MIN_VALUE&&d.clone().dot(b)>Number.MIN_VALUE)p=-p;n=d;p=(new THREE.Quaternion).setFromAxisAngle(n,p);p.normalize();b=p.clone().rotate(b);b.normalize();a.up.copy(p.clone().rotate(a.up));a.up.normalize();a.position.add(k.clone().multiplyScalar(f));this.center.copy(a.position.clone().add(b.clone().multiplyScalar(c)));
d.normalize();a.lookAt(this.center);g(!1)}};this.updown=function(b){if(!this.navApi.getIsLocked()){var c=Math.pow(b,2);0>b&&(c=-c);c=h(0,c);c.y=0.01*c.y*(n.maxSceneBound-n.minSceneBound);c=n.userHeightSpeed*c.y;var d=n.m_amount;if(0===b)c=0;else{var f=n.saveEye.clone().sub(worldUp.clone().multiplyScalar(d+c)),d=n.saveEye.clone().sub(worldUp.clone().multiplyScalar(d)),k=0,k=(n.maxSceneBound-n.minSceneBound)/1E3;n.topLimit&&0<b?(k=n.maxSceneBound-k,n.topLimit=!1):n.bottomLimit&&0>b?(k=n.minSceneBound+
k,n.bottomLimit=!1):k=f.dot(worldUp);b=d.dot(worldUp);k<n.minSceneBound?b<n.minSceneBound&&(n.bottomLimit=!0,c=0):k>n.maxSceneBound&&b>n.maxSceneBound&&(n.topLimit=!0,c=0)}n.m_amount+=c;b=new THREE.Vector3(0,1,0);c=n.saveEye.clone().sub(b.clone().multiplyScalar(n.m_amount));f=c.clone().dot(b);a.position.copy(c);f<n.minSceneBound&&a.position.add(b.clone().multiplyScalar(n.minSceneBound-f));f>n.maxSceneBound&&a.position.add(b.clone().multiplyScalar(n.maxSceneBound-f));this.center.copy(a.position.clone().add(n.saveCenter.clone().sub(n.saveEye)));
a.lookAt(this.center);g(!1)}};this.addHistoryElement=function(){};this.addIntermediateHistoryElement=function(){this.rewindParams.history=this.rewindParams.snapped?this.rewindParams.history.slice(0,this.rewindParams.timelineIndex):0<this.rewindParams.slideOffset.x?this.rewindParams.history.slice(0,this.rewindParams.timelineIndex):this.rewindParams.history.slice(0,this.rewindParams.timelineIndex+1);this.addHistoryElement()};this.clearHistory=function(){this.rewindParams.history.length=0;this.rewindParams.timelineIndex=
0;this.rewindParams.timelineIndexSlide=0;this.rewindParams.resetWeights=!0};this.openTimeline=function(a){this.rewindParams.timelineIndexSlide=this.rewindParams.timelineIndex;this.rewindParams.resetWeights&&(this.rewindParams.slideOffset.x=0,this.rewindParams.snapped=this.rewindParams.snappingEnabled);0===this.rewindParams.history.length&&this.addHistoryElement();for(var b=0;b<this.rewindParams.history.length;b++){var c=this.rewindParams.thumbnailGapSize+this.rewindParams.thumbnailSize;this.rewindParams.history[b].thumbnailBounds.setCenter((new THREE.Vector2(a.x+
(b-this.rewindParams.timelineIndex)*c,a.y)).add(this.rewindParams.slideOffset));this.rewindParams.resetWeights&&(this.rewindParams.history[b].weight=b==this.rewindParams.timelineIndex?1:0)}this.rewindParams.resetWeights&&(this.rewindParams.resetWeights=!1);c=2*(this.rewindParams.thumbnailGapSize+this.rewindParams.thumbnailSize);this.rewindParams.open=!0;this.rewindParams.openLocation=a.clone();this.rewindParams.openLocationOrigin=a.clone();this.rewindParams.openBracket=a.clone();this.rewindParams.openBracketA=
new THREE.Vector2(c,a.y);this.rewindParams.openBracketB=new THREE.Vector2(window.innerWidth-c,a.y);this.rewindParams.openBracketA.x>this.rewindParams.openBracketB.x&&(a=this.rewindParams.openBracketA.x,this.rewindParams.openBracketA.x=this.rewindParams.openBracketB.x,this.rewindParams.openBracketB.x=a);this.rewindParams.locationOffset=new THREE.Vector2(0,0);this.rewindParams.snapOffset=new THREE.Vector2(0,0)};this.slideTimeline=function(a){if(this.rewindParams.open&&0!==this.rewindParams.history.length){var b=
a.clone().add(this.rewindParams.locationOffset),c=2*(this.rewindParams.thumbnailGapSize+this.rewindParams.thumbnailSize);a=window.innerWidth-c;var d=this.rewindParams.history[0].thumbnailBounds.center().x,f=this.rewindParams.history[this.rewindParams.history.length-1].thumbnailBounds.center().x,g=0;b.x<this.rewindParams.openBracketA.x&&(g=b.x-this.rewindParams.openBracketA.x,d-=g,c<d&&(g=Math.min(g+(d-c),0)));b.x>this.rewindParams.openBracketB.x&&(g=b.x-this.rewindParams.openBracketB.x,c=f-g,a>c&&
(g=Math.max(g+(c-a),0)));this.rewindParams.openLocation.x+=g;this.rewindParams.openBracketA.x+=g;this.rewindParams.openBracketB.x+=g;this.rewindParams.openBracket.x=b.x-(this.rewindParams.openLocation.x-this.rewindParams.openLocationOrigin.x);a=new THREE.Vector2(-g,0);b=b.clone().sub(this.rewindParams.openLocation.clone().sub(this.rewindParams.openLocationOrigin));a.x+=this.rewindParams.snapOffset.x;this.rewindParams.snapOffset.x=0;c=!1;if(this.rewindParams.snappingEnabled)for(f=0;f<this.rewindParams.history.length;f++)if(d=
this.rewindParams.history[f].thumbnailBounds.center().add(a),4>Math.abs(d.x-b.x)||this.rewindParams.snapped&&16>Math.abs(d.x-b.x)){c=!0;0!==g?(this.rewindParams.snapOffset.x=d.x-b.x,a.x-=this.rewindParams.snapOffset.x):this.rewindParams.openBracket.x+=d.x-b.x;b.x=d.x;break}this.rewindParams.snapped=c;c=-1;for(f=g=0;f<this.rewindParams.history.length;f++){d=this.rewindParams.history[f].thumbnailBounds.clone();this.rewindParams.history[f].thumbnailBounds.setCenter(this.rewindParams.history[f].thumbnailBounds.center().add(a));
if(this.rewindParams.history[f].thumbnail){var h=this.rewindParams.history[f].thumbnailBounds.center().x-this.rewindParams.thumbnailSize/2;$("#rewindFrame"+f).css("left",h);$("#rewindBorder"+f).css("left",h-4)}h=new THREE.Vector2(2*(this.rewindParams.thumbnailGapSize+this.rewindParams.thumbnailSize),2*(this.rewindParams.thumbnailGapSize+this.rewindParams.thumbnailSize));d.setFromCenterAndSize(d.center(),h);h=new THREE.Vector2(0,0);d.getIcon2DCoords(b,h);h=1-Math.abs(Math.equalityClamp(h.x,-1,1));
this.rewindParams.history[f].weight=h;0===f&&b.x<d.center().x&&(this.rewindParams.history[f].weight=1);f===this.rewindParams.history.length-1&&b.x>d.center().x&&(this.rewindParams.history[f].weight=1);g+=this.rewindParams.history[f].weight;this.rewindParams.history[f].weight>c&&(c=this.rewindParams.history[f].weight,this.rewindParams.snappingEnabled&&1==this.rewindParams.history[f].weight?(this.rewindParams.slideOffset.x=0,this.rewindParams.snapped=!0):this.rewindParams.slideOffset.x=this.rewindParams.history[f].thumbnailBounds.center().x-
b.x,this.rewindParams.timelineIndexSlide=f)}for(a=0;a<this.rewindParams.history.length;a++)this.rewindParams.history[a].weight/=g;a=this.rewindParams.history[0].thumbnailBounds.center().x;b=this.rewindParams.history[this.rewindParams.history.length-1].thumbnailBounds.center().x;this.rewindParams.openBracket.x<a?(this.rewindParams.locationOffset.x+=a-this.rewindParams.openBracket.x,this.rewindParams.openBracket.x=a):this.rewindParams.openBracket.x>b&&(this.rewindParams.locationOffset.x+=b-this.rewindParams.openBracket.x,
this.rewindParams.openBracket.x=b)}};this.shiftBackOneElement=function(){0!==this.rewindParams.history.length&&(0<this.rewindParams.timelineIndex||0!==this.rewindParams.slideOffset.x)&&((this.rewindParams.snapped||0<this.rewindParams.slideOffset.x)&&this.rewindParams.timelineIndex--,this.rewindParams.timelineIndexSlide=this.rewindParams.timelineIndex,this.rewindParams.resetWeights=!0,n.elapsedTime=0,this.animateToRewindIndex())};this.animateToRewindIndex=function(){var b=this.rewindParams.timelineIndex,
c=0;n.elapsedTime>=F.duration?c=1:(c=Math.easeClamp(n.elapsedTime/F.duration,0,F.destinationPercent),n.elapsedTime+=z/500);n.center.copy(n.center.clone().multiplyScalar(1-c).clone().add(this.rewindParams.history[b].camera.center.clone().multiplyScalar(c)));a.position.copy(a.position.clone().multiplyScalar(1-c).clone().add(this.rewindParams.history[b].camera.position.clone().multiplyScalar(c)));a.up.copy(this.rewindParams.history[b].camera.up);n.pivot.copy(n.center);a.lookAt(n.center);g(!1);q&&requestAnimationFrame(q.render);
1!==c&&requestAnimationFrame(function(){n.animateToRewindIndex()})};this.closeTimeline=function(){this.rewindParams.timelineIndex!=this.rewindParams.timelineIndexSlide&&(this.rewindParams.timelineIndex=this.rewindParams.timelineIndexSlide);this.rewindParams.open=!1};this.getInterpolatedCamera=function(){var b=new THREE.PerspectiveCamera(70,window.innerWidth/window.innerHeight,1,1E4);b.center=new THREE.Vector3(0,0,0);b.pivot=new THREE.Vector3(0,0,0);b.leftFov=0;b.rightFov=0;b.topFov=0;b.bottomFov=
0;b.up.set(0,0,0);for(var c=0;c<this.rewindParams.history.length;c++){var d=this.rewindParams.history[c].camera,f=this.rewindParams.history[c].weight;b.center.add(d.center.clone().multiplyScalar(f));b.position.add(d.position.clone().multiplyScalar(f));b.up.add(d.up.clone().multiplyScalar(f));b.rotation.add(d.rotation.clone().multiplyScalar(f));b.pivot.add(d.pivot.clone().multiplyScalar(f));b.leftFov+=d.leftFov*f;b.rightFov+=d.rightFov*f;b.topFov+=d.topFov*f;b.bottomFov+=d.bottomFov*f}a.position.copy(b.position);
a.up.copy(b.up);a.rotation=b.rotation;a.leftFov=b.leftFov;a.rightFov=b.rightFov;a.topFov=b.topFov;a.bottomFov=b.bottomFov;n.center.copy(b.center);n.pivot.copy(b.pivot);a.lookAt(n.center);a.up.normalize();g(!1)}};
Autocam.ViewCube=function(a,b,c,d){function f(a,b){var c={};0===a.type.indexOf("touch")?0<a.touches.length?(c.clientX=a.touches[0].clientX,c.clientY=a.touches[0].clientY,c.pageX=a.touches[0].pageX,c.pageY=a.touches[0].pageY,c.screenX=a.touches[0].screenX,c.screenY=a.touches[0].screenY,c.movementX=c.screenX-b.prevX,c.movementY=c.screenY-b.prevY,c.which=h.navApi.getUseLeftHandedInput()?3:1):c=b.prevCoords:(c.clientX=a.clientX,c.clientY=a.clientY,c.pageX=a.pageX,c.pageY=a.pageY,c.screenX=a.screenX,c.screenY=
a.screenY,c.which=a.which,Z?(c.movementX=a.movementX||a.mozMovementX||a.webkitMovementX||0,c.movementY=a.movementY||a.mozMovementY||a.webkitMovementY||0):(c.movementX=c.screenX-b.prevX,c.movementY=c.screenY-b.prevY));b.prevX=c.screenX;b.prevY=c.screenY;return b.prevCoords=c}var g=this,h=b,k=b.camera;b.setCube(this);g.currentFace="front";var l="top,front;top right;top,left;top,back;bottom,front;bottom,right;bottom,left;bottom,back;left,front;front,right;right,back;back,left".split(";"),m="front,top,right back,top,right front,top,left back,top,left front,bottom,right back,bottom,right front,bottom,left back,bottom,left".split(" "),
p=["Go Home",null,"Orthographic","Perspective","Perspective with Ortho Faces",null,"Set current view as Home","Focus and set as Home","Reset Home",null,"Set current view as Front","Set current view as Top","Reset orientation"],n=[!0,null,!0,!0,!0,null,!0,!0,!0,null,!0,!0,!0],q=[null,null,function(){return!h.orthographicFaces&&!k.isPerspective},function(){return!h.orthographicFaces&&k.isPerspective},function(){return h.orthographicFaces},null,null,null,null,null,null,null,null],r,v,s,w,z,D,A;g.camera=
new THREE.PerspectiveCamera(45,window.innerWidth/window.innerHeight,1,2E3);g.camera.position.copy(k.position);g.center=new THREE.Vector3(0,0,0);g.camera.lookAt(g.center);var E,N,H,J,G,I=[],M,C=[],K=[],F=[],B=[],R=null,Y=null,S=null,P,ba,U,W,aa,V=0,Q,ka=0,ca=!0,Z=!1,la=!1,Aa=-1!=navigator.userAgent.search("Chrome"),ja=-1!=navigator.platform.search("Win32"),ea=!1,Da=!1,fa=[];this.height=this.width=0;this.animSpeed=500;this.animate=!0;this.compass=!1;this.viewScaleFactorCompass=1.5;this.viewScale=1;
this.draggable=!0;this.wantHomeButton=!1;this.wantContextMenu=this.wantRollArrows=!0;this.inactiveOpacity=0.5;var Ga=function(a){a=a.getBoundingClientRect();return{x:a.left,y:a.top,w:a.width,h:a.height}},bb=function(){h.navApi.getIsLocked()||(c.style.opacity="1.0",Da=!1);requestAnimationFrame(g.render)},Ta=function(a){if(Da||h.viewCubeMenuOpen||h.navApi.getIsLocked())h.navApi.getIsLocked()||(c.style.opacity=1);else{var b=Math.max(4*Math.abs((a.clientX-Q.x)/Q.w-0.5)-1,0);a=Math.max(4*Math.abs((a.clientY-
Q.y)/Q.h-0.5)-1,0);b=Math.max(0,Math.min(Math.sqrt(b*b+a*a),1));c.style.opacity=1-b*(1-g.inactiveOpacity)}},xa=function(){h.viewCubeMenuOpen||(c.style.opacity=g.inactiveOpacity,Da=!0,requestAnimationFrame(g.render))},qa=function(a){var b=new Image;b.crossOrigin="anonymous";var c=new THREE.Texture(b);b.onload=function(){c.needsUpdate=!0;ka++;11<=ka&&requestAnimationFrame(g.render)};b.src=a;return c},Ha=function(a,b,c){var d=new THREE.Vector3;d.copy(a);d=d.unproject(b);return(new THREE.Raycaster(b.position,
d.sub(b.position).normalize())).intersectObjects(c)},Ya=function(a,b){var c=a.clientX-b.x,d=a.clientY-b.y,c=c/b.w*2-1,d=(b.h-d)/b.h*2-1;return new THREE.Vector3(c,d,0.5)},fb=function(a){a.preventDefault();a.stopPropagation();if(!h.navApi.getIsLocked()&&!h.currentlyAnimating){a=f(a,g);Q=Ga(c);c.removeEventListener("mousemove",Wa,!1);document.addEventListener("mouseup",Va,!1);document.addEventListener("touchend",Va,!1);h.navApi.getUsePivotAlways()||(h.pivot.copy(h.center),h.navApi.setPivotPoint(h.center),
h.navApi.setPivotSetFlag(!1));h.startInteraction(a.pageX,a.pageY);0==h.rewindParams.history.length&&h.addHistoryElement();h.rewindParams.snapped&&h.rewindParams.timelineIndex+1==h.rewindParams.history.length||h.addIntermediateHistoryElement();var b=h.navApi.getUseLeftHandedInput()?1:3;a.which!==b&&(0>=g.animSpeed?console.error("animSpeed cannot be 0 or less, use ViewCube.animate flag to turn on and off animation"):(a=Ya(a,Q),a=Ha(a,g.camera,B),0<a.length&&(va(),g.draggable&&(document.addEventListener("mousemove",
Na,!1),document.addEventListener("touchmove",Na,!1),Z&&(c.requestPointerLock(),la=Aa&&ja)))))}},Na=function(a){a.preventDefault();a.stopPropagation();0>=g.animSpeed?(document.removeEventListener("mousemove",Na,!1),document.removeEventListener("touchmove",Na,!1),console.error("animSpeed cannot be 0 or less")):h.currentlyAnimating||(a=f(a,g),Z&&la&&(la=!1,a.movementX=a.movementY=0),a.movementX===a.movementY&&0===a.movementX?h.currentlyAnimating=!1:(ca=!1,ea=!0,h.showPivot(!0),h.currentCursor=new THREE.Vector2(a.pageX,
a.pageY),h.orbit(h.currentCursor,h.startCursor,new THREE.Vector3(-a.movementX,a.movementY,0),h.startState),g.camera.lookAt(g.center),requestAnimationFrame(g.render)))},Ma=function(a){a||(document.removeEventListener("mouseup",Va,!1),document.removeEventListener("touchend",Va,!1));document.removeEventListener("mousemove",Na,!1);document.removeEventListener("touchmove",Na,!1);c.addEventListener("mousemove",Wa,!1)},Va=function(a){a.preventDefault();a.stopPropagation();var b,d,l;if(h.currentlyAnimating||
ea)h.endInteraction(),h.showPivot(!1),ea=!1,Ma(!1);else{var m=f(a,g);if(h.viewCubeMenuOpen){a=m.clientX-Q.x;b=m.clientY-Q.y;if(h.menuOrigin.x<=a&&a<=h.menuOrigin.x+h.menuSize.x&&h.menuOrigin.y<=b&&b<=h.menuOrigin.y+h.menuSize.y)switch(Math.floor((b-5-h.menuOrigin.y)/25)){case 0:h.goHome();break;case 1:h.setOrthographicFaces(!1);h.toOrthographic();break;case 2:h.setOrthographicFaces(!1);h.toPerspective();break;case 3:h.setOrthographicFaces(!0);ca?h.toOrthographic():h.toPerspective();break;case 4:h.setCurrentViewAsHome(!1);
break;case 5:h.setCurrentViewAsHome(!0);break;case 6:h.resetHome();break;case 7:h.setCurrentViewAsFront();break;case 8:h.setCurrentViewAsTop();break;case 9:h.resetOrientation()}h.viewCubeMenuOpen=!1;h.removeDropdownMenu(c);(m.clientX<Q.x||m.clientX>Q.w+Q.x||m.clientY<Q.y||m.clientY>Q.h+Q.y)&&xa();g.mouseMoveSave&&g.processMouseMove(g.mouseMoveSave);Ma(!1)}else if(b=h.navApi.getUseLeftHandedInput()?1:3,m.which===b)h.viewCubeMenuOpen=!0,h.drawDropdownMenu(p,n,q,m.clientX,m.clientY,c,Q),Ma(!0);else{l=
Ya(m,Q);b=Ha(l,g.camera,B);d=Ha(l,A,C);l=Ha(l,A,F);if(0<d.length&&ca){var K=h.getOrientation();switch(g.currentFace){case "front":switch(K){case "up":d[0].object===C[0]?(h.calculateCubeTransform("top"),g.currentFace="top"):d[0].object===C[1]?(h.calculateCubeTransform("bottom"),g.currentFace="bottom"):d[0].object===C[2]?(h.calculateCubeTransform("right"),g.currentFace="right"):d[0].object===C[3]&&(h.calculateCubeTransform("left"),g.currentFace="left");break;case "right":d[0].object===C[0]?(h.calculateCubeTransform("right"),
g.currentFace="right"):d[0].object===C[1]?(h.calculateCubeTransform("left"),g.currentFace="left"):d[0].object===C[2]?(h.calculateCubeTransform("bottom"),g.currentFace="bottom"):d[0].object===C[3]&&(h.calculateCubeTransform("top"),g.currentFace="top");break;case "down":d[0].object===C[0]?(h.calculateCubeTransform("bottom"),g.currentFace="bottom"):d[0].object===C[1]?(h.calculateCubeTransform("top"),g.currentFace="top"):d[0].object===C[2]?(h.calculateCubeTransform("left"),g.currentFace="left"):d[0].object===
C[3]&&(h.calculateCubeTransform("right"),g.currentFace="right");break;case "left":d[0].object===C[0]?(h.calculateCubeTransform("left"),g.currentFace="left"):d[0].object===C[1]?(h.calculateCubeTransform("right"),g.currentFace="right"):d[0].object===C[2]?(h.calculateCubeTransform("top"),g.currentFace="top"):d[0].object===C[3]&&(h.calculateCubeTransform("bottom"),g.currentFace="bottom")}break;case "right":switch(K){case "up":d[0].object===C[0]?(h.calculateCubeTransform("top"),g.currentFace="top"):d[0].object===
C[1]?(h.calculateCubeTransform("bottom"),g.currentFace="bottom"):d[0].object===C[2]?(h.calculateCubeTransform("back"),g.currentFace="back"):d[0].object===C[3]&&(h.calculateCubeTransform("front"),g.currentFace="front");break;case "right":d[0].object===C[0]?(h.calculateCubeTransform("back"),g.currentFace="back"):d[0].object===C[1]?(h.calculateCubeTransform("front"),g.currentFace="front"):d[0].object===C[2]?(h.calculateCubeTransform("bottom"),g.currentFace="bottom"):d[0].object===C[3]&&(h.calculateCubeTransform("top"),
g.currentFace="top");break;case "down":d[0].object===C[0]?(h.calculateCubeTransform("bottom"),g.currentFace="bottom"):d[0].object===C[1]?(h.calculateCubeTransform("top"),g.currentFace="top"):d[0].object===C[2]?(h.calculateCubeTransform("front"),g.currentFace="front"):d[0].object===C[3]&&(h.calculateCubeTransform("back"),g.currentFace="back");break;case "left":d[0].object===C[0]?(h.calculateCubeTransform("front"),g.currentFace="front"):d[0].object===C[1]?(h.calculateCubeTransform("back"),g.currentFace=
"back"):d[0].object===C[2]?(h.calculateCubeTransform("top"),g.currentFace="top"):d[0].object===C[3]&&(h.calculateCubeTransform("bottom"),g.currentFace="bottom")}break;case "left":switch(K){case "up":d[0].object===C[0]?(h.calculateCubeTransform("top"),g.currentFace="top"):d[0].object===C[1]?(h.calculateCubeTransform("bottom"),g.currentFace="bottom"):d[0].object===C[2]?(h.calculateCubeTransform("front"),g.currentFace="front"):d[0].object===C[3]&&(h.calculateCubeTransform("back"),g.currentFace="back");
break;case "right":d[0].object===C[0]?(h.calculateCubeTransform("front"),g.currentFace="front"):d[0].object===C[1]?(h.calculateCubeTransform("back"),g.currentFace="back"):d[0].object===C[2]?(h.calculateCubeTransform("bottom"),g.currentFace="bottom"):d[0].object===C[3]&&(h.calculateCubeTransform("top"),g.currentFace="top");break;case "down":d[0].object===C[0]?(h.calculateCubeTransform("bottom"),g.currentFace="bottom"):d[0].object===C[1]?(h.calculateCubeTransform("top"),g.currentFace="top"):d[0].object===
C[2]?(h.calculateCubeTransform("back"),g.currentFace="back"):d[0].object===C[3]&&(h.calculateCubeTransform("front"),g.currentFace="front");break;case "left":d[0].object===C[0]?(h.calculateCubeTransform("back"),g.currentFace="back"):d[0].object===C[1]?(h.calculateCubeTransform("front"),g.currentFace="front"):d[0].object===C[2]?(h.calculateCubeTransform("top"),g.currentFace="top"):d[0].object===C[3]&&(h.calculateCubeTransform("bottom"),g.currentFace="bottom")}break;case "back":switch(K){case "up":d[0].object===
C[0]?(h.calculateCubeTransform("top"),g.currentFace="top"):d[0].object===C[1]?(h.calculateCubeTransform("bottom"),g.currentFace="bottom"):d[0].object===C[2]?(h.calculateCubeTransform("left"),g.currentFace="left"):d[0].object===C[3]&&(h.calculateCubeTransform("right"),g.currentFace="right");break;case "right":d[0].object===C[0]?(h.calculateCubeTransform("left"),g.currentFace="left"):d[0].object===C[1]?(h.calculateCubeTransform("right"),g.currentFace="right"):d[0].object===C[2]?(h.calculateCubeTransform("bottom"),
g.currentFace="bottom"):d[0].object===C[3]&&(h.calculateCubeTransform("top"),g.currentFace="top");break;case "down":d[0].object===C[0]?(h.calculateCubeTransform("bottom"),g.currentFace="bottom"):d[0].object===C[1]?(h.calculateCubeTransform("top"),g.currentFace="top"):d[0].object===C[2]?(h.calculateCubeTransform("right"),g.currentFace="right"):d[0].object===C[3]&&(h.calculateCubeTransform("left"),g.currentFace="left");break;case "left":d[0].object===C[0]?(h.calculateCubeTransform("right"),g.currentFace=
"right"):d[0].object===C[1]?(h.calculateCubeTransform("left"),g.currentFace="left"):d[0].object===C[2]?(h.calculateCubeTransform("top"),g.currentFace="top"):d[0].object===C[3]&&(h.calculateCubeTransform("bottom"),g.currentFace="bottom")}break;case "top":switch(K){case "up":d[0].object===C[0]?(h.calculateCubeTransform("back"),g.currentFace="back"):d[0].object===C[1]?(h.calculateCubeTransform("front"),g.currentFace="front"):d[0].object===C[2]?(h.calculateCubeTransform("right"),g.currentFace="right"):
d[0].object===C[3]&&(h.calculateCubeTransform("left"),g.currentFace="left");break;case "right":d[0].object===C[0]?(h.calculateCubeTransform("right"),g.currentFace="right"):d[0].object===C[1]?(h.calculateCubeTransform("left"),g.currentFace="left"):d[0].object===C[2]?(h.calculateCubeTransform("front"),g.currentFace="front"):d[0].object===C[3]&&(h.calculateCubeTransform("back"),g.currentFace="back");break;case "down":d[0].object===C[0]?(h.calculateCubeTransform("front"),g.currentFace="front"):d[0].object===
C[1]?(h.calculateCubeTransform("back"),g.currentFace="back"):d[0].object===C[2]?(h.calculateCubeTransform("left"),g.currentFace="left"):d[0].object===C[3]&&(h.calculateCubeTransform("right"),g.currentFace="right");break;case "left":d[0].object===C[0]?(h.calculateCubeTransform("left"),g.currentFace="left"):d[0].object===C[1]?(h.calculateCubeTransform("right"),g.currentFace="right"):d[0].object===C[2]?(h.calculateCubeTransform("back"),g.currentFace="back"):d[0].object===C[3]&&(h.calculateCubeTransform("front"),
g.currentFace="front")}break;case "bottom":switch(K){case "up":d[0].object===C[0]?(h.calculateCubeTransform("front"),g.currentFace="front"):d[0].object===C[1]?(h.calculateCubeTransform("back"),g.currentFace="back"):d[0].object===C[2]?(h.calculateCubeTransform("right"),g.currentFace="right"):d[0].object===C[3]&&(h.calculateCubeTransform("left"),g.currentFace="left");break;case "right":d[0].object===C[0]?(h.calculateCubeTransform("right"),g.currentFace="right"):d[0].object===C[1]?(h.calculateCubeTransform("left"),
g.currentFace="left"):d[0].object===C[2]?(h.calculateCubeTransform("back"),g.currentFace="back"):d[0].object===C[3]&&(h.calculateCubeTransform("front"),g.currentFace="front");break;case "down":d[0].object===C[0]?(h.calculateCubeTransform("back"),g.currentFace="back"):d[0].object===C[1]?(h.calculateCubeTransform("front"),g.currentFace="front"):d[0].object===C[2]?(h.calculateCubeTransform("left"),g.currentFace="left"):d[0].object===C[3]&&(h.calculateCubeTransform("right"),g.currentFace="right");break;
case "left":d[0].object===C[0]?(h.calculateCubeTransform("left"),g.currentFace="left"):d[0].object===C[1]?(h.calculateCubeTransform("right"),g.currentFace="right"):d[0].object===C[2]?(h.calculateCubeTransform("front"),g.currentFace="front"):d[0].object===C[3]&&(h.calculateCubeTransform("back"),g.currentFace="back")}}h.elapsedTime=0;h.sphericallyInterpolateTransition()}if(0<l.length){h.elapsedTime=0;if(g.wantHomeButton&&l[0].object===F[W]){h.goHome();Ma(!1);return}if(g.wantContextMenu&&l[0].object===
F[aa]){h.viewCubeMenuOpen=!0;h.drawDropdownMenu(p,n,q,m.clientX,m.clientY,c,Q);Ma(!0);return}g.wantRollArrows&&ca&&(l[0].object===F[P]||l[0].object===F[ba])&&(m=l[0].object===F[ba],d={center:h.center.clone(),position:k.position.clone(),pivot:k.pivot.clone(),fov:k.fov,worldUp:h.sceneUpDirection.clone(),isOrtho:!1===k.isPerspective},l=h.center.clone().sub(k.position).normalize(),m?d.up=k.up.clone().cross(l):(d.up=k.up.clone().multiplyScalar(-1),d.up.cross(l)),d.up.normalize(),h.elapsedTime=0,h.animateTransition(d))}0<
b.length&&(g.currentFace=b[0].object.name,h.orthographicFaces&&-1!==g.currentFace.indexOf(",")&&h.setCameraOrtho(!1),h.calculateCubeTransform(g.currentFace),h.elapsedTime=0,g.mouseMoveSave=a,h.sphericallyInterpolateTransition(function(){g.mouseMoveSave&&g.processMouseMove(g.mouseMoveSave)}));Ma(!1)}}};this.processMouseMove=function(a){var b,c;if(h.viewCubeMenuOpen||h.currentlyAnimating)g.mouseMoveSave=a;else{g.mouseMoveSave=null;a=f(a,g);c=Ya(a,Q);a=Ha(c,g.camera,K);b=Ha(c,A,C);c=Ha(c,A,F);R&&!ea&&
(R.material.color.setHex(14540253),R=null,requestAnimationFrame(g.render));if(0<b.length&&!ea){R=b[0].object;for(b=M.children.length;0<=--b;)if(R===C[b]){R=M.children[b];R.material.color.setHex(45055);break}requestAnimationFrame(g.render)}Y&&!ea&&(Y.material.opacity=0,Y=null,requestAnimationFrame(g.render));0<a.length&&!ea&&(Y=a[0].object,Y.material.opacity=0.3,requestAnimationFrame(g.render));0<c.length&&!ea?S!==c[0].object&&(g.wantHomeButton&&c[0].object===F[W]?(S=c[0].object,F[W].material.map=
fa[0]):g.wantRollArrows&&c[0].object===F[P]?(S=c[0].object,F[U].material.map=fa[1]):g.wantRollArrows&&c[0].object===F[ba]?(S=c[0].object,F[U].material.map=fa[2]):g.wantContextMenu&&c[0].object===F[aa]?(S=c[0].object,F[aa].material.map=fa[6]):g.wantHomeButton&&S===F[W]?(S=null,F[W].material.map=fa[3]):!g.wantRollArrows||S!==F[P]&&S!==F[ba]&&S!==F[U]?g.wantContextMenu&&S===F[aa]&&(S=null,F[aa].material.map=fa[5]):(S=null,F[U].material.map=fa[4]),requestAnimationFrame(g.render)):null===S||ea||(g.wantHomeButton&&
S===F[W]?(S=null,F[W].material.map=fa[3]):!g.wantRollArrows||S!==F[P]&&S!==F[ba]&&S!==F[U]?g.wantContextMenu&&S===F[aa]&&(S=null,F[aa].material.map=fa[5]):(S=null,F[U].material.map=fa[4]),requestAnimationFrame(g.render))}};var Wa=function(a){h.navApi.getIsLocked()||g.processMouseMove(a)},sa=function(){Q=Ga(c);g.width=c.offsetWidth;g.height=c.offsetHeight;g.camera.aspect=g.width/g.height;g.camera.updateProjectionMatrix();g.camera.topFov=g.camera.bottomFov=g.camera.fov/2;g.camera.leftFov=g.camera.rightFov=
g.camera.aspect*g.camera.fov/2;D.setSize(g.width,g.height);requestAnimationFrame(g.render)},Ia=function(a,b){var c,d=new THREE.Geometry;c=new THREE.Vector3(0,0,0);var f=new THREE.Vector3(60,-60,105),g=new THREE.Vector3(60,60,105),h=new THREE.Vector3(-60,60,105),k=new THREE.Vector3(-60,-60,105);d.vertices.push(c);d.vertices.push(f);d.vertices.push(g);d.vertices.push(h);d.vertices.push(k);d.faces.push(new THREE.Face3(1,2,3));d.faces.push(new THREE.Face3(1,3,4));d.applyMatrix((new THREE.Matrix4).makeRotationX(a));
d.applyMatrix((new THREE.Matrix4).makeRotationY(b));d.computeFaceNormals();d.computeVertexNormals();c=new THREE.MeshBasicMaterial({overdraw:!0,opacity:0,color:45055,transparent:!0});return new THREE.Mesh(d,c)},da=function(a,b,c){var d=new THREE.Geometry,f=new THREE.Vector3(60,105,105),g=new THREE.Vector3(-60,105,105),h=new THREE.Vector3(-60,60,105),k=new THREE.Vector3(60,60,105),l=new THREE.Vector3(60,105,60),m=new THREE.Vector3(-60,105,60),n=new THREE.Vector3(-60,105,105),p=new THREE.Vector3(60,
105,105);d.vertices.push(f);d.vertices.push(g);d.vertices.push(h);d.vertices.push(k);d.vertices.push(l);d.vertices.push(m);d.vertices.push(n);d.vertices.push(p);d.faces.push(new THREE.Face3(0,1,2));d.faces.push(new THREE.Face3(0,2,3));d.faces.push(new THREE.Face3(4,5,6));d.faces.push(new THREE.Face3(4,6,7));d.applyMatrix((new THREE.Matrix4).makeRotationX(a));d.applyMatrix((new THREE.Matrix4).makeRotationY(b));d.applyMatrix((new THREE.Matrix4).makeRotationZ(c));d.computeFaceNormals();d.computeVertexNormals();
a=new THREE.MeshBasicMaterial({overdraw:!0,opacity:0,color:45055,transparent:!0});return new THREE.Mesh(d,a)},pa=function(a,b){var c,d=new THREE.Geometry;c=new THREE.Vector3(105,105,105);var f=new THREE.Vector3(60,105,105),g=new THREE.Vector3(60,60,105),h=new THREE.Vector3(105,60,105),k=new THREE.Vector3(105,105,60),l=new THREE.Vector3(105,105,105),m=new THREE.Vector3(105,60,105),n=new THREE.Vector3(105,60,60),p=new THREE.Vector3(105,105,105),q=new THREE.Vector3(105,105,60),K=new THREE.Vector3(60,
105,60),r=new THREE.Vector3(60,105,105);d.vertices.push(c);d.vertices.push(f);d.vertices.push(g);d.vertices.push(h);d.vertices.push(k);d.vertices.push(l);d.vertices.push(m);d.vertices.push(n);d.vertices.push(p);d.vertices.push(q);d.vertices.push(K);d.vertices.push(r);d.faces.push(new THREE.Face3(0,1,2));d.faces.push(new THREE.Face3(0,2,3));d.faces.push(new THREE.Face3(4,5,6));d.faces.push(new THREE.Face3(4,6,7));d.faces.push(new THREE.Face3(8,9,10));d.faces.push(new THREE.Face3(8,10,11));d.applyMatrix((new THREE.Matrix4).makeRotationX(a));
d.applyMatrix((new THREE.Matrix4).makeRotationY(b));d.computeFaceNormals();d.computeVertexNormals();c=new THREE.MeshBasicMaterial({overdraw:!0,opacity:0,color:45055,transparent:!0});return new THREE.Mesh(d,c)},Oa=function(a){var b=h.cubeFront.clone(),c=h.sceneUpDirection.clone(),d=b.clone().cross(c);c.copy(d).cross(b);b.normalize();c.normalize();d.normalize();var f=(new THREE.Vector3(b.x,c.x,d.x)).multiplyScalar(a.x);f.add((new THREE.Vector3(b.y,c.y,d.y)).multiplyScalar(a.y));f.add((new THREE.Vector3(b.z,
c.z,d.z)).multiplyScalar(a.z));return f};this.render=function(){var a=g.compass?g.viewScaleFactorCompass*g.viewScale:g.viewScale,b=h.center.clone().sub(k.position).normalize(),c=k.up.normalize(),b=Oa(b),c=Oa(c);g.camera.position.copy(b);g.camera.position.multiplyScalar(-a/g.camera.position.length());g.camera.up=c.normalize();g.camera.lookAt(g.center);ca=h.isFaceView();!ca||Da||h.currentlyAnimating?va():(z.add(M),a=g.wantRollArrows?1:0,F[U].material.opacity=a,F[aa].material.opacity=a);G.material.opacity=
Da?0:g.wantContextMenu?1:0;H.material.opacity=Da?0:g.wantHomeButton?1:0;D.clear();D.render(r,g.camera);D.render(v,g.camera);D.render(w,g.camera);D.render(s,g.camera);D.render(z,A)};var va=function(){z.remove(M);F[U].material.opacity=0;F[aa].material.opacity=0};this.refreshCube=function(){sa()};this.setSize=function(a,b){g.width=a;g.height=b;if(1<c.children.length)for(var d=1;d<c.children.length;d++)c.children[d].style.bottom=(g.height/5).toString()+"px";sa()};this.useTransparency=function(a){(Da=
a)?(c.onmouseover=bb,c.onmousemove=Ta,c.onmouseout=xa,xa()):(c.onmouseover=null,c.onmouseout=null,c.onmousemove=null,c.style.opacity="1.0")};(function(){var a=c.getBoundingClientRect();g.width=a.width;g.height=a.height;Q=Ga(c);A=new THREE.PerspectiveCamera(70,g.height/g.width,1,1E4);A.position.set(0,0,500);r=new THREE.Scene;v=new THREE.Scene;s=new THREE.Scene;w=new THREE.Scene;z=new THREE.Scene;ca=!0;V=200;g.viewScale=3.5*V;var b=THREE.LinearFilter,a=Autodesk.Viewing.Private.getResourceUrl,f=d||"res/textures/",
k=(new THREE.DDSLoader).load(a(f+"VCcrossRGBA8small.dds"));k.minFilter=k.maxFilter=b;f=THREE.ShaderLib.cube;f=new THREE.ShaderMaterial({fragmentShader:f.fragmentShader,vertexShader:f.vertexShader,uniforms:THREE.UniformsUtils.clone(f.uniforms),depthWrite:!1});f.uniforms.tCube.value=k;var n=new THREE.BoxGeometry(V,V,V,2,2,2),k=new THREE.BoxGeometry(V+1,V+1,V+1,2,2,2);E=new THREE.Mesh(n,f);E.position.set(0,0,0);v.add(E);f=qa(a("res/textures/VCedge1.png"));f.minFilter=f.maxFilter=b;N=new THREE.Mesh(k,
new THREE.MeshBasicMaterial({map:f,overdraw:!1,transparent:!0,shading:THREE.SmoothShading}));N.position.set(0,0,0);w.add(N);var b=V,f=new THREE.Geometry,k=new THREE.Vector3(-30,0,0),n=new THREE.Vector3(30,0,0),p=new THREE.Vector3(0,-30,0);f.vertices.push(k);f.vertices.push(n);f.vertices.push(p);f.faces.push(new THREE.Face3(1,0,2));f.computeFaceNormals();var p=new THREE.MeshBasicMaterial({overdraw:!0,color:14540253,transparent:!1,opacity:1,shading:THREE.FlatShading}),q=new THREE.MeshBasicMaterial({overdraw:!0,
color:14540253,transparent:!1,opacity:1,shading:THREE.FlatShading}),R=new THREE.MeshBasicMaterial({overdraw:!0,color:14540253,transparent:!1,opacity:1,shading:THREE.FlatShading}),S=new THREE.MeshBasicMaterial({overdraw:!0,color:14540253,transparent:!1,opacity:1,shading:THREE.FlatShading}),k=new THREE.PlaneBufferGeometry(0.5*V,0.3*V,2,2),n=new THREE.MeshBasicMaterial({transparent:!0,opacity:0}),p=new THREE.Mesh(f,p),Y=new THREE.Mesh(k,n);p.position.set(0,b,0);Y.position.set(0,0.9*b,0.1);var q=new THREE.Mesh(f,
q),ka=new THREE.Mesh(k,n);q.position.set(0,-b,0);ka.position.set(0,0.9*-b,0.1);q.rotation.z+=Math.PI;ka.rotation.z+=Math.PI;var R=new THREE.Mesh(f,R),la=new THREE.Mesh(k,n);R.position.set(b,0,0);la.position.set(0.9*b,0,0.1);R.rotation.z-=Math.PI/2;la.rotation.z-=Math.PI/2;f=new THREE.Mesh(f,S);k=new THREE.Mesh(k,n);f.position.set(-b,0,0);k.position.set(0.9*-b,0,0.1);f.rotation.z+=Math.PI/2;k.rotation.z+=Math.PI/2;M=new THREE.Object3D;M.position.set(0,0,0);M.add(p);M.add(q);M.add(R);M.add(f);z.add(Y);
z.add(ka);z.add(la);z.add(k);z.add(M);C.push(Y);C.push(ka);C.push(la);C.push(k);b=new THREE.PlaneBufferGeometry(V/3,V/3,2,2);f=new THREE.MeshBasicMaterial({map:qa(a("res/textures/VChome.png")),transparent:!0,shading:THREE.FlatShading});H=new THREE.Mesh(b,f);H.position.set(-V,V,0);W=F.length;z.add(H);F.push(H);b=new THREE.PlaneBufferGeometry(1.5*V,1.5*V,2,2);f=new THREE.MeshBasicMaterial({map:qa(a("res/textures/VCarrows.png")),shading:THREE.FlatShading,transparent:!0});b=new THREE.Mesh(b,f);b.position.set(0.5*
V+20,0.5*V+20,0);f=new THREE.PlaneBufferGeometry(0.6*V,0.45*V,2,2);k=new THREE.MeshBasicMaterial({transparent:!0,opacity:0});f=new THREE.Mesh(f,k);f.position.set(0.5*V+20,V+20,0.1);k=new THREE.PlaneBufferGeometry(0.45*V,0.6*V,2,2);n=new THREE.MeshBasicMaterial({transparent:!0,opacity:0});k=new THREE.Mesh(k,n);k.position.set(V+20,0.5*V+20,0.1);z.add(b);z.add(f);z.add(k);P=F.length;F.push(f);ba=F.length;F.push(k);U=F.length;F.push(b);b=new THREE.PlaneBufferGeometry(V/2.3,V/2.3,2,2);f=new THREE.MeshBasicMaterial({map:qa(a("res/textures/VCcontext.png")),
transparent:!0,shading:THREE.FlatShading});G=new THREE.Mesh(b,f);G.position.set(V,-V,0);aa=F.length;z.add(G);F.push(G);b=new THREE.Geometry;b.vertices.push(new THREE.Vector3(0,0,0));b.vertices.push(new THREE.Vector3(-V/2,-V/2-20,-V/2));b.vertices.push(new THREE.Vector3(V/2,-V/2-20,-V/2));b.vertices.push(new THREE.Vector3(V/2,-V/2-20,V/2));b.vertices.push(new THREE.Vector3(-V/2,-V/2-20,V/2));b.faces.push(new THREE.Face3(4,3,2));b.faces.push(new THREE.Face3(4,2,1));f=new THREE.MeshBasicMaterial({color:0,
transparent:!0,opacity:0.5});J=new THREE.Mesh(b,f);r.add(J);f=[];k=[];f[0]=pa(0,0);f[1]=pa(0,Math.PI/2);f[2]=pa(0,-Math.PI/2);f[3]=pa(0,Math.PI);f[4]=pa(Math.PI/2,0);f[5]=pa(Math.PI/2,Math.PI/2);f[6]=pa(Math.PI/2,-Math.PI/2);f[7]=pa(Math.PI/2,Math.PI);k[0]=da(0,0,0);k[1]=da(0,Math.PI/2,0);k[2]=da(0,-Math.PI/2,0);k[3]=da(0,Math.PI,0);k[4]=da(Math.PI/2,0,0);k[5]=da(Math.PI/2,Math.PI/2,0);k[6]=da(Math.PI/2,-Math.PI/2,0);k[7]=da(Math.PI/2,Math.PI,0);k[8]=da(0,0,Math.PI/2);k[9]=da(0,0,-Math.PI/2);k[10]=
da(-Math.PI/2,0,-Math.PI/2);k[11]=da(-Math.PI,0,-Math.PI/2);I.push(Ia(0,0));I[0].name="front";K.push(I[0]);B.push(I[0]);s.add(I[0]);I.push(Ia(0,Math.PI/2));I[1].name="right";K.push(I[1]);B.push(I[1]);s.add(I[1]);I.push(Ia(0,Math.PI));I[2].name="back";K.push(I[2]);B.push(I[2]);s.add(I[2]);I.push(Ia(0,-Math.PI/2));I[3].name="left";K.push(I[3]);B.push(I[3]);s.add(I[3]);I.push(Ia(Math.PI/2,0));I[4].name="bottom";K.push(I[4]);B.push(I[4]);s.add(I[4]);I.push(Ia(-Math.PI/2,0));I[5].name="top";K.push(I[5]);
B.push(I[5]);s.add(I[5]);b=I.length;for(n=0;n<f.length;n++)I.push(f[n]),I[b+n].name=m[n],s.add(I[b+n]),K.push(I[b+n]),B.push(I[b+n]);b=I.length;for(n=0;n<k.length;n++)I.push(k[n]),I[b+n].name=l[n],s.add(I[b+n]),K.push(I[b+n]),B.push(I[b+n]);"CANVAS"===h.renderer.toUpperCase()?D=new THREE.CanvasRenderer:"WEBGL"===h.renderer.toUpperCase()?D=new FireflyWebGLRenderer({alpha:!0}):(console.log("Incorrect use of Autocam.renderer property"),D=new THREE.CanvasRenderer);g.useTransparency(!0);g.setSize(g.width,
g.height);g.camera.topFov=g.camera.bottomFov=g.camera.fov/2;g.camera.leftFov=g.camera.rightFov=g.camera.aspect*g.camera.fov/2;D.autoClear=!1;D.setSize(g.width,g.height);D.sortObjects=!1;c.appendChild(D.domElement);c.addEventListener("touchstart",fb,!1);c.addEventListener("mousedown",fb,!1);c.addEventListener("mousemove",Wa,!1);window.addEventListener("resize",sa,!1);Z=!1;fa.push(qa(a("res/textures/VChomeS.png")));fa.push(qa(a("res/textures/VCarrowsS0.png")));fa.push(qa(a("res/textures/VCarrowsS1.png")));
fa.push(qa(a("res/textures/VChome.png")));fa.push(qa(a("res/textures/VCarrows.png")));fa.push(qa(a("res/textures/VCcontext.png")));fa.push(qa(a("res/textures/VCcontextS.png")))})()};AutodeskNamespace("Autodesk.Viewing");
Autodesk.Viewing.ToolController=function(a,b,c,d,f){function g(a,c){return b.navigation.getUseLeftHandedInput()&&0===a||k&&1===a||h&&!m&&0===a&&c.ctrlKey}this.domElement=a.canvas;this.selector=a.selector;this.autocam=c;this.lastClickY=this.lastClickX=-1;var h=-1!=navigator.userAgent.search("Mac OS"),k=-1!=navigator.userAgent.search("Firefox"),l=-1!==navigator.userAgent.search("Chrome"),m=-1!==navigator.userAgent.search("Safari")&&!l,p={},n=[],q=!1,r=-1,v=-1,s=!1,w=null,z=void 0,D=!1,A={},E=this;this.__registerToolByName=
function(a,b){p[b]=a;a.utilities=d;a.controller=this};this.registerTool=function(a){var b=a.getNames();if(!b||0==b.length)return console.log("Cannot register tool with no name."),!1;for(var c=!1,d=0;d<b.length;++d)"default"!==b[d]&&(this.__registerToolByName(a,b[d]),c=!0);return c};this.deregisterTool=function(a){var b=a.getNames();if(!b||0==b.length)return!1;for(var c=b.length;0<=--c;)this.__deregisterToolName(b[c]);a.utilities=null;a.controller=null;return!0};this.__deregisterToolName=function(a){if(a in
p){for(var b=n.length;0<=--b;)n[b]===a&&(p[a].deactivate(a),n.splice(b,1));delete p[a]}};this.getTool=function(a){return p[a]};this.getActiveToolName=function(){var a=n.length;return 0<a?n[a-1]:"default"};this.activateTool=function(a){if(q)return!1;var c=p[a];if(c)return n.push(a),c.activate(a),b.fireEvent({type:Autodesk.Viewing.TOOL_CHANGE_EVENT,toolName:a,active:!0}),!0;stderr("activateTool not found: "+a);return!1};this.deactivateTool=function(a){if(q)return!1;for(var c=n.length;0<=--c;)if(n[c]===
a)return n.splice(c,1),p[a].deactivate(a),b.fireEvent({type:Autodesk.Viewing.TOOL_CHANGE_EVENT,toolName:a,active:!1}),!0;stderr("deactivateTool not found: "+a);return!1};this.getToolNames=function(){return Object.keys(p)};this.setDefaultTool=function(a){var b=this.getDefaultTool();return a&&a!==b?(this.__registerToolByName(a,"default"),b&&b.deactivate("default"),a.activate("default"),!0):!1};this.getDefaultTool=function(){return p["default"]};this.setDefaultTool(f);this.setIsLocked=function(a){var b=
q;q=!!a;return b};this.getIsLocked=function(){return q};this.__checkCursor=function(){for(var a=null,c=n.length;0<=--c;){var d=p[n[c]];if("getCursor"in d&&(a=d.getCursor()))break}a||(a="auto");w!=a&&(w=b.canvas.style.cursor=a)};this.update=function(a){this.__checkCursor();var c=!1;d&&d.update()&&(c=!0);for(var f=n.length;0<=--f;){var g=p[n[f]];"update"in g&&g.update(a)&&(c=!0)}b.navigation.getCamera().dirty?(b.navigation.updateCamera(),this.cameraUpdated=c=!0):this.cameraUpdated=!1;c?(b.navigation.updateCamera(),
this.moveDelay=Date.now()+150):0!==this.moveDelay&&(0<this.moveDelay-Date.now()?c=!0:this.moveDelay=0);return c};this.__clientToCanvasCoords=function(a,c,d){var f=b.navigation.getScreenViewport(),g=f.width,h=f.height,k=a.clientX-f.left,f=a.clientY-f.top;a.canvasX=k;a.canvasY=f;a.normalizedX=k/g*2-1;a.normalizedY=(h-f)/h*2-1;c&&c.set(k/g,f/h,0);d&&d.set(k,f)};this.__invokeStack=function(a,b,c){for(var d=n.length;0<=--d;){var f=p[n[d]];if(a in f&&f[a](b,c))return!0}d=this.getDefaultTool();return a in
d&&d[a](b,c)?!0:!1};this.distributeEvent=function(a,b,c){return this.__invokeStack(a,b,c)};this.handleResize=function(){b.navigation.setScreenViewport(b.container.getBoundingClientRect());for(var a=n.length;0<=--a;){var c=p[n[a]];"handleResize"in c&&c.handleResize()}};this.handleSingleClick=function(a){var b=this.applyButtonMappings(a);this.lastClickX=a.clientX;this.lastClickY=a.clientY;this.__invokeStack("handleSingleClick",a,b)&&(a.preventDefault(),a.stopPropagation())};this.handleDoubleClick=function(a){var b=
this.applyButtonMappings(a);this.__invokeStack("handleDoubleClick",a,b)&&(a.preventDefault(),a.stopPropagation())};this.handleSingleTap=function(a){this.lastClickX=a.canvasX;this.lastClickY=a.canvasY;this.__invokeStack("handleSingleTap",a)&&(a.preventDefault(),a.stopPropagation())};this.handleDoubleTap=function(a){this.lastClickX=a.canvasX;this.lastClickY=a.canvasY;this.__invokeStack("handleDoubleTap",a)&&(a.preventDefault(),a.stopPropagation())};this.handleWheelInput=function(a,b){this.__invokeStack("handleWheelInput",
a)&&(b.preventDefault(),b.stopPropagation())};this.applyButtonMappings=function(a){var c=a.button;"buttons"in a&&(a.firefoxSpoof?c=0:!s||a.buttons&1?2===c&&a.buttons&1&&(c=0,a.firefoxSpoof=s=!0):(a.firefoxSpoof=!0,s=!1,c=0));b.navigation.getUseLeftHandedInput()&&(c=0===c?2:2===c?0:c);return c};this.applyKeyMappings=function(a,b){switch(a.keyCode){case 91:case 93:case 224:return h&&a.metaKey&&a.shiftKey?null:17;case 16:return b&&h&&a.metaKey?null:16;case 61:return 187;case 173:case 109:return 189}return a.keyCode};
this.handleKeyDown=function(a){var b=this.applyKeyMappings(a,!0);b&&this.__invokeStack("handleKeyDown",a,b)&&(a.preventDefault(),a.stopPropagation())};this.handleKeyUp=function(a){var b=this.applyKeyMappings(a,!0);b&&this.__invokeStack("handleKeyUp",a,b)&&(a.preventDefault(),a.stopPropagation())};this.handleButtonDown=function(a,b){this.__invokeStack("handleButtonDown",a,b)&&(a.preventDefault(),a.stopPropagation())};this.handleButtonUp=function(a,b){this.__invokeStack("handleButtonUp",a,b)&&(a.preventDefault(),
a.stopPropagation())};this.handleMouseMove=function(a){this.__invokeStack("handleMouseMove",a)&&(a.preventDefault(),a.stopPropagation())};this.handleBlur=function(a){this.__invokeStack("handleBlur",a)&&(a.preventDefault(),a.stopPropagation())};this.keydown=function(b){z!==a.canvas||document.activeElement instanceof HTMLInputElement||document.activeElement instanceof HTMLTextAreaElement||h&&b.metaKey&&91!=b.keyCode&&93!=b.keyCode||E.handleKeyDown(b)};this.keyup=function(a){h&&a.metaKey&&91!=a.keyCode&&
93!=a.keyCode||E.handleKeyUp(a)};this.mousedown=function(a){function b(a){E.applyButtonMappings(a)===c&&(document.removeEventListener("mouseup",b),E.mouseup(a))}_isIE11&&inFullscreen()||document.activeElement.blur();E.__clientToCanvasCoords(a);var c=E.applyButtonMappings(a);E.handleButtonDown(a,c);r=a.canvasX;v=a.canvasY;if(g(c,a)){var d=void 0!==A.time&&500>a.timeStamp-A.time,f=void 0!==A.x&&void 0!==A.y&&2>=Math.abs(A.x-a.canvasX)&&2>=Math.abs(A.y-a.canvasY);if(!d||!f||A.clickCount&&2<=A.clickCount)A.clickCount=
0;A.clickCount?1===A.clickCount&&(A.clickCount=2):(A.clickCount=1,A.x=a.canvasX,A.y=a.canvasY,A.time=a.timeStamp)}document.addEventListener("mouseup",b,!1)};this.mousemove=function(a){E.__clientToCanvasCoords(a);var b=v-a.canvasY;if(2<Math.abs(r-a.canvasX)||2<Math.abs(b))v=r=-1;E.handleMouseMove(a)};this.mouseup=function(a){E.__clientToCanvasCoords(a);var b=E.applyButtonMappings(a);E.handleButtonUp(a,b);var c=r-a.canvasX,d=v-a.canvasY;v=r=-1;2>=Math.abs(c)&&2>=Math.abs(d)&&E.handleSingleClick(a);
g(b,a)&&2===A.clickCount&&(E.handleDoubleClick(a),A.clickCount=0,A.x=void 0,A.y=void 0,A.time=void 0)};this.doubleclick=function(a){E.__clientToCanvasCoords(a);r=a.canvasX;v=a.canvasY;E.handleDoubleClick(a)};this.mousewheel=function(a){var b=0;a.wheelDelta?b=a.wheelDelta/40:a.detail&&(b=-a.detail);E.handleWheelInput(b,a)};this.blur=function(a){E.handleBlur(a)};this.mouseover=function(a){z=a.target};this.enableMouseButtons=function(a){a&&!D?(this.domElement.addEventListener("mousedown",this.mousedown,
!1),this.domElement.addEventListener("dblclick",this.doubleclick,!1),window.addEventListener("mousemove",this.mousemove,!1),window.addEventListener("mouseover",this.mouseover,!1)):!a&&D&&(this.domElement.removeEventListener("mousedown",this.mousedown),this.domElement.removeEventListener("dblclick",this.doubleclick),window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseover",this.mouseover));var b=D;D=a;return b};this.enableMouseButtons(!0);this.domElement.addEventListener("mousewheel",
this.mousewheel,!1);this.domElement.addEventListener("DOMMouseScroll",this.mousewheel,!1);window.addEventListener("keydown",this.keydown,!1);window.addEventListener("keyup",this.keyup,!1);window.addEventListener("blur",this.blur,!1);this.uninitialize=function(){D&&(window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseover",this.mouseover));window.removeEventListener("keydown",this.keydown);window.removeEventListener("keyup",this.keyup);window.removeEventListener("blur",
this.blur);E=n=p=this.autocam=this.selector=this.domElement=null};this.set2DMode=function(a){};this.setAutocam=function(a){};this.syncCamera=function(){};this.recordHomeView=function(){var a=b.navigation.getCamera();c.sync(a);c.setHomeViewFrom(a)}};AutodeskNamespace("Autodesk.Viewing");
Autodesk.Viewing.ViewingUtilities=function(a,b,c){this.autocam=b;var d=c.getCamera(),f={},g={},h=new function(a){var b=0,c=new THREE.SphereGeometry(1),d=new THREE.MeshPhongMaterial({color:32512,ambient:32512,opacity:0.6,transparent:!0}),f=new THREE.MeshPhongMaterial({color:32512,ambient:32512,opacity:0.6,transparent:!0}),g=new THREE.Mesh(c,f);a.createOverlayScene("pivot",d,f);g.visible=!1;this.shown=function(){return g.visible};this.show=function(c,h,m){g.scale.x=h;g.scale.y=h;g.scale.z=h;g.position.set(c.x,
c.y,c.z);f.opacity=0.6;d.opacity=0.6;g.visible=!0;a.addOverlay("pivot",g);b=m?Date.now()+500:0};this.hide=function(){g.visible&&(g.visible=!1,a.removeOverlay("pivot",g),b=0)};this.fade=function(){if(0<b){var a=b-Date.now();if(0>=a)return this.hide(),!0;a=a/500*0.6;d.opacity=a;f.opacity=a;return!0}return!1};this.fading=function(){return 0<b}}(a);this.transitionView=function(a,f,g,h,n,q){n=n||c.getWorldUpVector();if(q)if(h=n,q=f.clone().sub(a),0===q.lengthSq())h=q.copy(h);else{var r=q.clone().cross(h);
0===r.lengthSq()&&(h.z>h.y?q.y-=1E-4:q.z-=1E-4,r.crossVectors(q,h));h=r.cross(q).normalize()}h||(h=d.up);b.goToView({position:a,center:f,pivot:f,fov:g,up:h,worldUp:n,isOrtho:!1===d.isPerspective})};this.goHome=function(){b.goHome()};this.getHitPoint=function(b,c){c=2*(1-c)-1;var d=new THREE.Vector3(2*b-1,c,1);return(d=a.hitTestViewport(d,!1))?d.intersectPoint:null};this.activatePivot=function(a){var b=d.isPerspective?c.getPivotPlaneDistance():c.getEyeVector().length(),f=c.getVerticalFov(),b=2*b*Math.tan(THREE.Math.degToRad(0.5*
f)),f=c.getScreenViewport(),b=5*b/(f.height*(window.devicePixelRatio||1));h.show(c.getPivotPoint(),b,a)};this.pivotActive=function(a,b){a=a&&!c.getIs2D();b=b||!1;!a&&h.shown()?h.hide():a&&this.activatePivot(b)};this.pivotUpdate=function(){h.shown()&&h.fade()&&a.invalidate(!1,!1,!0)};this.setPivotPoint=function(a,b,d){c.setPivotPoint(a);b||c.setTarget(a);d&&c.setPivotSetFlag(!0);this.setTemporaryPivot(null);c.getIs2D()||h.shown()&&this.activatePivot(h.fading())};this.savePivot=function(a){a||(a="default");
f[a]=c.getPivotPoint();g[a]=c.getPivotSetFlag()};this.restorePivot=function(a){a||(a="default");if(f[a]){var b=g[a];this.setPivotPoint(f[a],!0,b);b||c.setPivotSetFlag(!1);delete f[a];delete g[a]}};this.setTemporaryPivot=function(a){if(a){var b=c.getPivotPoint(),d=c.getPivotSetFlag();this.setPivotPoint(a,!0,d);f.TEMP=b;g.TEMP=d}else delete f.TEMP,delete g.TEMP};this.removeTemporaryPivot=function(){this.restorePivot("TEMP")};this.getBoundingBox=function(b){return a.getFitBounds(b)};this.fitToView=function(b){b=
c.fitBounds(b,a.getFitBounds(!1));this.activatePivot(!0);return b};this.update=function(){c.getRequestFitToView()&&!c.getTransitionActive()&&(c.setRequestFitToView(!1),this.fitToView());c.getRequestHomeView()&&!c.getTransitionActive()&&(c.setRequestHomeView(!1),this.goHome());var a=c.getRequestTransition();a&&!c.getTransitionActive()&&(c.setRequestTransition(!1),this.transitionView(a.position,a.coi,a.fov,a.up,a.worldUp,a.reorient));return!1}};AutodeskNamespace("Autodesk.Viewing");
Autodesk.Viewing.DefaultHandler=function(a,b,c){this.clickConfig=null;this.getNames=function(){return["default"]};this.getName=function(){return this.getNames()[0]};this.setClickBehavior=function(a){this.clickConfig=a};this.getClickBehavior=function(){return this.clickConfig};this.activate=function(a){};this.deactivate=function(a){};this.handleAction=function(b,f){for(var g=0;g<b.length;++g)switch(b[g]){case "selectOnly":a.selector&&f.node&&a.selector.setSelection([f.node]);break;case "deselectAll":a.selector&&
a.selector.setSelection([]);break;case "selectToggle":a.selector&&f.node&&a.selector.toggleSelection(f.node);break;case "isolate":f.node&&a.isolate(f.node);break;case "showAll":a.showAll();break;case "setCOI":f.intersectPoint&&(c.setPivotPoint(f.intersectPoint,!0,!0),c.pivotActive(!0,!0));break;case "hide":f.node&&a.hideMultiple([f.node]);break;case "show":f.node&&a.showMultiple([f.node]);break;case "toggleVisibility":f.node&&a.toggleVisibility(f.node);break;case "focus":a.selector&&(f.node?a.selector.setSelection([f.node]):
a.selector.setSelection([]),c.fitToView())}};this.handleSingleClick=function(b,f){var g=b.ctrlKey||b.metaKey,h=b.shiftKey,k=b.altKey;if(0===f){var l=new THREE.Vector3(b.normalizedX,b.normalizedY,1),l=a.hitTestViewport(l,!1),m="click";g&&(m+="Ctrl");h&&(m+="Shift");k&&(m+="Alt");g=l.node?"onObject":"offObject";if(this.clickConfig&&this.clickConfig[m]&&this.clickConfig[m][g])return this.handleAction(this.clickConfig[m][g],l),!0}else if(1===f&&h&&!k&&!g&&(l=new THREE.Vector3(b.normalizedX,b.normalizedY,
1),l=a.hitTestViewport(l,!1),l.intersectPoint))return c.setPivotPoint(l.intersectPoint,!0,!0),c.pivotActive(!0,!0),!0;return!1};this.handleDoubleClick=function(d,f){if(null!=a.selector&&0===f){var g=new THREE.Vector3(d.normalizedX,d.normalizedY,1),g=a.hitTestViewport(g,!1);g.node?a.selector.setSelection([g.node]):a.selector.clearSelection();c.fitToView();return!0}return 1===f?(b.fitBounds(!1,c.getBoundingBox(!0)),b.setPivotSetFlag(!1),!0):!1};this.handleSingleTap=function(a){return this.handleSingleClick(a,
0)};this.handleDoubleTap=function(d){return d.hasOwnProperty("pointers")&&2===d.pointers.length?(b.setRequestHomeView(!0),!0):null!=a.selector?(d=new THREE.Vector3(d.normalizedX,d.normalizedY,1),d=a.hitTestViewport(d,!1),d.node?a.selector.setSelection([d.node]):a.selector.clearSelection(),c.fitToView(),!0):!1};this.handlePressHold=function(b){return"press"===b.type?(b.clientX=b.pointers[0].clientX,b.clientY=b.pointers[0].clientY,a.api.triggerContextMenu(b)):!1}};AutodeskNamespace("Autodesk.Viewing");
Autodesk.Viewing.GestureHandler=function(a){var b=a.navigation,c=["gestures"],d=this,f=!0,g=null,h=isTouchDevice();b.setIsTouchDevice(h);h&&(g=new Hammer.Manager(a.canvas,{recognizers:[[Hammer.Tap,{event:"doubletap2",pointers:2,taps:2,interval:400,threshold:6,posThreshold:40}],[Hammer.Tap,{event:"doubletap",taps:2,interval:400,threshold:6,posThreshold:30}],[Hammer.Tap,{event:"singletap2",pointers:2,threshold:6}],[Hammer.Tap,{event:"singletap",threshold:6}],[Hammer.Pan,{event:"drag3",pointers:3,threshold:15}],
[Hammer.Pan,{event:"pan",pointers:2,threshold:20}],[Hammer.Pan,{event:"drag",pointers:1}],[Hammer.Rotate,{enable:!0,threshold:7}],[Hammer.Pinch,{enable:!0,threshold:0.05}],[Hammer.Press,{event:"press",time:500}]],inputClass:Hammer.TouchInput}),a.canvas.addEventListener("touchstart",function(a){a.preventDefault()},!1));this.getNames=function(){return c};this.getName=function(){return c[0]};this.__clientToCanvasCoords=function(a){var c=b.getScreenViewport(),d=c.width,f=c.height,g;a.hasOwnProperty("center")?
(g=a.center.x-c.left,c=a.center.y-c.top):(g=a.pointers[0].clientX-c.left,c=a.pointers[0].clientY-c.top);a.canvasX=g;a.canvasY=c;a.normalizedX=g/d*2-1;a.normalizedY=(f-c)/f*2-1};this.distributeGesture=function(a){d.__clientToCanvasCoords(a);d.controller.distributeEvent("handleGesture",a)&&a.preventDefault();-1!==a.type.indexOf("end",a.type.length-3)&&g.stop()};this.onSingleTap=function(a){d.__clientToCanvasCoords(a);d.controller.distributeEvent("handleSingleTap",a)&&a.preventDefault()};this.onDoubleTap=
function(a){d.__clientToCanvasCoords(a);d.controller.distributeEvent("handleDoubleTap",a)&&a.preventDefault()};this.onPressHold=function(a){d.__clientToCanvasCoords(a);"press"===a.type?f=d.controller.enableMouseButtons(!1):d.controller.enableMouseButtons(f);d.controller.distributeEvent("handlePressHold",a)&&a.preventDefault()};this.activate=function(a){g&&(g.on("dragstart dragmove dragend",this.distributeGesture),g.on("panstart panmove panend",this.distributeGesture),g.on("pinchstart pinchmove pinchend",
this.distributeGesture),g.on("rotatestart rotatemove rotateend",this.distributeGesture),g.on("drag3start drag3move drag3end",this.distributeGesture),g.on("singletap",this.onSingleTap),g.on("singletap2",this.onSingleTap),g.on("doubletap",this.onDoubleTap),g.on("doubletap2",this.onDoubleTap),g.on("press pressup",this.onPressHold),g.get("doubletap2").recognizeWith("doubletap"),g.get("singletap2").recognizeWith("singletap"),g.get("singletap").requireFailure("doubletap"))};this.deactivate=function(a){g&&
(g.off("dragstart dragmove dragend",this.distributeGesture),g.off("panstart panmove panend",this.distributeGesture),g.off("pinchstart pinchmove pinchend",this.distributeGesture),g.off("rotatestart rotatemove rotateend",this.distributeGesture),g.off("drag3start drag3move drag3end",this.distributeGesture),g.off("singletap",this.onSingleTap),g.off("singletap2",this.onSingleTap),g.off("doubletap",this.onDoubleTap),g.off("doubletap2",this.onDoubleTap),g.off("press pressup",this.onPressHold))};this.update=
function(){return!1};this.handleBlur=function(a){return!1}};AutodeskNamespace("Autodesk.Viewing");
Autodesk.Viewing.OrbitDollyPanTool=function(a,b){var c=this,d=-1!=navigator.userAgent.search("Mac OS"),f=b.navigation,g=f.getCamera(),h=["orbit","dolly","pan"],k=h[0],l=[k],m=k,p=null,n=0,q=0,r=!1,v=null,s=!1,w,z,D=null,A=-5,E=new THREE.Vector3,N=new THREE.Vector3,H=new THREE.Vector2,J=new THREE.Vector2,G=new THREE.Vector2,I=new THREE.Vector2,M=new THREE.Vector3,C=[!1,!1,!1,!1,!1,!1],K=0,F=0,B=0,R=0,Y=1,S=5,P=0.025;this.getNames=function(){return h};this.getName=function(){return h[0]};this.activate=
function(a){l.push(a);m=a};this.deactivate=function(a){var b=l.length-1;0<b&&l[b]===a&&(l.pop(),m=l[b-1])};this.adjustDollyLookSpeed=function(a){0===a?(P=0.025,S=5):(P*=0<a?1.1:0.9,S*=0<a?1.1:0.9,1E-6>P&&(P=1E-6),1E-6>S&&(S=1E-6))};this.getDollySpeed=function(a){var b=f.getEyeVector(),c=f.getPosition();a=a.clone().sub(c).dot(b.normalize())*P;return 0.01>Math.abs(a)?0>a?-0.01:0.01:a};this.getLookSpeed=function(){return S};this.coiIsActive=function(){return f.getPivotSetFlag()&&f.isPointVisible(f.getPivotPoint())};
this.adjustSpeed=function(a){this.adjustDollyLookSpeed(a);this.utilities.autocam&&(this.utilities.autocam.orbitMultiplier=this.getLookSpeed())};this.initTracking=function(a,b){var c;if(g.isPerspective){c=0.5*(g.near+g.far);var d=this.utilities.getHitPoint(a,b),h=f.getPosition();d&&d.sub?(c=d.sub(h),d=f.getEyeVector().normalize(),c=Math.abs(d.dot(c))):f.getPivotSetFlag()&&f.isPointVisible(f.getPivotPoint())&&(d=f.getPivotPlaneDistance(),1E-5<d&&(c=d))}else c=f.getEyeVector().length();Y=c};this.initOrbit=
function(){this.utilities.setTemporaryPivot(0>=f.getPivotPoint().sub(f.getPosition()).dot(f.getEyeVector())?f.getTarget():null)};this.getCursor=function(){switch(k){case "orbit":return"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAAAt1BMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8AAAAzMzP6+vri4uISEhKKioqtra2dnZ2EhIR9fX10dHRkZGQdHR3t7e3Hx8e5ubm1tbWoqKhWVlZKSko4ODgICAjv7+/o6OjMzMyxsbFOTk4pKSkXFxcEBAT29vbW1tZ6enpISEgLCwvhzeX+AAAAGXRSTlMANRO0nHRJHfnskIxQRKh89syDVwTWZjEJxPFEswAAAOFJREFUKM+1j+lygkAQhIflEAJe0Rw9u4CCeKKoSTTX+z9XoMJWWeX+ssrvZ3f19DQ5zOw/0DUMQPlmQ72bE2adBp8/Rp3CQUi3ILx+bxj4fjDs9T1Bmo6bbPPN8aDU4bjJt4nb+de789kSFyxn826jW3ICLNZZKU8nWWbrBTCRVm04U8TpjquRFf1Go0d7l8aYOrUR7FGEFr1S9LGymwthgX2gE/Kl0cHPOtF2xOWZ5QpIC93RflW4InkDoPRXesd5LJIMQPzV7tCMa7f6BvhJL79AVDmYTNQ1NhnxbI/uwB8H5Bjd4zQPBAAAAABJRU5ErkJggg==), wait";
case "dolly":return"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAAAgVBMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8mJiYAAADNzc2/v7+fn59paWlPT08MDAwICAj6+vqpqak7Ozv29vby8vLp6em2traAgIBkZGRZWVlAQEAaGhpISEgkS7tbAAAAFHRSTlMAOvhpZD8mkQWegMy9qY1YVE01EYiqlE0AAADZSURBVCjPbY9ZloMgEAAbEbfsmRZZXbJn7n/AAX2RQVN/VD26AXLOeZLDGo6IbfI9tHq8cdxuj1HwvgCoaiHqKoRk+M3hB9jueUW8PnfsE/bJ3vms7nCkq7NoE3s99AXxoh8vFoXCpknrn5faAuJCenT0xPkYqnxQFJaU0gdZrsKm8aHZrAIffBj40mc1jsTfIJRWegq6opTMvlfqLqYg7kr1ZB7jFgeaMC59N//8O4WZ1IiPF8b5wMHcJn8zB4g4mc77zpxgAbMSUVoGK4iV0hL4wrksz+H0Bw5+E+HrniDQAAAAAElFTkSuQmCC), wait";
case "pan":return"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAABHVBMVEUAAABPTk4AAAAAAAAJCQkRERE0MzQQEBAODg4QEBB4d3dbWlo9PDw/Pj4vLy8sLCwZGBgWFhYcHBwKCgoSEhIAAAAKCgoICAgKCgoQEBAODg4EBAQICAgPDw8REREMDAx2dnY0NDQvLy9QUFAaGhomJSYjIyM7OjokJCQNDA0mJiYNDQ0AAAAUFBQJCQkQEBAEBAQNDQ0PDw8VFRX///+amJkAAAD5+fnz8/PKycn9/f339vbi4eLR0dDNzMyAgIB8e3xycHH7+/vw7+/o6OjX1ta7urq4t7iwsLCnp6eioqKbmppva21OTk74+Pjl5eXc3Nzb29vLy8vDw8PDwsKrqqqdnZ2WlpaSkpKTkZKMiouEg4NkZGRISEgxLzBpgbsEAAAANHRSTlMA+fiQXgngKSYG/vX17uvBuqackpCNg3BpUkpAPBwTDvj18+vl0s/NwrOwoZZ+TDg4NBkBGrzX8QAAAP5JREFUKM99j9Vuw0AQRdeuKZyGkyZNmbnXDLHDVGb8/8/oy7paK1bO0+oc7WiGnGiaxq+QRTQAOh8f9Jv4H/Ge8PZPrCdlvkxfYluUT2WyyCq3mZ7unwlKVLcqOzA/Mf71j0TWJ/Ym6rPeca05Ni4iIevYc7yoUD2zQFhq71BdI9nvBeBabFDSPe8DswlUc1Riw3VxbH0NHBUPQ0jrbDnPYDjALQBMq9E7nkC5y7VDKTZlUg8Q0lmjvl74zlYErgvKa42GPKf3/a0kQmYCDY1SYMDosqMoiWrGwz/uAbNvc/fNon4kXRKGq+PUo2Mb96afV0iUxqGU2s4VBbKUP65NL/LKF+7ZAAAAAElFTkSuQmCC), wait"}return null};
this.getMotionDelta=function(a,b){var c=f&&f.getReverseZoomDirection()?-1.5:1.5;d&&(c*=-1);C[0]&&(N.x+=0.01,G.x+=20);C[1]&&(N.x-=0.01,G.x-=20);C[2]&&(N.y+=0.01,G.y+=20);C[3]&&(N.y-=0.01,G.y-=20);C[4]&&(N.z+=c);C[5]&&(N.z-=c);var c=N.x-E.x,g=N.y-E.y,h=N.z-E.z;0.0010>Math.abs(c)&&(c=0);0.0010>Math.abs(g)&&(g=0);0.0010>Math.abs(h)&&(h=0);a.set(c,g,h);b&&b.set(G.x-J.x,G.y-J.y)};this.stepMotionDelta=function(a,b){b?(E.x+=0.6*a.x,E.y+=0.6*a.y,E.z+=0.6*a.z):E.copy(N);J.copy(G)};this.update=function(){var a=
!1,c=!1,d;this.getMotionDelta(M,I);d=M.x;var l=M.y,m=M.z;r||this.checkInteractionMode();(r=-1<A)&&this.controller.setIsLocked(!0);if(0!==d||0!==l||0!==m){switch(k){case "orbit":this.utilities.autocam&&this.utilities.autocam.startState&&(I.x=-I.x,v&&this.utilities.autocam.orbit(G,v,I,this.utilities.autocam.startState));break;case "dolly":m*=0.6;0<=A?(l=-l,m=Math.abs(d)>Math.abs(l)?d:l,m*=100,c=d=0.5):(d=f.getScreenViewport(),c=w/d.width,d=z/d.height);c=!f.getIs2D()&&f.getZoomTowardsPivot()?this.coiIsActive()?
f.getPivotPoint():f.getWorldPoint(0.5,0.5):f.getWorldPoint(c,d);f.dollyFromPoint(m*this.getDollySpeed(c),c);break;case "pan":f.panRelative(-d,l,Y);break;case "dollypan":0===d&&0===l||f.panRelative(-d,l,Y),d=f.getScreenViewport(),c=w/d.width,d=z/d.height,c=f.getWorldPoint(c,d),d=f.getPosition(),d=f.getIs2D()?d.sub(c).length():Y,l=(n/q-1)*d,f.dollyFromPoint(l,c),n=q,Y=d+l}c=!0}this.stepMotionDelta(M,"pan"!==k&&"dollypan"!==k);-1===A&&1E-5>Math.abs(m)&&(this.interactionEnd(-1),c=a=!0);(K||F)&&-1!==h.indexOf(b.getActiveNavigationTool())&&
(c=!0);!s&&(a||-5<A)&&(-1<A&&(E.copy(N),this.utilities.removeTemporaryPivot()),this.utilities.autocam.endInteraction(),A=-5,r&&this.controller.setIsLocked(!1),r=!1,p=v=null);c?this.utilities.pivotActive(f.getPivotSetFlag(),-1>=A):this.utilities.pivotUpdate();return g.dirty};this.checkInteractionMode=function(){var a=2===A&&K&&!F&&!B||2===A&&F&&!K&&!B||"dolly"===m&&!F&&"pinch"!==p||0!==M.z?B||F||K||2!==A&&1!==A?"dolly":"pan":2===A&&!(K||F^B)||2===A&&K&&B||1===A&&!K&&!B||1===A&&F||1===A&&B&&!F||0===
A&&K&&!B&&!F||"pan"===m&&1!==A&&!F&&"pinch"!==p||R?"pan":"pan"===p||"pinch"===p?"dollypan":f.getIs2D()?m:"orbit";a!==k&&(k=a,("pan"===k&&-1<A||"dollypan"===k)&&this.initTracking(E.x,E.y))};this.interactionStart=function(a,b){if(b||a>A)A=a,s=!0,-1<a&&("pan"===k&&this.initTracking(E.x,E.y),"orbit"===k&&this.initOrbit()),this.utilities.pivotActive(f.getPivotSetFlag(),-1===a),this.utilities.autocam&&(this.utilities.autocam.sync(g),this.utilities.autocam.startInteraction(J.x,J.y),v=J.clone())};this.interactionCheck=
function(){(C[0]||C[1]||C[2]||C[3]||C[4]||C[5]||K||B||F||R)&&this.interactionStart(-4,!0)};this.interactionEnd=function(a){a===A&&(-1!==a&&this.utilities.pivotActive(!1),s=!1)};this.handleWheelInput=function(b){if(this.isDragging)return!1;if(f.getIs2D()){var c=f.getScreenViewport(),c=a.intersectGround(w+c.width,z+c.height);this.utilities.setPivotPoint(c,!0,!0)}f.getReverseZoomDirection()&&(b*=-1);N.z+=b;c=Date.now();D||(D=c);0!=b&&this.interactionStart(-1);return!0};this.resetKeys=function(){this.autoMove(-1,
!1);R=F=B=K=0};this.autoMove=function(a,b){b&&this.isDragging||(0>a?C[0]=C[1]=C[2]=C[3]=C[4]=C[5]=b:C[a]=b,b||this.interactionEnd(-4),this.interactionCheck())};this.updateModifierState=function(a){B=d&&a.metaKey||a.ctrlKey?1:0;K=a.shiftKey?1:0;F=a.altKey?1:0};this.handleKeyDown=function(a,b){this.updateModifierState(a);var c=!1;switch(b){case 187:this.adjustSpeed(1);c=!0;break;case 189:this.adjustSpeed(-1);c=!0;break;case 48:this.adjustSpeed(0);c=!0;break;case 37:this.autoMove(0,!0);c=!0;break;case 39:this.autoMove(1,
!0);c=!0;break;case 33:this.autoMove(2,!0);c=!0;break;case 34:this.autoMove(3,!0);c=!0;break;case 38:this.autoMove(4,!0);c=!0;break;case 40:this.autoMove(5,!0);c=!0;break;default:return!1}this.isDragging||this.interactionStart(-4);return c};this.handleKeyUp=function(a,b){this.updateModifierState(a);var c=!1;switch(b){case 37:this.autoMove(0,!1);c=!0;break;case 39:this.autoMove(1,!1);c=!0;break;case 33:this.autoMove(2,!1);c=!0;break;case 34:this.autoMove(3,!1);c=!0;break;case 38:this.autoMove(4,!1);
c=!0;break;case 40:this.autoMove(5,!1);c=!0;break;default:return!1}c&&(this.interactionEnd(-4),s||this.interactionCheck());return c};this.handleDollyPan=function(a){w=a.canvasX;z=a.canvasY;var b=f.getScreenViewport();G.x=H.x+a.deltaX;G.y=H.y+a.deltaY;N.x=G.x/b.width;N.y=G.y/b.height;var b=a.pointers[1].clientX-a.pointers[0].clientX,c=a.pointers[1].clientY-a.pointers[0].clientY;q=Math.sqrt(b*b+c*c);-1!==a.type.indexOf("start",a.type.length-5)&&(n=q)};this.handleGesture=function(a){switch(a.type){case "dragstart":return p=
"drag",this.handleButtonDown(a,0);case "dragmove":return"drag"===p?this.handleMouseMove(a):!1;case "dragend":if("drag"===p)return this.handleButtonUp(a,0),p=null,!0;break;case "panstart":return p="pan",this.isDragging=!0,E.x=0.5*(a.normalizedX+1),E.y=1-0.5*(a.normalizedY+1),H.set(a.canvasX,a.canvasY),J.set(a.canvasX,a.canvasY),this.interactionStart(3),this.handleDollyPan(a),!0;case "panmove":return"pan"===p?this.handleDollyPan(a):!1;case "panend":if("pan"===p)return this.isDragging=!1,this.handleDollyPan(a),
this.interactionEnd(3),!0;break;case "pinchstart":return this.isDragging=!0,p="pinch",E.x=0.5*(a.normalizedX+1),E.y=1-0.5*(a.normalizedY+1),H.set(a.canvasX,a.canvasY),J.set(a.canvasX,a.canvasY),this.interactionStart(3),this.handleDollyPan(a),!0;case "pinchmove":return"pinch"===p?this.handleDollyPan(a):!1;case "pinchend":if("pinch"===p)return this.isDragging=!1,this.handleDollyPan(a),this.interactionEnd(3),!0}return!1};this.handleButtonDown=function(a,b){this.updateModifierState(a);E.x=0.5*(a.normalizedX+
1);E.y=1-0.5*(a.normalizedY+1);J.set(a.canvasX,a.canvasY);N.copy(E);G.copy(J);w=a.canvasX;z=a.canvasY;this.isDragging=!0;this.interactionStart(b);return!0};this.handleButtonUp=function(a,b){this.updateModifierState(a);N.x=0.5*(a.normalizedX+1);N.y=1-0.5*(a.normalizedY+1);G.set(a.canvasX,a.canvasY);w=a.canvasX;z=a.canvasY;this.interactionEnd(b);this.isDragging=!1;return!0};this.handleMouseMove=function(b){this.updateModifierState(b);if(!this.isDragging)return E.x=0.5*(b.normalizedX+1),E.y=1-0.5*(b.normalizedY+
1),J.set(b.canvasX,b.canvasY),N.x=E.x,N.y=E.y,G.copy(J),w=b.canvasX,z=b.canvasY,f.getIs2D()&&a.rolloverObject(w,z),!1;N.x=0.5*(b.normalizedX+1);N.y=1-0.5*(b.normalizedY+1);G.set(b.canvasX,b.canvasY);w=b.canvasX;z=b.canvasY;return!0};this.handleBlur=function(a){this.resetKeys();this.interactionEnd(A)};b.addEventListener(Autodesk.Viewing.ESCAPE_EVENT,function(a){c.handleBlur(a)})};AutodeskNamespace("Autodesk.Viewing");
Autodesk.Viewing.HotGestureTool=function(a){navigator.userAgent.search("Mac OS");a.navigation.getCamera();var b=["hottouch"],c=null,d=null,f=!1,g=!1,h=null;this.getNames=function(){return b};this.getName=function(){return b[0]};this.activate=function(a){};this.deactivate=function(a){};this.__checkStart=function(){h&&(this.controller.distributeEvent("handleGesture",h),h=null)};this.update=function(){if(this.controller.getIsLocked())return!1;var b=a.getActiveNavigationTool(),h=!1===f&&!0===g,m=!0===
f&&!1===g;if(h||m){h=h?"worldup":"fov";if(b===h)return!1;if(b===c)return a.setActiveNavigationTool(h),c=h,this.__checkStart(),!1;d=b;a.setActiveNavigationTool(h);c=h;this.__checkStart()}else c&&(a.setActiveNavigationTool(d),d=c=null);return!1};this.resetKeys=function(){};this.updateModifierState=function(a){};this.handleGesture=function(a){if(a===h)return!1;switch(a.type){case "drag3start":h=a;f=!0;break;case "drag3end":f=!1;break;case "rotatestart":h=a;g=!0;break;case "rotateend":g=!1}return!1};
this.handleKeyDown=function(a,b){this.updateModifierState(a);return!1};this.handleKeyUp=function(a,b){this.updateModifierState(a);return!1};this.handleButtonDown=function(a,b){this.updateModifierState(a);return!1};this.handleButtonUp=function(a,b){this.updateModifierState(a);return!1};this.handleMouseMove=function(a){this.updateModifierState(a);return!1};this.handleBlur=function(a){this.resetKeys();return!1}};"use strict";AutodeskNamespace("Autodesk.Viewing.Private");
Autodesk.Viewing.HotkeyManager=function(){function a(a,b){return a-b}function b(){var a=f.join(),b,c;for(c=0;c<h.length;)b=h[c],b.keys===a?h.splice(c,1):c++;for(c=0;c<g.length;)b=g[c],b.keys!==a?g.splice(c,1):c++}function c(a,c){var k=f.join(),n=f.slice(0),q=f.indexOf(c);-1<q&&f.splice(q,1);var r=f.join(),v=f.slice(0);b();for(var s=[],w=[],z,q=d.length-1;0<=q;q--)z=d[q],z.keys===k&&z.onRelease?s.unshift(z):z.keys===r&&z.onPress&&w.unshift(z);for(q=s.length-1;0<=q&&(z=s[q],!z.onRelease(n));q--)z.options.tryUntilSuccess&&
h.unshift(z);for(q=w.length-1;0<=q&&(z=w[q],!z.onPress(v));q--)z.options.tryUntilSuccess&&g.unshift(z)}var d=[],f=[],g=[],h=[],k=["hotkeys"];return{pushHotkeys:function(b,c,f){if(d.some(function(a){return a.id===b}))return!1;for(var g=0;g<c.length;g++)d.push({id:b,keys:c[g].keycodes.sort(a).join(),onPress:c[g].onPress,onRelease:c[g].onRelease,options:f||{}});return!0},popHotkeys:function(a){for(var b=!1,c=d.length-1;0<=c;c--)d[c].id===a&&(d.splice(c,1),b=!0);return b},handleKeyDown:function(a,c){if(-1===
f.indexOf(c)){for(var k=f.join(),n=f.slice(0),q=0;q<f.length&&f[q]<c;)q++;f.splice(q,0,c);var r=f.join(),v=f.slice(0);b();for(var s=[],w=[],z,q=d.length-1;0<=q;q--)z=d[q],z.keys===k&&z.onRelease?s.unshift(z):z.keys===r&&z.onPress&&w.unshift(z);for(q=s.length-1;0<=q&&(z=s[q],!z.onRelease(n));q--)z.options.tryUntilSuccess&&h.unshift(z);for(q=w.length-1;0<=q&&(z=w[q],!z.onPress(v));q--)z.options.tryUntilSuccess&&g.unshift(z)}},handleKeyUp:c,handleBlur:function(){for(var a=f.length-1;0<=a;a--)c(null,
f[a])},getName:function(){return k[0]},getNames:function(){return k},activate:function(){},deactivate:function(){},update:function(){var a,b;for(b=0;b<h.length;)a=h[b],!0===a.onRelease(a.keys.split())?h.splice(b,1):b++;for(b=0;b<g.length;)a=g[b],!0===a.onPress(a.keys.split())?g.splice(b,1):b++;return!1},KEYCODES:{BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CONTROL:17,ALT:18,ESCAPE:27,SPACE:32,PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,INSERT:45,DELETE:46,ZERO:48,a:65,b:66,c:67,d:68,
e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,SEMICOLON:186,EQUALS:187,COMMA:188,DASH:189,PERIOD:190,SLASH:191,LBRACKET:219,RBRACKET:221,SINGLEQUOTE:222}}};Autodesk.Viewing.theHotkeyManager=new Autodesk.Viewing.HotkeyManager;AutodeskNamespace("Autodesk.Viewing");
Autodesk.Viewing.FovTool=function(a){var b=a.navigation,c=b.getCamera(),d=["fov"],f=!1,g=0,h=null,k=null,l=!1,m=0,p=-5,n=new THREE.Vector3,q=new THREE.Vector3,r=new THREE.Vector3,v=null;this.getNames=function(){return d};this.getName=function(){return d[0]};this.activate=function(a){m=0};this.deactivate=function(a){p=-5};this.getCursor=function(){return 0!==m&&-5===p?null:"url(data:image/x-icon;base64,AAACAAEAGBgAAAAAAACICQAAFgAAACgAAAAYAAAAMAAAAAEAIAAAAAAAYAkAABMLAAATCwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAlgAAAP8AAAD/AAAAlgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAACEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////////////AAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAnAwMD/yEhIf8AAABmAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////////////AAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAGknJyf/goKC/8/Pz/8aGhr/AAAALQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////////////AAAA/wAAAAAAAAAAAAAAAAAAAAAAAABTFBQU/2lpaf/MzMz///////////+Wlpb/AAAAlgAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAAAAAAAAAAAAAAAAlgAAAP8AAAD/AAAAlgAAAAAAAAAAAAAAOAAAAKFTU1P/t7e3////////////8PDw////////////AQEB/wAAAAEAAAAAAAAAFAAAAH0KCgr/AAAAYwAAAAAAAAAAAAAAlgAAAP8AAAD/AAAAlgAAAAAAAAAjCwsL/6Ghof/t7e3///////Dw8P9MTEz/LS0t//Pz8///////Ghoa/wAAABoAAAANDQ0N/319ff+rq6v/Y2Nj/wAAAK8AAABGAAAA////////////AAAA/wAAAF0hISH/jIyM////////////sLCw/xEREf8AAACHAAAArKysrP//////V1dX/wAAAFcAAABSUlJS//f39///////8PDw/6+vr/86Ojr/LS0t////////////FRUV/1xcXP/Gxsb/+Pj4//Hx8f9MTEz/AAAAsAAAAEcAAAAAAAAAZ2dnZ///////pKSk/wAAAKQAAACtra2t///////////////////////m5ub/kZGR/wAAAP8AAAD/q6ur//Hx8f//////vb29/x0dHf8AAACIAAAAAAAAAAAAAAAAAAAAOjo6Ov//////5+fn/wAAAOcAAADd3d3d////////////////////////////+/v7/9bW1v/i4uL//v7+//Pz8/9hYWH/AAAAvQAAAFQAAAAAAAAAAAAAAAAAAAAAAAAAJycnJ//6+vr//////wMDA/8AAADv7+/v/////////////////////////////////////////////////7y8vP8ODg7/AAAAKwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJiYmJv/6+vr//////wkJCf8AAADv7+/v//////////////////////////////////f39//9/f3//////+np6f+UlJT/GBgY/wAAAH0AAAACAAAAAAAAAAAAAAAAAAAAKSkpKf///////v7+/w0NDf8AAADd3d3d////////////////////////////29vb/39/f/+Xl5f/5+fn////////////5ubm/1RUVP8CAgL/AAAAPwAAAAAAAAAAAAAAOTk5Of//////8PDw/wgICP8AAAChoaGh/////////////////+np6f+YmJj/QkJC/wAAAP8AAAD/UFBQ/7e3t//39/f///////////+oqKj/EBAQ/wAAAIgAAAAAAAAAZ2dnZ///////29vb/wEBAf8AAAA4NTU1/9zc3P/t7e3/tbW1/01NTf8AAACYAAAA////////////AwMD/wsLC/9oaGj/y8vL////////////8fHx/zg4OP8AAACWAAAApaWlpf//////n5+f/wAAAJ8AAAAAAAAAczg4OP9LS0v/EhIS/wAAAE0AAAAAAAAA////////////FRUV/wAAABUAAABoJSUl/4GBgf/i4uL///////////9+fn7/Pz8///b29v//////SkpK/wAAAEoAAAAAAAAAAAAAADgAAABLAAAAEgAAAAAAAAAAAAAAlgAAAP8AAAD/AAAAlgAAAAAAAAAAAAAAJQAAAIE8PDz/np6e//z8/P/////////////////8/Pz/CQkJ/wAAAAkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAlgAAAP8AAAD/AAAAlgAAAAAAAAAAAAAAAAAAAAAAAAA8DAwM/09PT/+7u7v///////////+QkJD/AAAAkwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////////////Dw8P/wAAAA8AAAAAAAAAAAAAAAAAAAAAAAAADAAAAFIYGBj/aGho/729vf8WFhb/AAAAJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////////////FRUV/wAAABUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYAQEB/w8PD/8AAABUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////////////DAwM/wAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAA8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAlgAAAP8AAAD/AAAAlgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8x/h/nO/4fw1D+HwFy/h4BRu4YAHOGEABkAAAAXAAAIFwAAOBnAAHgIAAD4GUAAOB4AABgXAAAIGMAAABtggAAVMYYAHT+HgE7/g8BcP4Pw2/+D+dc/h//XP///2c=), wait"};
this.getMotionDelta=function(a){var b=q.x-n.x,c=q.y-n.y,d=q.z-n.z;0.0010>Math.abs(b)&&(b=0);0.0010>Math.abs(c)&&(c=0);0.0010>Math.abs(d)&&(d=0);a.set(b,c,d)};this.stepMotionDelta=function(a,b){b?(n.x+=0.6*a.x,n.y+=0.6*a.y,n.z+=0.6*a.z):n.copy(q)};this.getAccumulatedWheelDelta=function(){var a=Date.now(),b=0;k&&100<a-k?(b=0>g&&-3<g?-3:0<g&&3>g?3:g,g=0,k=h=null,l=!1):h&&100<a-h&&(l?3<=Math.abs(g)&&(b=g,g=0):(b=0>g&&-3<g?-3:0<g&&3>g?3:g,l=!0,g=0));return b};this.update=function(){var a=!1,d=-5<p;if(-5<
p){this.controller.setIsLocked(!0);this.getMotionDelta(r);var g=r.x,h=r.y,k=r.z;if(0!==g||0!==h||0!==k)d=!0,0<=p?(h=-h,k=Math.abs(g)>Math.abs(h)?g:h,0!==k&&(k*=-1,b.setVerticalFov(b.getVerticalFov()*(1+k),!0))):(g=this.getAccumulatedWheelDelta()/3,0!==g&&b.setFocalLength(b.getFocalLength()+g,!0));this.stepMotionDelta(r,!0);-1===p&&1E-5>Math.abs(k)&&(this.interactionEnd(-1),a=!0)}d?this.utilities.pivotActive(b.getPivotSetFlag(),!0):this.utilities.pivotUpdate();!f&&(a||-5<p)&&(-1<p&&n.copy(q),p=-5,
this.controller.setIsLocked(!1));return c.dirty};this.interactionStart=function(a,c){if(c||a>p)p=a,f=!0;b.toPerspective()};this.interactionEnd=function(a){a===p&&(-1!==a&&this.utilities.pivotActive(!1),f=!1)};this.handleWheelInput=function(a){if(-1<p)return!1;b.getReverseZoomDirection()&&(a*=-1);q.z+=a;g+=a;var c=Date.now();h||(h=c);k=c;0!=a&&this.interactionStart(-1);return!0};this.handleGesture=function(a){switch(a.type){case "dragstart":return this.handleButtonDown(a,0);case "dragmove":return this.handleMouseMove(a);
case "dragend":return this.handleButtonUp(a,0);case "drag3start":return v="drag",this.handleButtonDown(a,0);case "drag3move":return"drag"===v?this.handleMouseMove(a):!1;case "drag3end":"drag"===v&&this.handleButtonUp(a,0),v=null}return!1};this.handleButtonDown=function(a,b){m+=1<<b;return 2!==b?(n.x=0.5*(a.normalizedX+1),n.y=1-0.5*(a.normalizedY+1),q.copy(n),this.interactionStart(b),!0):!1};this.handleButtonUp=function(a,b){m-=1<<b;return 2!==b?(q.x=0.5*(a.normalizedX+1),q.y=1-0.5*(a.normalizedY+
1),this.interactionEnd(b),!0):!1};this.handleMouseMove=function(a){q.x=0.5*(a.normalizedX+1);q.y=1-0.5*(a.normalizedY+1);return-1<p};this.handleBlur=function(a){this.interactionEnd(p);return!1}};AutodeskNamespace("Autodesk.Viewing");
Autodesk.Viewing.WorldUpTool=function(a,b){var c=b.navigation,d=c.getCamera(),f=["worldup"],g=this,h=function(){var a=new THREE.Vector3;return function(b,c,d,f){b=new THREE.Vector3(b,c,d);c=f.dot(b);a.copy(f);a.multiplyScalar(c);return b.sub(a)}}(),k=2*Math.PI,l=1E-5,m=!1,p=!1,n=!1,q=new function(a,b){function d(a,b){var c=Math.abs(a-b);return c>k?c:Math.min(k-c,c)}function f(a,b){var c=m(a);if(c.distanceToSquared(b)<l)return!0;z.set(-b.x,-b.y,-b.z);return c.distanceToSquared(z)<l}function g(a){return a>
k?a:0>=a?a+Math.PI:a-Math.PI}function m(a){w.set(0,0,0);if(0<=a){var b=3<=a?-1:1;a%=3;0===a&&(w.x=b);1===a&&(w.y=b);2===a&&(w.z=b)}Da&&w.multiplyScalar(-1);return w}function n(a,b){for(var c=d(ja[0],a),f=0,g=1;6>g;++g){var h=d(ja[g],a);h<c&&(c=h,f=g)}return c<b?f:-1}function p(a){if(0!==a){var b=30*Math.PI/180,d=z.copy(P.position).sub(W).normalize();S.setFromAxisAngle(d,a);a=c.getWorldUpVector();d=Math.abs(d.angleTo(a));(d<b||Math.PI-d<b)&&a.copy(c.getCameraUpVector());a.applyQuaternion(S);c.setIsLocked(!1);
c.setWorldUpVector(a,!0);c.setIsLocked(!0)}}function q(a,b){0>a.dot(b)&&(b=b.clone().multiplyScalar(-1));c.orient(Z,W,P.position,b);Z.position.copy(b.multiplyScalar(0.495));for(var f=!1,g=fa?Ta:bb,h=0;6>h;++h){var k=d(ja[h],ea),n;n=a;n=k<g?m(h).distanceToSquared(n)<l:!1;n&&(f=!0);k=n?4:3*(1-3*k/Math.PI);1>k&&(k=1);k*=ba;Aa[h].visible=n;n=la[h];n.scale.x=k;n.scale.y=k;n.scale.z=k}V.visible=f;Q.visible=f;return ka.visible=f}function r(a){ea+=a;ea>Math.PI?ea-=k:ea<=-Math.PI&&(ea=k+ea);var b;a:{if(!fa&&
(b=n(ea,bb),0<=b)){fa=!0;ea=ja[b];b=m(b);break a}b=!1}if(b)Ga=ea,a=b,c.setIsLocked(!1),c.setWorldUpVector(a,!0),c.setIsLocked(!0);else if(fa&&0>n(ea,Ta)?(fa=!1,b=!0):b=!1,b)p(ea-Ga),Ga=0;else{if(fa)return!1;p(a)}return!0}var K=2*Math.tan(THREE.Math.degToRad(15)),v=new THREE.MeshPhongMaterial({color:12303291,ambient:12303291,opacity:0.5,transparent:!0}),s=new THREE.MeshPhongMaterial({color:12303291,ambient:12303291,opacity:0.5,transparent:!0}),w=new THREE.Vector3,z=new THREE.Vector3,S=new THREE.Quaternion,
P=new THREE.PerspectiveCamera(30,b.aspect,b.near,b.far),ba=1,U=1,W=null,aa=null,V=null,Q=null,ka=null,ca=null,Z=null,la=null,Aa=null,ja=Array(6),ea=0,Da=!1,fa=!0,Ga=0,bb=5*Math.PI/180,Ta=7*Math.PI/180,xa=1;a.createOverlayScene("roll",v,s,P);this.updateRollCamera=function(a,c){P.position.copy(b.position);P.quaternion.copy(b.quaternion);P.up.copy(b.up);P.aspect=b.aspect;a&&c&&(P.near=c-a,P.far=c+a);P.updateProjectionMatrix()};this.isSnapped=function(){return fa};this.resize=function(){var a=xa*K,c=
a*b.aspect,a=(1>b.aspect?c:a)*U;ca.scale.x=a;ca.scale.y=a;ca.scale.z=a};this.start=function(b,c){this.updateHUD(b,c);a.addOverlay("roll",ca)};this.updateHUD=function(a,k){W=a;0.35>k?k=0.35:0.8<k&&(k=0.8);U=k;ba=0.8/k;var l=w.copy(a).sub(b.position);xa=l.length();var m=xa*K,n=m*b.aspect,m=(1>b.aspect?n:m)*k;this.updateRollCamera(m,xa);var n=c.getWorldUpVector(),p=c.getCameraUpVector();if(!ca){ca=new THREE.Object3D;var r=new THREE.RingGeometry(0.5-0.01*ba,0.5,60);aa=r=new THREE.Mesh(r,v);var s=0.0070*
ba,D=new THREE.BoxGeometry(0.93,s,s),B=new THREE.BoxGeometry(s,0.93,s),s=new THREE.BoxGeometry(s,s,0.93);V=new THREE.Mesh(D,v);Q=new THREE.Mesh(B,v);ka=new THREE.Mesh(s,v);ca.add(V);ca.add(Q);ca.add(ka);Z=new THREE.Mesh(new THREE.CircleGeometry(0.0050),v);ca.add(Z);la=Array(6);Aa=Array(6);for(D=0;6>D;++D)B=0.0025*ba,la[D]=new THREE.Mesh(new THREE.CircleGeometry(0.0050*ba,16),v),Aa[D]=new THREE.Mesh(new THREE.CircleGeometry(B,16),v),Aa[D].visible=!1,la[D].add(Aa[D]),r.add(la[D]);ca.add(r)}c.orient(aa,
a,P.position,n);r=l.clone().normalize();D=Array(3);l=Array(6);D[0]=h(1,0,0,r);D[1]=h(0,1,0,r);D[2]=h(0,0,1,r);B=p.clone().cross(r).normalize();for(r=0;3>r;++r)s=D[r],l[r]=s.length(),0.1>l[r]?ja[r]=1E3:(s.multiplyScalar(1/l[r]),ja[r]=Math.atan2(B.dot(s),p.dot(s)));ja[3]=g(ja[0]);ja[4]=g(ja[1]);ja[5]=g(ja[2]);l[3]=l[0];l[4]=l[1];l[5]=l[2];r=bb+Ta+2*Math.PI/180;for(D=0;6>D;++D)if(1E3!==ja[D])for(B=D+1;6>B;++B)if(1E3!==ja[B]&&d(ja[D],ja[B])<r)if(l[D]<l[B]&&!f(D,n)||f(B,n)){ja[D]=1E3;break}else ja[B]=
1E3;for(r=0;6>r;++r)1E3!==ja[r]?(l=z.set(0,0,1),S.setFromAxisAngle(l,ja[r]),l=z.set(0,0.54,0),l.applyQuaternion(S),la[r].position.copy(l),la[r].visible=!0):la[r].visible=!1;ca.scale.x=m;ca.scale.y=m;ca.scale.z=m;ca.position.copy(a);Ga=ea=0;Da=0>n.dot(p);fa=q(n,p)};this.handleRoll=function(a,b,d){this.updateRollCamera();q(c.getWorldUpVector(),c.getCameraUpVector());return 0!==a||0!==b?(a=d.x-a-0.5,b=d.y-b-0.5,r(Math.atan2(d.y-0.5,d.x-0.5)-Math.atan2(b,a))):!1};this.handleRollTouch=function(a){this.updateRollCamera();
q(c.getWorldUpVector(),c.getCameraUpVector());a-=ea;return 0.0010<Math.abs(a)?r(a):!1};this.end=function(){a.removeOverlay("roll",ca)}}(a,d),r=new THREE.Vector3,v=new THREE.Vector3,s=new THREE.Vector3,w=null,z=0;this.getNames=function(){return f};this.getName=function(){return f[0]};this.activate=function(a){b.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,this.handleCameraChange);n=!1};this.deactivate=function(a){q.end();c.setIsLocked(!1);b.removeEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,
this.handleCameraChange);this.utilities.restorePivot();w=null;n=m=!1};this.getCursor=function(){return"auto"};this.getMotionDelta=function(a){var b=v.x-r.x,c=v.y-r.y,d=v.z-r.z;0.0010>Math.abs(b)&&(b=0);0.0010>Math.abs(c)&&(c=0);0.0010>Math.abs(d)&&(d=0);a.set(b,c,d)};this.stepMotionDelta=function(){r.copy(v)};this.update=function(){if(!n){var a=c.getEyeVector(),b=0.5*(d.near+d.far);a.normalize().multiplyScalar(b);a=a.add(d.position);this.utilities.savePivot();this.utilities.setPivotPoint(a,!0,!0);
this.utilities.pivotActive(!0);q.start(a,0.65);n=!0}a=p;this.getMotionDelta(s);var b=s.x,f=s.y,g=s.z;if(p||"roll"===w||m&&(0!==b||0!==f||0!==g))p="roll"===w?q.handleRollTouch(z):q.handleRoll(b,f,v);this.stepMotionDelta();d.dirty&&(a=!0);return a};this.handleResize=function(){q.resize();p=!0};this.handleGesture=function(a){switch(a.type){case "dragstart":return w="drag",this.handleButtonDown(a,0);case "dragmove":return this.handleMouseMove(a);case "dragend":return w=null,this.handleButtonUp(a,0);case "rotatestart":c.setIsLocked(!0);
b.removeEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,this.handleCameraChange);w="roll";z=THREE.Math.degToRad(a.rotation);var d=a.pointers[1].clientX-a.pointers[0].clientX;a=a.pointers[1].clientY-a.pointers[0].clientY;Math.sqrt(d*d+a*a);d=c.getScreenViewport();Math.min(d.width,d.height);return!0;case "rotatemove":return z=THREE.Math.degToRad(a.rotation),"roll"===w;case "rotateend":c.setIsLocked(!1),b.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,this.handleCameraChange),z=THREE.Math.degToRad(a.rotation),
w=null}return!1};this.handleWheelInput=function(a){return!0};this.handleCameraChange=function(){var a=c.getEyeVector(),b=0.5*(d.near+d.far);a.normalize().multiplyScalar(b);a=a.add(d.position);q.updateHUD(a,0.65)};this.handleButtonDown=function(a,d){r.x=0.5*(a.normalizedX+1);r.y=1-0.5*(a.normalizedY+1);v.copy(r);m=!0;w=null;c.setIsLocked(!0);this.controller.setIsLocked(!0);b.removeEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,g.handleCameraChange);return!0};this.handleButtonUp=function(a,d){v.x=
0.5*(a.normalizedX+1);v.y=1-0.5*(a.normalizedY+1);m=!1;p=!0;c.setIsLocked(!1);this.controller.setIsLocked(!1);b.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,g.handleCameraChange);return!0};this.handleMouseMove=function(a){v.x=0.5*(a.normalizedX+1);v.y=1-0.5*(a.normalizedY+1);return!0};this.handleBlur=function(a){m=!1;w=null;return!1}};AutodeskNamespace("Autodesk.Viewing.Private");
Autodesk.Viewing.Private.Selector=function(a){function b(a){var c=a.dbId||a.fragIds;if(0<h[c])h[c]--,0==h[c]&&g.viewer.highlightObjectNode(g.model,a,!1);else if(0>h[c])throw"Selection State machine broken. Negatively selected object!";if(a.children)for(c=0;c<a.children.length;c++)b(a.children[c])}function c(a,b){var d=a.dbId||a.fragIds;h[d]?h[d]++:(g.viewer.highlightObjectNode(g.model,a,!0,b),h[d]=1);if(a.children)for(d=0;d<a.children.length;d++)c(a.children[d],!0)}function d(a){g.isSelected(a)||
(g.selectedObjectIds[a.dbId]=a,g.selectionCount++,c(a))}function f(a){g.isSelected(a)&&(b(a),g.selectedObjectIds[a.dbId]=null,g.selectionCount--)}var g=this;this.viewer=a;this.model=null;this.selectedObjectIds={};this.selectionCount=0;var h={};a.api.addEventListener(Autodesk.Viewing.ISOLATE_EVENT,function(a){g.deselectInvisible()});a.api.addEventListener(Autodesk.Viewing.HIDE_EVENT,function(a){g.deselectInvisible()});this.getSelectionLength=function(){return g.selectionCount};this.getSelection=function(){var a=
[],b=g.selectedObjectIds,c;for(c in b)b[c]&&a.push(b[c]);return a};this.clearSelection=function(a){if(0<this.selectionCount){var c=g.selectedObjectIds,d;for(d in c)c[d]&&b(c[d]);g.selectedObjectIds={};g.selectionCount=0;a||this.fireSelectionChangedEvent()}};this.fireSelectionChangedEvent=function(){var a=[],b=[],c=g.selectedObjectIds,d;for(d in c){var f=c[d];f&&(a.push(f.dbId),b.push(f.fragIds))}b={type:Autodesk.Viewing.SELECTION_CHANGED_EVENT,dbIdArray:a,fragIdsArray:b,nodeArray:this.getSelection()};
Autodesk.Viewing.Private.logger.log({viewer_current_time:Date.now(),viewer_event_type:"selection",viewer_event_on_object:a});this.viewer.api.fireEvent(b)};this.isSelected=function(a){if(a&&this.selectedObjectIds[a.dbId])return!0};this.toggleSelection=function(a){a?(this.isSelected(a)?f(a):d(a),g.fireSelectionChangedEvent()):console.error("Attempting to select a null node.")};this.setSelectionIds=function(a){this.setSelection(this.model.getNodesByIds(a))};this.selectionIsEqual=function(a){if(this.selectionCount!==
a.length)return!1;for(var b=0;b<a.length;b++)if(!this.isSelected(a[b]))return!1;return!0};this.setSelection=function(a){if(!this.selectionIsEqual(a)&&(this.clearSelection(!0),null!=a)){for(var b=0;b<a.length;b++)d(a[b]);this.fireSelectionChangedEvent()}};this.deselectInvisible=function(){var a=!1,b=g.selectedObjectIds,c;for(c in b){var d=b[c];d&&!1==d.visible&&(f(d),a=!0)}a&&this.fireSelectionChangedEvent()};this.toggleSelectionId=function(a){this.toggleSelection(this.model.getNodeById(a))};this.isSelectedOrParentIsSelected=
function(a){for(;a;){if(this.isSelected(a))return!0;a=a.parent}return!1};this.getSelectionBounds=function(){var a=new THREE.Box3,b=new THREE.Box3,c=[],d=g.selectedObjectIds,f;for(f in d)d[f]&&g.model.getNodeFragments(parseInt(f),c);d=this.viewer;f=this.model;for(var h=0;h<c.length;++h){var r=d.getRenderProxy(f,c[h]);r&&(b.copy(r.geometry.boundingBox).applyMatrix4(r.matrixWorld),a.union(b))}return a};this.getSelectionVisibility=function(){var a=!1,b=!1,c=g.selectedObjectIds,d;for(d in c){var f=c[d];
if(f&&(Autodesk.Viewing.Private.VisibilityManager.isVisible(f)?a=!0:b=!0,a&&b))break}return{hasVisible:a,hasHidden:b}};this.uninitialize=function(){this.selectedObjectIds=this.model=this.viewer=null}};AutodeskNamespace("Autodesk.Viewing.Private");Autodesk.Viewing.Private.VisibilityManager=function(a){this.viewerImpl=a;this.model=null;this.isolatedNodes=[];this.hiddenNodes=[]};Autodesk.Viewing.Private.VisibilityManager.prototype.getIsolatedNodes=function(){return this.isolatedNodes.slice(0)};
Autodesk.Viewing.Private.VisibilityManager.prototype.getHiddenNodes=function(){return this.hiddenNodes.slice(0)};Autodesk.Viewing.Private.VisibilityManager.prototype.isolate=function(a){a?this.isolateMultiple([a]):this.isolateNone()};
Autodesk.Viewing.Private.VisibilityManager.prototype.isolateNone=function(){this.viewerImpl.setModelVisibility(this.model,!0);var a=this.model?this.model.getRoot():null;a&&this.setVisibilityOnNode(a,!0);this.hiddenNodes=[];this.isolatedNodes=[];this.viewerImpl.resetIsolation(this.model);this.viewerImpl.api.fireEvent({type:Autodesk.Viewing.ISOLATE_EVENT,nodeIdArray:[]})};
Autodesk.Viewing.Private.VisibilityManager.prototype.isolateMultiple=function(a){if(a&&0!=a.length){var b=this.model?this.model.getRoot():null;b&&this.setVisibilityOnNode(b,!1);this.viewerImpl.setModelVisibility(this.model,!1);this.isolatedNodes=a.slice(0);this.hiddenNodes=[];for(b=0;b<a.length;b++)this.setVisibilityOnNode(a[b],!0),this.viewerImpl.needGhostedPass=!0;this.viewerImpl.api.fireEvent({type:Autodesk.Viewing.ISOLATE_EVENT,nodeIdArray:a})}else this.isolateNone();this.viewerImpl.invalidate(!0)};
Autodesk.Viewing.Private.VisibilityManager.prototype.hideMultiple=function(a){for(var b=0;b<a.length;++b)this.setVisibilityOnNode(a[b],!1);0<a.length&&this.viewerImpl.api.fireEvent({type:Autodesk.Viewing.HIDE_EVENT,nodeIdArray:a})};Autodesk.Viewing.Private.VisibilityManager.prototype.hide=function(a){this.setVisibilityOnNode(a,!1);this.viewerImpl.api.fireEvent({type:Autodesk.Viewing.HIDE_EVENT,nodeIdArray:[a]})};
Autodesk.Viewing.Private.VisibilityManager.prototype.showMultiple=function(a){for(var b=0;b<a.length;++b)this.setVisibilityOnNode(a[b],!0);0<a.length&&this.viewerImpl.api.fireEvent({type:Autodesk.Viewing.SHOW_EVENT,nodeIdArray:a})};Autodesk.Viewing.Private.VisibilityManager.prototype.show=function(a){this.setVisibilityOnNode(a,!0);this.viewerImpl.api.fireEvent({type:Autodesk.Viewing.SHOW_EVENT,nodeIdArray:[a]})};
Autodesk.Viewing.Private.VisibilityManager.prototype.toggleVisibility=function(a){var b=Autodesk.Viewing.Private.VisibilityManager.isVisible(a);this.setVisibilityOnNode(a,!b);this.viewerImpl.api.fireEvent(b?{type:Autodesk.Viewing.HIDE_EVENT,nodeIdArray:[a]}:{type:Autodesk.Viewing.SHOW_EVENT,nodeIdArray:[a]})};
Autodesk.Viewing.Private.VisibilityManager.prototype.setVisibilityOnNode=function(a,b){var c=this.viewerImpl,d=this.model,f=this;(function k(a){if(a.visible&&!b)for(var g=0,p=f.isolatedNodes.length;g<p;++g)if(f.isolatedNodes[g].dbId===a.dbId){f.isolatedNodes.splice(g,1);break}a.visible=b;g=a.fragIds;if(void 0!==g)if(Array.isArray(g))for(p=0;p<g.length;p++)c.setFragmentVisibility(d,g[p],b);else c.setFragmentVisibility(d,g,b);if(a.children)for(g=0;g<a.children.length;g++)k(a.children[g])})(a);this.viewerImpl.needGhostedPass=
!0;if(0>=this.isolatedNodes.length){var g=this.hiddenNodes.indexOf(a);b&&-1!==g?this.hiddenNodes.splice(g,1):b||-1!==g||this.hiddenNodes.push(a)}};Autodesk.Viewing.Private.VisibilityManager.isVisible=function(a){return null!=a.visible?a.visible:!0};Autodesk.Viewing.Private.VisibilityManager.prototype.areAllVisible=function(){return this.viewerImpl.isWholeModelVisible(this.model)};AutodeskNamespace("Autodesk.Viewing.Private");
var NUM_WORKER_THREADS=Math.min(navigator.hardwareConcurrency||4,4),NUM_PARALLEL_DOWNLOADS=NUM_WORKER_THREADS,WORKER_DATA_URL=null;LMV_WORKER_URL||(LMV_WORKER_URL="src/workers/MainWorker.js");void 0==ENABLE_INLINE_WORKER&&(ENABLE_INLINE_WORKER=!1);
var WORKER_LOAD_GEOMETRY="LOAD_GEOMETRY",WORKER_LOAD_SVF="LOAD_SVF",WORKER_SEARCH="SEARCH",WORKER_GET_PROPERTIES="GET_PROPERTIES",WORKER_SEARCH_PROPERTIES="SEARCH_PROPERTIES",WORKER_GET_OBJECT_TREE="GET_OBJECT_TREE",WORKER_PARSE_F2D="PARSE_F2D",WORKER_STREAM_F2D="STREAM_F2D",WORKER_PARSE_F2D_FRAME="PARSE_F2D_FRAME",WORKER_CLOUD_RENDERING="CLOUD_RENDERING",WORKER_SVF_TO_SPD="SVF_TO_SPD";
Autodesk.Viewing.Private.SvfLoader=function(a){this.viewer3DImpl=a;this.next_pack=0;this.loading=!1;this.tmpMatrix=new THREE.Matrix4;this.getObjectTreeCallbacks=[];Autodesk.Viewing.Private.logger||(Autodesk.Viewing.Private.logger=new Autodesk.Viewing.Private.Logger({console:!0,viewingservice:!1,webstorage:!1,endpoint:"",flushThreshold:0}));this.logger=Autodesk.Viewing.Private.logger;this.loadTime=0;this.domainParam=auth?"domain="+window.location.hostname:""};
Autodesk.Viewing.Private.SvfLoader.prototype.uninitialize=function(){this.viewer3DImpl=this.svf=null};Autodesk.Viewing.Private.SvfLoader.prototype.pathToURL=function(a){if("http://"==a.substr(0,7)||"https://"==a.substr(0,8)||"file:///"==a.substr(0,8)||"urn:"==a.substr(0,4))return a;var b=window.location.pathname,c=b.lastIndexOf("/"),b=b.substr(0,c+1);return window.location.protocol+"//"+window.location.host+b+a};
Autodesk.Viewing.Private.SvfLoader.prototype.loadSvf=function(a,b,c,d,f){if(this.loading)return console.log("Loading of SVF already in progress. Ignoring new request."),!1;this.svfWorker&&(this.svfWorker.terminate(),this.svfWorker=null);this.parsingWorker&&(this.parsingWorker.terminate(),this.parsingWorker=null);this.streamingWorker&&(this.streamingWorker.terminate(),this.streamingWorker=null);if(this.pack_workers){for(var g=0;g<this.pack_workers.length;g++)this.pack_workers[g].terminate();this.pack_workers=
null}g=a.indexOf("urn:");-1!=g&&(this.logger.bindURN(a.substr(g,a.substr(g).indexOf("/"))),stderr("Extracted URN: "+this.logger.urn),g=this.logger.urn.lastIndexOf(":"),this.svfUrn=this.logger.urn.substr(g+1),this.svfFullPath=a);this.sharedDbPath=c;this.currentLoadPath=a;var h=this.isf2d=-1!=a.indexOf(".f2d");if(ENABLE_INLINE_WORKER&&!WORKER_DATA_URL){var k=new XMLHttpRequest;c=LMV_WORKER_URL;(g=Autodesk.Viewing.Private.getResourceUrl(LMV_WORKER_URL))&&(c=g);k.open("GET",c,!0);k.withCredentials=!1;
var l=this;k.onload=function(){var c;window.URL=window.URL||window.webkitURL;try{c=new Blob([k.responseText],{type:"application/javascript"})}catch(g){c=new BlobBuilder,c.append(k.responseText),c=c.getBlob()}WORKER_DATA_URL=URL.createObjectURL(c);h?l.loadFydoCB(a,b,d,f):l.loadSvfCB(a,b,d,f)};k.send();return!0}return h?this.loadFydoCB(a,b,d,f):this.loadSvfCB(a,b,d,f)};
Autodesk.Viewing.Private.SvfLoader.prototype.loadSvfCB=function(a,b,c,d){this.t0=(new Date).getTime();this.failedToLoadSomeGeometryPacks=null;var f=this,g=this.svfWorker=createWorkerWithTokenRefresh(function(a){if(a.data&&a.data.svf){a=f.svf=a.data.svf;f.failedToLoadSomeGeometryPacks&&(d&&d(f.failedToLoadSomeGeometryPacks.code,f.failedToLoadSomeGeometryPacks.msg),f.failedToLoadSomeGeometryPacks=null);f.onSvfLoadDone(a);c&&c(a);var b=a.geompacks.length;if(b)for(var b=Math.min(b,NUM_PARALLEL_DOWNLOADS),
l=0;l<b;l++){var m=a.geompacks[l];f.loadGeometryPack(m.id,m.uri);f.next_pack=l+1}else f.onGeomLoadDone();f.loading=!1;g.finish();g=null}else a.data&&a.data.progress||(a.data&&a.data.error?(f.loading=!1,g.finish(),g=null,d&&d(a.data.error.code,a.data.error.msg)):a.data&&a.data.debug?stderr(a.data.message):(stderr("SVF download failed."),f.loading=!1,g.finish(),g=null))},"SVF Load");a=f.pathToURL(a);g.postMessage({operation:WORKER_LOAD_SVF,url:a,headers:Autodesk.Viewing.HTTP_REQUEST_HEADERS,objectIds:b,
auth:auth,viewing_url:VIEWING_URL,queryParams:this.domainParam});return!0};
Autodesk.Viewing.Private.SvfLoader.prototype.loadFydoCB=function(a,b,c,d){this.t0=Date.now();var f=this.pathToURL(a),g=this.streamingWorker=createWorker(),h=this.parsingWorker=createWorker(),k=this,l={};g.addEventListener("message",function(a){if(a.data&&"F2DBLOB"==a.data.type){var b={operation:WORKER_PARSE_F2D,data:a.data.buffer,metadata:a.data.metadata,manifest:a.data.manifest,basePath:a.data.basePath,f2dLoadOptions:l,url:f};h.postMessage(b,[b.data]);g.terminate()}else a.data&&"F2DSTREAM"==a.data.type?
(b={operation:WORKER_PARSE_F2D_FRAME,data:a.data.frames,url:f,f2dLoadOptions:l},a.data.metadata&&(b.metadata=a.data.metadata,b.manifest=a.data.manifest),a.data.finalFrame&&(b.finalFrame=!0),a.data.progress&&k.viewer3DImpl.signalProgress(100*a.data.progress),h.postMessage(b,b.data?[b.data]:void 0),a.data.finalFrame&&g.terminate()):a.data&&a.data.debug?stderr(a.data.message):a.data&&a.data.error?(k.loading=!1,g.terminate(),d&&d.call(this,a.data.error.code,a.data.error.msg)):(stderr("F2D download failed."),
k.loading=!1,g.terminate())},!1);h.addEventListener("message",function(a){if(a.data&&a.data.f2d){var b=k.svf=a.data.f2d;h.terminate();stderr("Num polylines: "+b.numPolylines);stderr("Line segments: "+b.numLineSegs);stderr("Circular arcs: "+b.numCircles);stderr("Ellipitcal arcs:"+b.numEllipses);stderr("Plain triangles:"+b.numTriangles);stderr("Total # of op codes generated by fydo.parse: "+b.opCount);k.onSvfLoadDone(k.svf);c&&c(k.svf);for(var f=0;f<b.meshes.length;f++)k.processReceivedMesh2D(b.meshes[f],
f);b.meshes=null;k.onGeomLoadDone();k.loading=!1}else if(a.data&&a.data.f2dframe){var g=0;a.data.meshes?(b=a.data.bbox,k.svf.bbox=new THREE.Box3(b.min,b.max)):k.svf=a.data.f2dframe;g=a.data.baseIndex;b=k.svf;b.fragments&&b.fragments.initialized?b.maxObjectNumber=a.data.maxObjectNumber:(k.onSvfLoadDone(b),c&&c(b));if(a.data.meshes&&a.data.meshes.length){for(f=0;f<a.data.meshes.length;f++)k.processReceivedMesh2D(a.data.meshes[f],g+f);a.data.finalFrame&&(k.onGeomLoadDone(),k.loading=!1,h.terminate())}}else a.data&&
a.data.progress||(a.data&&a.data.debug?stderr(a.data.message):a.data&&a.data.error?(k.loading=!1,h.terminate(),stderr("Error while parsing F2d: "+JSON.stringify(a.data.error.args)),d&&d.call(this,a.data.error.code,a.data.error.msg)):(stderr("F2D download failed."),k.loading=!1,h.terminate()))},!1);g.postMessage({operation:WORKER_STREAM_F2D,url:f,headers:Autodesk.Viewing.HTTP_REQUEST_HEADERS,objectIds:b,auth:auth,viewing_url:VIEWING_URL,queryParams:this.domainParam});return!0};
Autodesk.Viewing.Private.SvfLoader.prototype.loadGeometryPack=function(a,b){var c,d,f,g=this;d=function(a){if(a.data&&a.data.mesh){if(g.processReceivedMesh(a.data),1<=a.data.progress){g.pack_workers[a.data.workerId].queued-=1;a=!0;for(f=0;f<g.pack_workers.length;f++)if(0!=g.pack_workers[f].queued){a=!1;break}if(a){for(f=0;f<NUM_WORKER_THREADS;f++)g.pack_workers[f].finish();g.pack_workers=null}g.svf.fragments.numLoaded==g.svf.fragments.length&&(g.viewer3DImpl.matman().loadTextures(g.svf),g.onGeomLoadDone())}}else a.data&&
a.data.progress?(g.pack_workers[a.data.workerId].queued-=1,g.next_pack<g.svf.geompacks.length&&(a=g.svf.geompacks[g.next_pack++],g.loadGeometryPack(a.id,a.uri)),g.viewer3DImpl.signalProgress(100*g.next_pack/g.svf.geompacks.length)):a.data&&a.data.debug?stderr(a.data.message):a.data&&a.data.error?g.failedToLoadSomeGeometryPacks={code:a.data.error.code,msg:a.data.error.msg}:g.pack_workers[a.data.workerId].queued-=2};if(!this.pack_workers)for(this.pack_workers=[],c=0;c<NUM_WORKER_THREADS;c++){var h=
createWorkerWithTokenRefresh(d,"Mesh Load");h.queued=0;this.pack_workers.push(h)}d=0;h=this.pack_workers[0].queued;for(c=1;c<NUM_WORKER_THREADS;c++)this.pack_workers[c].queued<h&&(d=c,h=this.pack_workers[c].queued);c=this.pack_workers[d];c.queued+=2;h=this.pathToURL(this.svf.basePath+b);d={operation:WORKER_LOAD_GEOMETRY,url:h,packId:parseInt(a),headers:Autodesk.Viewing.HTTP_REQUEST_HEADERS,workerId:d,auth:auth,viewing_url:VIEWING_URL};c.postMessage(d)};
function meshToGeometry(a){var b=a.mesh,c=new THREE.BufferGeometry;a.byteSize=0;c.vb=b.vb;c.vbNeedsUpdate=!0;a.byteSize+=b.vb.byteLength;c.vbstride=b.vbstride;b.isLines&&(c.isLines=b.isLines);a.is2d&&(c.is2d=!0);c.numInstances=b.numInstances;for(var d in b.vblayout){var f=b.vblayout[d],g=new THREE.BufferAttribute(f.array,f.itemSize);g.bytesPerItem=f.bytesPerItem;g.normalize=f.normalize;g.isPattern=f.isPattern;c.addAttribute(d,g);c.numInstances&&(c.attributes[d].divisor=f.divisor);f.array?a.byteSize+=
f.array.byteLength:f.hasOwnProperty("offset")?c.attributes[d].itemOffset=f.offset:stderr("VB attribute is neither interleaved nor separate. Something is wrong with the buffer specificaiton.")}c.addAttribute("index",new THREE.BufferAttribute(b.indices,1));a.byteSize+=b.indices.byteLength;65535<b.vb.length/b.vbstride&&stderr("Mesh with >65535 vertices. It will fail to draw.");c.boundingBox=(new THREE.Box3).copy(b.boundingBox);c.boundingSphere=(new THREE.Sphere).copy(b.boundingSphere);a.geometry=c;delete a.mesh}
function getFragmentTransform(a,b,c){c*=16;b=b.transforms;if(!b)return null;for(var d=!0,f=0;16>f;f++)if(f%5&&0!=b[c+f]||!(f%5)&&1!=b[c+f]){d=!1;break}if(d)return null;for(d=0;16>d;d++)a.elements[d]=b[c+d];return a}
Autodesk.Viewing.Private.SvfLoader.prototype.processReceivedMesh=function(a){meshToGeometry(a);var b=a.packId+":"+a.meshIndex,c=this.svf,d=c.fragments,f=d.mesh2frag[b];if(void 0===f)stderr("Mesh "+b+" was not referenced by any fragments.");else{c.meshCount++;var g=268435456,h=MAX_FRAGS_PER_GROUP;this.isf2d&&(g*=2);if(c.disableStreaming||67108864>c.gpuMeshMemory&&c.gpuNumMeshes<h)a.geometry.streamingDraw=!1,a.geometry.streamingIndex=!1;else if(c.gpuMeshMemory>g||2E3<c.gpuNumMeshes)a.geometry.streamingDraw=
!0,a.geometry.streamingIndex=!0;else{var k;this.isf2d?k=100001:Array.isArray(f)?k=f.length*a.byteSize:300>(0|f)?(a.geometry.streamingDraw=!1,a.geometry.streamingIndex=!1):k=a.byteSize;1E5>k&&(a.geometry.streamingDraw=!0,a.geometry.streamingIndex=!0)}a.geometry.streamingDraw||(c.gpuMeshMemory+=a.byteSize,c.gpuNumMeshes+=1);if(Array.isArray(f))for(h=0;h<f.length;h++)k=0|f[h],g=d.materials[k].toString(),this.viewer3DImpl.addMeshInstance(a.geometry,k,g,getFragmentTransform(this.tmpMatrix,d,k));else h=
getFragmentTransform(this.tmpMatrix,d,0|f),g=d.materials[f].toString(),this.viewer3DImpl.addMeshInstance(a.geometry,0|f,g,h);delete d.mesh2frag[b];b=a.geometry.attributes.index.array.length/3;c.geomPolyCount+=b;c.instancePolyCount+=b*(f.length||1);c.geomMemory+=a.byteSize;d.numLoaded+=f.length||1;a=d.numLoaded;d=a/d.length;c.geomPolyCount>c.nextRepaintPolys&&(c.numRepaints++,c.nextRepaintPolys+=1E4*Math.pow(1.5,c.numRepaints),this.viewer3DImpl.invalidate(!1,!0),this.viewer3DImpl.sceneUpdated());this.isf2d&&
0==a%20?this.viewer3DImpl.invalidate(!1,!0):this.isf2d||1!=d||this.viewer3DImpl.invalidate(!0)}};
Autodesk.Viewing.Private.SvfLoader.prototype.processReceivedMesh2D=function(a,b){var c={mesh:a,is2d:!0,packId:"0",meshIndex:b},d="0:"+b,f=this.svf.fragments;f.fragId2dbId[b]=c.mesh.dbIds;for(var g in c.mesh.dbIds){var h=parseInt(g),k=f.dbId2fragId[h];Array.isArray(k)?k.push(b):f.dbId2fragId[h]="undefined"!==typeof k?[k,b]:b}f.mesh2frag[d]=b;f.materials[b]=this.viewer3DImpl.matman().create2DMaterial(this.svf,a.material);f.length++;this.processReceivedMesh(c)};
Autodesk.Viewing.Private.SvfLoader.prototype.onSvfLoadDone=function(a){this.isf2d?(a.fragments={},a.fragments.mesh2frag={},a.fragments.materials=[],a.fragments.fragId2dbId=[],a.fragments.dbId2fragId=[],a.fragments.length=0,a.fragments.initialized=!0):a.packFileTotalSize&&268435456>=a.packFileTotalSize-6*a.primitiveCount&&(a.disableStreaming=!0);a.geomPolyCount=0;a.instancePolyCount=0;a.geomMemory=0;a.fragments.numLoaded=0;a.meshCount=0;a.gpuNumMeshes=0;a.gpuMeshMemory=0;a.nextRepaintPolys=1E4;a.numRepaints=
0;a.basePath="";var b=this.currentLoadPath.lastIndexOf("/");-1!=b&&(a.basePath=this.currentLoadPath.substr(0,b+1));b=Date.now();this.loadTime+=b-this.t0;stderr("SVF load: "+(b-this.t0));this.viewer3DImpl.matman().convertMaterials(a);this.t0=b;a.bbox=new THREE.Box3(a.bbox.min,a.bbox.max);if(a.cameras)for(b=0;b<a.cameras.length;b++){var c=a.cameras[b];c.position=(new THREE.Vector3).copy(c.position);c.target=(new THREE.Vector3).copy(c.target);c.up=(new THREE.Vector3).copy(c.up)}stderr("scene bounds: "+
JSON.stringify(a.bbox));this.viewer3DImpl.signalProgress(5,"Hold on, getting the model...")};
Autodesk.Viewing.Private.SvfLoader.prototype.onGeomLoadDone=function(){this.svf.loadDone=!0;this.svf.fragments.entityIndexes=null;this.svf.fragments.packIds=null;var a=Date.now(),b="Fragments load time: "+(a-this.t0);this.loadTime+=a-this.t0;stderr(b);stderr("Total geometry size: "+this.svf.geomMemory/1048576+" MB");stderr("Number of meshes: "+this.svf.meshCount);stderr("Num Meshes on GPU: "+this.svf.gpuNumMeshes);stderr("Net GPU geom memory used: "+this.svf.gpuMeshMemory);a={viewer_current_time:Date.now(),
viewer_model_stats_is_f2d:this.isf2d,viewer_model_stats_total_load_time:this.loadTime,viewer_model_stats_total_geometry_size:this.svf.geomMemory/1048576,viewer_model_stats_total_meshes_count:this.svf.meshCount,viewer_model_stats_total_meshes_on_gpu:this.svf.gpuNumMeshes,viewer_model_stats_total_gpu_memory_used:this.svf.gpuMeshMemory/1048576};this.logger.log(a,!0);this.currentLoadPath=null;this.isf2d=void 0;this.viewer3DImpl.onLoadComplete()};
Autodesk.Viewing.Private.SvfLoader.prototype.getProperties=function(a,b,c){var d=this,f=function(g){g.data&&g.data.error?c&&c(g.data.error.code,g.data.error.msg,g.data.error.args):g.data&&g.data.debug?stderr(g.data.message):g.data&&g.data.dbId===a&&(d.propWorker.removeMessageEventListener(f),b(g.data.result))};this.propWorker?this.propWorker.addMessageEventListener(f):this.propWorker=createWorkerWithTokenRefresh(f,"Property");var g=this.pathToURL(this.svf.basePath);this.sharedDbPath&&!this.svf.propertydb.values.length&&
(g=this.sharedDbPath,stderr("Using shared property db: "+g));this.propWorker.postMessage({operation:WORKER_GET_PROPERTIES,url:g,propertydb:this.svf.propertydb,dbId:a,headers:Autodesk.Viewing.HTTP_REQUEST_HEADERS,auth:auth,viewing_url:VIEWING_URL})};
Autodesk.Viewing.Private.SvfLoader.prototype.searchProperties=function(a,b,c){var d=this,f=function(a){a.data&&a.data.error?c&&c(a.data.error.code,a.data.error.msg):a.data&&a.data.debug?stderr(a.data.message):(d.propWorker.removeMessageEventListener(f),b&&b(a.data))};this.propWorker?this.propWorker.addMessageEventListener(f):this.propWorker=createWorkerWithTokenRefresh(f,"Property");var g=this.pathToURL(this.svf.basePath);this.sharedDbPath&&!this.svf.propertydb.values.length&&(g=this.sharedDbPath,
stderr("Using shared property db: "+g));this.propWorker.postMessage({operation:WORKER_SEARCH_PROPERTIES,url:g,propertydb:this.svf.propertydb,searchText:a,headers:Autodesk.Viewing.HTTP_REQUEST_HEADERS,auth:auth,viewing_url:VIEWING_URL})};
Autodesk.Viewing.Private.SvfLoader.prototype.createFragToNodeMapping=function(){var a=this.svf,b=a.fragments.fragId2dbId;if(a.instanceTree&&b){var c=a.fragments.fragToDbNode=Array(b.length);(function f(a){var b=a.fragIds;if(void 0!==b)if(Array.isArray(b))for(var k=0;k<b.length;k++)c[b[k]]=a;else c[b]=a;if(a.children)for(b=0;b<a.children.length;b++)f(a.children[b])})(a.instanceTree);a.fragToNodeDone=!0;this.viewer3DImpl.api.fireEvent({type:Autodesk.Viewing.OBJECT_TREE_CREATED_EVENT})}};
Autodesk.Viewing.Private.SvfLoader.prototype.getObjectTree=function(a,b){function c(){for(var a=0;a<d.getObjectTreeCallbacks.length;a++)d.getObjectTreeCallbacks[a](d.svf.instanceTree);d.getObjectTreeCallbacks=[]}var d=this;a&&this.getObjectTreeCallbacks.push(a);if(d.svf.instanceTree)c();else{var f=function(a){if(!a.data||!a.data.error)if(a.data&&a.data.debug)stderr(a.data.message);else{var b=a.data.instanceTree,g=a.data.instanceBoxes;b?d.svf.instanceTree||(d.svf.instanceTree=b,d.svf.maxTreeDepth=
a.data.maxTreeDepth,d.createFragToNodeMapping()):a.data.objectCount&&(d.svf.hasObjectProperties=a.data.objectCount);c();g&&(d.svf.instanceBoxes=g,d.propWorker.removeMessageEventListener(f))}};this.propWorker?this.propWorker.addMessageEventListener(f):this.propWorker=createWorkerWithTokenRefresh(f,"Property");var g=this.pathToURL(this.svf.basePath);this.sharedDbPath&&!this.svf.propertydb.values.length&&(g=this.sharedDbPath,stderr("Using shared property db: "+g));this.propWorker.postMessage({operation:WORKER_GET_OBJECT_TREE,
url:g,propertydb:this.svf.propertydb,headers:Autodesk.Viewing.HTTP_REQUEST_HEADERS,fragToDbId:this.svf.fragments.fragId2dbId,fragBoxes:this.svf.fragments.boxes,auth:auth,viewing_url:VIEWING_URL})}};function createWorker(){return ENABLE_DEBUG||!ENABLE_INLINE_WORKER?new Worker(Autodesk.Viewing.Private.getResourceUrl(LMV_WORKER_URL)):new Worker(WORKER_DATA_URL)}
function createWorkerWithTokenRefresh(a,b){var c=createWorker();c.hasEventListener=!1;c.onMessageReceivedCallbacks=[];c.name=b;c.onMessageReceived=function(a){if(a.data&&a.data.refreshToken)(new Autodesk.Viewing.Private.WorkerViewingServiceRefreshTokenHandler).refreshToken(function(a){stderr("Token refreshed in thread");c.postMessage({tokenRefreshed:!0})},function(a){stderr("Failed token refresh in thread");c.postMessage({tokenRefreshed:!1})});else for(var b=0;b<c.onMessageReceivedCallbacks.length;++b)c.onMessageReceivedCallbacks[b](a)};
c.addMessageEventListener=function(a){c.onMessageReceivedCallbacks.indexOf(a);c.onMessageReceivedCallbacks.push(a);c.hasEventListener||(c.addEventListener("message",c.onMessageReceived,!1),c.hasEventListener=!0);return!0};a&&c.addMessageEventListener(a);c.postMessageWithCallback=function(a,b,g){b&&c.addMessageEventListener(b);ENABLE_DEBUG&&g?(b=function(b){c.postMessage.call(c,a)},0===Autodesk.Viewing.Private.env.indexOf("Autodesk")?Autodesk.Viewing.Private.setApigeeTokenInCookie("invalid",b):Autodesk.Viewing.Private.setAuthTokenInCookie("invalid",
b)):c.postMessage.call(c,a)};c.removeMessageEventListener=function(a){a=c.onMessageReceivedCallbacks.indexOf(a);return-1!==a?(c.onMessageReceivedCallbacks.splice(a,1),0===c.onMessageReceivedCallbacks.length&&(c.removeEventListener("message",c.onMessageReceived),c.hasEventListener=!1),!0):!1};c.removeAllMessageEventListeners=function(){c.onMessageReceivedCallbacks=[];c.removeEventListener("message",c.onMessageReceived);c.hasEventListener=!1};c.finish=function(){c.removeAllMessageEventListeners();c.terminate()};
return c}
Autodesk.Viewing.Private.SvfLoader.prototype.cloudRendering=function(a,b,c){a=this.cloudRenderingWorker;b={operation:WORKER_CLOUD_RENDERING,url:"urn:"+this.spdUrn,headers:Autodesk.Viewing.HTTP_REQUEST_HEADERS,auth:auth,viewing_url:VIEWING_URL,queryParams:this.domainParam,camera:b,canvas:{width:this.viewer3DImpl.canvas.width,height:this.viewer3DImpl.canvas.height},imageNo:c,exposureBias:this.viewer3DImpl.renderer().getExposureBias(),currentLightPreset:this.viewer3DImpl.currentLightPreset(),upVector:this.viewer3DImpl.model.getUpVector()};
a.postMessage(b)};
Autodesk.Viewing.Private.SvfLoader.prototype.svfToSpdTranslator=function(a,b,c,d){var f=this.cloudRenderingWorker,g=this;if(!this.cloudRenderingWorker){var f=this.cloudRenderingWorker=createWorker(),h=function(b){var l=function(){f.removeEventListener("message",h);f.terminate();f=null};b.data&&b.data.translation?(g.spdUrn=b.data.translation.spdUrn,g.spdUrn=btoa(g.spdUrn),stderr("spdUrn = "+g.spdUrn),g.cloudRendering(a,b.data.translation.camera,b.data.translation.imageNo),alertify.success("Translation Job Complete")):b.data&&
b.data.translationProgress?alertify.success("Translation Job In Progress"):b.data&&b.data.translationError?(alertify.error("Translation Job Error"),d(b.data.translationError),l()):b.data&&b.data.renderings?(alertify.success("RaaS Rendering Job Complete"),c(b.data.renderings),stderr(renderings)):b.data&&b.data.progress?alertify.success("RaaS Rendering Job in Progress"):b.data&&b.data.error?(alertify.error("RaaS Rendering Job Error"),d(b.data.error),l()):b.data&&b.data.debug&&stderr(b.data.message)};
f.addEventListener("message",h,!1)}f.postMessage({operation:WORKER_SVF_TO_SPD,url:"urn:",headers:Autodesk.Viewing.HTTP_REQUEST_HEADERS,auth:auth,viewing_url:VIEWING_URL,queryParams:this.domainParam,svfUrn:g.svfUrn,camera:this.viewer3DImpl.camera,imageNo:b})};var MAX_FRAGS_PER_GROUP=333;
function RenderQueue(a,b,c,d){function f(a,b,c){var d=s[a];if(!!(d&b)==c)return!1;s[a]=c?d|b:d&~b;return!0}var g=0,h=-1,k=!0,l=!1,m=0,p=new THREE.Box3,n,q=new THREE.Box3,r=0<c?c:MAX_FRAGS_PER_GROUP;0>=a&&(a=1);var v=Array(a),s=new Uint8Array(a),w=new THREE.Raycaster,z=0,D=!1,A=0,E=1;a=0|(a+r-1)/r;var N=Array(a);for(c=0;c<a;c++)N[c]=new THREE.Scene(!0),N[c].sortDone=!1;this.visibleBoundsDirty=!1;b&&p.copy(b);this.addMesh=function(a,b){var c=v[a];c&&(stderr("duplicate fragment."),c.parent.remove(c));
v[a]=b;b.fragId=a;if(s.length<v.length){c=2*s.length;c<v.length&&(c=v.length);for(var c=new Uint8Array(c),d=0,f=s.length;d<f;d++)c[d]=s[d];s=c}s[a]=1;c=0|a/r;(d=N[c])||(N[c]=d=new THREE.Scene(!0));q.copy(b.geometry.boundingBox);q.applyMatrix4(b.matrixWorld);p.union(q);d.add(b);d.sortDone=!1;this.visibleBoundsDirty=!0};this.renderSome=function(a,b){var c=g,f=N.length,k=s,l=Date.now(),m,n=l,p=!0,q=0===c;q&&!D&&(h=-1,D=!0);for(b*=E;c<f;c++){var r=N[c];r.sortDone||d||(r.children.sort(function(a,b){return a.material.id-
b.material.id}),r.sortDone=!0);m=!1;q&&0<h?(c==h&&(m=!0),p=!1):p?(0>=b&&(m=!0),p=!1):b<=0.5*r.avgFrameTime&&(m=!0);if(m)break;m=r.children;var v=!0;if(2==z)for(var w=0,ba=m.length;w<ba;w++){var U=m[w],W=!(k[U.fragId]&1);U.visible=W;v=v&&!W}else if(1==z)for(w=0,ba=m.length;w<ba;w++)U=m[w],W=!!(k[U.fragId]&2),U.visible=W,v=v&&!W;else for(w=0,ba=m.length;w<ba;w++)U=m[w],W=1==k[U.fragId],U.visible=W,v=v&&!W;v||a(r);m=Date.now();v=m-l;l=m;r.avgFrameTime=void 0===r.avgFrameTime?v:0.9*r.avgFrameTime+0.1*
v;g=c+1;b-=r.avgFrameTime}q&&-1==h&&(h=c);q&&A&&(E=(l-n)/A,0>=E&&(E=1),1<E&&(E=1));c!=f&&q||(h=-1,D=!1);return b/E};this.isDone=function(){return g==N.length};this.reset=function(a,b){g=0;A=b};this.drawNormalObjectsOnly=function(){z=0};this.drawHighlightedObjectsOnly=function(){z=1};this.drawHiddenObjectsOnly=function(){z=2};this.setOverrideMaterial=function(a){for(var b=0,c=N.length;b<c;b++)N[b].overrideMaterial=a};this.setHighlighted=function(a,b){f(a,2,b)&&(b?m++:m--);this.visibleBoundsDirty=!0};
this.setVisibility=function(a,b){f(a,1,b);this.visibleBoundsDirty=l=!0};this.setAllVisibility=function(a){var b=s,c=0,d=b.length;if(a)for(;c<d;c++)b[c]|=1;else for(;c<d;c++)b[c]&=-2;k=a;l=!1;this.visibleBoundsDirty=!0};this.hideLines=function(a){var b=s,c=0,d=b.length;if(a)for(;c<d;c++)v[c]&&v[c].isLine&&(b[c]|=4);else for(;c<d;c++)v[c]&&v[c].isLine&&(b[c]&=-5);l=!0};this.hasHighlighted=function(){return!!m};this.isFragVisible=function(a){return 1==(s[a]&3)};this.areAllVisible=function(){if(l){k=
!0;l=!1;for(var a=s,b=0,c=a.length;b<c;b++)if(0===(a[b]&1)){k=!1;break}}return k};this.getVisibleBounds=function(a){if(!this.visibleBoundsDirty&&a==n)return p;n=a;var b=s;p.makeEmpty();for(var c=0,d=b.length;c<d;c++){var f=b[c];if(f&1||a&&0===f)if(f=v[c])q.copy(f.geometry.boundingBox).applyMatrix4(f.matrixWorld),p.union(q)}this.visibleBoundsDirty=!1;return p};this.rayIntersect=function(a,b,c){w.set(a,b);a=w.intersectObjects(N,!0);for(var d=b=null,f=0;f<a.length;f++){var g=a[f].object;if(!g.is2d){var h=
g.visible;void 0!==g.fragId&&(h=this.isFragVisible(g.fragId));if(h&&(!c||!a[f].object.material.transparent)){b=a[f].object;d=a[f].point;g=!1;if(b.material.cutplanes)for(h=0;h<b.material.cutplanes.length;h++)g|=0>b.material.cutplanes[h].dot(new THREE.Vector4(d.x,d.y,d.z,1));if(g)d=b=null;else break}}}return[b,d]};this.getRenderProgress=function(){return g/N.length};this.getVizmesh=function(a){return v[a]};this.getSceneCount=function(){return N.length};this.cleanup=function(){for(var a={type:"removed"},
b={type:"dispose"},c=0;c<v.length;c++){var d=v[c];d&&(d.dispatchEvent(a),d.geometry.dispatchEvent(b),d.material.dispatchEvent(b))}}}
function RenderContext(){function a(){function a(b){b.material.blending=THREE.NoBlending;b.material.depthWrite=!1;b.material.depthTest=!1}var b=NormalsShader;c=new THREE.ShaderMaterial({fragmentShader:b.fragmentShader,vertexShader:b.vertexShader,uniforms:THREE.UniformsUtils.clone(b.uniforms)});c.blending=THREE.NoBlending;k=new THREE.ShaderPass(SAOShader);a(k);h=new THREE.ShaderPass(SAOBlurShader);a(h);m=new THREE.ShaderPass(SAOMinifyFirstShader);a(m);l=new THREE.ShaderPass(SAOMinifyShader);a(l);p=
new THREE.ShaderPass(FXAAShader);a(p);n=new THREE.ShaderPass(BlendShader);a(n);g=new THREE.ShaderPass(BackgroundShader);a(g)}var b,c,d,f,g,h,k,l,m,p,n,q=!1,r,v=null,s=null,w=null,z=null,D=null,A=null,E=0,N=0,H=1,J,G,I=!1,M=new Uint8Array(4),C=(new THREE.Color).setRGB(1,1,1),K=(new THREE.Color).setRGB(0,0,0),F=!1,B={antialias:!0,sao:!1,useHdrTarget:!1,haveTwoSided:!1,useSSAA:!1,idbuffer:!1,customPresentPass:!1},R,Y,S,P;this.settings=B;this.init=function(c,d,f){c?(F=-1!=window.navigator.userAgent.indexOf("Firefox")&&
-1!=window.navigator.userAgent.indexOf("Mac OS"),J=d,G=f,b=c,a(),this.initPostPipeline(B.sao,B.antialias,!1),P=new GroundShadow(b)):console.error("You need a gl context to make a renderer. Things will go downhill from here.")};this.beginScene=function(a,c,h,l){d=c;f=h;q=!1;s?(l&&(b.setClearColor(K,0),b.clearTarget(s,!1,!0,!1),g.render(b,s,null),P.enabled&&P.bufferValid&&(P.rendered=!1)),A&&(b.setClearColor(C,1),b.clearTarget(A,!0,!1,!1)),B.sao&&(l&&(b.setClearColor(K,0),b.clearTarget(r,!0,!1,!1)),
k.uniforms.cameraNear.value=c.near,k.uniforms.cameraFar.value=c.far,m.uniforms.cameraNear.value=c.near,m.uniforms.cameraInvNearFar.value=1/(c.near-c.far),h=c.projectionMatrix.elements,c.isPerspective?(k.uniforms.projInfo.value.set(-2/(s.width*h[0]),-2/(s.height*h[5]),(1-h[8])/h[0],(1+h[9])/h[5]),k.uniforms.isOrtho.value=0):(k.uniforms.projInfo.value.set(-2/(s.width*h[0]),-2/(s.height*h[5]),(1-h[12])/h[0],(1-h[13])/h[5]),k.uniforms.isOrtho.value=1),k.uniforms.projScale.value=0.125*s.height*h[5]),b.beginFrame(d),
this.renderScenePart(a,!0,!0,!1,!0)):J||I||(console.error("Rendering to a canvas that was resized to zero. If you see this message you may be accidentally leaking a viewer instance."),I=!0)};this.renderScenePart=function(a,d,g,h,k){q=!1;k=k?f:void 0;this.hasMRT()?(B.sao&&g&&B.idbuffer&&h&&stderr("Incompatible render target combination given to renderScenePart"),B.idbuffer?b.renderIncrement(a,[s,A]):B.sao?b.renderIncrement(a,[s,r],k):b.renderIncrement(a,s,k)):(d&&b.renderIncrement(a,s,k),B.idbuffer&&
h&&b.renderIncrement(a,A,void 0),B.sao&&g&&(d=a.overrideMaterial,a.overrideMaterial=c,b.renderIncrement(a,r,void 0),a.overrideMaterial=d));!P.enabled||P.bufferValid||a.overrideMaterial&&a.overrideMaterial.transparent||P.renderShadow(a)};this.sceneDirty=function(a,b){P.reset();P.updateTransform(a,b.clone())};this.clearAllOverlays=function(){b.clearTarget(w,!0,!1,!1)};this.renderOverlays=function(a,c){var f=0,g;for(g in a)if(a.hasOwnProperty(g)){var h=a[g],k=h.scene,l=h.camera?h.camera:d;k.children.length&&
(f||(f=1,b.setClearColor(K,0),b.clearTarget(w,!0,!1,!1)),h.materialPre&&(k.overrideMaterial=h.materialPre,b.render(k,l,w,!1,c)),h.materialPost&&(k.overrideMaterial=h.materialPost,b.context.depthFunc(b.context.GREATER),b.render(k,l,w,!1,c),b.context.depthFunc(b.context.LEQUAL)),k.overrideMaterial=null)}n.uniforms.useOverlay.value=f};this.computeSSAO=function(a){if(!a&&B.sao){if(!q){if(v){a=v[0];m.uniforms.resolution.value.set(1/a.width,1/a.height);m.render(b,a,r);for(var c=1;c<v.length;c++){var d=
v[c];l.uniforms.resolution.value.set(1/d.width,1/d.height);l.render(b,d,a);a=d}}k.render(b,D,s);h.uniforms.axis.value.set(1,0);h.render(b,z,D);h.uniforms.axis.value.set(0,1);h.render(b,D,z);q=!0}n.uniforms.useAO.value=1}else n.uniforms.useAO.value=0};this.presentBuffer=function(a){!a&&!B.antialias||B.sao||n.uniforms.useOverlay.value||n.uniforms.objID.value?B.antialias?(n.render(b,z,s),a?(p.render(b,D,z),a.render(b,null,D)):p.render(b,null,z)):a?(n.render(b,z,s),a.render(b,null,z)):n.render(b,null,
s):B.antialias?a?(p.render(b,z,s),a.render(b,null,z)):p.render(b,null,s):a.render(b,null,s)};this.composeFinalFrame=function(a,c){b.endIncrementalFrame();P.renderPost(d,s);this.computeSSAO(a);c||this.presentBuffer()};this.cleanup=function(){s&&s.dispose();r&&r.dispose();w&&w.dispose();z&&z.dispose();D&&D.dispose();if(v)for(var a=0;a<v.length;a++)v[a].dispose()};this.setSize=function(a,c,d){J=a;G=c;var f=0|a*b.devicePixelRatio,g=0|c*b.devicePixelRatio;B.logicalWidth=a;B.logicalHeight=c;B.deviceWidth=
f;B.deviceHeight=g;if(0==a&&0==c)this.cleanup(),D=z=w=r=s=null,v=[];else{b.setSize(a,c);stderr("width: "+f+" height: "+g);var l=1/f,m=1/g;a=!1;if(B.useSSAA){if(B.antialias){f*=3/b.devicePixelRatio;g*=3/b.devicePixelRatio;for(a=1;a<f;)a*=2;for(c=1;c<g;)c*=2;f=a;g=c}d=a=!0}if(d||!s||s.width!=f||s.height!=g)stderr("Reallocating render targets."),this.cleanup(),s=new THREE.WebGLRenderTarget(f,g,{minFilter:a?THREE.LinearMipMapLinearFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBFormat,
type:B.useHdrTarget?THREE.FloatType:THREE.UnsignedByteType,stencilBuffer:!1,generateMipmaps:a}),w=new THREE.WebGLRenderTarget(f,g,{minFilter:THREE.NearestFilter,magFilter:THREE.NearestFilter,format:THREE.RGBAFormat,stencilBuffer:!1}),w.shareDepthFrom=s,D=z=r=null,v=[];if(B.antialias||B.sao||B.customPresentPass)if(d||!z||z.width!=f||z.height!=g)z=new THREE.WebGLRenderTarget(f,g,{minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBAFormat,stencilBuffer:!1,depthBuffer:!1});if(B.sao){if(d||
!r||r.width!=f||r.height!=g){r=new THREE.WebGLRenderTarget(f,g,{minFilter:THREE.NearestFilter,magFilter:THREE.NearestFilter,format:THREE.RGBFormat,type:THREE.FloatType,stencilBuffer:!1});r.shareDepthFrom=s;v=[];for(c=0;5>c;c++){var q=new THREE.WebGLRenderTarget(0|f/(2<<c),0|g/(2<<c),{minFilter:THREE.NearestFilter,magFilter:THREE.NearestFilter,format:THREE.RGBAFormat,depthBuffer:!1,stencilBuffer:!1});q.generateMipmaps=!1;v.push(q);k.uniforms["tDepth_mip"+(c+1)].value=q}b.verifyMRTWorks([s,r]);D=z.clone()}!D&&
B.antialias&&B.customPresentPass&&(D=z.clone());A=null;k.uniforms.size.value.set(f,g);k.uniforms.tDepth.value=r;h.uniforms.size.value.set(f,g);h.uniforms.resolution.value.set(l,m)}!B.idbuffer||!d&&A&&A.width==f&&A.height==g||(A=new THREE.WebGLRenderTarget(f,g,{minFilter:THREE.NearestFilter,magFilter:THREE.NearestFilter,format:THREE.RGBFormat,type:THREE.UnsignedByteType,stencilBuffer:!1,generateMipmaps:a}),A.shareDepthFrom=s,b.verifyMRTWorks([s,A]),v=r=null);p.uniforms.resolution.value.set(l,m);n.uniforms.tOverlay.value=
w;n.uniforms.tAO.value=D;n.uniforms.useAO.value=B.sao?1:0;n.uniforms.resolution.value.set(l,m);n.uniforms.tID.value=A}};this.getMaxAnisotropy=function(){return b.getMaxAnisotropy()};this.hasMRT=function(){return!F&&b.supportsMRT()};this.initPostPipeline=function(a,b,d){B.sao=a&&!_isIE11;B.antialias=b&&!_isIE11;if(B.idbuffer=d)B.sao=!1;B.haveTwoSided&&(c.side=THREE.DoubleSide);c.needsUpdate=!0;k.material.needsUpdate=!0;h.material.needsUpdate=!0;m.material.needsUpdate=!0;l.material.needsUpdate=!0;p.material.needsUpdate=
!0;n.material.needsUpdate=!0;g.material.needsUpdate=!0;this.setSize(J,G)};this.setClearColors=function(a,b){g.uniforms.color2.value.copy(a);b?g.uniforms.color1.value.copy(b):g.uniforms.color1.value.set(0,0,0,1)};this.setAOOptions=function(a,b){void 0!==a&&(k.uniforms.radius.value=a);void 0!==b&&(k.uniforms.intensity.value=b);q=!1};this.getAORadius=function(){return k.uniforms.radius.value};this.getAOIntensity=function(){return k.uniforms.intensity.value};this.setExposureBias=function(a){E=a};this.getExposureBias=
function(){return E};this.setTonemapMethod=function(a){N=a;b.gammaInput=0===a?!1:!0};this.getToneMapMethod=function(){return N};this.toggleTwoSided=function(a){B.haveTwoSided!=a&&c&&(c.side=a?THREE.DoubleSide:THREE.FrontSide,c.needsUpdate=!0);B.haveTwoSided=a};this.enter2DMode=function(a){R=B.sao;Y=B.antialias;P&&(S=P.enabled,P.enabled=!1);this.initPostPipeline(!1,!1,!0)};this.exit2DMode=function(){P&&(P.enabled=S);this.initPostPipeline(R,Y,!1)};this.idAtPixel=function(a,c){if(!A)return 0;b.readPixels(A,
0.5*(a+1)*A.width,0.5*(c+1)*A.height,1,1,M);return M[2]<<16|M[1]<<8|M[0]};this.rolloverObjectViewport=function(a,b){var c=this.idAtPixel(a,b);if(0===c||16777215==c)c=0,M[0]=M[1]=M[2]=M[3]=0;n.uniforms.objID.value=c;n.uniforms.objIDv3.value.set(M[0]/255,M[1]/255,M[2]/255)};this.screenCapture=function(){return b.domElement.toDataURL("image/png")};this.setUnitScale=function(a){H=a};this.getUnitScale=function(){return H};this.getBlendPass=function(){return n};this.toggleGroundShadow=function(a){P.enabled=
a;P.reset()}}FXAAShader={uniforms:{tDiffuse:{type:"t",value:null},resolution:{type:"v2",value:new THREE.Vector2(1/1024,1/512)}},vertexShader:"varying vec2 vUv;\nvoid main() {\nvUv = uv;\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D tDiffuse;\nuniform vec2 resolution;\nvarying vec2 vUv;\n#define FXAA_SPAN_MAX     8.0\n#define FXAA_EDGE_THRESHOLD_MIN (1.0/24.0)\n#define FXAA_EDGE_THRESHOLD (1.0/8.0)\n#define FXAA_SEARCH_THRESHOLD (1.0/4.0)\n#define FXAA_SEARCH_STEPS 16\n#define FXAA_SUBPIX_TRIM (1.0/4.0)\n#define FXAA_SUBPIX_TRIM_SCALE (1.0/(1.0 - FXAA_SUBPIX_TRIM))\n#define FXAA_SUBPIX_CAP (3.0/4.0)\nvec4 getColor(sampler2D tex, vec2 uv) {\nvec4 c = texture2D(tex, uv);\nreturn c;\n}\nfloat FxaaLuma(vec3 rgb) {\nreturn rgb.y * (0.587/0.299) + rgb.x; }\nvec4 FxaaFilterReturn(vec4 rgba) {\nreturn rgba;}\nvec3 FxaaLerp3(vec3 a, vec3 b, float amountOfA) {\nreturn (vec3(-amountOfA) * b) +\n((a * vec3(amountOfA)) + b); }\nvec4 FxaaTex(sampler2D tex, vec2 pos) {\nreturn getColor(tex, pos.xy);}\nvec4 FxaaTexOff(sampler2D tex, vec2 pos, vec2 offset, vec2 resolution) {\nvec2 uv = pos.xy + offset * resolution;\nreturn getColor(tex, uv);}\nvoid main() {\nvec3 rgbN = FxaaTexOff( tDiffuse, vUv, vec2(0.0,-1.0), resolution ).xyz;\nvec3 rgbE = FxaaTexOff( tDiffuse, vUv, vec2(1.0, 0.0), resolution ).xyz;\nvec3 rgbW = FxaaTexOff( tDiffuse, vUv, vec2(-1.0,0.0), resolution ).xyz;\nvec3 rgbS = FxaaTexOff( tDiffuse, vUv, vec2(0.0, 1.0), resolution ).xyz;\nvec4 rgbaM = FxaaTex( tDiffuse, vUv);\nvec3 rgbM  = rgbaM.xyz;\nfloat lumaN = FxaaLuma(rgbN);\nfloat lumaE = FxaaLuma(rgbE);\nfloat lumaW = FxaaLuma(rgbW);\nfloat lumaS = FxaaLuma(rgbS);\nfloat lumaM = FxaaLuma(rgbM);\nfloat rangeMin = min(lumaM, min(min(lumaN, lumaW), min(lumaS, lumaE)));\nfloat rangeMax = max(lumaM, max(max(lumaN, lumaW), max(lumaS, lumaE)));\nfloat range = rangeMax - rangeMin;\nif(range < max(FXAA_EDGE_THRESHOLD_MIN, rangeMax * FXAA_EDGE_THRESHOLD)) {\ngl_FragColor = FxaaFilterReturn(rgbaM); return;}\nvec3 rgbL = rgbN + rgbW + rgbM + rgbE + rgbS;\nfloat lumaL = (lumaN + lumaW + lumaE + lumaS) * 0.25;\nfloat rangeL = abs(lumaL - lumaM);\nfloat blendL = max(0.0, (rangeL / range) - FXAA_SUBPIX_TRIM) * FXAA_SUBPIX_TRIM_SCALE;\nblendL = min(FXAA_SUBPIX_CAP, blendL);\nvec3 rgbNW = FxaaTexOff( tDiffuse, vUv, vec2(-1.0,-1.0), resolution ).xyz;\nvec3 rgbNE = FxaaTexOff( tDiffuse, vUv, vec2(1.0,-1.0), resolution ).xyz;\nvec3 rgbSW = FxaaTexOff( tDiffuse, vUv, vec2(-1.0,1.0), resolution ).xyz;\nvec3 rgbSE = FxaaTexOff( tDiffuse, vUv, vec2(1.0,1.0), resolution ).xyz;\nfloat opacity  = rgbaM.w;\nrgbL += (rgbNW + rgbNE + rgbSW + rgbSE);\nrgbL *= vec3(1.0/9.0);\nfloat lumaNW = FxaaLuma( rgbNW);\nfloat lumaNE = FxaaLuma( rgbNE);\nfloat lumaSW = FxaaLuma( rgbSW);\nfloat lumaSE = FxaaLuma( rgbSE);\nfloat edgeVert = abs((0.25 * lumaNW) + (-0.5 * lumaN) + (0.25 * lumaNE)) +\nabs((0.50 * lumaW ) + (-1.0 * lumaM) + (0.50 * lumaE )) +\nabs((0.25 * lumaSW) + (-0.5 * lumaS) + (0.25 * lumaSE));\nfloat edgeHorz = abs((0.25 * lumaNW) + (-0.5 * lumaW) + (0.25 * lumaSW)) +\nabs((0.50 * lumaN ) + (-1.0 * lumaM) + (0.50 * lumaS )) +\nabs((0.25 * lumaNE) + (-0.5 * lumaE) + (0.25 * lumaSE));\nbool horzSpan = edgeHorz >= edgeVert;\nfloat lengthSign = horzSpan ? -resolution.y : -resolution.x;\nif(!horzSpan) lumaN = lumaW;\nif(!horzSpan) lumaS = lumaE;\nfloat gradientN = abs(lumaN - lumaM);\nfloat gradientS = abs(lumaS - lumaM);\nlumaN = (lumaN + lumaM) * 0.5;\nlumaS = (lumaS + lumaM) * 0.5;\nbool pairN = gradientN >= gradientS;\nif(!pairN) lumaN = lumaS;\nif(!pairN) gradientN = gradientS;\nif(!pairN) lengthSign *= -1.0;\nvec2 posN;\nposN.x = vUv.x + (horzSpan ? 0.0 : lengthSign * 0.5);\nposN.y = vUv.y + (horzSpan ? lengthSign * 0.5 : 0.0);\ngradientN *= FXAA_SEARCH_THRESHOLD;\nvec2 posP = posN;\nvec2 offNP = horzSpan ? vec2(resolution.x, 0.0) : vec2(0.0, resolution.y);\nfloat lumaEndN = lumaN;\nfloat lumaEndP = lumaN;\nbool doneN = false;\nbool doneP = false;\nposN += offNP * vec2(-1.0, -1.0);\nposP += offNP * vec2( 1.0,  1.0);\nfor(int i = 0; i < FXAA_SEARCH_STEPS; i++) {\nif(!doneN) lumaEndN = FxaaLuma(FxaaTex( tDiffuse, posN.xy).xyz);\nif(!doneP) lumaEndP = FxaaLuma(FxaaTex( tDiffuse, posP.xy).xyz);\ndoneN = doneN || (abs(lumaEndN - lumaN) >= gradientN);\ndoneP = doneP || (abs(lumaEndP - lumaN) >= gradientN);\nif(doneN && doneP) break;\nif(!doneN) posN -= offNP;\nif(!doneP) posP += offNP; }\nfloat dstN = horzSpan ? vUv.x - posN.x : vUv.y - posN.y;\nfloat dstP = horzSpan ? posP.x - vUv.x : posP.y - vUv.y;\nbool directionN = dstN < dstP;\nlumaEndN = directionN ? lumaEndN : lumaEndP;\nif(((lumaM - lumaN) < 0.0) == ((lumaEndN - lumaN) < 0.0))\nlengthSign = 0.0;\nfloat spanLength = (dstP + dstN);\ndstN = directionN ? dstN : dstP;\nfloat subPixelOffset = (0.5 + (dstN * (-1.0/spanLength))) * lengthSign;\nvec3 rgbF = FxaaTex(tDiffuse, vec2(\nvUv.x + (horzSpan ? 0.0 : subPixelOffset),\nvUv.y + (horzSpan ? subPixelOffset : 0.0))).xyz;\ngl_FragColor = FxaaFilterReturn(vec4(FxaaLerp3(rgbL, rgbF, blendL), opacity));\n}"};
TonemapShaderChunk="float luminance_post(vec3 rgb) {\nreturn dot(rgb, vec3(0.299, 0.587, 0.114));\n}\nfloat luminance_pre(vec3 rgb) {\nreturn dot(rgb, vec3(0.212671, 0.715160, 0.072169));\n}\nconst float Shift = 1.0 / 0.18;\nfloat toneMapCanonFilmic_NoGamma(float x) {\nx *= Shift;\nconst float A = 0.2;\nconst float B = 0.34;\nconst float C = 0.002;\nconst float D = 1.68;\nconst float E = 0.0005;\nconst float F = 0.252;\nconst float scale = 1.0/0.833837;\nreturn (((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F) * scale;\n}\nvec3 toneMapCanonFilmic_WithGamma(vec3 x) {\nx *= Shift;\nconst float A = 0.27;\nconst float B = 0.29;\nconst float C = 0.052;\nconst float D = 0.2;\nconst float F = 0.18;\nconst float scale = 1.0/0.897105;\nreturn (((x*(A*x+C*B))/(x*(A*x+B)+D*F))) * scale;\n}";
PackDepthShaderShunk="vec4 packDepth( const in float depth ) {\nvec4 enc = vec4(1.0, 255.0, 65025.0, 160581375.0) * depth;\nenc = fract(enc);\nenc -= enc.yzww * vec4(1.0/255.0,1.0/255.0,1.0/255.0,0.0);\nreturn enc;\n}\nfloat unpackDepth( const in vec4 rgba_depth ) {\nreturn dot( rgba_depth, vec4(1.0, 1.0/255.0, 1.0/65025.0, 1.0/160581375.0) );\n}";
BlendShader={uniforms:{tDiffuse:{type:"t",value:null},tAO:{type:"t",value:null},useAO:{type:"i",value:0},tOverlay:{type:"t",value:null},useOverlay:{type:"i",value:0},tID:{type:"t",value:null},objID:{type:"i",value:0},objIDv3:{type:"v3",value:new THREE.Vector3(0,0,0)},resolution:{type:"v2",value:new THREE.Vector2(1/1024,1/512)}},defines:{},vertexShader:"varying vec2 vUv;\nvoid main() {\nvUv = uv;\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:["uniform sampler2D tDiffuse;\nuniform sampler2D tAO;\nuniform int useAO;\nuniform sampler2D tOverlay;\nuniform int useOverlay;\nuniform vec2 resolution;\nuniform int objID;\nuniform vec3 objIDv3;\nuniform sampler2D tID;\nvarying vec2 vUv;",
TonemapShaderChunk,"vec4 fetchOverlayTexel(vec2 uv, vec2 offset) {\nreturn texture2D(tOverlay, uv + resolution * offset);\n}\n#define checkOnePixel(i, j) { \t\t\tvec4 c = fetchOverlayTexel(vUv, vec2(i, j));\t\t\tmax_alpha = max(max_alpha, c.a);\t\t\tif (i==0 && j==0)\t\t\t\tcenter = c;\t\t\tif (c.a == 0.0)\t\t\t\thas_zero++;\t\t\telse \t\t\t\tnon_zero_pixel = c;\t\t}\nvec4 overlayEdgeDetect(vec2 vUv) {\nint has_zero = 0;\nvec4 center = vec4(0.0);\nvec4 non_zero_pixel = vec4(0.0);\nfloat max_alpha = 0.0;\ncheckOnePixel(-1,-1);\ncheckOnePixel(0,-1);\ncheckOnePixel(1,-1);\ncheckOnePixel(-1,0);\ncheckOnePixel(0,0);\ncheckOnePixel(1,0);\ncheckOnePixel(-1,1);\ncheckOnePixel(0,1);\ncheckOnePixel(1,1);\nif (has_zero != 0 && has_zero != 9)\n{\nif (center == vec4(0.0))\ncenter = non_zero_pixel;\nfloat maxComponent = max(center.r, max(center.g, center.b));\ncenter.rgb /= maxComponent;\ncenter.rgb = sqrt(center.rgb);\ncenter.a = 0.5 + 0.5 * max_alpha * 0.125 * float(has_zero);\n}\nif (has_zero == 0) {\ncenter.a = -center.a;\n}\nreturn center;\n}\nvec4 sampleColor() {\nreturn texture2D( tDiffuse, vUv );\n}\nfloat sampleAO() {\nreturn (useAO != 0) ? texture2D(tAO, vUv).r : 1.0;\n}\nvoid main() {\nvec4 texel = sampleColor();\nfloat ao = sampleAO();\ntexel.rgb *= ao;\nif (useOverlay!=0) {\nvec4 overlay = overlayEdgeDetect(vUv);\nif (overlay.a < 0.0) {\noverlay.a = -overlay.a;\nif (overlay.a >= 0.99) {\noverlay.a = 0.75;\ntexel.rgb = vec3(luminance_post(texel.rgb));\n}\n}\ntexel.rgb = mix(texel.rgb, sqrt(overlay.rgb)/*sqrt=gamma*/, overlay.a);\n}\nif (objID != 0) {\nvec4 idAtPixel = texture2D(tID, vUv);\nvec3 idDelta = abs(idAtPixel.rgb - objIDv3.rgb);\nif (max(max(idDelta.r, idDelta.g), idDelta.b) < 1e-3) {\ntexel.rgb = mix(texel.rgb, vec3(1.0,1.0,0.0), 0.25);\n}\n}\ngl_FragColor = texel;\n}"].join("\n")};
THREE.ShaderPass=function(a,b){this.textureID=void 0!==b?b:"tDiffuse";this.uniforms=THREE.UniformsUtils.clone(a.uniforms);this.material=new THREE.ShaderMaterial({uniforms:this.uniforms,vertexShader:a.vertexShader,fragmentShader:a.fragmentShader,defines:THREE.UniformsUtils.clone(a.defines)});this.renderToScreen=!1;this.enabled=!0;this.clear=!1;this.camera=new THREE.OrthographicCamera(-1,1,1,-1,0,1);var c=new THREE.BufferGeometry,d=new Float32Array(9);d[0]=-1;d[1]=-1;d[2]=0;d[3]=3;d[4]=-1;d[5]=0;d[6]=
-1;d[7]=3;d[8]=0;var f=new Float32Array(6);f[0]=0;f[1]=0;f[2]=2;f[3]=0;f[4]=0;f[5]=2;c.addAttribute("position",new THREE.BufferAttribute(d,3));c.addAttribute("uv",new THREE.BufferAttribute(f,2));this.quad=new THREE.Mesh(c,this.material);this.scene=new THREE.Scene;this.scene.add(this.quad)};
THREE.ShaderPass.prototype={render:function(a,b,c,d){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=c);this.renderToScreen||!b?a.render(this.scene,this.camera):a.render(this.scene,this.camera,b,this.clear)}};
SAOShader={uniforms:{tDepth:{type:"t",value:null},size:{type:"v2",value:new THREE.Vector2(512,512)},cameraNear:{type:"f",value:1},cameraFar:{type:"f",value:100},radius:{type:"f",value:10},bias:{type:"f",value:0.01},projScale:{type:"f",value:500},projInfo:{type:"v4",value:new THREE.Vector4(0,0,0,0)},intensity:{type:"f",value:0.5},isOrtho:{type:"f",value:1},tDepth_mip1:{type:"t",value:null},tDepth_mip2:{type:"t",value:null},tDepth_mip3:{type:"t",value:null},tDepth_mip4:{type:"t",value:null},tDepth_mip5:{type:"t",
value:null}},vertexShader:"varying vec2 vUv;\nvoid main() {\nvUv = uv;\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:["#extension GL_OES_standard_derivatives : enable\n#define USE_MIPMAP 1\nuniform float cameraNear;\nuniform float cameraFar;\nuniform vec2 size;\nuniform float lumInfluence;\nvarying vec2 vUv;\n#define NUM_SAMPLES (17)\n#define LOG_MAX_OFFSET (3)\n#define MAX_MIP_LEVEL (5)\n#define NUM_SPIRAL_TURNS (7)\nuniform float           projScale;\nuniform sampler2D tDepth;\n#ifdef USE_MIPMAP\nuniform sampler2D tDepth_mip1;\nuniform sampler2D tDepth_mip2;\nuniform sampler2D tDepth_mip3;\nuniform sampler2D tDepth_mip4;\nuniform sampler2D tDepth_mip5;\n#endif\nuniform float radius;\nuniform float bias;\nuniform float intensity;\nuniform float isOrtho;\nfloat intensityDivR6 = intensity / pow(radius, 6.0);\nvec2 tapLocation(int sampleNumber, float spinAngle, out float ssR){\nfloat alpha = float(float(sampleNumber) + 0.5) * (1.0 / float(NUM_SAMPLES));\nfloat angle = alpha * (float(NUM_SPIRAL_TURNS) * 6.28) + spinAngle;\nssR = alpha;\nreturn vec2(cos(angle), sin(angle));\n}\nfloat CSZToKey(float z) {\nreturn clamp(z * (1.0 / -cameraFar), 0.0, 1.0);\n}\nvoid packKey(float key, out vec2 p) {\nfloat temp = floor(key * 256.0);\np.x = temp * (1.0 / 256.0);\np.y = key * 256.0 - temp;\n}",
PackDepthShaderShunk,"float unpackDepthNearFar( const in vec4 rgba_depth ) {\nfloat depth = unpackDepth( rgba_depth );\nif (depth == 0.0)\nreturn -cameraFar * 1.0e10;\nreturn depth * (cameraNear - cameraFar) - cameraNear;\n}\nuniform vec4 projInfo;\nvec3 reconstructCSPosition(vec2 S, float z) {\nreturn vec3((S.xy * projInfo.xy + projInfo.zw) * mix(z, -1.0, isOrtho), z);\n}\nvec3 reconstructCSFaceNormal(vec3 C) {\nreturn normalize(cross(dFdy(C), dFdx(C)));\n}\nvec3 reconstructNonUnitCSFaceNormal(vec3 C) {\nreturn cross(dFdy(C), dFdx(C));\n}\nvec2 sizeM1 = vec2(1.0/(size.x), 1.0/(size.y));\nvec3 getPosition(ivec2 ssP, float depth) {\nvec3 P;\nP = reconstructCSPosition(vec2(ssP) + vec2(0.5), depth);\nreturn P;\n}\nvec3 getOffsetPosition(ivec2 ssC, vec2 unitOffset, float ssR) {\nivec2 ssP = ivec2(ssR * unitOffset) + ssC;\nvec3 P;\nvec2 screenUV = (vec2(ssP) + vec2(0.5)) * sizeM1;\n#ifdef USE_MIPMAP\nint mipLevel = int(max(0.0, min(floor(log2(ssR)) - float(LOG_MAX_OFFSET), float(MAX_MIP_LEVEL))));\nif (mipLevel == 0) {\nP.z = texture2D(tDepth, screenUV).z;\nif (P.z == 0.0) P.z = -cameraFar * 1.0e10;\n}\nelse if (mipLevel == 1)\nP.z = unpackDepthNearFar(texture2D(tDepth_mip1, screenUV));\nelse if (mipLevel == 2)\nP.z = unpackDepthNearFar(texture2D(tDepth_mip2, screenUV));\nelse if (mipLevel == 3)\nP.z = unpackDepthNearFar(texture2D(tDepth_mip3, screenUV));\nelse if (mipLevel == 4)\nP.z = unpackDepthNearFar(texture2D(tDepth_mip4, screenUV));\nelse if (mipLevel == 5)\nP.z = unpackDepthNearFar(texture2D(tDepth_mip5, screenUV));\n#else\nP.z = texture2D(tDepth, screenUV).z;\nif (P.z == 0.0) P.z = -cameraFar * 1.0e10;\n#endif\nP = reconstructCSPosition(vec2(ssP) + vec2(0.5), P.z);\nreturn P;\n}\nfloat radius2 = radius * radius;\nfloat invRadius2 = 1.0 / radius2;\nfloat sampleAO(in ivec2 ssC, in vec3 C, in vec3 n_C, in float ssDiskRadius, in int tapIndex, in float randomPatternRotationAngle) {\nfloat ssR;\nvec2 unitOffset = tapLocation(tapIndex, randomPatternRotationAngle, ssR);\nssR *= ssDiskRadius;\nvec3 Q = getOffsetPosition(ssC, unitOffset, ssR);\nvec3 v = Q - C;\nfloat vv = dot(v, v);\nfloat vn = dot(v, n_C);\nconst float epsilon = 0.01;\nfloat f = max(radius2 - vv, 0.0); return f * f * f * max((vn - bias) / (epsilon + vv), 0.0);\n}\nconst bool useNoise = true;\nvec2 rand( const vec2 coord ) {\nvec2 noise;\nif ( useNoise ) {\nfloat nx = dot ( coord, vec2( 12.9898, 78.233 ) );\nfloat ny = dot ( coord, vec2( 12.9898, 78.233 ) * 2.0 );\nnoise = clamp( fract ( 43758.5453 * sin( vec2( nx, ny ) ) ), 0.0, 1.0 );\n} else {\nfloat ff = fract( 1.0 - coord.s * ( size.x / 2.0 ) );\nfloat gg = fract( coord.t * ( size.y / 2.0 ) );\nnoise = vec2( 0.25, 0.75 ) * vec2( ff ) + vec2( 0.75, 0.25 ) * gg;\n}\nreturn ( noise * 2.0  - 1.0 );\n}\nfloat getRandomAngle(vec2 pos) {\nvec2 rnd = rand(pos);\nreturn atan(rnd.y, rnd.x);\n}\nvoid main() {\nivec2 ssC = ivec2(gl_FragCoord.xy);\nvec4 nrmz = texture2D(tDepth, vUv);\nif (nrmz.z == 0.0) {\ngl_FragColor.r = 1.0;\ngl_FragColor.a = 0.0;\npackKey(1.0, gl_FragColor.gb);\nreturn;\n}\nvec3 C = getPosition(ssC, nrmz.z);\npackKey(CSZToKey(C.z), gl_FragColor.gb);\nfloat randomPatternRotationAngle = getRandomAngle(vUv);\nvec3 n_C = vec3(nrmz.x, nrmz.y, sqrt(1.0 - dot(nrmz.xy, nrmz.xy)));\nfloat ssDiskRadius = -projScale * radius / mix(C.z, -1.0, isOrtho);\nfloat sum = 0.0;\nsum += sampleAO(ssC, C, n_C, ssDiskRadius, 0, randomPatternRotationAngle);\nsum += sampleAO(ssC, C, n_C, ssDiskRadius, 1, randomPatternRotationAngle);\nsum += sampleAO(ssC, C, n_C, ssDiskRadius, 2, randomPatternRotationAngle);\nsum += sampleAO(ssC, C, n_C, ssDiskRadius, 3, randomPatternRotationAngle);\nsum += sampleAO(ssC, C, n_C, ssDiskRadius, 4, randomPatternRotationAngle);\nsum += sampleAO(ssC, C, n_C, ssDiskRadius, 5, randomPatternRotationAngle);\nsum += sampleAO(ssC, C, n_C, ssDiskRadius, 6, randomPatternRotationAngle);\nsum += sampleAO(ssC, C, n_C, ssDiskRadius, 7, randomPatternRotationAngle);\nsum += sampleAO(ssC, C, n_C, ssDiskRadius, 8, randomPatternRotationAngle);\nsum += sampleAO(ssC, C, n_C, ssDiskRadius, 9, randomPatternRotationAngle);\nsum += sampleAO(ssC, C, n_C, ssDiskRadius, 10, randomPatternRotationAngle);\nsum += sampleAO(ssC, C, n_C, ssDiskRadius, 11, randomPatternRotationAngle);\nsum += sampleAO(ssC, C, n_C, ssDiskRadius, 12, randomPatternRotationAngle);\nsum += sampleAO(ssC, C, n_C, ssDiskRadius, 13, randomPatternRotationAngle);\nsum += sampleAO(ssC, C, n_C, ssDiskRadius, 14, randomPatternRotationAngle);\nsum += sampleAO(ssC, C, n_C, ssDiskRadius, 15, randomPatternRotationAngle);\nsum += sampleAO(ssC, C, n_C, ssDiskRadius, 16, randomPatternRotationAngle);\nfloat A = max(0.0, 1.0 - sum * intensityDivR6 * (5.0 / float(NUM_SAMPLES)));\nif (abs(dFdx(C.z)) < 0.02) {\nA -= dFdx(A) * (mod(float(ssC.x), 2.0) - 0.5);\n}\nif (abs(dFdy(C.z)) < 0.02) {\nA -= dFdy(A) * (mod(float(ssC.y), 2.0) - 0.5);\n}\ngl_FragColor.r = A;\ngl_FragColor.a = 1.0;\n}"].join("\n")};
SAOBlurShader={uniforms:{tDiffuse:{type:"t",value:null},size:{type:"v2",value:new THREE.Vector2(512,512)},resolution:{type:"v2",value:new THREE.Vector2(1/512,1/512)},axis:{type:"v2",value:new THREE.Vector2(1,0)}},vertexShader:"varying vec2 vUv;\nvoid main() {\nvUv = uv;\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"#define EDGE_SHARPNESS     (1.0)\n#define SCALE               (2)\n#define R                   (4)\n#define VALUE_TYPE        float\n#define VALUE_COMPONENTS   r\n#define VALUE_IS_KEY       0\n#define KEY_COMPONENTS     gb\n#if __VERSION__ >= 330\nconst float gaussian[R + 1] =\nfloat[](0.153170, 0.144893, 0.122649, 0.092902, 0.062970);  // stddev = 2.0\n#endif\nuniform sampler2D   tDiffuse;\nuniform vec2 size;\nuniform vec2 resolution;\nuniform vec2       axis;\nivec2 axisi = ivec2(axis);\n#define  result         gl_FragColor.VALUE_COMPONENTS\n#define  keyPassThrough gl_FragColor.KEY_COMPONENTS\nfloat unpackKey(vec2 p) {\nreturn p.x * (256.0 / 257.0) + p.y * (1.0 / 257.0);\n}\nvarying vec2 vUv;\nvoid main() {\n#   if __VERSION__ < 330\nfloat gaussian[R + 1];\n#       if R == 3\ngaussian[0] = 0.153170; gaussian[1] = 0.144893; gaussian[2] = 0.122649; gaussian[3] = 0.092902;  // stddev = 2.0\n#       elif R == 4\ngaussian[0] = 0.153170; gaussian[1] = 0.144893; gaussian[2] = 0.122649; gaussian[3] = 0.092902; gaussian[4] = 0.062970;  // stddev = 2.0\n#       elif R == 6\ngaussian[0] = 0.111220; gaussian[1] = 0.107798; gaussian[2] = 0.098151; gaussian[3] = 0.083953; gaussian[4] = 0.067458; gaussian[5] = 0.050920; gaussian[6] = 0.036108;\n#       endif\n#   endif\nivec2 ssC = ivec2(gl_FragCoord.xy);\nvec4 temp = texture2D(tDiffuse, vUv);\ngl_FragColor.gb = temp.KEY_COMPONENTS;\ngl_FragColor.a = temp.a;\nVALUE_TYPE sum = temp.VALUE_COMPONENTS;\nif (temp.a == 0.0) {\nresult = sum;\nreturn;\n}\nfloat key = unpackKey(keyPassThrough);\nfloat BASE = gaussian[0];\nfloat totalWeight = BASE;\nsum *= totalWeight;\nint r = -4; {\nvec2 ssUV = vec2(ssC + axisi * (r * SCALE))*resolution;\ntemp = texture2D(tDiffuse, ssUV);\nfloat      tapKey = unpackKey(temp.KEY_COMPONENTS);\nVALUE_TYPE value  = temp.VALUE_COMPONENTS;\nfloat weight = 0.3 + gaussian[4];\nfloat dz = tapKey - key;\nweight *= max(0.0, 1.0 - (EDGE_SHARPNESS * 2000.0) * abs(dz));\nsum += value * weight;\ntotalWeight += weight;\n}\nr = -3; {\nvec2 ssUV = vec2(ssC + axisi * (r * SCALE))*resolution;\ntemp = texture2D(tDiffuse, ssUV);\nfloat      tapKey = unpackKey(temp.KEY_COMPONENTS);\nVALUE_TYPE value  = temp.VALUE_COMPONENTS;\nfloat weight = 0.3 + gaussian[3];\nfloat dz = tapKey - key;\nweight *= max(0.0, 1.0 - (EDGE_SHARPNESS * 2000.0) * abs(dz));\nsum += value * weight;\ntotalWeight += weight;\n}\nr = -2; {\nvec2 ssUV = vec2(ssC + axisi * (r * SCALE))*resolution;\ntemp = texture2D(tDiffuse, ssUV);\nfloat      tapKey = unpackKey(temp.KEY_COMPONENTS);\nVALUE_TYPE value  = temp.VALUE_COMPONENTS;\nfloat weight = 0.3 + gaussian[2];\nfloat dz = tapKey - key;\nweight *= max(0.0, 1.0 - (EDGE_SHARPNESS * 2000.0) * abs(dz));\nsum += value * weight;\ntotalWeight += weight;\n}\nr=-1; {\nvec2 ssUV = vec2(ssC + axisi * (r * SCALE))*resolution;\ntemp = texture2D(tDiffuse, ssUV);\nfloat      tapKey = unpackKey(temp.KEY_COMPONENTS);\nVALUE_TYPE value  = temp.VALUE_COMPONENTS;\nfloat weight = 0.3 + gaussian[1];\nfloat dz = tapKey - key;\nweight *= max(0.0, 1.0 - (EDGE_SHARPNESS * 2000.0) * abs(dz));\nsum += value * weight;\ntotalWeight += weight;\n}\nr = 1; {\nvec2 ssUV = vec2(ssC + axisi * (r * SCALE))*resolution;\ntemp = texture2D(tDiffuse, ssUV);\nfloat      tapKey = unpackKey(temp.KEY_COMPONENTS);\nVALUE_TYPE value  = temp.VALUE_COMPONENTS;\nfloat weight = 0.3 + gaussian[1];\nfloat dz = tapKey - key;\nweight *= max(0.0, 1.0 - (EDGE_SHARPNESS * 2000.0) * abs(dz));\nsum += value * weight;\ntotalWeight += weight;\n}\nr = 2; {\nvec2 ssUV = vec2(ssC + axisi * (r * SCALE))*resolution;\ntemp = texture2D(tDiffuse, ssUV);\nfloat      tapKey = unpackKey(temp.KEY_COMPONENTS);\nVALUE_TYPE value  = temp.VALUE_COMPONENTS;\nfloat weight = 0.3 + gaussian[2];\nfloat dz = tapKey - key;\nweight *= max(0.0, 1.0 - (EDGE_SHARPNESS * 2000.0) * abs(dz));\nsum += value * weight;\ntotalWeight += weight;\n}\nr = 3; {\nvec2 ssUV = vec2(ssC + axisi * (r * SCALE))*resolution;\ntemp = texture2D(tDiffuse, ssUV);\nfloat      tapKey = unpackKey(temp.KEY_COMPONENTS);\nVALUE_TYPE value  = temp.VALUE_COMPONENTS;\nfloat weight = 0.3 + gaussian[3];\nfloat dz = tapKey - key;\nweight *= max(0.0, 1.0 - (EDGE_SHARPNESS * 2000.0) * abs(dz));\nsum += value * weight;\ntotalWeight += weight;\n}\nr = 4; {\nvec2 ssUV = vec2(ssC + axisi * (r * SCALE))*resolution;\ntemp = texture2D(tDiffuse, ssUV);\nfloat      tapKey = unpackKey(temp.KEY_COMPONENTS);\nVALUE_TYPE value  = temp.VALUE_COMPONENTS;\nfloat weight = 0.3 + gaussian[4];\nfloat dz = tapKey - key;\nweight *= max(0.0, 1.0 - (EDGE_SHARPNESS * 2000.0) * abs(dz));\nsum += value * weight;\ntotalWeight += weight;\n}\nconst float epsilon = 0.0001;\nresult = sum / (totalWeight + epsilon);\n}"};
SAOMinifyFirstShader={uniforms:{tDiffuse:{type:"t",value:null},cameraNear:{type:"f",value:1},cameraInvNearFar:{type:"f",value:100},resolution:{type:"v2",value:new THREE.Vector2(1/512,1/512)}},vertexShader:"void main() {\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:["uniform sampler2D tDiffuse;\nuniform vec2 resolution;\nuniform float cameraNear;\nuniform float cameraInvNearFar;",PackDepthShaderShunk,"void main() {\nvec2 ssP = vec2(gl_FragCoord.xy);\nssP = ssP * 2.0 + mod(ssP, 2.0);\nssP = (ssP + 0.5) * resolution * 0.5;\nfloat depth = texture2D(tDiffuse, ssP).z;\nif (depth != 0.0)\ndepth = (depth + cameraNear) * cameraInvNearFar;\ngl_FragColor = packDepth(depth);\n}"].join("\n")};
SAOMinifyShader={uniforms:{tDiffuse:{type:"t",value:null},resolution:{type:"v2",value:new THREE.Vector2(1/512,1/512)}},vertexShader:"void main() {\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D tDiffuse;\nuniform vec2 resolution;\nvoid main() {\nvec2 ssP = vec2(gl_FragCoord.xy);\nssP = ssP * 2.0 + mod(ssP, 2.0);\nssP = (ssP + 0.5) * resolution * 0.5;\ngl_FragColor = texture2D(tDiffuse, ssP);\n}"};
FireflyPhongShader={uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.bump,THREE.UniformsLib.normalmap,THREE.UniformsLib.lights,{ambient:{type:"c",value:new THREE.Color(16777215)},emissive:{type:"c",value:new THREE.Color(0)},specular:{type:"c",value:new THREE.Color(1118481)},shininess:{type:"f",value:30},wrapRGB:{type:"v3",value:new THREE.Vector3(1,1,1)},offsetRepeatBump:{type:"v4",value:new THREE.Vector4(0,0,1,1)},offsetRepeatAlpha:{type:"v4",value:new THREE.Vector4(0,
0,1,1)},irradianceMap:{type:"t",value:null},exposureBias:{type:"f",value:1},cutplanes:{type:"v4v",value:[]}}]),vertexShader:"varying vec3 vViewPosition;\nvarying vec3 vNormal;\n#if defined( USE_MAP ) || defined( USE_SPECULARMAP )\nvarying vec2 vUv;\nuniform vec4 offsetRepeat;\n#endif\n#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\nvarying vec2 vUvBump;\nuniform vec4 offsetRepeatBump;\n#endif\n#if defined( USE_ALPHAMAP ) || defined( USE_ALPHAMAP )\nvarying vec2 vUvAlpha;\nuniform vec4 offsetRepeatAlpha;\n#endif\n#if defined( USE_ENVMAP )\n#if ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP )\nuniform float refractionRatio;\nuniform bool useRefract;\n#endif\n#endif\n#if MAX_SPOT_LIGHTS > 0 || NUM_CUTPLANES > 0\nvarying vec3 vWorldPosition;\n#endif\n#ifdef USE_COLOR\nvarying vec3 vColor;\n#endif\n#ifdef USE_LOGDEPTHBUF\n#ifdef USE_LOGDEPTHBUF_EXT\nvarying float vFragDepth;\n#endif\nuniform float logDepthBufFC;\n#endif\n#ifdef MRT_NORMALS\nvarying float depth;\n#endif\nvoid main() {\n#if defined( USE_MAP ) || defined( USE_SPECULARMAP )\nvUv = uv * offsetRepeat.zw + offsetRepeat.xy;\n#endif\n#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\nvUvBump = uv * offsetRepeatBump.zw + offsetRepeatBump.xy;\n#endif\n#if defined( USE_ALPHAMAP )\nvUvAlpha = uv * offsetRepeatAlpha.zw + offsetRepeatAlpha.xy;\n#endif\n#ifdef USE_COLOR\n#ifdef GAMMA_INPUT\nvColor = color * color;\n#else\nvColor = color;\n#endif\n#endif\nvec3 objectNormal = normal;\n#ifdef FLIP_SIDED\nobjectNormal = -objectNormal;\n#endif\nvec3 transformedNormal = normalMatrix * objectNormal;\nvNormal = normalize( transformedNormal );\nvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\ngl_Position = projectionMatrix * mvPosition;\nvViewPosition = -mvPosition.xyz;\n#if MAX_SPOT_LIGHTS > 0 || NUM_CUTPLANES > 0\nvec4 worldPosition = modelMatrix * vec4( position, 1.0 );\nvWorldPosition = worldPosition.xyz;\n#endif\n#ifdef USE_LOGDEPTHBUF\nif (projectionMatrix[3][3] == 0.0) {\ngl_Position.z = log2(max(1.0e-6, gl_Position.w + 1.0)) * logDepthBufFC;\n#ifdef USE_LOGDEPTHBUF_EXT\nvFragDepth = 1.0 + gl_Position.w;\n#else\ngl_Position.z = (gl_Position.z - 1.0) * gl_Position.w;\n#endif\n} else {\n#ifdef USE_LOGDEPTHBUF_EXT\nvFragDepth = 1.0 + vViewPosition.z;\n#else\n#endif\n}\n#endif\n#ifdef MRT_NORMALS\ndepth = mvPosition.z;\n#endif\n}",
fragmentShader:["uniform vec3 diffuse;\nuniform float opacity;\nuniform vec3 ambient;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\n#ifdef USE_COLOR\nvarying vec3 vColor;\n#endif\n#if defined( USE_MAP ) || defined( USE_SPECULARMAP )\nvarying vec2 vUv;\n#endif\n#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\nvarying vec2 vUvBump;\n#endif\n#if defined( USE_ALPHAMAP )\nvarying vec2 vUvAlpha;\n#endif\n#ifdef USE_MAP\nuniform sampler2D map;\n#endif\nconst mat3 InverseM = mat3(\n6.0014, -2.7008, -1.7996,\n-1.3320,  3.1029, -5.7721,\n0.3008, -1.0882,  5.6268);\nvec3 LogLuvDecode(in vec4 vLogLuv) {\nfloat Le = vLogLuv.b * 255.0 + vLogLuv.a;\nvec3 Xp_Y_XYZp;\nXp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);\nXp_Y_XYZp.z = Xp_Y_XYZp.y / vLogLuv.g;\nXp_Y_XYZp.x = vLogLuv.r * Xp_Y_XYZp.z;\nvec3 vRGB = InverseM * Xp_Y_XYZp;\nreturn max(vRGB, vec3(0.0));\n}\n#ifdef USE_ENVMAP\nuniform float reflectivity;\nuniform samplerCube envMap;\nuniform float flipEnvMap;\nuniform int combine;\n#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\nuniform bool useRefract;\nuniform float refractionRatio;\n#endif\n#endif\nuniform vec3 ambientLightColor;\n#if MAX_DIR_LIGHTS > 0\nuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\nuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n#endif\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\nuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n#endif\n#if MAX_SPOT_LIGHTS > 0\nuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\nuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\nuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\nuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\n#endif\n#ifdef USE_IRRADIANCEMAP\nuniform samplerCube irradianceMap;\n#endif\n#if MAX_SPOT_LIGHTS > 0 || NUM_CUTPLANES > 0\nvarying vec3 vWorldPosition;\n#endif\n#ifdef WRAP_AROUND\nuniform vec3 wrapRGB;\n#endif\nvarying vec3 vViewPosition;\nvarying vec3 vNormal;\n#ifdef USE_BUMPMAP\nuniform sampler2D bumpMap;\nuniform float bumpScale;\nvec2 dHdxy_fwd() {\nvec2 dSTdx = dFdx( vUvBump );\nvec2 dSTdy = dFdy( vUvBump );\nfloat Hll = bumpScale * texture2D( bumpMap, vUvBump ).x;\nfloat dBx = bumpScale * texture2D( bumpMap, vUvBump + dSTdx ).x - Hll;\nfloat dBy = bumpScale * texture2D( bumpMap, vUvBump + dSTdy ).x - Hll;\nreturn vec2( dBx, dBy );\n}\nvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\nvec3 vSigmaX = dFdx( surf_pos );\nvec3 vSigmaY = dFdy( surf_pos );\nvec3 vN = surf_norm;\nvec3 R1 = cross( vSigmaY, vN );\nvec3 R2 = cross( vN, vSigmaX );\nfloat fDet = dot( vSigmaX, R1 );\nvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\nreturn normalize( abs( fDet ) * surf_norm - vGrad );\n}\n#endif\n#ifdef USE_NORMALMAP\nuniform sampler2D normalMap;\nuniform vec2 normalScale;\nvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\nvec3 q0 = dFdx( eye_pos.xyz );\nvec3 q1 = dFdy( eye_pos.xyz );\nvec2 st0 = dFdx( vUvBump.st );\nvec2 st1 = dFdy( vUvBump.st );\nvec3 S = normalize(  q0 * st1.t - q1 * st0.t );\nvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\nvec3 N = normalize( surf_norm );\nvec3 mapN = texture2D( normalMap, vUvBump ).xyz * 2.0 - 1.0;\nmapN.xy = normalScale * mapN.xy;\nmat3 tsn = mat3( S, T, N );\nreturn normalize( tsn * mapN );\n}\n#endif\n#ifdef USE_SPECULARMAP\nuniform sampler2D specularMap;\n#endif\n#ifdef USE_ALPHAMAP\nuniform sampler2D alphaMap;\n#endif\n#ifdef MRT_NORMALS",
"undefined"!==typeof _isIE11&&_isIE11?"":"#extension GL_EXT_draw_buffers : require","varying float depth;\n#define gl_FragColor gl_FragData[0]\n#endif\n#ifdef HAVE_TEXTURE_LOD\n#extension GL_EXT_shader_texture_lod : enable\n#endif\n#ifdef TONEMAP_OUTPUT\nuniform float exposureBias;",TonemapShaderChunk,"#endif\n#ifdef USE_LOGDEPTHBUF\nuniform float logDepthBufFC;\n#ifdef USE_LOGDEPTHBUF_EXT\n#extension GL_EXT_frag_depth : enable\nvarying float vFragDepth;\n#endif\n#endif\n#if NUM_CUTPLANES > 0\nuniform vec4 cutplanes[NUM_CUTPLANES];\n#endif\nvoid main() {\n#if NUM_CUTPLANES > 0\n#define CUTPLANES_OUTLINE_COLOR vec3(0.0, 1.0, 0.0)\n#define CUTPLANES_OUTLINE_THICKNESS 0.001\nfloat outlineThickness = CUTPLANES_OUTLINE_THICKNESS * vViewPosition.z;\nbool isCut = false;\nbool isCutEdge = false;\nfor (int i=0; i<NUM_CUTPLANES; i++) {\nfloat dotPlane = dot(vec4(vWorldPosition, 1.0), cutplanes[i]);\nisCut = isCut || (dotPlane < 0.0);\nisCutEdge = isCutEdge || (dotPlane < outlineThickness);\n}\nif (isCut) {\ndiscard;\n}\nelse if (isCutEdge) {\ngl_FragColor = vec4(CUTPLANES_OUTLINE_COLOR, 1.0);\nreturn;\n}\n#endif\ngl_FragColor = vec4( vec3 ( 1.0 ), opacity );\n#ifdef USE_MAP\nvec4 texelColor = texture2D( map, vUv );\n#ifdef GAMMA_INPUT\ntexelColor.xyz *= texelColor.xyz;\n#endif\ngl_FragColor = gl_FragColor * texelColor;\n#endif\n#ifdef USE_ALPHAMAP\nvec4 texelAlpha = texture2D( alphaMap, vUvAlpha );\ngl_FragColor.a *= texelAlpha.r;\n#endif\n#ifdef ALPHATEST\nif ( gl_FragColor.a < ALPHATEST ) discard;\n#endif\nfloat specularStrength;\n#ifdef USE_SPECULARMAP\nvec4 texelSpecular = texture2D( specularMap, vUv );\nspecularStrength = texelSpecular.r;\n#else\nspecularStrength = 1.0;\n#endif\nvec3 normal = normalize( vNormal );\nvec3 geomNormal = normal;\nvec3 viewPosition = normalize( vViewPosition );\n#ifdef DOUBLE_SIDED\nnormal = normal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );\n#endif\n#ifdef USE_NORMALMAP\nnormal = perturbNormal2Arb( -vViewPosition, normal );\n#elif defined( USE_BUMPMAP )\nnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif\nvec3 totalDiffuse = vec3( 0.0 );\nvec3 totalSpecular = vec3( 0.0 );\n#if MAX_POINT_LIGHTS > 0\nvec3 pointDiffuse  = vec3( 0.0 );\nvec3 pointSpecular = vec3( 0.0 );\nfor ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz + vViewPosition.xyz;\nfloat lDistance = 1.0;\nif ( pointLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\nlVector = normalize( lVector );\nfloat dotProduct = dot( normal, lVector );\n#ifdef WRAP_AROUND\nfloat pointDiffuseWeightFull = max( dotProduct, 0.0 );\nfloat pointDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\nvec3 pointDiffuseWeight = mix( vec3 ( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );\n#else\nfloat pointDiffuseWeight = max( dotProduct, 0.0 );\n#endif\npointDiffuse  += diffuse * pointLightColor[ i ] * pointDiffuseWeight * lDistance;\nvec3 pointHalfVector = normalize( lVector + viewPosition );\nfloat pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );\nfloat pointSpecularWeight = specularStrength * max( pow( pointDotNormalHalf, shininess ), 0.0 );\nfloat specularNormalization = shininess * 0.125 + 0.25;\nvec3 schlick = specular + vec3( 1.0 - specular ) * pow( max(1.0 - dot( lVector, pointHalfVector ), 0.0), 5.0 );\npointSpecular += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * lDistance * specularNormalization ;\n}\ntotalDiffuse += pointDiffuse;\ntotalSpecular += pointSpecular;\n#endif\n#if MAX_SPOT_LIGHTS > 0\nvec3 spotDiffuse  = vec3( 0.0 );\nvec3 spotSpecular = vec3( 0.0 );\nfor ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz + vViewPosition.xyz;\nfloat lDistance = 1.0;\nif ( spotLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );\nlVector = normalize( lVector );\nfloat spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );\nif ( spotEffect > spotLightAngleCos[ i ] ) {\nspotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );\nfloat dotProduct = dot( normal, lVector );\n#ifdef WRAP_AROUND\nfloat spotDiffuseWeightFull = max( dotProduct, 0.0 );\nfloat spotDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\nvec3 spotDiffuseWeight = mix( vec3 ( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );\n#else\nfloat spotDiffuseWeight = max( dotProduct, 0.0 );\n#endif\nspotDiffuse += diffuse * spotLightColor[ i ] * spotDiffuseWeight * lDistance * spotEffect;\nvec3 spotHalfVector = normalize( lVector + viewPosition );\nfloat spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );\nfloat spotSpecularWeight = specularStrength * max( pow( spotDotNormalHalf, shininess ), 0.0 );\nfloat specularNormalization = shininess * 0.125 + 0.25;\nvec3 schlick = specular + vec3( 1.0 - specular ) * pow( max(1.0 - dot( lVector, spotHalfVector ), 0.0), 5.0 );\nspotSpecular += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * lDistance * specularNormalization * spotEffect;\n}\n}\ntotalDiffuse += spotDiffuse;\ntotalSpecular += spotSpecular;\n#endif\n#if MAX_DIR_LIGHTS > 0\nvec3 dirDiffuse  = vec3( 0.0 );\nvec3 dirSpecular = vec3( 0.0 );\nfor( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\nvec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );\nvec3 dirVector = normalize( lDirection.xyz );\nfloat dotProduct = dot( normal, dirVector );\n#ifdef WRAP_AROUND\nfloat dirDiffuseWeightFull = max( dotProduct, 0.0 );\nfloat dirDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\nvec3 dirDiffuseWeight = mix( vec3( dirDiffuseWeightFull ), vec3( dirDiffuseWeightHalf ), wrapRGB );\n#else\nfloat dirDiffuseWeight = max( dotProduct, 0.0 );\n#endif\ndirDiffuse  += diffuse * directionalLightColor[ i ] * dirDiffuseWeight;\nvec3 dirHalfVector = normalize( dirVector + viewPosition );\nfloat dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );\nfloat dirSpecularWeight = specularStrength * max( pow( dirDotNormalHalf, shininess ), 0.0 );\nfloat specularNormalization = shininess * 0.125 + 0.25;\nvec3 schlick = specular + vec3( 1.0 - specular ) * pow( max(1.0 - dot( dirVector, dirHalfVector ), 0.0), 5.0 );\ndirSpecular += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;\n}\ntotalDiffuse += dirDiffuse;\ntotalSpecular += dirSpecular;\n#endif\n#ifdef USE_IRRADIANCEMAP\nvec3 worldNormal = mat3( viewMatrixInverse[ 0 ].xyz, viewMatrixInverse[ 1 ].xyz, viewMatrixInverse[ 2 ].xyz ) * normal;\nvec4 cubeColor4 = textureCube(irradianceMap, worldNormal);\n#ifdef IRR_LOGLUV\nvec3 indirectDiffuse = LogLuvDecode(cubeColor4);\n#else\nvec3 indirectDiffuse = cubeColor.xyz;\n#ifdef GAMMA_INPUT\nindirectDiffuse.xyz *= indirectDiffuse.xyz;\n#endif\n#endif\ntotalDiffuse += diffuse * indirectDiffuse;\n#endif\n#ifdef METAL\ngl_FragColor.xyz = gl_FragColor.xyz * ( emissive + totalDiffuse + ambientLightColor * ambient + totalSpecular );\n#else\ngl_FragColor.xyz = gl_FragColor.xyz * ( emissive + totalDiffuse + ambientLightColor * ambient ) + totalSpecular;\n#endif\n#ifdef USE_COLOR\ngl_FragColor = gl_FragColor * vec4( vColor, 1.0 );\n#endif\n#if defined(USE_ENVMAP)\nvec3 reflectVec;\n#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\nvec3 cameraToVertex = normalize( -vViewPosition );\nif ( useRefract ) {\nreflectVec = refract( cameraToVertex, normal, refractionRatio );\n} else { \nreflectVec = reflect( cameraToVertex, normal );\n}\n#else\nvec3 cameraToVertex = normalize( -vViewPosition );\nreflectVec = reflect( cameraToVertex, vNormal );\n#endif\nfloat reflectScale = 1.0 - clamp(-reflectVec.y, 0.0, 1.0);\nreflectVec = mat3( viewMatrixInverse[ 0 ].xyz, viewMatrixInverse[ 1 ].xyz, viewMatrixInverse[ 2 ].xyz ) * reflectVec;\nfloat logShiny = log(max(1.0+1e-10, shininess));\n#ifdef ENV_LOGLUV\nfloat MipmapIndex = max(0.0, -0.72134752 * logShiny + 5.5);\n#ifdef HAVE_TEXTURE_LOD\nvec4 envTexColor = textureCubeLodEXT( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ), MipmapIndex );\n#else\nvec4 envTexColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ), MipmapIndex );\n#endif\nvec3 cubeColor = LogLuvDecode(envTexColor);\n#else\nvec4 envTexColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\nvec3 cubeColor = envTexColor.xyz;\n#ifdef GAMMA_INPUT\ncubeColor.xyz *= cubeColor.xyz;\n#endif\n#endif\ncubeColor *= reflectScale;\nfloat facing = dot( viewPosition, normal );\nif (facing < 0.0) {\nfacing = 1.0;\n}\nvec4 speca = vec4(specular, gl_FragColor.a);\n#ifdef METAL\nvec4 schlickRefl = speca;\ngl_FragColor.xyz += cubeColor.xyz * specularStrength * schlickRefl.xyz;\ngl_FragColor.a = speca.a;\n#else\n#ifdef CLEARCOAT\nvec3 cubeColorClearcoat;\nvec3 reflectVecClearcoat = reflect( -vViewPosition, geomNormal );\nreflectVecClearcoat = mat3( viewMatrixInverse[ 0 ].xyz, viewMatrixInverse[ 1 ].xyz, viewMatrixInverse[ 2 ].xyz ) * reflectVecClearcoat;\n#ifdef ENV_LOGLUV\nvec4 envTexColorClearcoat = textureCube( envMap, vec3( flipEnvMap * reflectVecClearcoat.x, reflectVecClearcoat.yz ));\ncubeColorClearcoat = LogLuvDecode(envTexColorClearcoat);\n#else\nvec4 envTexColorClearcoat = textureCube( envMap, vec3( flipEnvMap * reflectVecClearcoat.x, reflectVecClearcoat.yz ) );\ncubeColorClearcoat = envTexColorClearcoat.xyz;\n#ifdef GAMMA_INPUT\ncubeColorClearcoat.xyz *= cubeColorClearcoat.xyz;\n#endif\n#endif\ngl_FragColor.xyz += cubeColor.xyz * specularStrength * speca.xyz;\nfloat schlickRefl = reflectivity + ( 1.0 - reflectivity ) * pow( max(1.0 - facing, 0.0), 5.0 );\ngl_FragColor.xyz = mix(gl_FragColor.xyz, cubeColorClearcoat * schlickRefl, 0.5);\n#else\nvec4 schlickRefl = speca + ( 1.0 - speca ) * pow( max(1.0 - facing, 0.0), 5.0 );\nschlickRefl.rgb *= max(0.0, 1.0 - 2.0 / logShiny);\nif ( combine == 1 ) {\ngl_FragColor.xyz = mix( gl_FragColor.xyz, cubeColor.xyz, specularStrength * schlickRefl.xyz );\ngl_FragColor.a = schlickRefl.a;\n} else if ( combine == 2 ) {\ngl_FragColor.xyz += cubeColor.xyz * specularStrength * schlickRefl.xyz;\ngl_FragColor.a = schlickRefl.a;\n} else {\ngl_FragColor = mix( gl_FragColor, vec4(gl_FragColor.xyz * cubeColor.xyz, gl_FragColor.a), specularStrength * schlickRefl );\n}\n#endif\n#endif\n#endif\n#ifdef GAMMA_OUTPUT\ngl_FragColor.xyz = sqrt( gl_FragColor.xyz );\n#endif\n#ifdef TONEMAP_OUTPUT\ngl_FragColor.xyz = toneMapCanonFilmic_WithGamma( exposureBias * gl_FragColor.xyz );\n#endif\n#if defined(USE_LOGDEPTHBUF) && defined(USE_LOGDEPTHBUF_EXT)\ngl_FragDepthEXT = log2(vFragDepth) * logDepthBufFC * 0.5;\n#endif\n#ifdef MRT_NORMALS\ngeomNormal = geomNormal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );\ngl_FragData[1] = vec4(geomNormal.x, geomNormal.y, depth, gl_FragColor.a < 1.0 ? 0.0 : 1.0);\n#endif\n}"].join("\n")};
THREE.ShaderLib.firefly_phong=FireflyPhongShader;NormalsShader={uniforms:{},vertexShader:"varying vec3 vNormal;\nvarying float depth;\nvoid main() {\nvNormal = normalize( normalMatrix * normal );\nvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\ndepth = mvPosition.z;\nvec4 p_Position = projectionMatrix * mvPosition;\ngl_Position = p_Position;\n}",fragmentShader:"varying vec3 vNormal;\nvarying float depth;\nvoid main() {\nvec3 n = vNormal;\nn = n * ( -1.0 + 2.0 * float( gl_FrontFacing ) );\nn = normalize( n );\ngl_FragColor = vec4(n.x, n.y, depth, 1.0);\n}"};
BackgroundShader={uniforms:{color1:{type:"v4",value:new THREE.Vector4(1/255,2/255,3/255,1)},color2:{type:"v4",value:new THREE.Vector4(41/255,76/255,120/255,1)},luminance:{type:"f",value:1},linearize:{type:"i",value:0}},vertexShader:"uniform vec4 color1;\nuniform vec4 color2;\nuniform float luminance;\nuniform int linearize;\nvarying vec4 vcolor;\nvoid main() {\nif (uv.y == 0.0)\nvcolor = color1;\nelse\nvcolor = color2;\nif (linearize != 0)\nvcolor *= vcolor;\nvcolor *= luminance;\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",
fragmentShader:"const vec4 c0 = vec4(1.0, 13.0, 4.0, 16.0);\nconst vec4 c1 = vec4(9.0, 5.0, 12.0, 8.0);\nconst vec4 c2 = vec4(3.0, 15.0, 2.0, 14.0);\nconst vec4 c3 = vec4(11.0, 7.0, 10.0, 6.0);\nvarying vec4 vcolor;\nvoid main() {\nvec4 c = vcolor;\nint i = int(mod(float(gl_FragCoord.x), 4.0));\nint j = int(mod(float(gl_FragCoord.y), 4.0));\nvec4 col;\nif (i==0) col = c0; else if (i==1) col = c1; else if (i==2) col = c2; else col = c3;\nfloat bias;\nif (j==0) bias = col.x; else if (j==1) bias = col.y; else if (j==2) bias = col.z; else bias = col.w;\nc.xyz += bias * (1.0/(17.0*256.0));\ngl_FragColor = c;\n}"};
LineShader={uniforms:{pixelsPerUnit:{type:"f",value:1},unitsPerPixel:{type:"f",value:1},tLayerMask:{type:"t",value:null},tRaster:{type:"t",value:null},tSelectionTexture:{type:"t",value:null},vSelTexSize:{type:"v2",value:new THREE.Vector2(4096,1)}},attributes:{fields1:0,fields2:0,color4b:0,dbId4b:0,flags4b:0,extraParams:0,instFlags4b:0},defines:{},vertexShader:"#define TAU 6.28318530718\n#define PI 3.14159265358979\n#define HALF_PI 1.57079632679\n#define VBB_LINE_SEGMENT     16.0\n#define VBB_ARC_CIRCULAR     32.0\n#define VBB_ARC_ELLIPTICAL   48.0\n#define VBB_TEX_QUAD         64.0\n#define VBB_ONE_TRIANGLE     80.0\n#define VBB_INSTANCED_FLAG   0.0\n#define VBB_SEG_START_RIGHT  1.0\n#define VBB_SEG_START_LEFT   2.0\n#define VBB_SEG_END_RIGHT    3.0\n#define VBB_SEG_END_LEFT     4.0\nattribute vec3 fields1;\nattribute vec3 fields2;\nattribute vec4 color4b;\nattribute vec4 dbId4b;\nattribute vec4 flags4b;\n#ifdef HAS_ELLIPTICALS\nattribute vec3 extraParams;\n#endif\nattribute vec4 instFlags4b;\nuniform mat4 mvpMatrix;\nuniform float pixelsPerUnit;\nuniform float unitsPerPixel;\nuniform sampler2D tLayerMask;\n#ifdef SELECTION_RENDERER\nuniform sampler2D tSelectionTexture;\nuniform vec2 vSelTexSize;\n#endif\nvarying vec4 outColor;\nvarying vec4 dbId;\nvarying vec2 centralVertex;\nvarying vec2 offsetPosition;\nvarying vec4 multipurpose;\nvarying float halfWidth;\nvoid strokeLineSegment(float vertexId) {\nfloat distanceAlong = fields2.x;\nfloat isStartCapVertex = (vertexId < VBB_SEG_END_RIGHT) ? -1.0 : 1.0;\nfloat isLeftSide = (vertexId == VBB_SEG_END_LEFT || vertexId == VBB_SEG_START_LEFT) ? 1.0 : -1.0;\nfloat angleTransverse = fields1.z + isLeftSide * HALF_PI;\nfloat st = sin(angleTransverse);\nfloat ct = cos(angleTransverse);\nfloat lwAdjustment = halfWidth + 0.5 * unitsPerPixel;\nvec2 transverseOffset = vec2(ct, st) * lwAdjustment;\noffsetPosition.xy += transverseOffset;\nvec2 moveOffset = isStartCapVertex * isLeftSide * vec2(-transverseOffset.y, transverseOffset.x);\noffsetPosition.xy -= moveOffset;\ncentralVertex.xy -= moveOffset;\nfloat distanceFromStart = max(isStartCapVertex, 0.0) * distanceAlong;\nvec2 along = distanceFromStart * vec2(cos(fields1.z), sin(fields1.z));\noffsetPosition.xy += along;\ncentralVertex.xy += along;\nmultipurpose.x = (isStartCapVertex * lwAdjustment) + distanceFromStart;\nmultipurpose.y = distanceAlong;\nmultipurpose.z = 0.0;\n}\n#ifdef HAS_TRIANGLE_GEOMS\nvoid strokeOneTriangle(float vertexId) {\nhalfWidth = 0.0;\nif (vertexId == VBB_SEG_END_RIGHT)\noffsetPosition.xy = vec2(fields1.z, fields2.x);\nelse if (vertexId == VBB_SEG_END_LEFT)\noffsetPosition.xy = fields2.yz;\n}\n#endif\n#ifdef HAS_RASTER_QUADS\nvoid strokeTexQuad(float vertexId) {\nfloat distanceAlong = fields2.x;\nbool isStartCapVertex = (vertexId < VBB_SEG_END_RIGHT);\nfloat isLeftSide = (vertexId == VBB_SEG_END_LEFT || vertexId == VBB_SEG_START_LEFT) ? 1.0 : -1.0;\nfloat angleTransverse = fields1.z + isLeftSide * HALF_PI;\nmultipurpose.y = distanceAlong;\nfloat st = sin(angleTransverse);\nfloat ct = cos(angleTransverse);\nfloat moveDist = halfWidth;\nvec2 offset = vec2(ct, st) * moveDist;\noffsetPosition.xy += offset;\nmultipurpose.z = 1.0;\nhalfWidth = 0.0;\nif (isStartCapVertex) {\noffsetPosition.xy += isLeftSide * vec2(0.0, offset.x);\nmultipurpose.x = 0.0;\nmultipurpose.y = max(0.0, isLeftSide);\n}\nelse {\nvec2 along = vec2(cos(fields1.z), sin(fields1.z));\noffsetPosition.xy += distanceAlong * along;\ncentralVertex.xy += distanceAlong * along;\noffsetPosition.xy += isLeftSide * vec2(0.0, -offset.x);\nmultipurpose.x = 1.0;\nmultipurpose.y = max(0.0, isLeftSide);\n}\n}\n#endif\n#ifdef HAS_CIRCLES\nvoid strokeCircularArc(float vertexId) {\nvec2 angles = vec2(fields1.z, fields2.x);\nfloat r = fields2.z;\nif (r * pixelsPerUnit < 0.125)\nr = 0.125 * unitsPerPixel;\nfloat isStart = (vertexId < VBB_SEG_END_RIGHT) ? -1.0 : 1.0;\nfloat isLeft = (vertexId == VBB_SEG_END_LEFT || vertexId == VBB_SEG_START_LEFT) ? -1.0 : 1.0;\nvec2 minPt;\nvec2 maxPt;\nvec2 endsX = vec2(fields1.x) + r * cos(angles);\nvec2 endsY = vec2(fields1.y) + r * sin(angles);\nminPt = maxPt = vec2(endsX.x, endsY.x);\nminPt = min(minPt, vec2(endsX.y, endsY.y));\nmaxPt = max(maxPt, vec2(endsX.y, endsY.y));\nfloat start = angles.x;\nfloat end = angles.y;\nif (end > start) {\nif (start < (0.5 * PI) && end > (0.5 * PI)) {\nminPt = min(minPt, vec2(fields1.x, fields1.y + r));\nmaxPt = max(maxPt, vec2(fields1.x, fields1.y + r));\n}\nif (start < PI && end > PI) {\nminPt = min(minPt, vec2(fields1.x - r, fields1.y));\nmaxPt = max(maxPt, vec2(fields1.x - r, fields1.y));\n}\nif (start < (1.5 * PI) && end > (1.5 * PI)) {\nminPt = min(minPt, vec2(fields1.x, fields1.y - r));\nmaxPt = max(maxPt, vec2(fields1.x, fields1.y - r));\n}\n}\nelse {\nminPt = min(minPt, vec2(fields1.x + r, fields1.y));\nmaxPt = max(maxPt, vec2(fields1.x + r, fields1.y));\nif (start < (0.5 * PI) || end > (0.5 * PI)) {\nminPt = min(minPt, vec2(fields1.x, fields1.y + r));\nmaxPt = max(maxPt, vec2(fields1.x, fields1.y + r));\n}\nif (start < PI || end > PI) {\nminPt = min(minPt, vec2(fields1.x - r, fields1.y));\nmaxPt = max(maxPt, vec2(fields1.x - r, fields1.y));\n}\nif (start < (1.5 * PI) || end > (1.5 * PI)) {\nminPt = min(minPt, vec2(fields1.x, fields1.y - r));\nmaxPt = max(maxPt, vec2(fields1.x, fields1.y - r));\n}\n}\nminPt -= halfWidth + 0.5 * unitsPerPixel;\nmaxPt += halfWidth + 0.5 * unitsPerPixel;\nif (isStart<0.0)\noffsetPosition.x = minPt.x;\nelse\noffsetPosition.x = maxPt.x;\nif (isLeft<0.0)\noffsetPosition.y = minPt.y;\nelse\noffsetPosition.y = maxPt.y;\nmultipurpose.x = angles.x;\nmultipurpose.y = -r;\nmultipurpose.z = angles.y;\nmultipurpose.w = -r;\n}\n#endif\n#ifdef HAS_ELLIPTICALS\nvoid strokeEllipticalArc(float vertexId) {\nvec2 angles = vec2(fields1.z, fields2.x);\nfloat isStart = (vertexId < VBB_SEG_END_RIGHT) ? -1.0 : 1.0;\nfloat isLeft = (vertexId == VBB_SEG_END_LEFT || vertexId == VBB_SEG_START_LEFT) ? -1.0 : 1.0;\nfloat major = fields2.z;\nfloat minor = extraParams.x;\nvec2 minPt;\nvec2 maxPt;\nvec2 endsX = vec2(fields1.x) + major * cos(angles);\nvec2 endsY = vec2(fields1.y) + minor * sin(angles);\nminPt = maxPt = vec2(endsX.x, endsY.x);\nminPt = min(minPt, vec2(endsX.y, endsY.y));\nmaxPt = max(maxPt, vec2(endsX.y, endsY.y));\nfloat start = angles.x;\nfloat end = angles.y;\nif (end > start) {\nif (start < (0.5 * PI) && end > (0.5 * PI)) {\nminPt = min(minPt, vec2(fields1.x, fields1.y + minor));\nmaxPt = max(maxPt, vec2(fields1.x, fields1.y + minor));\n}\nif (start < PI && end > PI) {\nminPt = min(minPt, vec2(fields1.x - major, fields1.y));\nmaxPt = max(maxPt, vec2(fields1.x - major, fields1.y));\n}\nif (start < (1.5 * PI) && end > (1.5 * PI)) {\nminPt = min(minPt, vec2(fields1.x, fields1.y - minor));\nmaxPt = max(maxPt, vec2(fields1.x, fields1.y - minor));\n}\n}\nelse {\nminPt = min(minPt, vec2(fields1.x + major, fields1.y));\nmaxPt = max(maxPt, vec2(fields1.x + major, fields1.y));\nif (start < (0.5 * PI) || end > (0.5 * PI)) {\nminPt = min(minPt, vec2(fields1.x, fields1.y + minor));\nmaxPt = max(maxPt, vec2(fields1.x, fields1.y + minor));\n}\nif (start < PI || end > PI) {\nminPt = min(minPt, vec2(fields1.x - major, fields1.y));\nmaxPt = max(maxPt, vec2(fields1.x - major, fields1.y));\n}\nif (start < (1.5 * PI) || end > (1.5 * PI)) {\nminPt = min(minPt, vec2(fields1.x, fields1.y - minor));\nmaxPt = max(maxPt, vec2(fields1.x, fields1.y - minor));\n}\n}\nminPt -= halfWidth + 0.5 * unitsPerPixel;\nmaxPt += halfWidth + 0.5 * unitsPerPixel;\nif (isStart < 0.0)\noffsetPosition.x = minPt.x;\nelse\noffsetPosition.x = maxPt.x;\nif (isLeft < 0.0)\noffsetPosition.y = minPt.y;\nelse\noffsetPosition.y = maxPt.y;\nmultipurpose.x = angles.x;\nmultipurpose.y = -major;\nmultipurpose.z = angles.y;\nmultipurpose.w = minor;\n}\n#endif\n#ifdef SELECTION_RENDERER\nbool isSelected() {\nvec3 oid = dbId4b.rgb * 255.0;\nfloat id01 = oid.r + oid.g * 256.0;\nfloat t = (id01 + 0.5) * (1.0 / 4096.0);\nfloat flrt = floor(t);\nfloat texU = t - flrt;\nfloat id23 = oid.b * (65536.0 / 4096.0) + flrt;\nt = (id23 + 0.5) / vSelTexSize.y;\nfloat texV = fract(t);\nvec4 selBit = texture2D(tSelectionTexture, vec2(texU, texV));\nreturn selBit.r == 1.0;\n}\n#endif\nbool isLayerOff() {\nvec4 layerBit = texture2D(tLayerMask, flags4b.ba / 255.0);\nreturn layerBit.r == 0.0;\n}\nvoid main() {\ncentralVertex = offsetPosition = fields1.xy;\nif (isLayerOff()) {\noutColor = vec4(0.0);\n}\nelse {\nfloat vertexId = mod(flags4b.x, 16.0);\nfloat geomType = flags4b.x - vertexId;\nvertexId = max(instFlags4b.x, vertexId);\nfloat lineWeight = fields2.y;\nif (lineWeight > 0.0) {\nif (lineWeight * pixelsPerUnit < 0.5)\nlineWeight = 0.5 * unitsPerPixel;\n}\nelse {\nlineWeight = abs(lineWeight) * unitsPerPixel;\n}\n#ifdef SELECTION_RENDERER\nif (isSelected())\noutColor = vec4(0.0,0.0,1.0,1.0);\nelse\noutColor = vec4(0.0);\n#else\noutColor = color4b;\n#endif\nhalfWidth = lineWeight;\ndbId = dbId4b;\nif (geomType == VBB_LINE_SEGMENT)\nstrokeLineSegment(vertexId);\n#ifdef HAS_CIRCLES\nelse if (geomType == VBB_ARC_CIRCULAR)\nstrokeCircularArc(vertexId);\n#endif\n#ifdef HAS_ELLIPTICALS\nelse if (geomType == VBB_ARC_ELLIPTICAL)\nstrokeEllipticalArc(vertexId);\n#endif\n#ifdef HAS_RASTER_QUADS\nelse if (geomType == VBB_TEX_QUAD)\nstrokeTexQuad(vertexId);\n#endif\n#ifdef HAS_TRIANGLE_GEOMS\nelse if (geomType == VBB_ONE_TRIANGLE)\nstrokeOneTriangle(vertexId);\n#endif\nelse {\nhalfWidth = 0.0;\nmultipurpose.z = 0.0;\n}\n}\ngl_Position = mvpMatrix * vec4( offsetPosition.xy, 0.0, 1.0 );\n}",
fragmentShader:"#define TAU 6.28318530717958\n#define PI  3.14159265358979\nuniform float pixelsPerUnit;\nuniform float unitsPerPixel;\nfloat aaRange = 0.5 * unitsPerPixel;\n#ifdef HAS_RASTER_QUADS\nuniform sampler2D tRaster;\n#endif\nvarying vec4 outColor;\nvarying vec4 dbId;\n#ifdef MRT_ID_BUFFER\n#extension GL_EXT_draw_buffers : enable\n#define gl_FragColor gl_FragData[0]\n#endif\nvarying vec2 centralVertex;\nvarying vec2 offsetPosition;\nvarying vec4 multipurpose;\nvarying float halfWidth;\nfloat curveGaussian(float r, float invWidth) {\nfloat amt = clamp(r * invWidth, 0.0, 1.0);\nfloat exponent = amt * 3.5;\nreturn exp(-exponent*exponent);\n}\nvoid fillLineSegment() {\nfloat radius = halfWidth;\nfloat parametricDistance = multipurpose.x;\nfloat segmentLength = multipurpose.y;\nfloat ltz = max(0.0, sign(parametricDistance));\nfloat gtsl = max(0.0, sign(parametricDistance - segmentLength));\nfloat d = (1.0 - ltz + gtsl) * (parametricDistance - ltz * segmentLength);\nradius = sqrt(max(0.0, radius * radius - d * d));\nfloat dist = distance(centralVertex, offsetPosition);\nfloat range =  dist - radius;\nif (range > aaRange) {\ndiscard;\n}\ngl_FragColor = outColor;\ngl_FragColor.a *= curveGaussian(range+aaRange, pixelsPerUnit);\n}\n#ifdef HAS_CIRCLES\nvoid fillCircularArc() {\nfloat dist = distance(centralVertex, offsetPosition);\nfloat radius = abs(multipurpose.y);\nfloat range =  abs(dist - radius);\nrange -= halfWidth;\nif (range > aaRange) {\ndiscard;\n}\nvec2 angles = multipurpose.xz;\nvec2 direction = offsetPosition - centralVertex;\nfloat angle = atan(direction.y, direction.x);\nif (angles.x > angles.y)\nangles.x -= TAU;\nelse if (angle < 0.0)\nangle += TAU;\nif (angle > angles.x && angle < angles.y) {\ngl_FragColor = outColor;\ngl_FragColor.a *= curveGaussian(range+aaRange, pixelsPerUnit);\n}\nelse {\ndiscard;\n}\n}\n#endif\n#ifdef HAS_ELLIPTICALS\nfloat DistancePointEllipseSpecial (vec2 e, vec2 y, out vec2 x, float width, float aaRange) {\nfloat dist;\nvec2 esqr = e * e;\nvec2 ey = e * y;\nfloat t0 = -esqr[1] + ey[1];\nfloat t1 = -esqr[1] + length(ey);\nfloat t;\nvec2 r;\nfor (int i = 0; i < 6; ++i) {\nt = mix(t0, t1, 0.5);//0.5*(t0 + t1);\nr = ey / (vec2(t) + esqr);\nvec2 rsq = r * r;\nfloat f = rsq[0] + rsq[1] - 1.0;\nfloat fsign = sign(f);\nt0 = mix(t0, t, max(0.0, fsign));\nt1 = mix(t1, t, max(0.0, -fsign));\n}\nx = e * r;\ndist = distance(x, y);\nif (dist > max(2.0 * (width + aaRange), e[0] * 0.05))\nreturn dist;\nfor (int i = 0; i < 6; ++i) {\nt = mix(t0, t1, 0.5);//0.5*(t0 + t1);\nr = ey / (vec2(t) + esqr);\nvec2 rsq = r * r;\nfloat f = rsq[0] + rsq[1] - 1.0;\nfloat fsign = sign(f);\nt0 = mix(t0, t, max(0.0, fsign));\nt1 = mix(t1, t, max(0.0, -fsign));\n}\nx = e * r;\ndist = distance(x, y);\nfloat ecc = 1.0 +  0.1 * e[0] / e[1];\nif (dist > max(ecc * (width + aaRange), e[0] * 0.001))\nreturn dist;\nif (dist < (width - aaRange) / ecc)\nreturn dist;\nfor (int i = 0; i < 10; ++i) {\nt = mix(t0, t1, 0.5);//0.5*(t0 + t1);\nr = ey / (vec2(t) + esqr);\nvec2 rsq = r * r;\nfloat f = rsq[0] + rsq[1] - 1.0;\nfloat fsign = sign(f);\nt0 = mix(t0, t, max(0.0, fsign));\nt1 = mix(t1, t, max(0.0, -fsign));\n}\nx = e * r;\ndist = distance(x, y);\nreturn dist;\n}\nfloat DistancePointEllipse(vec2 e, vec2 y, out vec2 locX, float width, float aaRange) {\nvec2 locE, locY;\nfloat diff = sign(e[0] - e[1]);\nvec2 swizzle = vec2(max(diff, 0.0), -min(diff, 0.0));\nlocE.x = dot(e, swizzle.xy);\nlocE.y = dot(e, swizzle.yx);\nlocY.x = dot(y, swizzle.xy);\nlocY.y = dot(y, swizzle.yx);\nvec2 refl = sign(locY);\nlocY *= refl;\nvec2 x;\nfloat distance = DistancePointEllipseSpecial(locE, locY, x, width, aaRange);\nx *= refl;\nlocX.x = dot(x, swizzle.xy);\nlocX.y = dot(x, swizzle.yx);\nreturn distance;\n}\nvoid fillEllipticalArc() {\nvec2 radii = abs(multipurpose.yw);\nvec2 dir = offsetPosition - centralVertex;\nvec2 pos;\nfloat range = DistancePointEllipse(radii, dir, pos, halfWidth, aaRange);\nrange -= halfWidth;\nif (range > aaRange)\ndiscard;\nfloat ar = radii[0] / radii[1];\nvec2 angles = multipurpose.xz;\nfloat angle = atan(ar * pos.y, pos.x);\nif (angles.x > angles.y)\nangles.x -= TAU;\nelse if (angle < 0.0)\nangle += TAU;\nif (angle > angles.x && angle < angles.y) {\ngl_FragColor = outColor;\ngl_FragColor.a *= curveGaussian(range+aaRange, pixelsPerUnit);\n}\nelse {\ndiscard;\n}\n}\n#endif\nvoid main() {\nif (outColor.a == 0.0) {\ndiscard;\n}\nif (halfWidth == 0.0) {\n#ifdef HAS_RASTER_QUADS\nif (multipurpose.z != 0.0)\ngl_FragColor = texture2D(tRaster, multipurpose.xy);\nelse\n#endif\ngl_FragColor = outColor;\n}\nelse if (multipurpose.y < 0.0) {\n#ifdef HAS_CIRCLES\n#ifdef HAS_ELLIPTICALS\nif (multipurpose.y == multipurpose.w)\n#endif\nfillCircularArc();\n#endif\n#ifdef HAS_ELLIPTICALS\n#ifdef HAS_CIRCLES\nelse\n#endif\nfillEllipticalArc();\n#endif\n}\nelse\nfillLineSegment();\n#ifdef MRT_ID_BUFFER\ngl_FragData[1] = vec4(dbId.rgb, 1.0);\n#elif defined(ID_COLOR)\ngl_FragColor = vec4(dbId.rgba);\n#endif\n}"};
FireflyWebGLProgram=function(){var a=0;return function(b,c,d,f){var g=b.context,h=d.defines,k=d.__webglShader.uniforms,l=d.attributes,m=d.__webglShader.vertexShader,p=d.__webglShader.fragmentShader,n=d.index0AttributeName;void 0===n&&!0===f.morphTargets&&(n="position");var q="SHADOWMAP_TYPE_BASIC";f.shadowMapType===THREE.PCFShadowMap?q="SHADOWMAP_TYPE_PCF":f.shadowMapType===THREE.PCFSoftShadowMap&&(q="SHADOWMAP_TYPE_PCF_SOFT");var r,v;r=[];for(var s in h)v=h[s],!1!==v&&(v="#define "+s+" "+v,r.push(v));
r=r.join("\n");h=g.createProgram();d instanceof THREE.RawShaderMaterial?b=d="":(d=["precision "+f.precision+" float;","precision "+f.precision+" int;",r,f.supportsVertexTextures?"#define VERTEX_TEXTURES":"",b.gammaInput?"#define GAMMA_INPUT":"",b.gammaOutput?"#define GAMMA_OUTPUT":"",f.mrtNormals?"#define MRT_NORMALS":"","#define MAX_DIR_LIGHTS "+f.maxDirLights,"#define MAX_POINT_LIGHTS "+f.maxPointLights,"#define MAX_SPOT_LIGHTS "+f.maxSpotLights,"#define MAX_HEMI_LIGHTS "+f.maxHemiLights,"#define MAX_SHADOWS "+
f.maxShadows,"#define MAX_BONES "+f.maxBones,"#define NUM_CUTPLANES "+f.numCutplanes,f.map?"#define USE_MAP":"",f.envMap?"#define USE_ENVMAP":"",f.irradianceMap?"#define USE_IRRADIANCEMAP":"",f.lightMap?"#define USE_LIGHTMAP":"",f.bumpMap?"#define USE_BUMPMAP":"",f.normalMap?"#define USE_NORMALMAP":"",f.specularMap?"#define USE_SPECULARMAP":"",f.alphaMap?"#define USE_ALPHAMAP":"",f.vertexColors?"#define USE_COLOR":"",f.skinning?"#define USE_SKINNING":"",f.useVertexTexture?"#define BONE_TEXTURE":"",
f.morphTargets?"#define USE_MORPHTARGETS":"",f.morphNormals?"#define USE_MORPHNORMALS":"",f.wrapAround?"#define WRAP_AROUND":"",f.doubleSided?"#define DOUBLE_SIDED":"",f.flipSided?"#define FLIP_SIDED":"",f.shadowMapEnabled?"#define USE_SHADOWMAP":"",f.shadowMapEnabled?"#define "+q:"",f.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",f.shadowMapCascade?"#define SHADOWMAP_CASCADE":"",f.sizeAttenuation?"#define USE_SIZEATTENUATION":"",f.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",f.useFragDepthExt?
"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform mat4 viewMatrix;\nuniform mat3 normalMatrix;\nuniform vec3 cameraPosition;\nattribute vec3 position;\nattribute vec3 normal;\nattribute vec2 uv;\nattribute vec2 uv2;\n#ifdef USE_COLOR\n\tattribute vec3 color;\n#endif\n"].join("\n"),b=["precision "+f.precision+" float;","precision "+f.precision+" int;",f.bumpMap||f.normalMap?"#extension GL_OES_standard_derivatives : enable":
"",f.haveTextureLod?"#define HAVE_TEXTURE_LOD":"",r,"#define MAX_DIR_LIGHTS "+f.maxDirLights,"#define MAX_POINT_LIGHTS "+f.maxPointLights,"#define MAX_SPOT_LIGHTS "+f.maxSpotLights,"#define MAX_HEMI_LIGHTS "+f.maxHemiLights,"#define MAX_SHADOWS "+f.maxShadows,"#define NUM_CUTPLANES "+f.numCutplanes,f.alphaTest?"#define ALPHATEST "+f.alphaTest:"",b.gammaInput?"#define GAMMA_INPUT":"",b.gammaOutput?"#define GAMMA_OUTPUT":"",f.mrtNormals?"#define MRT_NORMALS":"",f.tonemapOutput?"#define TONEMAP_OUTPUT":
"",f.useFog&&f.fog?"#define USE_FOG":"",f.useFog&&f.fogExp?"#define FOG_EXP2":"",f.map?"#define USE_MAP":"",f.envMap?"#define USE_ENVMAP":"",f.irradianceMap?"#define USE_IRRADIANCEMAP":"",f.envLogLuv?"#define ENV_LOGLUV":"",f.irrLogLuv?"#define IRR_LOGLUV":"",f.lightMap?"#define USE_LIGHTMAP":"",f.bumpMap?"#define USE_BUMPMAP":"",f.normalMap?"#define USE_NORMALMAP":"",f.specularMap?"#define USE_SPECULARMAP":"",f.alphaMap?"#define USE_ALPHAMAP":"",f.vertexColors?"#define USE_COLOR":"",f.metal?"#define METAL":
"",f.clearcoat?"#define CLEARCOAT":"",f.wrapAround?"#define WRAP_AROUND":"",f.doubleSided?"#define DOUBLE_SIDED":"",f.flipSided?"#define FLIP_SIDED":"",f.shadowMapEnabled?"#define USE_SHADOWMAP":"",f.shadowMapEnabled?"#define "+q:"",f.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",f.shadowMapCascade?"#define SHADOWMAP_CASCADE":"",f.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",f.useFragDepthExt?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;\nuniform vec3 cameraPosition;\n#ifdef USE_ENVMAP\nuniform mat4 viewMatrixInverse;\n#endif\n"].join("\n"));
m=new THREE.WebGLShader(g,g.VERTEX_SHADER,d+m);p=new THREE.WebGLShader(g,g.FRAGMENT_SHADER,b+p);g.attachShader(h,m);g.attachShader(h,p);void 0!==n&&g.bindAttribLocation(h,0,n);g.linkProgram(h);!1===g.getProgramParameter(h,g.LINK_STATUS)&&(console.error("THREE.WebGLProgram: Could not initialise shader."),console.error("gl.VALIDATE_STATUS",g.getProgramParameter(h,g.VALIDATE_STATUS)),console.error("gl.getError()",g.getError()));""!==g.getProgramInfoLog(h)&&console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",
g.getProgramInfoLog(h));g.deleteShader(m);g.deleteShader(p);n="viewMatrix modelViewMatrix projectionMatrix normalMatrix modelMatrix cameraPosition viewMatrixInverse mvpMatrix".split(" ");f.logarithmicDepthBuffer&&n.push("logDepthBufFC");for(var w in k)n.push(w);f=n;k={};w=0;for(n=f.length;w<n;w++)b=f[w],k[b]=g.getUniformLocation(h,b);this.uniforms=k;var n="position normal uv uv2 tangent color lineDistance".split(" "),z;for(z in l)n.push(z);l=n;z={};f=0;for(k=l.length;f<k;f++)w=l[f],z[w]=g.getAttribLocation(h,
w);this.attributes=z;this.attributesKeys=Object.keys(this.attributes);this.id=a++;this.code=c;this.usedTimes=1;this.program=h;this.vertexShader=m;this.fragmentShader=p;return this}}();
FireflyWebGLRenderer=function(a){function b(a,b){var g=b.geometry,h=a.faces3,k=3*h.length,l=1*h.length,m=3*h.length,h=c(b,a),n=f(h),p=d(h),q=h.vertexColors?h.vertexColors:!1;a.__vertexArray=new Float32Array(3*k);p&&(a.__normalArray=new Float32Array(3*k));g.hasTangents&&(a.__tangentArray=new Float32Array(4*k));q&&(a.__colorArray=new Float32Array(3*k));n&&(0<g.faceVertexUvs.length&&(a.__uvArray=new Float32Array(2*k)),1<g.faceVertexUvs.length&&(a.__uv2Array=new Float32Array(2*k)));b.geometry.skinWeights.length&&
b.geometry.skinIndices.length&&(a.__skinIndexArray=new Float32Array(4*k),a.__skinWeightArray=new Float32Array(4*k));g=null!==nb&&21845<l?Uint32Array:Uint16Array;a.__typeArray=g;a.__faceArray=new g(3*l);a.__lineArray=new g(2*m);a.__webglFaceCount=3*l;a.__webglLineCount=2*m;if(h.attributes){void 0===a.__webglCustomAttributesList&&(a.__webglCustomAttributesList=[]);for(var K in h.attributes){var l=h.attributes[K],g={},r;for(r in l)g[r]=l[r];if(!g.__webglInitialized||g.createUniqueBuffers)g.__webglInitialized=
!0,m=1,"v2"===g.type?m=2:"v3"===g.type?m=3:"v4"===g.type?m=4:"c"===g.type&&(m=3),g.size=m,g.array=new Float32Array(k*m),g.buffer=t.createBuffer(),g.buffer.belongsToAttribute=K,l.needsUpdate=!0,g.__original=l;a.__webglCustomAttributesList.push(g)}}a.__inittedArrays=!0}function c(a,b){return a.material instanceof THREE.MeshFaceMaterial?a.material.materials[b.materialIndex]:a.material}function d(a){return a instanceof THREE.MeshBasicMaterial&&!a.envMap||a instanceof THREE.MeshDepthMaterial?!1:a&&void 0!==
a.shading&&a.shading===THREE.SmoothShading?THREE.SmoothShading:THREE.FlatShading}function f(a){return a.map||a.lightMap||a.bumpMap||a.normalMap||a.specularMap||a.alphaMap||a instanceof THREE.ShaderMaterial?!0:!1}function g(a,b,c,d){var f,g,h,m=!1;if(c.vb){if(c.streamingDraw){var n=gb.interleavedVB;n||(n=t.createBuffer(),gb.interleavedVB=n);t.bindBuffer(t.ARRAY_BUFFER,n);t.bufferData(t.ARRAY_BUFFER,c.vb,t.STREAM_DRAW)}else t.bindBuffer(t.ARRAY_BUFFER,c.vbbuffer);n=c.vbstride;for(h in b)if("index"!=
h&&(g=b[h],f=c.attributes[h],0<=g&&f))if(void 0!==f.itemOffset){var p=t.FLOAT;1===f.bytesPerItem&&(p=t.UNSIGNED_BYTE);k(g);t.vertexAttribPointer(g,f.itemSize,p,f.normalize,4*n,4*(f.itemOffset+d*n));Ua&&Ua.vertexAttribDivisorANGLE(g,f.divisor?f.divisor:0)}else m=!0}else m=!0;if(m)for(h in b)"index"!=h&&(g=b[h],f=c.attributes[h],0<=g&&(f?void 0===f.itemOffset&&(c.streamingDraw?(n=gb[h],n||(n=t.createBuffer(),gb[h]=n),t.bindBuffer(t.ARRAY_BUFFER,n),t.bufferData(t.ARRAY_BUFFER,f.array,t.DYNAMIC_DRAW)):
t.bindBuffer(t.ARRAY_BUFFER,f.buffer),p=t.FLOAT,1===f.bytesPerItem&&(p=t.UNSIGNED_BYTE),k(g),t.vertexAttribPointer(g,f.itemSize,p,f.normalize,0,d*f.itemSize*4),Ua&&Ua.vertexAttribDivisorANGLE(g,f.divisor?f.divisor:0)):a.defaultAttributeValues&&((f=a.defaultAttributeValues[h])&&2===f.length?t.vertexAttrib2fv(g,a.defaultAttributeValues[h]):f&&3===f.length&&t.vertexAttrib3fv(g,a.defaultAttributeValues[h]))));l()}function h(){for(var a=0,b=Qa.length;a<b;a++)Qa[a]=0}function k(a){Qa[a]=1;0===wa[a]&&(t.enableVertexAttribArray(a),
wa[a]=1)}function l(){for(var a=0,b=wa.length;a<b;a++)wa[a]!==Qa[a]&&(t.disableVertexAttribArray(a),wa[a]=0)}function m(a,b){return a.z!==b.z?b.z-a.z:a.id-b.id}function p(a,b){return a.z!==b.z?a.z-b.z:a.id-b.id}function n(a,g){if(!1!==g.visible){if(!(g instanceof THREE.Scene||g instanceof THREE.Group)){void 0===g.__webglInit&&(g.__webglInit=!0,g._modelViewMatrix=new THREE.Matrix4,g._normalMatrix=new THREE.Matrix3,g.addEventListener("removed",Vb));var h=g.geometry;if(void 0!==h&&void 0===h.__webglInit&&
(h.__webglInit=!0,h.addEventListener("dispose",Wb),!(h instanceof THREE.BufferGeometry)))if(g instanceof THREE.Mesh)v(a,g,h);else if(g instanceof THREE.Line){if(void 0===h.__webglVertexBuffer){h.__webglVertexBuffer=t.createBuffer();h.__webglColorBuffer=t.createBuffer();h.__webglLineDistanceBuffer=t.createBuffer();Z.info.memory.geometries++;var k=h.vertices.length;h.__vertexArray=new Float32Array(3*k);h.__colorArray=new Float32Array(3*k);h.__lineDistanceArray=new Float32Array(1*k);h.__webglLineCount=
k;var l=h.vertices.length,m=g.material;if(m.attributes){void 0===h.__webglCustomAttributesList&&(h.__webglCustomAttributesList=[]);for(var p in m.attributes){var q=m.attributes[p];if(!q.__webglInitialized||q.createUniqueBuffers){q.__webglInitialized=!0;var K=1;"v2"===q.type?K=2:"v3"===q.type?K=3:"v4"===q.type?K=4:"c"===q.type&&(K=3);q.size=K;q.array=new Float32Array(l*K);q.buffer=t.createBuffer();q.buffer.belongsToAttribute=p;q.needsUpdate=!0}h.__webglCustomAttributesList.push(q)}}h.verticesNeedUpdate=
!0;h.colorsNeedUpdate=!0;h.lineDistancesNeedUpdate=!0}}else g instanceof THREE.PointCloud&&void 0===h.__webglVertexBuffer&&(createParticleBuffers(h),initParticleBuffers(h,g),h.verticesNeedUpdate=!0,h.colorsNeedUpdate=!0);if(void 0===g.__webglActive)if(g.__webglActive=!0,g instanceof THREE.Mesh)if(h instanceof THREE.BufferGeometry)s(V,h,g);else{if(h instanceof THREE.Geometry)for(var r=Gb[h.id],F=0,A=r.length;F<A;F++)s(V,r[F],g)}else g instanceof THREE.Line||g instanceof THREE.PointCloud?s(V,h,g):(g instanceof
THREE.ImmediateRenderObject||g.immediateRenderCallback)&&Q.push({id:null,object:g,opaque:null,transparent:null,z:0});if(g instanceof THREE.Light)aa.push(g);else{var D=V[g.id];if(D&&(!1===g.frustumCulled||!0===Cb.intersectsObject(g))){var B=g.geometry,E,C;if(B instanceof THREE.BufferGeometry)if(B.streamingDraw){if(!B.streamingIndex){var R=B.attributes.index;R&&(R.buffer=t.createBuffer(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,R.buffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,R.array,t.STATIC_DRAW))}}else{B.vb&&
void 0===B.vbbuffer&&(B.vbbuffer=t.createBuffer(),B.vbNeedsUpdate=!0);for(var J=B.attributes,P=B.attributesKeys,G=0,H=P.length;G<H;G++){var S=P[G],N=J[S];N.array&&void 0===N.buffer&&(N.buffer=t.createBuffer(),N.needsUpdate=!0);if(!0===N.needsUpdate){var I="index"===S?t.ELEMENT_ARRAY_BUFFER:t.ARRAY_BUFFER;t.bindBuffer(I,N.buffer);t.bufferData(I,N.array,t.STATIC_DRAW);N.needsUpdate=!1}}B.vbNeedsUpdate&&(t.bindBuffer(t.ARRAY_BUFFER,B.vbbuffer),t.bufferData(t.ARRAY_BUFFER,B.vb,t.STATIC_DRAW),B.vbNeedsUpdate=
!1)}else if(g instanceof THREE.Mesh){!0===B.groupsNeedUpdate&&v(a,g,B);for(var Y=Gb[B.id],U=0,ba=Y.length;U<ba;U++){var M=Y[U];C=c(g,M);!0===B.groupsNeedUpdate&&b(M,g);E=C.attributes&&w(C);if(B.verticesNeedUpdate||B.morphTargetsNeedUpdate||B.elementsNeedUpdate||B.uvsNeedUpdate||B.normalsNeedUpdate||B.colorsNeedUpdate||B.tangentsNeedUpdate||E){var W=M,la=g,da=t.DYNAMIC_DRAW,ea=!B.dynamic,Aa=C;if(W.__inittedArrays){var ja=d(Aa),fa=Aa.vertexColors?Aa.vertexColors:!1,pa=f(Aa),Da=ja===THREE.SmoothShading,
X=void 0,ma=void 0,sa=void 0,ta=void 0,Ha=void 0,qa=void 0,Oa=void 0,Ia=void 0,Na=void 0,xa=void 0,ya=void 0,ga=void 0,ha=void 0,ia=void 0,Ya=void 0,Ga=void 0,Ma=void 0,Va=void 0,Wa=void 0,Ta=void 0,La=void 0,Qa=void 0,Ja=void 0,bb=void 0,fb=void 0,va=0,wa=0,Pa=0,Ra=0,Ua=0,Ba=0,eb=0,Ka=0,ib=0,T=0,$a=void 0,Ca=W.__vertexArray,ab=W.__uvArray,cb=W.__uv2Array,Sa=W.__normalArray,hb=W.__tangentArray,Ea=W.__colorArray,gb=W.__webglCustomAttributesList,O=void 0,db=W.__faceArray,Xa=W.__lineArray,kb=la.geometry,
ob=kb.elementsNeedUpdate,mb=kb.uvsNeedUpdate,qb=kb.normalsNeedUpdate,vb=kb.tangentsNeedUpdate,wb=kb.colorsNeedUpdate,pb=kb.vertices,na=W.faces3,xb=kb.faces,rb=kb.faceVertexUvs[0],sb=kb.faceVertexUvs[1];if(kb.verticesNeedUpdate){X=0;for(ma=na.length;X<ma;X++)ta=xb[na[X]],ga=pb[ta.a],ha=pb[ta.b],ia=pb[ta.c],Ca[wa]=ga.x,Ca[wa+1]=ga.y,Ca[wa+2]=ga.z,Ca[wa+3]=ha.x,Ca[wa+4]=ha.y,Ca[wa+5]=ha.z,Ca[wa+6]=ia.x,Ca[wa+7]=ia.y,Ca[wa+8]=ia.z,wa+=9;t.bindBuffer(t.ARRAY_BUFFER,W.__webglVertexBuffer);t.bufferData(t.ARRAY_BUFFER,
Ca,da)}if(wb&&fa){X=0;for(ma=na.length;X<ma;X++)ta=xb[na[X]],Oa=ta.vertexColors,Ia=ta.color,3===Oa.length&&fa===THREE.VertexColors?(Va=Oa[0],Wa=Oa[1],Ta=Oa[2]):Ta=Wa=Va=Ia,Ea[ib]=Va.r,Ea[ib+1]=Va.g,Ea[ib+2]=Va.b,Ea[ib+3]=Wa.r,Ea[ib+4]=Wa.g,Ea[ib+5]=Wa.b,Ea[ib+6]=Ta.r,Ea[ib+7]=Ta.g,Ea[ib+8]=Ta.b,ib+=9;0<ib&&(t.bindBuffer(t.ARRAY_BUFFER,W.__webglColorBuffer),t.bufferData(t.ARRAY_BUFFER,Ea,da))}if(vb&&kb.hasTangents){X=0;for(ma=na.length;X<ma;X++)ta=xb[na[X]],Na=ta.vertexTangents,Ya=Na[0],Ga=Na[1],Ma=
Na[2],hb[eb]=Ya.x,hb[eb+1]=Ya.y,hb[eb+2]=Ya.z,hb[eb+3]=Ya.w,hb[eb+4]=Ga.x,hb[eb+5]=Ga.y,hb[eb+6]=Ga.z,hb[eb+7]=Ga.w,hb[eb+8]=Ma.x,hb[eb+9]=Ma.y,hb[eb+10]=Ma.z,hb[eb+11]=Ma.w,eb+=12;t.bindBuffer(t.ARRAY_BUFFER,W.__webglTangentBuffer);t.bufferData(t.ARRAY_BUFFER,hb,da)}if(qb&&ja){X=0;for(ma=na.length;X<ma;X++)if(ta=xb[na[X]],Ha=ta.vertexNormals,qa=ta.normal,3===Ha.length&&Da)for(La=0;3>La;La++)Ja=Ha[La],Sa[Ba]=Ja.x,Sa[Ba+1]=Ja.y,Sa[Ba+2]=Ja.z,Ba+=3;else for(La=0;3>La;La++)Sa[Ba]=qa.x,Sa[Ba+1]=qa.y,
Sa[Ba+2]=qa.z,Ba+=3;t.bindBuffer(t.ARRAY_BUFFER,W.__webglNormalBuffer);t.bufferData(t.ARRAY_BUFFER,Sa,da)}if(mb&&rb&&pa){X=0;for(ma=na.length;X<ma;X++)if(sa=na[X],xa=rb[sa],void 0!==xa)for(La=0;3>La;La++)bb=xa[La],ab[Pa]=bb.x,ab[Pa+1]=bb.y,Pa+=2;0<Pa&&(t.bindBuffer(t.ARRAY_BUFFER,W.__webglUVBuffer),t.bufferData(t.ARRAY_BUFFER,ab,da))}if(mb&&sb&&pa){X=0;for(ma=na.length;X<ma;X++)if(sa=na[X],ya=sb[sa],void 0!==ya)for(La=0;3>La;La++)fb=ya[La],cb[Ra]=fb.x,cb[Ra+1]=fb.y,Ra+=2;0<Ra&&(t.bindBuffer(t.ARRAY_BUFFER,
W.__webglUV2Buffer),t.bufferData(t.ARRAY_BUFFER,cb,da))}if(ob){X=0;for(ma=na.length;X<ma;X++)db[Ua]=va,db[Ua+1]=va+1,db[Ua+2]=va+2,Ua+=3,Xa[Ka]=va,Xa[Ka+1]=va+1,Xa[Ka+2]=va,Xa[Ka+3]=va+2,Xa[Ka+4]=va+1,Xa[Ka+5]=va+2,Ka+=6,va+=3;t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,W.__webglFaceBuffer);t.bufferData(t.ELEMENT_ARRAY_BUFFER,db,da);t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,W.__webglLineBuffer);t.bufferData(t.ELEMENT_ARRAY_BUFFER,Xa,da)}if(gb)for(La=0,Qa=gb.length;La<Qa;La++)if(O=gb[La],O.__original.needsUpdate){T=
0;if(1===O.size)if(void 0===O.boundTo||"vertices"===O.boundTo)for(X=0,ma=na.length;X<ma;X++)ta=xb[na[X]],O.array[T]=O.value[ta.a],O.array[T+1]=O.value[ta.b],O.array[T+2]=O.value[ta.c],T+=3;else{if("faces"===O.boundTo)for(X=0,ma=na.length;X<ma;X++)$a=O.value[na[X]],O.array[T]=$a,O.array[T+1]=$a,O.array[T+2]=$a,T+=3}else if(2===O.size)if(void 0===O.boundTo||"vertices"===O.boundTo)for(X=0,ma=na.length;X<ma;X++)ta=xb[na[X]],ga=O.value[ta.a],ha=O.value[ta.b],ia=O.value[ta.c],O.array[T]=ga.x,O.array[T+
1]=ga.y,O.array[T+2]=ha.x,O.array[T+3]=ha.y,O.array[T+4]=ia.x,O.array[T+5]=ia.y,T+=6;else{if("faces"===O.boundTo)for(X=0,ma=na.length;X<ma;X++)ia=ha=ga=$a=O.value[na[X]],O.array[T]=ga.x,O.array[T+1]=ga.y,O.array[T+2]=ha.x,O.array[T+3]=ha.y,O.array[T+4]=ia.x,O.array[T+5]=ia.y,T+=6}else if(3===O.size){var ua;ua="c"===O.type?["r","g","b"]:["x","y","z"];if(void 0===O.boundTo||"vertices"===O.boundTo)for(X=0,ma=na.length;X<ma;X++)ta=xb[na[X]],ga=O.value[ta.a],ha=O.value[ta.b],ia=O.value[ta.c],O.array[T]=
ga[ua[0]],O.array[T+1]=ga[ua[1]],O.array[T+2]=ga[ua[2]],O.array[T+3]=ha[ua[0]],O.array[T+4]=ha[ua[1]],O.array[T+5]=ha[ua[2]],O.array[T+6]=ia[ua[0]],O.array[T+7]=ia[ua[1]],O.array[T+8]=ia[ua[2]],T+=9;else if("faces"===O.boundTo)for(X=0,ma=na.length;X<ma;X++)ia=ha=ga=$a=O.value[na[X]],O.array[T]=ga[ua[0]],O.array[T+1]=ga[ua[1]],O.array[T+2]=ga[ua[2]],O.array[T+3]=ha[ua[0]],O.array[T+4]=ha[ua[1]],O.array[T+5]=ha[ua[2]],O.array[T+6]=ia[ua[0]],O.array[T+7]=ia[ua[1]],O.array[T+8]=ia[ua[2]],T+=9;else if("faceVertices"===
O.boundTo)for(X=0,ma=na.length;X<ma;X++)$a=O.value[na[X]],ga=$a[0],ha=$a[1],ia=$a[2],O.array[T]=ga[ua[0]],O.array[T+1]=ga[ua[1]],O.array[T+2]=ga[ua[2]],O.array[T+3]=ha[ua[0]],O.array[T+4]=ha[ua[1]],O.array[T+5]=ha[ua[2]],O.array[T+6]=ia[ua[0]],O.array[T+7]=ia[ua[1]],O.array[T+8]=ia[ua[2]],T+=9}else if(4===O.size)if(void 0===O.boundTo||"vertices"===O.boundTo)for(X=0,ma=na.length;X<ma;X++)ta=xb[na[X]],ga=O.value[ta.a],ha=O.value[ta.b],ia=O.value[ta.c],O.array[T]=ga.x,O.array[T+1]=ga.y,O.array[T+2]=
ga.z,O.array[T+3]=ga.w,O.array[T+4]=ha.x,O.array[T+5]=ha.y,O.array[T+6]=ha.z,O.array[T+7]=ha.w,O.array[T+8]=ia.x,O.array[T+9]=ia.y,O.array[T+10]=ia.z,O.array[T+11]=ia.w,T+=12;else if("faces"===O.boundTo)for(X=0,ma=na.length;X<ma;X++)ia=ha=ga=$a=O.value[na[X]],O.array[T]=ga.x,O.array[T+1]=ga.y,O.array[T+2]=ga.z,O.array[T+3]=ga.w,O.array[T+4]=ha.x,O.array[T+5]=ha.y,O.array[T+6]=ha.z,O.array[T+7]=ha.w,O.array[T+8]=ia.x,O.array[T+9]=ia.y,O.array[T+10]=ia.z,O.array[T+11]=ia.w,T+=12;else if("faceVertices"===
O.boundTo)for(X=0,ma=na.length;X<ma;X++)$a=O.value[na[X]],ga=$a[0],ha=$a[1],ia=$a[2],O.array[T]=ga.x,O.array[T+1]=ga.y,O.array[T+2]=ga.z,O.array[T+3]=ga.w,O.array[T+4]=ha.x,O.array[T+5]=ha.y,O.array[T+6]=ha.z,O.array[T+7]=ha.w,O.array[T+8]=ia.x,O.array[T+9]=ia.y,O.array[T+10]=ia.z,O.array[T+11]=ia.w,T+=12;t.bindBuffer(t.ARRAY_BUFFER,O.buffer);t.bufferData(t.ARRAY_BUFFER,O.array,da)}ea&&(delete W.__inittedArrays,delete W.__colorArray,delete W.__normalArray,delete W.__tangentArray,delete W.__uvArray,
delete W.__uv2Array,delete W.__faceArray,delete W.__vertexArray,delete W.__lineArray,delete W.__skinIndexArray,delete W.__skinWeightArray)}}}B.verticesNeedUpdate=!1;B.morphTargetsNeedUpdate=!1;B.elementsNeedUpdate=!1;B.uvsNeedUpdate=!1;B.normalsNeedUpdate=!1;B.colorsNeedUpdate=!1;B.tangentsNeedUpdate=!1;C.attributes&&z(C)}else if(g instanceof THREE.Line){C=c(g,B);E=C.attributes&&w(C);if(B.verticesNeedUpdate||B.colorsNeedUpdate||B.lineDistancesNeedUpdate||E){var nb=t.DYNAMIC_DRAW,jb,Hb,Ib,tb,ra,ub,
Bb=B.vertices,Eb=B.colors,Fb=B.lineDistances,Kb=Bb.length,Lb=Eb.length,Qb=Fb.length,Mb=B.__vertexArray,Nb=B.__colorArray,Jb=B.__lineDistanceArray,Rb=B.colorsNeedUpdate,Sb=B.lineDistancesNeedUpdate,Tb=B.__webglCustomAttributesList,Ob,Xb,Fa,Db,Za,oa;if(B.verticesNeedUpdate){for(jb=0;jb<Kb;jb++)tb=Bb[jb],ra=3*jb,Mb[ra]=tb.x,Mb[ra+1]=tb.y,Mb[ra+2]=tb.z;t.bindBuffer(t.ARRAY_BUFFER,B.__webglVertexBuffer);t.bufferData(t.ARRAY_BUFFER,Mb,nb)}if(Rb){for(Hb=0;Hb<Lb;Hb++)ub=Eb[Hb],ra=3*Hb,Nb[ra]=ub.r,Nb[ra+1]=
ub.g,Nb[ra+2]=ub.b;t.bindBuffer(t.ARRAY_BUFFER,B.__webglColorBuffer);t.bufferData(t.ARRAY_BUFFER,Nb,nb)}if(Sb){for(Ib=0;Ib<Qb;Ib++)Jb[Ib]=Fb[Ib];t.bindBuffer(t.ARRAY_BUFFER,B.__webglLineDistanceBuffer);t.bufferData(t.ARRAY_BUFFER,Jb,nb)}if(Tb)for(Ob=0,Xb=Tb.length;Ob<Xb;Ob++)if(oa=Tb[Ob],oa.needsUpdate&&(void 0===oa.boundTo||"vertices"===oa.boundTo)){ra=0;Db=oa.value.length;if(1===oa.size)for(Fa=0;Fa<Db;Fa++)oa.array[Fa]=oa.value[Fa];else if(2===oa.size)for(Fa=0;Fa<Db;Fa++)Za=oa.value[Fa],oa.array[ra]=
Za.x,oa.array[ra+1]=Za.y,ra+=2;else if(3===oa.size)if("c"===oa.type)for(Fa=0;Fa<Db;Fa++)Za=oa.value[Fa],oa.array[ra]=Za.r,oa.array[ra+1]=Za.g,oa.array[ra+2]=Za.b,ra+=3;else for(Fa=0;Fa<Db;Fa++)Za=oa.value[Fa],oa.array[ra]=Za.x,oa.array[ra+1]=Za.y,oa.array[ra+2]=Za.z,ra+=3;else if(4===oa.size)for(Fa=0;Fa<Db;Fa++)Za=oa.value[Fa],oa.array[ra]=Za.x,oa.array[ra+1]=Za.y,oa.array[ra+2]=Za.z,oa.array[ra+3]=Za.w,ra+=4;t.bindBuffer(t.ARRAY_BUFFER,oa.buffer);t.bufferData(t.ARRAY_BUFFER,oa.array,nb)}}B.verticesNeedUpdate=
!1;B.colorsNeedUpdate=!1;B.lineDistancesNeedUpdate=!1;C.attributes&&z(C)}else g instanceof THREE.PointCloud&&(C=c(g,B),E=C.attributes&&w(C),(B.verticesNeedUpdate||B.colorsNeedUpdate||g.sortParticles||E)&&setParticleBuffers(B,t.DYNAMIC_DRAW,g),B.verticesNeedUpdate=!1,B.colorsNeedUpdate=!1,C.attributes&&z(C));for(var Ab=0,Ub=D.length;Ab<Ub;Ab++){var Pb=D[Ab],yb=Pb,Yb=yb.object,Zb=yb.buffer,$b=Yb.geometry,zb=Yb.material;zb instanceof THREE.MeshFaceMaterial?(zb=zb.materials[$b instanceof THREE.BufferGeometry?
0:Zb.materialIndex],yb.material=zb,zb.transparent?ca.push(yb):ka.push(yb)):zb&&(yb.material=zb,zb.transparent?ca.push(yb):ka.push(yb));Pb.render=!0;!0===Z.sortObjects&&(null!==g.renderDepth?Pb.z=g.renderDepth:(za.setFromMatrixPosition(g.matrixWorld),za.applyProjection(lb),Pb.z=za.z))}}}}if(g.children)for(Ab=0,Ub=g.children.length;Ab<Ub;Ab++)n(a,g.children[Ab])}}function q(){Da=Aa=null;ea=fa=Ya=Ha=sa=Wa=fb=-1;cb=!0}function r(a,b,c,d,f,g){for(var h,k=0,l=a.length;k<l;k++){h=a[k];var m=h.object,n=h.buffer,
p=m;p._modelViewMatrix.multiplyMatrices(b.matrixWorldInverse,p.matrixWorld);p._normalMatrix.getNormalMatrix(p._modelViewMatrix);if(g)h=g;else{h=h.material;if(!h)continue;f&&Z.setBlending(h.blending,h.blendEquation,h.blendSrc,h.blendDst);Z.setDepthTest(h.depthTest);Z.setDepthWrite(h.depthWrite);G(h.polygonOffset,h.polygonOffsetFactor,h.polygonOffsetUnits)}Z.setMaterialFaces(h);n instanceof THREE.BufferGeometry?Z.renderBufferDirect(b,c,d,h,n,m):Z.renderBuffer(b,c,d,h,n,m)}}function v(a,c,d){var f=c.material;
a=!1;if(void 0===Gb[d.id]||!0===d.groupsNeedUpdate){delete V[c.id];a=Gb;for(var g=d.id,f=f instanceof THREE.MeshFaceMaterial,h=nb?4294967296:65535,k,l={},m=d.morphTargets.length,n=d.morphNormals.length,p,q={},K=[],r=0,v=d.faces.length;r<v;r++){k=d.faces[r];var F=f?k.materialIndex:0;F in l||(l[F]={hash:F,counter:0});k=l[F].hash+"_"+l[F].counter;k in q||(p={id:Qb++,faces3:[],materialIndex:F,vertices:0,numMorphTargets:m,numMorphNormals:n},q[k]=p,K.push(p));q[k].vertices+3>h&&(l[F].counter+=1,k=l[F].hash+
"_"+l[F].counter,k in q||(p={id:Qb++,faces3:[],materialIndex:F,vertices:0,numMorphTargets:m,numMorphNormals:n},q[k]=p,K.push(p)));q[k].faces3.push(r);q[k].vertices+=3}a[g]=K;d.groupsNeedUpdate=!1}g=Gb[d.id];f=0;for(h=g.length;f<h;f++)l=g[f],void 0===l.__webglVertexBuffer?(a=l,a.__webglVertexBuffer=t.createBuffer(),a.__webglNormalBuffer=t.createBuffer(),a.__webglTangentBuffer=t.createBuffer(),a.__webglColorBuffer=t.createBuffer(),a.__webglUVBuffer=t.createBuffer(),a.__webglUV2Buffer=t.createBuffer(),
a.__webglSkinIndicesBuffer=t.createBuffer(),a.__webglSkinWeightsBuffer=t.createBuffer(),a.__webglFaceBuffer=t.createBuffer(),a.__webglLineBuffer=t.createBuffer(),Z.info.memory.geometries++,b(l,c),d.verticesNeedUpdate=!0,d.morphTargetsNeedUpdate=!0,d.elementsNeedUpdate=!0,d.uvsNeedUpdate=!0,d.normalsNeedUpdate=!0,d.tangentsNeedUpdate=!0,a=d.colorsNeedUpdate=!0):a=!1,(a||void 0===c.__webglActive)&&s(V,l,c);c.__webglActive=!0}function s(a,b,c){var d=c.id;a[d]=a[d]||[];a[d].push({id:d,buffer:b,object:c,
material:null,z:0})}function w(a){for(var b in a.attributes)if(a.attributes[b].needsUpdate)return!0;return!1}function z(a){for(var b in a.attributes)a.attributes[b].needsUpdate=!1}function D(a,b,c,d,f){qa=0;if(d.needsUpdate){d.program&&Jb(d);d.addEventListener("dispose",Kb);var g;d instanceof THREE.MeshDepthMaterial?g="depth":d instanceof THREE.MeshNormalMaterial?console.log("MeshNormalMaterial is turned off."):d instanceof THREE.MeshBasicMaterial?g="basic":d instanceof THREE.MeshLambertMaterial?
console.log("MeshLambertMaterial is turned off."):d instanceof THREE.MeshPhongMaterial?g="firefly_phong":d instanceof THREE.LineBasicMaterial?g="basic":d instanceof THREE.LineDashedMaterial&&(g="dashed");if(g){var h=THREE.ShaderLib[g];d.__webglShader={uniforms:THREE.UniformsUtils.clone(h.uniforms),vertexShader:h.vertexShader,fragmentShader:h.fragmentShader}}else d.__webglShader={uniforms:d.uniforms,vertexShader:d.vertexShader,fragmentShader:d.fragmentShader};for(var k=h=0,l=0,m=0,n=0,p=b.length;n<
p;n++){var q=b[n];q.onlyShadow||(q instanceof THREE.DirectionalLight&&h++,q instanceof THREE.PointLight&&k++,q instanceof THREE.SpotLight&&l++,q instanceof THREE.HemisphereLight&&m++)}p=n=0;for(q=b.length;p<q;p++){var K=b[p];K.castShadow&&(K instanceof THREE.SpotLight&&n++,K instanceof THREE.DirectionalLight&&!K.shadowCascade&&n++)}h={precision:F,supportsVertexTextures:db,haveTextureLod:!!pb,map:!!d.map,envMap:!!d.envMap,irradianceMap:!!d.irradianceMap,envIsSpherical:d.envMap&&d.envMap.mapping instanceof
THREE.SphericalReflectionMapping,envLogLuv:d.envMap&&d.envMap.LogLuv,irrLogLuv:d.irradianceMap&&d.irradianceMap.LogLuv,lightMap:!!d.lightMap,bumpMap:mb&&!!d.bumpMap,normalMap:mb&&!!d.normalMap,specularMap:!!d.specularMap,alphaMap:!!d.alphaMap,vertexColors:d.vertexColors,fog:c,useFog:d.fog,fogExp:c instanceof THREE.FogExp2,sizeAttenuation:d.sizeAttenuation,logarithmicDepthBuffer:ba,useFragDepthExt:jb,maxDirLights:h,maxPointLights:k,maxSpotLights:l,maxHemiLights:m,maxShadows:n,shadowMapEnabled:Z.shadowMapEnabled&&
f.receiveShadow,shadowMapType:Z.shadowMapType,shadowMapDebug:Z.shadowMapDebug,shadowMapCascade:Z.shadowMapCascade,alphaTest:d.alphaTest,metal:d.metal,clearcoat:d.clearcoat,wrapAround:d.wrapAround,doubleSided:d.side===THREE.DoubleSide,flipSided:d.side===THREE.BackSide,mrtNormals:Pa&&d.mrtNormals,tonemapOutput:d.tonemapOutput,numCutplanes:d.cutplanes?d.cutplanes.length:0};k=[];g?k.push(g):(k.push(d.fragmentShader),k.push(d.vertexShader));for(var r in d.defines)k.push(r),k.push(d.defines[r]);for(var v in h)k.push(v),
k.push(h[v]);g=k.join();var s;v=0;for(r=la.length;v<r;v++)if(k=la[v],k.code===g){s=k;s.usedTimes++;break}void 0===s&&(s=new FireflyWebGLProgram(Z,g,d,h),la.push(s),Z.info.memory.programs=la.length);d.program=s;d.uniformsList=[];for(u in d.__webglShader.uniforms)(v=d.program.uniforms[u])&&d.uniformsList.push([d.__webglShader.uniforms[u],v]);d.needsUpdate=!1}k=h=r=!1;v=d.program;s=v.uniforms;g=d.__webglShader.uniforms;v.id!==Aa&&(t.useProgram(v.program),Aa=v.id,k=h=r=!0);d.id!==ea&&(-1===ea&&(k=!0),
ea=d.id,h=!0);if(r||a!==Da)if(t.uniformMatrix4fv(s.projectionMatrix,!1,a.projectionMatrix.elements),ba&&t.uniform1f(s.logDepthBufFC,2/(Math.log(a.far+1)/Math.LN2)),a!==Da&&(Da=a),(d instanceof THREE.ShaderMaterial||d instanceof THREE.MeshPhongMaterial||d.envMap)&&null!==s.cameraPosition&&(za.setFromMatrixPosition(a.matrixWorld),t.uniform3f(s.cameraPosition,za.x,za.y,za.z)),d instanceof THREE.MeshPhongMaterial||d instanceof THREE.MeshLambertMaterial||d instanceof THREE.ShaderMaterial||d.skinning)null!==
s.viewMatrix&&t.uniformMatrix4fv(s.viewMatrix,!1,a.matrixWorldInverse.elements),null!==s.viewMatrixInverse&&t.uniformMatrix4fv(s.viewMatrixInverse,!1,sb.elements),s.mvpMatrix&&t.uniformMatrix4fv(s.mvpMatrix,!1,lb.elements);if(h){c&&d.fog&&(g.fogColor.value=c.color,c instanceof THREE.Fog?(g.fogNear.value=c.near,g.fogFar.value=c.far):c instanceof THREE.FogExp2&&(g.fogDensity.value=c.density));if(d instanceof THREE.MeshPhongMaterial||d instanceof THREE.MeshLambertMaterial||d.lights)cb&&(k=!0,J(b),cb=
!1),k?(c=tb,g.ambientLightColor.value=c.ambient,g.directionalLightColor.value=c.directional.colors,g.directionalLightDirection.value=c.directional.positions,g.pointLightColor.value=c.point.colors,g.pointLightPosition.value=c.point.positions,g.pointLightDistance.value=c.point.distances,g.spotLightColor.value=c.spot.colors,g.spotLightPosition.value=c.spot.positions,g.spotLightDistance.value=c.spot.distances,g.spotLightDirection.value=c.spot.directions,g.spotLightAngleCos.value=c.spot.anglesCos,g.spotLightExponent.value=
c.spot.exponents,g.hemisphereLightSkyColor.value=c.hemi.skyColors,g.hemisphereLightGroundColor.value=c.hemi.groundColors,g.hemisphereLightDirection.value=c.hemi.positions,A(g,!0)):A(g,!1);if(d instanceof THREE.MeshBasicMaterial||d instanceof THREE.MeshLambertMaterial||d instanceof THREE.MeshPhongMaterial){g.opacity.value=d.opacity;Z.gammaInput?g.diffuse.value.copyGammaToLinear(d.color):g.diffuse.value.copy(d.color);g.map.value=d.map;g.lightMap.value=d.lightMap;g.specularMap.value=d.specularMap;g.alphaMap.value=
d.alphaMap;d.bumpMap&&(g.bumpMap.value=d.bumpMap,g.bumpScale.value=d.bumpScale);d.normalMap&&(g.normalMap.value=d.normalMap,g.normalScale.value.copy(d.normalScale));var w;d.map?w=d.map:d.specularMap?w=d.specularMap:d.alphaMap&&(w=d.alphaMap);void 0!==w&&(c=w.offset,w=w.repeat,g.offsetRepeat.value.set(c.x,c.y,w.x,w.y));var B;d.normalMap?B=d.normalMap:d.bumpMap&&(B=d.bumpMap);void 0!==B&&(c=B.offset,w=B.repeat,g.offsetRepeatBump.value.set(c.x,c.y,w.x,w.y));d.alphaMap&&(c=d.alphaMap.offset,w=d.alphaMap.repeat,
g.offsetRepeatAlpha.value.set(c.x,c.y,w.x,w.y));g.envMap.value=d.envMap;g.irradianceMap&&(g.irradianceMap.value=d.irradianceMap);g.reflectivity.value=Z.gammaInput?d.reflectivity*d.reflectivity:d.reflectivity;g.refractionRatio.value=d.refractionRatio;g.combine.value=d.combine;g.useRefract.value=d.envMap&&d.envMap.mapping instanceof THREE.CubeRefractionMapping}d instanceof THREE.LineBasicMaterial?(g.diffuse.value=d.color,g.opacity.value=d.opacity):d instanceof THREE.LineDashedMaterial?(g.diffuse.value=
d.color,g.opacity.value=d.opacity,g.dashSize.value=d.dashSize,g.totalSize.value=d.dashSize+d.gapSize,g.scale.value=d.scale):d instanceof THREE.MeshPhongMaterial?(g.shininess.value=d.shininess,Z.gammaInput?(g.ambient.value.copyGammaToLinear(d.ambient),g.emissive.value.copyGammaToLinear(d.emissive),g.specular.value.copyGammaToLinear(d.specular)):(g.ambient.value.copy(d.ambient),g.emissive.value.copy(d.emissive),g.specular.value.copy(d.specular)),d.wrapAround&&g.wrapRGB.value.copy(d.wrapRGB),g.exposureBias.value=
d.exposureBias,d.cutplanes&&(g.cutplanes.value=d.cutplanes.slice())):d instanceof THREE.MeshLambertMaterial?(Z.gammaInput?(g.ambient.value.copyGammaToLinear(d.ambient),g.emissive.value.copyGammaToLinear(d.emissive)):(g.ambient.value.copy(d.ambient),g.emissive.value.copy(d.emissive)),d.wrapAround&&g.wrapRGB.value.copy(d.wrapRGB)):d instanceof THREE.MeshDepthMaterial?(g.mNear.value=a.near,g.mFar.value=a.far,g.opacity.value=d.opacity):d instanceof THREE.MeshNormalMaterial&&(g.opacity.value=d.opacity);
if(f.receiveShadow&&!d._shadowPass&&g.shadowMatrix)for(B=a=0,w=b.length;B<w;B++)c=b[B],c.castShadow&&(c instanceof THREE.SpotLight||c instanceof THREE.DirectionalLight&&!c.shadowCascade)&&(g.shadowMap.value[a]=c.shadowMap,g.shadowMapSize.value[a]=c.shadowMapSize,g.shadowMatrix.value[a]=c.shadowMatrix,g.shadowDarkness.value[a]=c.shadowDarkness,g.shadowBias.value[a]=c.shadowBias,a++);b=d.uniformsList;d=0;for(a=b.length;d<a;d++)if(B=b[d][0],!1!==B.needsUpdate)switch(c=B.type,r=B.value,w=b[d][1],c){case "1i":t.uniform1i(w,
r);break;case "1f":t.uniform1f(w,r);break;case "2f":t.uniform2f(w,r[0],r[1]);break;case "3f":t.uniform3f(w,r[0],r[1],r[2]);break;case "4f":t.uniform4f(w,r[0],r[1],r[2],r[3]);break;case "1iv":t.uniform1iv(w,r);break;case "3iv":t.uniform3iv(w,r);break;case "1fv":t.uniform1fv(w,r);break;case "2fv":t.uniform2fv(w,r);break;case "3fv":t.uniform3fv(w,r);break;case "4fv":t.uniform4fv(w,r);break;case "Matrix3fv":t.uniformMatrix3fv(w,!1,r);break;case "Matrix4fv":t.uniformMatrix4fv(w,!1,r);break;case "i":t.uniform1i(w,
r);break;case "f":t.uniform1f(w,r);break;case "v2":t.uniform2f(w,r.x,r.y);break;case "v3":t.uniform3f(w,r.x,r.y,r.z);break;case "v4":t.uniform4f(w,r.x,r.y,r.z,r.w);break;case "c":t.uniform3f(w,r.r,r.g,r.b);break;case "iv1":t.uniform1iv(w,r);break;case "iv":t.uniform3iv(w,r);break;case "fv1":t.uniform1fv(w,r);break;case "fv":t.uniform3fv(w,r);break;case "v2v":void 0===B._array&&(B._array=new Float32Array(2*r.length));c=0;for(g=r.length;c<g;c++)h=2*c,B._array[h]=r[c].x,B._array[h+1]=r[c].y;t.uniform2fv(w,
B._array);break;case "v3v":void 0===B._array&&(B._array=new Float32Array(3*r.length));c=0;for(g=r.length;c<g;c++)h=3*c,B._array[h]=r[c].x,B._array[h+1]=r[c].y,B._array[h+2]=r[c].z;t.uniform3fv(w,B._array);break;case "v4v":void 0===B._array&&(B._array=new Float32Array(4*r.length));c=0;for(g=r.length;c<g;c++)h=4*c,B._array[h]=r[c].x,B._array[h+1]=r[c].y,B._array[h+2]=r[c].z,B._array[h+3]=r[c].w;t.uniform4fv(w,B._array);break;case "m3":t.uniformMatrix3fv(w,!1,r.elements);break;case "m3v":void 0===B._array&&
(B._array=new Float32Array(9*r.length));c=0;for(g=r.length;c<g;c++)r[c].flattenToArrayOffset(B._array,9*c);t.uniformMatrix3fv(w,!1,B._array);break;case "m4":t.uniformMatrix4fv(w,!1,r.elements);break;case "m4v":void 0===B._array&&(B._array=new Float32Array(16*r.length));c=0;for(g=r.length;c<g;c++)r[c].flattenToArrayOffset(B._array,16*c);t.uniformMatrix4fv(w,!1,B._array);break;case "t":h=r;r=E();t.uniform1i(w,r);if(!h)continue;if(h instanceof THREE.CubeTexture||h.image instanceof Array&&6===h.image.length){if(B=
h,w=r,6===B.image.length)if(B.needsUpdate){B.image.__webglTextureCube||(B.addEventListener("dispose",Bb),B.image.__webglTextureCube=t.createTexture(),Z.info.memory.textures++);t.activeTexture(t.TEXTURE0+w);t.bindTexture(t.TEXTURE_CUBE_MAP,B.image.__webglTextureCube);t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,B.flipY);w=B instanceof THREE.CompressedTexture;c=B.image[0]instanceof THREE.DataTexture;g=[];for(r=0;6>r;r++)h=g,k=r,!Z.autoScaleCubemaps||w||c?l=c?B.image[r].image:B.image[r]:(l=B.image[r],n=rb,l.width<=
n&&l.height<=n||(p=Math.max(l.width,l.height),m=Math.floor(l.width*n/p),n=Math.floor(l.height*n/p),p=document.createElement("canvas"),p.width=m,p.height=n,p.getContext("2d").drawImage(l,0,0,l.width,l.height,0,0,m,n),l=p)),h[k]=l;r=g[0];h=THREE.Math.isPowerOfTwo(r.width)&&THREE.Math.isPowerOfTwo(r.height);k=C(B.format);l=C(B.type);I(t.TEXTURE_CUBE_MAP,B,h&&l!=t.FLOAT);for(r=0;6>r;r++)if(w)for(n=g[r].mipmaps,p=0,q=n.length;p<q;p++)m=n[p],B.format!==THREE.RGBAFormat?t.compressedTexImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+
r,p,k,m.width,m.height,0,m.data):t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+r,p,k,m.width,m.height,0,k,l,m.data);else c?t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+r,0,k,g[r].width,g[r].height,0,k,l,g[r].data):t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+r,0,k,k,l,g[r]);B.generateMipmaps&&h&&t.generateMipmap(t.TEXTURE_CUBE_MAP);B.needsUpdate=!1;if(B.onUpdate)B.onUpdate()}else t.activeTexture(t.TEXTURE0+w),t.bindTexture(t.TEXTURE_CUBE_MAP,B.image.__webglTextureCube)}else h instanceof THREE.WebGLRenderTargetCube?
setCubeTextureDynamic(h,r):Z.setTexture(h,r);break;case "tv":void 0===B._array&&(B._array=[]);c=0;for(g=B.value.length;c<g;c++)B._array[c]=E();t.uniform1iv(w,B._array);c=0;for(g=B.value.length;c<g;c++)h=B.value[c],r=B._array[c],h&&Z.setTexture(h,r);break;default:console.warn("THREE.WebGLRenderer: Unknown uniform type: "+c)}}t.uniformMatrix4fv(s.modelViewMatrix,!1,f._modelViewMatrix.elements);s.normalMatrix&&t.uniformMatrix3fv(s.normalMatrix,!1,f._normalMatrix.elements);null!==s.modelMatrix&&t.uniformMatrix4fv(s.modelMatrix,
!1,f.matrixWorld.elements);return v}function A(a,b){a.ambientLightColor.needsUpdate=b;a.directionalLightColor.needsUpdate=b;a.directionalLightDirection.needsUpdate=b;a.pointLightColor.needsUpdate=b;a.pointLightPosition.needsUpdate=b;a.pointLightDistance.needsUpdate=b;a.spotLightColor.needsUpdate=b;a.spotLightPosition.needsUpdate=b;a.spotLightDistance.needsUpdate=b;a.spotLightDirection.needsUpdate=b;a.spotLightAngleCos.needsUpdate=b;a.spotLightExponent.needsUpdate=b;a.hemisphereLightSkyColor.needsUpdate=
b;a.hemisphereLightGroundColor.needsUpdate=b;a.hemisphereLightDirection.needsUpdate=b}function E(){var a=qa;a>=ob&&console.warn("WebGLRenderer: trying to use "+a+" texture units while this GPU supports only "+ob);qa+=1;return a}function N(a,b,c,d){a[b]=c.r*c.r*d;a[b+1]=c.g*c.g*d;a[b+2]=c.b*c.b*d}function H(a,b,c,d){a[b]=c.r*d;a[b+1]=c.g*d;a[b+2]=c.b*d}function J(a){var b,c,d,f=0,g=0,h=0,k,l,m,n=tb,p=n.directional.colors,q=n.directional.positions,r=n.point.colors,K=n.point.positions,v=n.point.distances,
s=n.spot.colors,t=n.spot.positions,F=n.spot.distances,w=n.spot.directions,B=n.spot.anglesCos,A=n.spot.exponents,z=n.hemi.skyColors,D=n.hemi.groundColors,aa=n.hemi.positions,Q=0,E=0,C=0,R=0,V=0,J=0,P=0,G=0,S=d=0;b=m=S=0;for(c=a.length;b<c;b++)d=a[b],d.onlyShadow||(k=d.color,l=d.intensity,m=d.distance,d instanceof THREE.AmbientLight?d.visible&&(Z.gammaInput?(f+=k.r*k.r,g+=k.g*k.g,h+=k.b*k.b):(f+=k.r,g+=k.g,h+=k.b)):d instanceof THREE.DirectionalLight?(V+=1,d.visible&&(ya.setFromMatrixPosition(d.matrixWorld),
za.setFromMatrixPosition(d.target.matrixWorld),ya.sub(za),ya.normalize(),d=3*Q,q[d]=ya.x,q[d+1]=ya.y,q[d+2]=ya.z,Z.gammaInput?N(p,d,k,l*l):H(p,d,k,l),Q+=1)):d instanceof THREE.PointLight?(J+=1,d.visible&&(S=3*E,Z.gammaInput?N(r,S,k,l*l):H(r,S,k,l),za.setFromMatrixPosition(d.matrixWorld),K[S]=za.x,K[S+1]=za.y,K[S+2]=za.z,v[E]=m,E+=1)):d instanceof THREE.SpotLight?(P+=1,d.visible&&(S=3*C,Z.gammaInput?N(s,S,k,l*l):H(s,S,k,l),za.setFromMatrixPosition(d.matrixWorld),t[S]=za.x,t[S+1]=za.y,t[S+2]=za.z,F[C]=
m,ya.copy(za),za.setFromMatrixPosition(d.target.matrixWorld),ya.sub(za),ya.normalize(),w[S]=ya.x,w[S+1]=ya.y,w[S+2]=ya.z,B[C]=Math.cos(d.angle),A[C]=d.exponent,C+=1)):d instanceof THREE.HemisphereLight&&(G+=1,d.visible&&(ya.setFromMatrixPosition(d.matrixWorld),ya.normalize(),m=3*R,aa[m]=ya.x,aa[m+1]=ya.y,aa[m+2]=ya.z,k=d.color,d=d.groundColor,Z.gammaInput?(l*=l,N(z,m,k,l),N(D,m,d,l)):(H(z,m,k,l),H(D,m,d,l)),R+=1)));b=3*Q;for(c=Math.max(p.length,3*V);b<c;b++)p[b]=0;b=3*E;for(c=Math.max(r.length,3*
J);b<c;b++)r[b]=0;b=3*C;for(c=Math.max(s.length,3*P);b<c;b++)s[b]=0;b=3*R;for(c=Math.max(z.length,3*G);b<c;b++)z[b]=0;b=3*R;for(c=Math.max(D.length,3*G);b<c;b++)D[b]=0;n.directional.length=Q;n.point.length=E;n.spot.length=C;n.hemi.length=R;n.ambient[0]=f;n.ambient[1]=g;n.ambient[2]=h}function G(a,b,c){Ia!==a&&(a?t.enable(t.POLYGON_OFFSET_FILL):t.disable(t.POLYGON_OFFSET_FILL),Ia=a);!a||da===b&&pa===c||(t.polygonOffset(b,c),da=b,pa=c)}function I(a,b,c){c?(t.texParameteri(a,t.TEXTURE_WRAP_S,C(b.wrapS)),
t.texParameteri(a,t.TEXTURE_WRAP_T,C(b.wrapT)),t.texParameteri(a,t.TEXTURE_MAG_FILTER,C(b.magFilter)),t.texParameteri(a,t.TEXTURE_MIN_FILTER,C(b.minFilter))):(t.texParameteri(a,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(a,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(a,t.TEXTURE_MAG_FILTER,M(b.magFilter)),t.texParameteri(a,t.TEXTURE_MIN_FILTER,M(b.minFilter)));Xa&&b.type!==THREE.FloatType&&(1<b.anisotropy||b.__oldAnisotropy)&&(t.texParameterf(a,Xa.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(b.anisotropy,
Ja)),b.__oldAnisotropy=b.anisotropy)}function M(a){return a===THREE.NearestFilter||a===THREE.NearestMipMapNearestFilter||a===THREE.NearestMipMapLinearFilter?t.NEAREST:t.LINEAR}function C(a){if(a===THREE.RepeatWrapping)return t.REPEAT;if(a===THREE.ClampToEdgeWrapping)return t.CLAMP_TO_EDGE;if(a===THREE.MirroredRepeatWrapping)return t.MIRRORED_REPEAT;if(a===THREE.NearestFilter)return t.NEAREST;if(a===THREE.NearestMipMapNearestFilter)return t.NEAREST_MIPMAP_NEAREST;if(a===THREE.NearestMipMapLinearFilter)return t.NEAREST_MIPMAP_LINEAR;
if(a===THREE.LinearFilter)return t.LINEAR;if(a===THREE.LinearMipMapNearestFilter)return t.LINEAR_MIPMAP_NEAREST;if(a===THREE.LinearMipMapLinearFilter)return t.LINEAR_MIPMAP_LINEAR;if(a===THREE.UnsignedByteType)return t.UNSIGNED_BYTE;if(a===THREE.UnsignedShort4444Type)return t.UNSIGNED_SHORT_4_4_4_4;if(a===THREE.UnsignedShort5551Type)return t.UNSIGNED_SHORT_5_5_5_1;if(a===THREE.UnsignedShort565Type)return t.UNSIGNED_SHORT_5_6_5;if(a===THREE.ByteType)return t.BYTE;if(a===THREE.ShortType)return t.SHORT;
if(a===THREE.UnsignedShortType)return t.UNSIGNED_SHORT;if(a===THREE.IntType)return t.INT;if(a===THREE.UnsignedIntType)return t.UNSIGNED_INT;if(a===THREE.FloatType)return t.FLOAT;if(a===THREE.HalfFloatType)return 36193;if(a===THREE.AlphaFormat)return t.ALPHA;if(a===THREE.RGBFormat)return t.RGB;if(a===THREE.RGBAFormat)return t.RGBA;if(a===THREE.LuminanceFormat)return t.LUMINANCE;if(a===THREE.LuminanceAlphaFormat)return t.LUMINANCE_ALPHA;if(a===THREE.AddEquation)return t.FUNC_ADD;if(a===THREE.SubtractEquation)return t.FUNC_SUBTRACT;
if(a===THREE.ReverseSubtractEquation)return t.FUNC_REVERSE_SUBTRACT;if(a===THREE.ZeroFactor)return t.ZERO;if(a===THREE.OneFactor)return t.ONE;if(a===THREE.SrcColorFactor)return t.SRC_COLOR;if(a===THREE.OneMinusSrcColorFactor)return t.ONE_MINUS_SRC_COLOR;if(a===THREE.SrcAlphaFactor)return t.SRC_ALPHA;if(a===THREE.OneMinusSrcAlphaFactor)return t.ONE_MINUS_SRC_ALPHA;if(a===THREE.DstAlphaFactor)return t.DST_ALPHA;if(a===THREE.OneMinusDstAlphaFactor)return t.ONE_MINUS_DST_ALPHA;if(a===THREE.DstColorFactor)return t.DST_COLOR;
if(a===THREE.OneMinusDstColorFactor)return t.ONE_MINUS_DST_COLOR;if(a===THREE.SrcAlphaSaturateFactor)return t.SRC_ALPHA_SATURATE;if(void 0!==Ra&&null!==Ra){if(a===THREE.RGB_S3TC_DXT1_Format)return Ra.COMPRESSED_RGB_S3TC_DXT1_EXT;if(a===THREE.RGBA_S3TC_DXT1_Format)return Ra.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(a===THREE.RGBA_S3TC_DXT3_Format)return Ra.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(a===THREE.RGBA_S3TC_DXT5_Format)return Ra.COMPRESSED_RGBA_S3TC_DXT5_EXT}return 0}console.log("THREE.WebGLRenderer",THREE.REVISION);
a=a||{};var K=void 0!==a.canvas?a.canvas:document.createElement("canvas"),F=void 0!==a.precision?a.precision:"highp",B=void 0!==a.alpha?a.alpha:!1,R=void 0!==a.premultipliedAlpha?a.premultipliedAlpha:!0,Y=void 0!==a.antialias?a.antialias:!1,S=void 0!==a.stencil?a.stencil:!0,P=void 0!==a.preserveDrawingBuffer?a.preserveDrawingBuffer:!0,ba=void 0!==a.logarithmicDepthBuffer?a.logarithmicDepthBuffer:!1,U=new THREE.Color(0),W=0,aa=[],V={},Q=[],ka=[],ca=[];this.domElement=K;this.context=null;this.devicePixelRatio=
void 0!==a.devicePixelRatio?a.devicePixelRatio:void 0!==self.devicePixelRatio?self.devicePixelRatio:1;this.sortObjects=this.autoClearStencil=this.autoClearDepth=this.autoClearColor=this.autoClear=!0;this.shadowMapEnabled=this.gammaOutput=this.gammaInput=!1;this.shadowMapAutoUpdate=!0;this.shadowMapType=THREE.PCFShadowMap;this.shadowMapCullFace=THREE.CullFaceFront;this.shadowMapCascade=this.shadowMapDebug=!1;this.maxMorphTargets=8;this.maxMorphNormals=4;this.autoScaleCubemaps=!0;this.renderPluginsPre=
[];this.renderPluginsPost=[];this.info={memory:{programs:0,geometries:0,textures:0},render:{calls:0,vertices:0,faces:0,points:0}};var Z=this,la=[],Aa=null,ja=null,ea=-1,Da=null,fa=null,Ga=null,bb=new THREE.Frustum,Ta=new THREE.Matrix4,xa=new THREE.Matrix4,qa=0,Ha=-1,Ya=-1,fb=-1,Na=-1,Ma=-1,Va=-1,Wa=-1,sa=-1,Ia=null,da=null,pa=null,Oa=null,va=0,Ka=0,Ca=K.width,ab=K.height,Qa=new Uint8Array(16),wa=new Uint8Array(16),gb={},Cb=new THREE.Frustum,lb=new THREE.Matrix4,sb=new THREE.Matrix4,za=new THREE.Vector3,
ya=new THREE.Vector3,cb=!0,tb={ambient:[0,0,0],directional:{length:0,colors:[],positions:[]},point:{length:0,colors:[],positions:[],distances:[]},spot:{length:0,colors:[],positions:[],distances:[],directions:[],anglesCos:[],exponents:[]},hemi:{length:0,skyColors:[],groundColors:[],positions:[]}},t,wb,ub,mb,Xa,Ra,nb,jb,Sa,Ua,pb,Pa=!1;(function(){try{var a={alpha:B,premultipliedAlpha:R,antialias:Y,stencil:S,preserveDrawingBuffer:P};t=K.getContext("webgl",a)||K.getContext("experimental-webgl",a);if(null===
t)throw"Error creating WebGL context.";}catch(b){console.error(b)}wb=t.getExtension("OES_texture_float");ub=t.getExtension("OES_texture_half_float");t.getExtension("OES_texture_float_linear");mb=t.getExtension("OES_standard_derivatives");Sa=t.getExtension("WEBGL_draw_buffers");nb=t.getExtension("OES_element_index_uint");Ua=null;pb=t.getExtension("EXT_shader_texture_lod");Pa=!!Sa;Xa=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");
Ra=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");wb||console.log("THREE.WebGLRenderer: Float textures not supported.");ub||console.log("THREE.WebGLRenderer: Half float textures not supported.");mb||console.log("THREE.WebGLRenderer: Standard derivatives not supported.");Xa||console.log("THREE.WebGLRenderer: Anisotropic texture filtering not supported.");Ra||console.log("THREE.WebGLRenderer: S3TC compressed textures not supported.");
Sa||console.log("THREE.WebGLRenderer: Multiple render targets not supported.");Ua||console.log("THREE.WebGLRenderer: Hardware instancing not supported.");void 0===t.getShaderPrecisionFormat&&(t.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}});ba&&(jb=t.getExtension("EXT_frag_depth"))})();t.clearColor(0,0,0,1);t.clearDepth(1);t.clearStencil(0);t.enable(t.DEPTH_TEST);t.depthFunc(t.LEQUAL);t.frontFace(t.CCW);t.cullFace(t.BACK);t.enable(t.CULL_FACE);t.enable(t.BLEND);t.blendEquation(t.FUNC_ADD);
t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA);t.viewport(va,Ka,Ca,ab);t.clearColor(U.r,U.g,U.b,W);this.context=t;var ob=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),qb=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS);t.getParameter(t.MAX_TEXTURE_SIZE);var rb=t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),Ja=Xa?t.getParameter(Xa.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0,db=0<qb;Ra&&t.getParameter(t.COMPRESSED_TEXTURE_FORMATS);var Ea=t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT),Ba=t.getShaderPrecisionFormat(t.VERTEX_SHADER,
t.MEDIUM_FLOAT);t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.LOW_FLOAT);var vb=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT),Rb=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT);t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.LOW_FLOAT);var Sb=0<Ea.precision&&0<vb.precision,Eb=0<Ba.precision&&0<Rb.precision;"highp"!==F||Sb||(Eb?(F="mediump",console.warn("WebGLRenderer: highp not supported, using mediump")):(F="lowp",console.warn("WebGLRenderer: highp and mediump not supported, using lowp")));
"mediump"!==F||Eb||(F="lowp",console.warn("WebGLRenderer: mediump not supported, using lowp"));this.getContext=function(){return t};this.supportsVertexTextures=function(){return db};this.supportsFloatTextures=function(){return wb};this.supportsStandardDerivatives=function(){return mb};this.supportsCompressedTextureS3TC=function(){return Ra};this.supportsMRT=function(){return Pa};this.getMaxAnisotropy=function(){return Ja};this.getPrecision=function(){return F};this.setSize=function(a,b,c){K.width=
a*this.devicePixelRatio;K.height=b*this.devicePixelRatio;!1!==c&&(K.style.width=a+"px",K.style.height=b+"px");this.setViewport(0,0,a,b)};this.setViewport=function(a,b,c,d){va=a*this.devicePixelRatio;Ka=b*this.devicePixelRatio;Ca=c*this.devicePixelRatio;ab=d*this.devicePixelRatio;t.viewport(va,Ka,Ca,ab)};this.setScissor=function(a,b,c,d){t.scissor(a,b,c,d)};this.enableScissorTest=function(a){a?t.enable(t.SCISSOR_TEST):t.disable(t.SCISSOR_TEST)};this.setClearColor=function(a,b){U.set(a);W=void 0!==
b?b:1;t.clearColor(U.r,U.g,U.b,W)};this.setClearColorHex=function(a,b){console.warn("DEPRECATED: .setClearColorHex() is being removed. Use .setClearColor() instead.");this.setClearColor(a,b)};this.getClearColor=function(){return U};this.getClearAlpha=function(){return W};this.clear=function(a,b,c){var d=0;if(void 0===a||a)d|=t.COLOR_BUFFER_BIT;if(void 0===b||b)d|=t.DEPTH_BUFFER_BIT;if(void 0===c||c)d|=t.STENCIL_BUFFER_BIT;t.clear(d)};this.clearColor=function(){t.clear(t.COLOR_BUFFER_BIT)};this.clearDepth=
function(){t.clear(t.DEPTH_BUFFER_BIT)};this.clearStencil=function(){t.clear(t.STENCIL_BUFFER_BIT)};this.clearTarget=function(a,b,c,d){this.setRenderTarget(a);this.clear(b,c,d)};this.addPostPlugin=function(a){a.init(this,aa,V,Q);this.renderPluginsPost.push(a)};this.addPrePlugin=function(a){a.init(this,aa,V,Q);this.renderPluginsPre.push(a)};this.updateShadowMap=function(a,b){Aa=null;ea=fa=sa=Wa=fb=-1;cb=!0;Ya=Ha=-1;initObjects(a);this.shadowMapPlugin.update(a,b)};var Vb=function(a){a.target.traverse(function(a){a.removeEventListener("remove",
Vb);if(a instanceof THREE.Mesh||a instanceof THREE.PointCloud||a instanceof THREE.Line)delete V[a.id];else if(a instanceof THREE.ImmediateRenderObject||a.immediateRenderCallback)for(var b=Q,c=b.length-1;0<=c;c--)b[c].object===a&&b.splice(c,1);delete a.__webglInit;delete a._modelViewMatrix;delete a._normalMatrix;delete a.__webglActive})},Wb=function(a){a=a.target;a.removeEventListener("dispose",Wb);a.__webglInit=void 0;if(a instanceof THREE.BufferGeometry){void 0!==a.vbbuffer&&t.deleteBuffer(a.vbbuffer);
a=a.attributes;for(var b in a)void 0!==a[b].buffer&&t.deleteBuffer(a[b].buffer);Z.info.memory.geometries--}else if(void 0!==a.geometryGroups){b=0;for(var c=a.geometryGroupsList.length;b<c;b++){var d=a.geometryGroupsList[b];if(void 0!==d.numMorphTargets)for(var f=0,g=d.numMorphTargets;f<g;f++)t.deleteBuffer(d.__webglMorphTargetsBuffers[f]);if(void 0!==d.numMorphNormals)for(f=0,g=d.numMorphNormals;f<g;f++)t.deleteBuffer(d.__webglMorphNormalsBuffers[f]);Lb(d)}}else Lb(a)},Bb=function(a){a=a.target;a.removeEventListener("dispose",
Bb);a.image&&a.image.__webglTextureCube?t.deleteTexture(a.image.__webglTextureCube):a.__webglInit&&(a.__webglInit=!1,t.deleteTexture(a.__webglTexture));Z.info.memory.textures--},Fb=function(a){a=a.target;a.removeEventListener("dispose",Fb);a&&a.__webglTexture&&(t.deleteTexture(a.__webglTexture),t.deleteFramebuffer(a.__webglFramebuffer),t.deleteRenderbuffer(a.__webglRenderbuffer));Z.info.memory.textures--},Kb=function(a){a=a.target;a.removeEventListener("dispose",Kb);Jb(a)},Lb=function(a){void 0!==
a.__webglVertexBuffer&&t.deleteBuffer(a.__webglVertexBuffer);void 0!==a.__webglNormalBuffer&&t.deleteBuffer(a.__webglNormalBuffer);void 0!==a.__webglTangentBuffer&&t.deleteBuffer(a.__webglTangentBuffer);void 0!==a.__webglColorBuffer&&t.deleteBuffer(a.__webglColorBuffer);void 0!==a.__webglUVBuffer&&t.deleteBuffer(a.__webglUVBuffer);void 0!==a.__webglUV2Buffer&&t.deleteBuffer(a.__webglUV2Buffer);void 0!==a.__webglSkinIndicesBuffer&&t.deleteBuffer(a.__webglSkinIndicesBuffer);void 0!==a.__webglSkinWeightsBuffer&&
t.deleteBuffer(a.__webglSkinWeightsBuffer);void 0!==a.__webglFaceBuffer&&t.deleteBuffer(a.__webglFaceBuffer);void 0!==a.__webglLineBuffer&&t.deleteBuffer(a.__webglLineBuffer);void 0!==a.__webglLineDistanceBuffer&&t.deleteBuffer(a.__webglLineDistanceBuffer);if(void 0!==a.__webglCustomAttributesList)for(var b in a.__webglCustomAttributesList)t.deleteBuffer(a.__webglCustomAttributesList[b].buffer);Z.info.memory.geometries--},Jb=function(a){var b=a.program.program;if(void 0!==b){a.program=void 0;var c,
d,f=!1;a=0;for(c=la.length;a<c;a++)if(d=la[a],d.program===b){d.usedTimes--;0===d.usedTimes&&(f=!0);break}if(!0===f){f=[];a=0;for(c=la.length;a<c;a++)d=la[a],d.program!==b&&f.push(d);la=f;t.deleteProgram(b);Z.info.memory.programs--}}};this.renderBufferDirect=function(a,b,c,d,f,k){if(!1!==d.visible){var l=D(a,b,c,d,k);a=l.attributes;c=f.attributes;b=!1;l=16777215*f.id+2*l.id+(d.wireframe?1:0);l!==fa&&(fa=l,b=!0);b&&h();if(k instanceof THREE.Mesh)if(k=c.index){k.array instanceof Uint32Array?(c=t.UNSIGNED_INT,
l=4):(c=t.UNSIGNED_SHORT,l=2);var m=f.offsets;m&&1<m.length&&(b=!0);var n=0;do{var p,q,r;m&&m.length?(p=m[n].index,q=m[n].start,r=m[n].count):(q=p=0,r=k.array.length);b&&(g(d,a,f,p),!k.buffer&&f.streamingDraw?(p=gb.index,p||(p=t.createBuffer(),gb.index=p),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,p),t.bufferData(t.ELEMENT_ARRAY_BUFFER,k.array,t.DYNAMIC_DRAW)):t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,k.buffer));f.numInstances?Ua.drawElementsInstancedANGLE(f.isLines?t.LINES:
t.TRIANGLES,r,c,q*l,f.numInstances):t.drawElements(f.isLines?t.LINES:t.TRIANGLES,r,c,q*l)}while(m&&++n<m.length)}else b&&g(d,a,f,p),d=f.attributes.position,f.numInstances?Ua.drawArraysInstancedANGLE(f.isLines?t.LINE_STRIP:t.TRIANGLES,0,d.array.length/3,f.numInstances):t.drawArrays(f.isLines?t.LINE_STRIP:t.TRIANGLES,0,d.array.length/3);else console.log("Only THREE.Mesh can be rendered by the Firefly renderer. Use THREE.Mesh to draw lines.")}};this.renderBuffer=function(a,b,c,d,f,g){if(!1!==d.visible){var m,
n;c=D(a,b,c,d,g);b=c.attributes;a=!1;c=16777215*f.id+2*c.id+(d.wireframe?1:0);c!==fa&&(fa=c,a=!0);a&&h();!d.morphTargets&&0<=b.position&&a&&(t.bindBuffer(t.ARRAY_BUFFER,f.__webglVertexBuffer),k(b.position),t.vertexAttribPointer(b.position,3,t.FLOAT,!1,0,0));if(a){if(f.__webglCustomAttributesList)for(m=0,n=f.__webglCustomAttributesList.length;m<n;m++)c=f.__webglCustomAttributesList[m],0<=b[c.buffer.belongsToAttribute]&&(t.bindBuffer(t.ARRAY_BUFFER,c.buffer),k(b[c.buffer.belongsToAttribute]),t.vertexAttribPointer(b[c.buffer.belongsToAttribute],
c.size,t.FLOAT,!1,0,0));0<=b.color&&(0<g.geometry.colors.length||0<g.geometry.faces.length?(t.bindBuffer(t.ARRAY_BUFFER,f.__webglColorBuffer),k(b.color),t.vertexAttribPointer(b.color,3,t.FLOAT,!1,0,0)):d.defaultAttributeValues&&t.vertexAttrib3fv(b.color,d.defaultAttributeValues.color));0<=b.normal&&(t.bindBuffer(t.ARRAY_BUFFER,f.__webglNormalBuffer),k(b.normal),t.vertexAttribPointer(b.normal,3,t.FLOAT,!1,0,0));0<=b.tangent&&(t.bindBuffer(t.ARRAY_BUFFER,f.__webglTangentBuffer),k(b.tangent),t.vertexAttribPointer(b.tangent,
4,t.FLOAT,!1,0,0));0<=b.uv&&(g.geometry.faceVertexUvs[0]?(t.bindBuffer(t.ARRAY_BUFFER,f.__webglUVBuffer),k(b.uv),t.vertexAttribPointer(b.uv,2,t.FLOAT,!1,0,0)):d.defaultAttributeValues&&t.vertexAttrib2fv(b.uv,d.defaultAttributeValues.uv));0<=b.uv2&&(g.geometry.faceVertexUvs[1]?(t.bindBuffer(t.ARRAY_BUFFER,f.__webglUV2Buffer),k(b.uv2),t.vertexAttribPointer(b.uv2,2,t.FLOAT,!1,0,0)):d.defaultAttributeValues&&t.vertexAttrib2fv(b.uv2,d.defaultAttributeValues.uv2));0<=b.lineDistance&&(t.bindBuffer(t.ARRAY_BUFFER,
f.__webglLineDistanceBuffer),k(b.lineDistance),t.vertexAttribPointer(b.lineDistance,1,t.FLOAT,!1,0,0))}l();g instanceof THREE.Mesh?(g=f.__typeArray===Uint32Array?t.UNSIGNED_INT:t.UNSIGNED_SHORT,d.wireframe?(d=d.wireframeLinewidth,d!==Oa&&(t.lineWidth(d),Oa=d),a&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,f.__webglLineBuffer),t.drawElements(t.LINES,f.__webglLineCount,g,0)):(a&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,f.__webglFaceBuffer),t.drawElements(t.TRIANGLES,f.__webglFaceCount,g,0))):g instanceof THREE.Line&&
(g=g.type===THREE.LineStrip?t.LINE_STRIP:t.LINES,d=d.linewidth,d!==Oa&&(t.lineWidth(d),Oa=d),t.drawArrays(g,0,f.__webglLineCount))}};this.beginFrame=function(a){!1===a instanceof THREE.Camera?console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera."):(q(),Ga=a,void 0===a.parent&&a.updateMatrixWorld(),a.matrixWorldInverse.getInverse(a.matrixWorld),a.worldUpTransform?xa.multiplyMatrices(a.worldUpTransform,a.matrixWorld):xa.copy(a.matrixWorld),Ta.multiplyMatrices(a.projectionMatrix,
a.matrixWorldInverse),bb.setFromMatrix(Ta))};this.renderIncrement=function(a,b,c){var d=Ga;Cb.copy(bb);sb.copy(xa);lb.copy(Ta);this.setRenderTarget(b);b=a.fog;!0===a.autoUpdate&&a.updateMatrixWorld();void 0!==c&&(aa.length=0,cb=!0);ka.length=0;ca.length=0;n(a,a);!0===Z.sortObjects&&(ka.sort(p),ca.sort(m));cb&&(c&&c.length&&(aa=c.slice()),J(aa));a.overrideMaterial?(a=a.overrideMaterial,this.setBlending(a.blending,a.blendEquation,a.blendSrc,a.blendDst),this.setDepthTest(a.depthTest),this.setDepthWrite(a.depthWrite),
G(a.polygonOffset,a.polygonOffsetFactor,a.polygonOffsetUnits),r(ka,d,aa,b,!0,a)):(a=null,this.setBlending(THREE.NoBlending),r(ka,d,aa,b,!1,a));r(ca,d,aa,b,!0,a)};this.endIncrementalFrame=function(){q();this.setDepthTest(!0);this.setDepthWrite(!0)};this.render=function(a,b,c,d,f){if(!1===b instanceof THREE.Camera)console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");else{var g=a.fog;ea=fa=-1;Da=null;void 0!==f&&(aa.length=0,cb=!0);!0===a.autoUpdate&&a.updateMatrixWorld();
void 0===b.parent&&b.updateMatrixWorld();b.matrixWorldInverse.getInverse(b.matrixWorld);b.worldUpTransform?sb.multiplyMatrices(b.worldUpTransform,b.matrixWorld):sb.copy(b.matrixWorld);lb.multiplyMatrices(b.projectionMatrix,b.matrixWorldInverse);Cb.setFromMatrix(lb);ka.length=0;ca.length=0;n(a,a);!0===Z.sortObjects&&(ka.sort(p),ca.sort(m));cb&&(f&&f.length&&(aa=f.slice()),J(aa));q();this.setRenderTarget(c);(this.autoClear||d)&&this.clear(this.autoClearColor,this.autoClearDepth,this.autoClearStencil);
a.overrideMaterial?(a=a.overrideMaterial,this.setBlending(a.blending,a.blendEquation,a.blendSrc,a.blendDst),this.setDepthTest(a.depthTest),this.setDepthWrite(a.depthWrite),G(a.polygonOffset,a.polygonOffsetFactor,a.polygonOffsetUnits),r(ka,b,aa,g,!0,a)):(a=null,this.setBlending(THREE.NoBlending),r(ka,b,aa,g,!1,a));r(ca,b,aa,g,!0,a);q();c&&c.generateMipmaps&&c.minFilter!==THREE.NearestFilter&&c.minFilter!==THREE.LinearFilter&&(t.bindTexture(t.TEXTURE_2D,c.__webglTexture),t.generateMipmap(t.TEXTURE_2D),
t.bindTexture(t.TEXTURE_2D,null));this.setDepthTest(!0);this.setDepthWrite(!0)}};var Gb={},Qb=0;this.setFaceCulling=function(a,b){a===THREE.CullFaceNone?t.disable(t.CULL_FACE):(b===THREE.FrontFaceDirectionCW?t.frontFace(t.CW):t.frontFace(t.CCW),a===THREE.CullFaceBack?t.cullFace(t.BACK):a===THREE.CullFaceFront?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK),t.enable(t.CULL_FACE))};this.setMaterialFaces=function(a){var b=a.side===THREE.DoubleSide;a=a.side===THREE.BackSide;Ha!==b&&(b?t.disable(t.CULL_FACE):
t.enable(t.CULL_FACE),Ha=b);Ya!==a&&(a?t.frontFace(t.CW):t.frontFace(t.CCW),Ya=a)};this.setDepthTest=function(a){Wa!==a&&(a?t.enable(t.DEPTH_TEST):t.disable(t.DEPTH_TEST),Wa=a)};this.setDepthWrite=function(a){sa!==a&&(t.depthMask(a),sa=a)};this.setBlending=function(a,b,c,d){a!==fb&&(a===THREE.NoBlending?t.disable(t.BLEND):a===THREE.AdditiveBlending?(t.enable(t.BLEND),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.SRC_ALPHA,t.ONE)):a===THREE.SubtractiveBlending?(t.enable(t.BLEND),t.blendEquation(t.FUNC_ADD),
t.blendFunc(t.ZERO,t.ONE_MINUS_SRC_COLOR)):a===THREE.MultiplyBlending?(t.enable(t.BLEND),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ZERO,t.SRC_COLOR)):a===THREE.CustomBlending?t.enable(t.BLEND):(t.enable(t.BLEND),t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA)),fb=a);if(a===THREE.CustomBlending){if(b!==Na&&(t.blendEquation(C(b)),Na=b),c!==Ma||d!==Va)t.blendFunc(C(c),C(d)),Ma=c,Va=d}else Va=Ma=Na=null};this.setTexture=
function(a,b){if(a.needsUpdate){a.__webglInit||(a.__webglInit=!0,a.addEventListener("dispose",Bb),a.__webglTexture=t.createTexture(),Z.info.memory.textures++);t.activeTexture(t.TEXTURE0+b);t.bindTexture(t.TEXTURE_2D,a.__webglTexture);t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,a.flipY);t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a.premultiplyAlpha);t.pixelStorei(t.UNPACK_ALIGNMENT,a.unpackAlignment);var c=a.image,d=THREE.Math.isPowerOfTwo(c.width)&&THREE.Math.isPowerOfTwo(c.height),f=C(a.format),g=C(a.type);
I(t.TEXTURE_2D,a,d);var h=a.mipmaps;if(a instanceof THREE.DataTexture)if(0<h.length&&d){for(var k=0,l=h.length;k<l;k++)c=h[k],t.texImage2D(t.TEXTURE_2D,k,f,c.width,c.height,0,f,g,c.data);a.generateMipmaps=!1}else t.texImage2D(t.TEXTURE_2D,0,f,c.width,c.height,0,f,g,c.data);else if(a instanceof THREE.CompressedTexture)for(k=0,l=h.length;k<l;k++)c=h[k],a.format!==THREE.RGBAFormat?t.compressedTexImage2D(t.TEXTURE_2D,k,f,c.width,c.height,0,c.data):t.texImage2D(t.TEXTURE_2D,k,f,c.width,c.height,0,f,g,
c.data);else if(0<h.length&&d){k=0;for(l=h.length;k<l;k++)c=h[k],t.texImage2D(t.TEXTURE_2D,k,f,f,g,c);a.generateMipmaps=!1}else t.texImage2D(t.TEXTURE_2D,0,f,f,g,a.image);a.generateMipmaps&&d&&t.generateMipmap(t.TEXTURE_2D);a.needsUpdate=!1;if(a.onUpdate)a.onUpdate()}else t.activeTexture(t.TEXTURE0+b),t.bindTexture(t.TEXTURE_2D,a.__webglTexture)};this.initFrameBufferMRT=function(a,b){var c=a[0],d=!1;if(c&&!c.__webglFramebuffer){void 0===c.depthBuffer&&(c.depthBuffer=!0);void 0===c.stencilBuffer&&
(c.stencilBuffer=!0);c.__webglFramebuffer=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,c.__webglFramebuffer);var f;c.shareDepthFrom?f=c.__webglRenderbuffer=c.shareDepthFrom.__webglRenderbuffer:c.depthBuffer&&!c.stencilBuffer?(f=c.__webglRenderbuffer=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,f),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,c.width,c.height)):c.depthBuffer&&c.stencilBuffer&&(f=c.__webglRenderbuffer=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,
f),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,c.width,c.height));c.depthBuffer&&!c.stencilBuffer?t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,f):c.depthBuffer&&c.stencilBuffer&&t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,f);d=!0}f=ja;t.bindFramebuffer(t.FRAMEBUFFER,c.__webglFramebuffer);for(var g=0;g<a.length;g++){var h=a[g];if(!h.__webglTexture){var k=THREE.Math.isPowerOfTwo(h.width)&&THREE.Math.isPowerOfTwo(h.height),l=
C(h.format),m=C(h.type);h.addEventListener("dispose",Fb);h.__webglTexture=t.createTexture();Z.info.memory.textures++;t.bindTexture(t.TEXTURE_2D,h.__webglTexture);I(t.TEXTURE_2D,h,k);t.texImage2D(t.TEXTURE_2D,0,l,h.width,h.height,0,l,m,null);k&&h.generateMipmaps&&t.generateMipmap(t.TEXTURE_2D)}t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+g,t.TEXTURE_2D,h.__webglTexture,0)}Pa&&1<a.length&&Sa.drawBuffersWEBGL([Sa.COLOR_ATTACHMENT0_WEBGL,Sa.COLOR_ATTACHMENT1_WEBGL]);b&&(g=t.checkFramebufferStatus(t.FRAMEBUFFER),
g!==t.FRAMEBUFFER_COMPLETE&&(console.log("Can't use multiple render targets. Falling back to two passes. "+g),delete c.__webglFramebuffer,b=!1));t.bindFramebuffer(t.FRAMEBUFFER,f);d&&(t.bindTexture(t.TEXTURE_2D,null),t.bindRenderbuffer(t.RENDERBUFFER,null),t.bindFramebuffer(t.FRAMEBUFFER,null));return b};this.setRenderTarget=function(a){var b;Array.isArray(a)?(this.initFrameBufferMRT(a),b=a[0]):a&&(this.initFrameBufferMRT([a]),b=a);var c,d,f;b?(a=b.__webglFramebuffer,c=b.width,b=b.height,f=d=0):(a=
null,c=Ca,b=ab,d=va,f=Ka);a!==ja&&(t.bindFramebuffer(t.FRAMEBUFFER,a),t.viewport(d,f,c,b),ja=a)};this.readPixels=function(a,b,c,d,f,g){this.setRenderTarget(a);t.readPixels(b,c,d,f,t.RGBA,t.UNSIGNED_BYTE,g)};this.verifyMRTWorks=function(a){Sa&&(Pa=this.initFrameBufferMRT(a,!0));return Pa}};AutodeskNamespace("Autodesk.Viewing.Private");
(function(){var a=Autodesk.Viewing.Private;a.BackgroundPresets={"Fusion Grey":[230,230,230,150,150,150],"Sky Blue":[226,244,255,156,172,180],Midnight:[41,76,120,1,2,3],White:[255,255,255,255,255,255],AutoCADModel:[30,40,48,30,40,48],"Dark Grey":[51,51,51,51,51,51],"Infinity Pool":[164,175,179,164,175,179],Tranquility:[0,84,166,0,84,166],"Grey Room":[129,129,129,129,129,129],"Photo Booth":[237,237,237,237,237,237],"RaaS SBS":[1,1,1,90,90,90],Custom:[230,230,230,150,150,150]};var b=a.BackgroundPresets;
a.LightPresets=[{name:"Simple Grey",path:null,tonemap:0,E_bias:0,directLightColor:[1,0.84,0.67],ambientColor:[0.8,0.9,1],lightMultiplier:1,bgColorGradient:b["Fusion Grey"],darkerFade:!1},{name:"Sharp Highlights",path:"studio_01",tonemap:1,E_bias:-9,directLightColor:[0.5,0.5,0.5],ambientColor:[0.25,0.25,0.25],lightMultiplier:1,bgColorGradient:b["Photo Booth"],darkerFade:!0},{name:"Dark Sky",path:"DarkSky",tonemap:1,E_bias:-2,directLightColor:[1,1,1],ambientColor:[0,0,0],lightMultiplier:2.5,bgColorGradient:b["Dark Grey"],
darkerFade:!1},{name:"Grey Room",path:"GreyRoom",tonemap:1,E_bias:1,directLightColor:[1,1,1],ambientColor:[0,0,0],lightMultiplier:0,bgColorGradient:b["Grey Room"],darkerFade:!0},{name:"Photo Booth",path:"PhotoBooth",tonemap:1,E_bias:0,directLightColor:[1,1,1],ambientColor:[0.125,0.125,0.125],lightMultiplier:1,bgColorGradient:b["Photo Booth"],darkerFade:!0},{name:"Tranquility",path:"TranquilityBlue",tonemap:1,E_bias:-2,directLightColor:[1,1,1],ambientColor:[0,0,0],lightMultiplier:4,bgColorGradient:b.Tranquility,
darkerFade:!1},{name:"Infinity Pool",path:"InfinityPool",tonemap:1,E_bias:-1,directLightColor:[1,0.84,0.67],ambientColor:[0,0,0],lightMultiplier:2.5,bgColorGradient:b["Infinity Pool"],darkerFade:!1},{name:"Simple White",path:null,tonemap:0,E_bias:0,directLightColor:[1,1,1],ambientColor:[0.9,0.9,0.9],lightMultiplier:1,bgColorGradient:b.White,saoRadius:0.06,saoIntensity:0.15,darkerFade:!0},{name:"Riverbank",path:"riverbank",tonemap:1,E_bias:-5.7,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:b["Sky Blue"],
darkerFade:!1},{name:"Contrast",path:"IDViz",tonemap:1,E_bias:0,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:b.Midnight,darkerFade:!1},{name:"Rim Highlights",path:"RimHighlights",tonemap:1,E_bias:-9,directLightColor:[0.5,0.5,0.5],ambientColor:[0.25,0.25,0.25],lightMultiplier:1,bgColorGradient:b["Photo Booth"],darkerFade:!0},{name:"Cool Light",path:"CoolLight",tonemap:1,E_bias:-9,directLightColor:[0.5,0.5,0.5],ambientColor:[0.25,0.25,0.25],lightMultiplier:1,bgColorGradient:b["Fusion Grey"],
darkerFade:!0},{name:"Warm Light",path:"WarmLight",tonemap:1,E_bias:-9,directLightColor:[0.5,0.5,0.5],ambientColor:[0.25,0.25,0.25],lightMultiplier:1,bgColorGradient:b["Fusion Grey"],darkerFade:!0},{name:"Soft Light",path:"SoftLight",tonemap:1,E_bias:-9,directLightColor:[0.5,0.5,0.5],ambientColor:[0.25,0.25,0.25],lightMultiplier:1,bgColorGradient:b["Fusion Grey"],darkerFade:!0},{name:"Grid Light",path:"GridLight",tonemap:1,E_bias:-9,directLightColor:[0.5,0.5,0.5],ambientColor:[0.25,0.25,0.25],lightMultiplier:1,
bgColorGradient:b["Fusion Grey"],darkerFade:!0},{name:"Plaza",path:"Plaza",tonemap:1,E_bias:-13,directLightColor:[1,1,1],ambientColor:[0.25,0.25,0.25],lightMultiplier:0,bgColorGradient:b["Sky Blue"],darkerFade:!1},{name:"Snow Field",path:"SnowField",tonemap:1,E_bias:-11.5,directLightColor:[0.8,0.8,0.8],ambientColor:[0.25,0.25,0.25],lightMultiplier:1,bgColorGradient:b["Sky Blue"],darkerFade:!1}];a.DebugEnvironments=[{name:"Field",path:"field",tonemap:1,E_bias:-2.9,directLightColor:[1,1,1],lightMultiplier:0,
bgColorGradient:b["Sky Blue"],darkerFade:!1},{name:"Crossroads",path:"crossroads",tonemap:1,E_bias:-5.5,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:b["Sky Blue"],darkerFade:!1},{name:"Seaport",path:"seaport",tonemap:1,E_bias:-6.5,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:b["Sky Blue"],darkerFade:!1},{name:"Glacier",path:"glacier",tonemap:1,E_bias:0,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:b.Midnight,darkerFade:!1},{name:"Boardwalk",path:"boardwalk",
tonemap:1,E_bias:-7,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:b["Sky Blue"],darkerFade:!1},{name:"RaaS Test Env",path:"Reflection",tonemap:2,E_bias:-1.5,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:b["RaaS SBS"],darkerFade:!1},{name:"RaaS Test Env 2",path:"ReflectionBlinn",tonemap:2,E_bias:-1.5,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:b["RaaS SBS"],darkerFade:!1}];ENABLE_DEBUG&&(a.LightPresets=a.LightPresets.concat(a.DebugEnvironments));a.CreateCubeMapFromColors=
function(a,b){for(var f=255*a.x,g=255*a.y,h=255*a.z,k=255*b.x,l=255*b.y,m=255*b.z,p=new Uint8Array(16),n=new Uint8Array(16),q=new Uint8Array(16),r=0;4>r;r++)p[4*r]=f,p[4*r+1]=g,p[4*r+2]=h,p[4*r+3]=255,n[4*r]=k,n[4*r+1]=l,n[4*r+2]=m,n[4*r+3]=255,0|r/2?(q[4*r]=f,q[4*r+1]=g,q[4*r+2]=h):(q[4*r]=k,q[4*r+1]=l,q[4*r+2]=m),q[4*r+3]=255;f=new THREE.DataTexture(q,2,2,THREE.RGBAFormat);g=new THREE.DataTexture(q,2,2,THREE.RGBAFormat);n=new THREE.DataTexture(n,2,2,THREE.RGBAFormat);p=new THREE.DataTexture(p,2,
2,THREE.RGBAFormat);h=new THREE.DataTexture(q,2,2,THREE.RGBAFormat);q=new THREE.DataTexture(q,2,2,THREE.RGBAFormat);k=new THREE.Texture(null,new THREE.CubeReflectionMapping,THREE.RepeatWrapping,THREE.RepeatWrapping,THREE.LinearFilter,THREE.LinearFilter,THREE.RGBAFormat);k.image=[g,f,p,n,q,h];k.needsUpdate=!0;return k};a.DefaultLightPreset=8;a.DefaultLightPreset2d=0})();AutodeskNamespace("Autodesk.Viewing.Private");
Autodesk.Viewing.Private.MaterialManager=function(a){function b(a){if("http://"==a.substr(0,7)||"https://"==a.substr(0,8)||"file:///"==a.substr(0,8)||"urn:"==a.substr(0,4))return a;var b=window.location.pathname,c=b.lastIndexOf("/"),b=b.substr(0,c+1);return window.location.protocol+"//"+window.location.host+b+a}function c(a){return-1!=a.indexOf("__lineMaterial__")}function d(a,b,c){auth&&(-1!=a.indexOf("/items/")?THREE.ImageUtils.crossOrigin="use-credentials":THREE.ImageUtils.crossOrigin="");return THREE.ImageUtils.loadTexture(a,
b,c)}var f=Autodesk.Viewing.Private,g=this,h=this.materials={},k=this.materialsNonHDR={};this.textures={};this.irradianceMap=this.reflectionCube=this.layerMaskTex=null;var l=[],m=[];this.defaultMaterial=new THREE.MeshPhongMaterial({ambient:197379,color:7829367,specular:3355443,shininess:30,shading:THREE.SmoothShading});this.findMaterial=function(a,b){var d=h[c(b)?b:a.basePath+"|mat|"+b];d||(stderr("Unknown material "+b+". Using default."),d=this.defaultMaterial);return d};this.convertMaterials=function(a){if(a.materials){var b=
a.materials.materials,d;for(d in b){var f=a.simplemats[d],g=c(d)?d:a.basePath+"|mat|"+d;if(f){f.color=(new THREE.Color).copy(f.color);f.ambient=(new THREE.Color).copy(f.ambient);f.specular=(new THREE.Color).copy(f.specular);f.emissive=(new THREE.Color).copy(f.emissive);var h=new THREE.MeshPhongMaterial(f);h.proteinType=f.proteinType;h.proteinMat=b[d];h.tag=f.tag;h.metal=f.metal;_isIE11||!f.doubleSided&&!a.doubleSided||(h.side=THREE.DoubleSide);for(var k in f)0===k.indexOf("uri_")&&(h[k]=f[k]),0===
k.indexOf("uscale_")&&(h[k]=f[k]),0===k.indexOf("vscale_")&&(h[k]=f[k])}else h=new THREE.MeshPhongMaterial({ambient:197379,color:7829367,specular:3355443,shininess:30,shading:THREE.SmoothShading}),h.proteinMat=b[d];this.addMaterial(g,h)}}};this.updateMaterials=function(){for(;l.length;)for(var b=l.pop(),c=0;c<b.mats.length;c++)b.mats[c][b.slot]=b.tex,b.mats[c].needsUpdate=!0,a.invalidate(!0,!1,!1)};this.loadTextures=function(c){var f=function(a){var b=g.textures[a.name];if(b){for(var c=0;c<b.mats.length;c++)b.mats[c][b.slots[c]]=
a;l.push(b)}},k;for(k in h){var m=h[k];if(m){var v=["map","bumpMap","specularMap","normalMap","alphaMap"];m.bumpScale&&1<=m.bumpScale&&(m.bumpScale=0.03);for(var s=0;s<v.length;s++){var w=m["uri_"+v[s]];if(w)if(w=w.replace(/\\/g,"/"),w=c.basePath+w,g.textures[w])g.textures[w].mats.push(m),g.textures[w].slots.push(v[s]);else{var z="envMap"==v[s],D=b(w),A=D.indexOf("urn:");-1!=A&&(D=D.substr(0,A)+encodeURIComponent(D.substr(A)),D+="?domain="+window.location.hostname,Autodesk.Viewing.ACM_SESSION_ID&&
(D+="&acmsession="+Autodesk.Viewing.ACM_SESSION_ID));var A=m["uscale_"+v[s]],E=m["vscale_"+v[s]];A||(A=1);E||(E=1);D=z?d(D,new THREE.SphericalReflectionMapping,f):d(D,new THREE.UVMapping,f);D.name=w;g.textures[D.name]={mats:[m],slots:[v[s]],tex:D};"alphaMap"==v[s]&&(m.transparent=!0);D.anisotropy="bumpMap"==v[s]||"normalMap"==v[s]?0:a.renderer().getMaxAnisotropy();D.repeat.set(A,E);D.wrapS=THREE.RepeatWrapping;D.wrapT=THREE.RepeatWrapping;D.flipY=!z;z&&(c.envMap=D)}}}}};this.create2DMaterial=function(b,
f,k,l){var m="__lineMaterial__";f.image&&(m+="|image:"+f.image.name);f.clip&&(m+="|clip:"+JSON.stringify(f.clip));k&&(m+="|id");l&&(m+="|selection");f.skipEllipticals&&(m+="|skipEllipticals");f.skipCircles&&(m+="|skipCircles");f.skipTriangleGeoms&&(m+="|skipTriangleGeoms");b&&(m+="|"+b.basePath);m=c(m)?m:null.basePath+"|mat|"+m;if(!h.hasOwnProperty(m)){var s=new THREE.ShaderMaterial({fragmentShader:LineShader.fragmentShader,vertexShader:LineShader.vertexShader,uniforms:THREE.UniformsUtils.clone(LineShader.uniforms),
attributes:LineShader.attributes,defines:THREE.UniformsUtils.clone(LineShader.defines),transparent:!0});s.depthWrite=!1;s.depthTest=!1;s.side=THREE.DoubleSide;s.blending=THREE.NormalBlending;k?(s.defines.ID_COLOR=1,s.blending=THREE.NoBlending):l?s.defines.SELECTION_RENDERER=1:a.renderer().hasMRT()&&(s.defines.MRT_ID_BUFFER=1);f.skipEllipticals||(s.defines.HAS_ELLIPTICALS=1);f.skipCircles||(s.defines.HAS_CIRCLES=1);f.skipTriangleGeoms||(s.defines.HAS_TRIANGLE_GEOMS=1);s.uniforms.tLayerMask.value=g.layerMaskTex;
f.image&&(s.defines.HAS_RASTER_QUADS=1,d(f.image.dataURI,new THREE.UVMapping,function(b){b.wrapS=THREE.ClampToEdgeWrapping;b.wrapT=THREE.ClampToEdgeWrapping;b.minFilter=THREE.LinearFilter;b.magFilter=THREE.LinearFilter;b.anisotropy=1;b.flipY=!0;b.needsUpdate=!0;s.uniforms.tRaster.value=b;-1!=f.image.dataURI.indexOf("png")&&(s.transparent=!0);s.needsUpdate=!0;a.invalidate(!1,!0,!1)}));h[m]=s}return m};this.addMaterial=function(b,c,d){function f(a){return 0.299*a.r+0.587*a.g+0.114*a.b}var k=c.proteinMat?
c.proteinMat:null,l=c.proteinType&&-1!=c.proteinType.indexOf("Prism");if(!d){if(c.metal){if(c.reflectivity||(c.reflectivity=f(c.specular)),k&&(1===c.reflectivity&&(c.reflectivity=f(c.specular)),0!==c.color.r||0!==c.color.g||0!==c.color.b))c.color.r*=0.1,c.color.g*=0.1,c.color.b*=0.1}else k?l?(d=!1,"PrismLayered"==c.proteinType&&(c.clearcoat=!0,c.reflectivity=0.06,k&&(k=k.materials[k.userassets[0]].categories)&&k.length&&-1!=k[0].indexOf("Metal")&&(d=!0)),c.reflectivity=Math.sqrt(c.reflectivity),d?
c.specular.copy(c.color):(c.specular.r=c.reflectivity,c.specular.g=c.reflectivity,c.specular.b=c.reflectivity)):(c.reflectivity||(c.reflectivity=0.01+0.06*f(c.specular)),c.specular.r*=c.reflectivity,c.specular.g*=c.reflectivity,c.specular.b*=c.reflectivity):c.reflectivity?(c.metal=!0,c.specular.r=c.color.r*c.reflectivity,c.specular.g=c.color.g*c.reflectivity,c.specular.b=c.color.b*c.reflectivity,c.color.r*=0.1,c.color.g*=0.1,c.color.b*=0.1):1!==c.color.r||1!==c.color.g||1!==c.color.b||1!==c.specular.r||
1!==c.specular.g||1!==c.specular.b||c.uri_map||c.uri_specularMap||(c.metal=!0,c.reflectivity=0.7,c.specular.r=c.specular.g=c.specular.b=c.reflectivity,c.color.r*=0.1,c.color.g*=0.1,c.color.b*=0.1);c.ambient.copy(c.color);c.ambient.r*=0.3;c.ambient.g*=0.3;c.ambient.b*=0.3;c.combine=THREE.MixOperation;if(c.transparent||c.uri_map&&-1!=c.uri_map.toLowerCase().indexOf(".png")||c.uri_opacityMap)c.alphaTest=0.01}if(c.uri_normalMap){k=c.bumpScale;if(void 0===k||1<=k)k=1;c.normalScale=new THREE.Vector2(k,
k)}else void 0===c.bumpScale&&(c.uri_map||c.uri_bumpMap)?c.bumpScale=0.03:1<=c.bumpScale&&(c.bumpScale=0.03);g.reflectionCube&&(c.envMap=g.reflectionCube);g.irradianceMap&&(c.irradianceMap=g.irradianceMap);c.exposureBias=Math.pow(2,a.renderer().getExposureBias());c.tonemapOutput=a.renderer().getToneMapMethod();c.mrtNormals=a.renderer().hasMRT()&&a.renderer().settings.sao;c.side==THREE.DoubleSide&&a.renderer().toggleTwoSided(!0);c.cutplanes=m;h[b]=c};this.addMaterialNonHDR=function(a,b){b.cutplanes=
m;k[a]=b};this.togglePolygonOffset=function(a){for(var b in h){var c=h[b];c instanceof THREE.MeshPhongMaterial&&(c.polygonOffset=!0,c.polygonOffsetFactor=a?1:0,c.polygonOffsetUnits=a?1:0,c.needsUpdate=!0)}};this.applyGeometryFlagsToMaterial=function(a,b){b.attributes.color&&(a.vertexColors=THREE.VertexColors,a.needsUpdate=!0);!a.proteinType&&b.attributes.uv&&b.attributes.uv.isPattern&&(a.map&&!a.bumpMap&&(a.bumpMap=a.map,a.needsUpdate=!0),a.uri_map&&!a.uri_bumpMap&&(a.uri_bumpMap=a.uri_map,a.needsUpdate=
!0))};this.toggleMRTSetting=function(a){for(var b in h){var c=h[b];c.mrtNormals!==a&&(c.mrtNormals=a,c.needsUpdate=!0)}};this.updatePixelScale=function(a){var b=h,d;for(d in b)c(d)&&(b[d].uniforms.unitsPerPixel.value=1/a,b[d].uniforms.pixelsPerUnit.value=a)};this.setCubeMapFromColors=function(b,c){var d=f.CreateCubeMapFromColors(b,c);g.reflectionCube=d;g.reflectionCube.isBgColor=!0;for(var k in h){var l=h[k];l.envMap=d;l.needsUpdate=!0}a.invalidate(!0)};this.setCubeMap=function(b){var c=function(b){g.reflectionCube=
b;if(g.reflectionCube)for(var c in h)b=h[c],b.envMap=g.reflectionCube,b.needsUpdate=!0;else g.setCubeMapFromColors(a.clearColorTop,a.clearColorBottom);a.invalidate(!0)};Array.isArray(b)?(g.reflectionCube=THREE.ImageUtils.loadTextureCube(b,new THREE.CubeReflectionMapping,c),g.reflectionCube.format=THREE.RGBFormat):"string"==typeof b?-1!=b.toLowerCase().indexOf(".dds")?(g.reflectionCube=(new THREE.DDSLoader).load(b,c),g.reflectionCube.mapping=new THREE.CubeReflectionMapping,g.reflectionCube.LogLuv=
-1!=b.indexOf("logluv")):(g.reflectionCube=THREE.ImageUtils.loadTexture(b,new THREE.SphericalReflectionMapping,c),g.reflectionCube.format=THREE.RGBFormat):b?c(b):c(null)};this.setIrradianceMap=function(b){var c=function(b){if(b){for(var c in h){var d=h[c];d.irradianceMap=b;d.needsUpdate=!0}g.irradianceMap=b}else if(g.irradianceMap){for(c in h)d=h[c],d.irradianceMap=null,d.needsUpdate=!0;g.irradianceMap=null}a.invalidate(!0)};THREE.ImageUtils.crossOrigin="";Array.isArray(b)?(g.irradianceMap=THREE.ImageUtils.loadTextureCube(b,
new THREE.CubeReflectionMapping,c),g.irradianceMap.format=THREE.RGBFormat):"string"==typeof b?-1!=b.toLowerCase().indexOf(".dds")&&(g.irradianceMap=(new THREE.DDSLoader).load(b,c),g.irradianceMap.mapping=new THREE.CubeReflectionMapping,g.irradianceMap.LogLuv=-1!=b.indexOf("logluv")):b?c(b):c(null)};this.setTonemapMethod=function(a){for(var b in h){var c=h[b];c.tonemapOutput=a;c.needsUpdate=!0}};this.setExposureBias=function(a){a=Math.pow(2,a);for(var b in h){var c=h[b];c.exposureBias=a;c.needsUpdate=
!0}};this.initLayersTexture=function(a){for(var b=a.getData().layerCount,c=new Uint8Array(65536),d=0;d<b;d++)c[d]=255;b=new THREE.DataTexture(c,256,256,THREE.LuminanceFormat,THREE.UnsignedByteType,new THREE.UVMapping,THREE.ClampToEdgeWrapping,THREE.ClampToEdgeWrapping,THREE.NearestFilter,THREE.NearestFilter,0);b.generateMipmaps=!1;b.flipY=!1;b.needsUpdate=!0;this.layerMaskTex=b;this.layersMap=a.getData().layersMap};this.init2DSelectionMaterial=function(a){for(var b=a.myData.maxObjectNumber||1,c=0|
Math.ceil(b/4096),d=1;d<c;)d*=2;for(var c=d,d=new Uint8Array(4096*c),f=0;f<b;f++)d[f]=0;b=new THREE.DataTexture(d,4096,c,THREE.LuminanceFormat,THREE.UnsignedByteType,new THREE.UVMapping,THREE.ClampToEdgeWrapping,THREE.ClampToEdgeWrapping,THREE.NearestFilter,THREE.NearestFilter,0);b.generateMipmaps=!1;b.flipY=!1;b.needsUpdate=!0;this.selectionTex=b;a=this.create2DMaterial(a.getData(),{},!1,!0);a=h[a];a.uniforms.tSelectionTexture.value=this.selectionTex;a.uniforms.vSelTexSize.value.set(4096,c);a.needsUpdate=
!0;return a};this.setLayerVisible=function(b,d){for(var f=this.layerMaskTex,g=f.image.data,k=this.layersMap,l=d?255:0,m=0;m<b.length;++m)g[k[b[m]]]=l;f.needsUpdate=!0;for(var z in h)c(z)&&(h[z].needsUpdate=!0);a.invalidate(!0)};this.isLayerVisible=function(a){return!!this.layerMaskTex.image.data[this.layersMap[a]]};this.highlightObject2D=function(b,c){this.selectionTex.image.data[b]=c?255:0;this.selectionTex.needsUpdate=!0;a.invalidate(!1,!1,!0)};this.cloneMaterial=function(a){var b=a.clone();b instanceof
THREE.MeshPhongMaterial&&(b.exposureBias=a.exposureBias,b.irradianceMap=a.irradianceMap,b.proteinMat=a.proteinMat,b.proteinType=a.proteinType,b.tag=a.tag,b.tonemapOutput=a.tonemapOutput,b.uri_bumpMap=a.uri_bumpMap,b.uscale_bumpMap=a.uscale_bumpMap,b.vscale_bumpMap=a.vscale_bumpMap,b.cutplanes=a.cutplanes);return b};this.setCutplanes=function(a){if(m.length!==(a?a.length||0:0)){for(var b in h)h[b].needsUpdate=!0;for(b in k)k[b].needsUpdate=!0}for(;0<m.length;)m.pop();if(a)for(b=0;b<a.length;b++){var c=
a[b].normal;m.push(new THREE.Vector4(c.x,c.y,c.z,a[b].constant))}};this.cleanup=function(a){var b={},c;for(c in this.textures){var d=this.textures[c];-1===c.indexOf(a.basePath)?b[c]=d:d.tex.dispose()}this.textures=b;var b={},f;for(f in h)-1===f.indexOf(a.basePath)&&(b[f]=h[f]);h=this.materials=b};this.addMaterial("__defaultMaterial__",this.defaultMaterial)};
var GroundDepthShader={uniforms:{},vertexShader:"#ifdef USE_LOGDEPTHBUF\n    #ifdef USE_LOGDEPTHBUF_EXT\n        varying float vFragDepth;\n    #endif\n    uniform float logDepthBufFC;\n#endif\nvoid main() {\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );;\n#ifdef USE_LOGDEPTHBUF\n    gl_Position.z = log2(max(1e-6, gl_Position.w + 1.0)) * logDepthBufFC;\n    #ifdef USE_LOGDEPTHBUF_EXT\n        vFragDepth = 1.0 + gl_Position.w;\n    #else\n        gl_Position.z = (gl_Position.z - 1.0) * gl_Position.w;\n    #endif\n#endif\n}",fragmentShader:["#ifdef USE_LOGDEPTHBUF\n    uniform float logDepthBufFC;\n    #ifdef USE_LOGDEPTHBUF_EXT\n        #extension GL_EXT_frag_depth : enable\n        varying float vFragDepth;\n    #endif\n#endif",
PackDepthShaderShunk,"void main() {\n#if defined(USE_LOGDEPTHBUF) && defined(USE_LOGDEPTHBUF_EXT)\ngl_FragDepthEXT = log2(vFragDepth) * logDepthBufFC * 0.5;\n#endif\n#ifdef USE_LOGDEPTHBUF_EXT\nfloat depth = gl_FragDepthEXT / gl_FragCoord.w;\n#else\nfloat depth = gl_FragCoord.z / gl_FragCoord.w;\n#endif\ndepth = 1.0 - depth;\ngl_FragColor = packDepth(depth);\n}"].join("\n")},GroundShadowAOShader={uniforms:{tDepth:{type:"t",value:null},worldSize:{type:"v3",value:new THREE.Vector3(1,1,1)}},defines:{},
vertexShader:"varying vec2 vUv;\nvoid main() {\nvUv = vec2(uv.x, uv.y);\ngl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}",fragmentShader:["#define NUM_SAMPLES 29.0\n#define NUM_SPIRAL_TURNS 7.0\nuniform sampler2D tDepth;\nuniform vec3 worldSize;\nvarying vec2 vUv;\n#ifdef PRESET_2\n#define SAMPLE_RADIUS 0.3\n#define AO_GAMMA 1.0\n#define AO_INTENSITY 1.0\n#else\n#define SAMPLE_RADIUS 0.2\n#define AO_GAMMA 3.0\n#define AO_INTENSITY 0.8\n#endif",PackDepthShaderShunk,"#define PI 3.14159265358979\nfloat rand(vec2 co) {\nreturn fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\nfloat getRandomAngle(vec2 pos) {\nreturn rand(pos) * (2.0 * PI);\n}\nvec2 tapLocation(float sampleNumber, float spinAngle, out float ssR){\nfloat alpha = float(sampleNumber + 0.5) * (1.0 / NUM_SAMPLES);\nfloat angle = alpha * (NUM_SPIRAL_TURNS * PI * 2.0) + spinAngle;\nssR = alpha;\nreturn vec2(cos(angle), sin(angle));\n}\nvec2 sampleAO(vec2 unitDirection, float radius) {\nvec2 sampleOffset = unitDirection * radius;\nfloat idepth = unpackDepth(texture2D(tDepth, vUv + sampleOffset));\nfloat depth = 1.0 - idepth;\nif (depth < 1e-6) {\nif (radius == 0.0)\nreturn vec2(1.0, 1.0);\nelse\nreturn vec2(0.0, 1.0);\n}\nvec3 dir = vec3(sampleOffset.x, depth, sampleOffset.y) * worldSize;\nfloat distance2 = dot(dir,dir);\nfloat idistance = 1.0 / sqrt(distance2);\nvec3 ndir = dir * idistance;\n#ifdef PRESET_2\nfloat importance = ndir.y * idistance;\n#else\nfloat importance = ndir.y / distance2;\n#endif\nvec2 ret;\nret.x = (idepth == 0.0) ? 0.0 : importance;\nret.y = importance;\nreturn ret;\n}\nvoid main() {\nvec2 sum = vec2(0.0);\nfloat angle = getRandomAngle(vUv);\nfor (float i = 0.0; i<NUM_SAMPLES; i+= 1.0) {\nfloat ssR;\nvec2 uv = tapLocation(i, angle, ssR);\nsum += sampleAO(uv, ssR * SAMPLE_RADIUS);\n}\nfloat ao = sum.x / sum.y;\ngl_FragColor = packDepth(AO_INTENSITY * clamp(pow(ao, AO_GAMMA), 0.0, 0.9999));\n}"].join("\n")},
GroundShadowBlurShader={uniforms:{tDepth:{type:"t",value:null}},defines:{},vertexShader:"varying vec2 vUv;\nvoid main() {\nvUv = vec2(uv.x, uv.y);\ngl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}",fragmentShader:["uniform sampler2D tDepth;\nvarying vec2 vUv;\n#ifdef HORIZONTAL\n#define GET_UV(X) vec2(vUv.x + KERNEL_SCALE*(X), vUv.y)\n#else\n#define GET_UV(Y) vec2(vUv.x, vUv.y + KERNEL_SCALE*(Y))\n#endif",PackDepthShaderShunk,"#define PI 3.14159265358979\n#define SIGMA ((2.0 * KERNEL_RADIUS+1.0) / 6.0)\n#define SIGMASQ2 (2.0 * SIGMA * SIGMA)\n#ifdef BOX\n#define KERNEL_VAL(X) 1.0\n#else\n#define KERNEL_VAL(X) ( (1.0 / sqrt(PI * SIGMASQ2)) * exp(-(X)*(X)/SIGMASQ2) )\n#endif\nvoid main() {\nfloat depthVal = 0.0;\nfloat sum = 0.0;\nfor (float x=-KERNEL_RADIUS; x<=KERNEL_RADIUS; x+=1.0) {\ndepthVal += unpackDepth(texture2D(tDepth, GET_UV(x))) * KERNEL_VAL(x);\nsum += KERNEL_VAL(x);\n}\ngl_FragColor = packDepth(depthVal/sum);\n}"].join("\n")},
GroundShadowColorShader={uniforms:{tDepth:{type:"t",value:null}},defines:{},vertexShader:"varying vec2 vUv;\nvoid main() {\n    vUv = vec2(uv.x, uv.y);\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}",fragmentShader:["uniform sampler2D tDepth;\nvarying vec2 vUv;",PackDepthShaderShunk,"void main() {\nfloat depthVal = unpackDepth(texture2D(tDepth, vUv));\ngl_FragColor = vec4(SHADOW_COLOR.rgb, SHADOW_COLOR.a * depthVal);\n}"].join("\n")},GroundShadow=function(a,b){function c(a){return new THREE.ShaderMaterial({uniforms:THREE.UniformsUtils.clone(a.uniforms),
vertexShader:a.vertexShader,fragmentShader:a.fragmentShader,defines:THREE.UniformsUtils.clone(a.defines)})}var d,f,g,h,k,l,m,p,n,q,r,v;this.enabled=!0;this.rendered=this.bufferValid=!1;var s={texSize:64,pixScale:1,blurRadius:7,color:new THREE.Color(0,0,0),alpha:1,debug:!1};this.setTransform=function(a,b,c,f){d.left=-b.z/2;d.right=b.z/2;d.top=b.x/2;d.bottom=-b.x/2;d.near=1;d.far=b.y+d.near;d.updateProjectionMatrix();d.position.addVectors(a,c.clone().multiplyScalar(-b.y/2-d.near));f&&d.up.set(f.x,f.y,
f.z);d.lookAt(a);g.position.set(a.x,a.y,a.z);g.rotation.set(d.rotation.x,d.rotation.y,d.rotation.z);g.scale.set(b.z,b.x,b.y);s.debug&&(v.position.set(a.x,a.y,a.z),v.rotation.set(d.rotation.x,d.rotation.y,d.rotation.z),v.scale.set(b.z,b.x,b.y));r.uniforms.worldSize.value.copy(b)};this.renderShadow=function(b){var c=b.overrideMaterial;b.overrideMaterial=m;a.render(b,d,k,!1);b.overrideMaterial=c};this.clear=function(){var b=a.getClearColor().getHex(),c=a.getClearAlpha();a.setClearColor(0,0);a.clearTarget(k,
!0,!0,!1);a.setClearColor(b,c)};this.renderPost=function(b,c){this.enabled&&(this.bufferValid||(q.render(a,l,k),n.render(a,k,l),this.bufferValid=!0),this.rendered||(c?a.render(f,b,c,!1):a.render(f,b),this.rendered=!0))};this.reset=function(){this.enabled&&(this.clear(),this.rendered=this.bufferValid=!1)};this.updateTransform=function(a,b){var c=new THREE.Vector3(1,0,0),d=b.center(),f=b.size();a.worldUpTransform&&(c.applyMatrix4(a.worldUpTransform),b.applyMatrix4(a.worldUpTransform),f=b.size());f.multiply(new THREE.Vector3(1.25,
1.01,1.25));f.x=f.z=Math.max(f.x,f.z);this.setTransform(d,f,a.worldup,c)};if(b)for(h in s)s[h]=b[h]||s[h];f=new THREE.Scene;d=new THREE.OrthographicCamera;k=new THREE.WebGLRenderTarget(s.texSize,s.texSize,{minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBAFormat,stencilBuffer:!1});k.generateMipmaps=!1;l=new THREE.WebGLRenderTarget(s.texSize,s.texSize,{minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBAFormat,stencilBuffer:!1});l.generateMipmaps=!1;
m=c(GroundDepthShader);m.side=THREE.DoubleSide;m.blending=THREE.NoBlending;n=new THREE.ShaderPass(GroundShadowBlurShader,"tDepth");q=new THREE.ShaderPass(GroundShadowBlurShader,"tDepth");r=new THREE.ShaderPass(GroundShadowAOShader,"tDepth");n.material.defines.KERNEL_SCALE=q.material.defines.KERNEL_SCALE=(s.pixScale/s.texSize).toFixed(4);n.material.defines.KERNEL_RADIUS=q.material.defines.KERNEL_RADIUS=s.blurRadius.toFixed(2);r.material.blending=n.material.blending=q.material.blending=THREE.NoBlending;
r.material.depthWrite=n.material.depthWrite=q.material.depthWrite=!1;r.material.depthTest=n.material.depthTest=q.material.depthTest=!1;n.material.defines.HORIZONTAL=1;p=c(GroundShadowColorShader);p.uniforms.tDepth.value=k;p.depthWrite=!1;p.transparent=!0;p.defines.SHADOW_COLOR="vec4("+s.color.r+", "+s.color.g+", "+s.color.b+", "+s.alpha+")";h=new THREE.BufferGeometry;h.addAttribute("position",new THREE.BufferAttribute(new Float32Array([-0.5,-0.5,0.5,-0.5,0.5,0.5,0.5,0.5,0.5,0.5,-0.5,0.5]),3));h.addAttribute("uv",
new THREE.BufferAttribute(new Float32Array([0,0,0,1,1,1,1,0]),2));h.addAttribute("index",new THREE.BufferAttribute(new Uint16Array([0,1,2,2,3,0]),1));g=new THREE.Mesh(h,p);f.add(g);s.debug&&(v=new THREE.Mesh(new THREE.BoxGeometry(1,1,1),new THREE.MeshBasicMaterial({color:65280,wireframe:!0})),f.add(v));this.setTransform(new THREE.Vector3(0,0,0),new THREE.Vector3(1,1,1),new THREE.Vector3(0,1,0))};GroundShadow.prototype.constructor=GroundShadow;AutodeskNamespace("Autodesk.Viewing.Private");
Autodesk.Viewing.Private.INTERPOLATION_TYPE={LINEAR:0,CATMULLROM:1,CATMULLROM_FORWARD:2};Autodesk.Viewing.Private.AnimationHandler=function(){this.animations=[]};
Autodesk.Viewing.Private.AnimationHandler.prototype.init=function(a){if(!0===a.initialized)return a;for(var b=0;b<a.hierarchy.length;b++){for(var c=0;c<a.hierarchy[b].keys.length;c++)if(0>a.hierarchy[b].keys[c].time&&(a.hierarchy[b].keys[c].time=0),void 0!==a.hierarchy[b].keys[c].rot&&!(a.hierarchy[b].keys[c].rot instanceof THREE.Quaternion)){var d=a.hierarchy[b].keys[c].rot;Array.isArray(d)||(d=[d._x,d._y,d._z,d._w]);a.hierarchy[b].keys[c].rot=(new THREE.Quaternion).fromArray(d)}for(c=1;c<a.hierarchy[b].keys.length;c++)a.hierarchy[b].keys[c].time===
a.hierarchy[b].keys[c-1].time&&(a.hierarchy[b].keys.splice(c,1),c--);for(c=0;c<a.hierarchy[b].keys.length;c++)a.hierarchy[b].keys[c].index=c}a.initialized=!0;return a};Autodesk.Viewing.Private.AnimationHandler.prototype.parse=function(a){function b(a,c){c.push(a);if(a.children&&!(a instanceof THREE.Camera))for(var g=0;g<a.children.length;g++)b(a.children[g],c)}var c=[];b(a,c);return c};Autodesk.Viewing.Private.AnimationHandler.prototype.play=function(a){-1===this.animations.indexOf(a)&&this.animations.push(a)};
Autodesk.Viewing.Private.AnimationHandler.prototype.stop=function(a){a=this.animations.indexOf(a);-1!==a&&this.animations.splice(a,1)};Autodesk.Viewing.Private.AnimationHandler.prototype.update=function(a){for(var b=0;b<this.animations.length;b++)this.animations[b].update(a)};
Autodesk.Viewing.Private.Animation=function(a,b,c){this.root=a;this.handler=c.animationHandler;this.data=this.handler.init(b);this.hierarchy=this.handler.parse(a);this.viewer=c.viewer;this.animator=c;this.currentTime=0;this.timeScale=1;this.isPlaying=!1;this.isPaused=!0;this.loop=!1;this.delta=0.5;this.interpolationType=Autodesk.Viewing.Private.INTERPOLATION_TYPE.LINEAR;this.setStartAndEndKeyTime()};
Autodesk.Viewing.Private.Animation.prototype.setStartAndEndKeyTime=function(){if(0<this.data.hierarchy.length){var a=this.data.hierarchy[0].keys;this.startKeyTime=a[0].time;this.endKeyTime=a[a.length-1].time}else this.startKeyTime=this.endKeyTime=0};Autodesk.Viewing.Private.Animation.prototype.keyTypes=[];Autodesk.Viewing.Private.Animation.prototype.defaultKey={};
Autodesk.Viewing.Private.Animation.prototype.play=function(a){this.currentTime=void 0!==a?a:0;this.isPlaying=!0;this.isPaused=!1;this.reset();this.handler.play(this)};Autodesk.Viewing.Private.Animation.prototype.pause=function(){!0===this.isPaused?this.handler.play(this):this.handler.stop(this);this.isPaused=!this.isPaused};Autodesk.Viewing.Private.Animation.prototype.stop=function(){this.isPaused=this.isPlaying=!1;this.handler.stop(this)};
Autodesk.Viewing.Private.Animation.prototype.goto=function(a){this.isPlaying||this.play();this.isPaused||this.pause();this.update(a-this.currentTime)};
Autodesk.Viewing.Private.Animation.prototype.reset=function(){for(var a=0,b=this.hierarchy.length;a<b;a++){var c=this.hierarchy[a];void 0===c.animationCache&&(c.animationCache={});void 0===c.animationCache[this.data.name]&&(c.animationCache[this.data.name]={},c.animationCache[this.data.name].prevKey=this.defaultKey,c.animationCache[this.data.name].nextKey=this.defaultKey,c.animationCache[this.data.name].originalMatrix=c.matrix);for(var c=c.animationCache[this.data.name],d=0;d<this.keyTypes.length;d++){for(var f=
this.keyTypes[d],g=this.data.hierarchy[a].keys[0],h=this.getNextKeyWith(f,a,1);h.time<this.currentTime&&h.index>g.index;)g=h,h=this.getNextKeyWith(f,a,h.index+1);c.prevKey[f]=g;c.nextKey[f]=h}}this.setStartAndEndKeyTime()};
Autodesk.Viewing.Private.Animation.prototype.getNextKeyWith=function(a,b,c){var d=this.data.hierarchy[b].keys;for(c=this.interpolationType===Autodesk.Viewing.Private.INTERPOLATION_TYPE.CATMULLROM||this.interpolationType===Autodesk.Viewing.Private.INTERPOLATION_TYPE.CATMULLROM_FORWARD?c<d.length-1?c:d.length-1:c%d.length;c<d.length;c++)if(void 0!==d[c][a])return d[c];return this.data.hierarchy[b].keys[0]};
Autodesk.Viewing.Private.Animation.prototype.getPrevKeyWith=function(a,b,c){var d=this.data.hierarchy[b].keys;for(c=this.interpolationType===Autodesk.Viewing.Private.INTERPOLATION_TYPE.CATMULLROM||this.interpolationType===Autodesk.Viewing.Private.INTERPOLATION_TYPE.CATMULLROM_FORWARD?0<c?c:0:0<=c?c:c+d.length;0<=c;c--)if(void 0!==d[c][a])return d[c];return this.data.hierarchy[b].keys[d.length-1]};
Autodesk.Viewing.Private.Animation.prototype.isPlayingOutOfRange=function(){return!1===this.isPaused&&(this.currentTime<this.startKeyTime-this.delta||this.currentTime>this.endKeyTime+this.delta)};Autodesk.Viewing.Private.Animation.prototype.resetIfLooped=function(){!0===this.loop&&this.currentTime>this.endKeyTime&&(this.currentTime%=this.endKeyTime,this.reset())};
Autodesk.Viewing.Private.MeshAnimation=function(a,b,c){Autodesk.Viewing.Private.Animation.call(this,a,b,c);this.originalMatrix=a.matrix.clone();this.localMatrix=new THREE.Matrix4;(this.relativeTransform=b.transform&&"abs"===b.transform?!1:!0)?this.root.updateMatrixWorld():this.root.matrix.decompose(this.root.position,this.root.quaternion,this.root.scale)};Autodesk.Viewing.Private.MeshAnimation.prototype=Object.create(Autodesk.Viewing.Private.Animation.prototype);
Autodesk.Viewing.Private.MeshAnimation.prototype.constructor=Autodesk.Viewing.Private.MeshAnimation;Autodesk.Viewing.Private.MeshAnimation.prototype.keyTypes=["pos","rot","scl"];Autodesk.Viewing.Private.MeshAnimation.prototype.defaultKey={pos:0,rot:0,scl:0};
Autodesk.Viewing.Private.MeshAnimation.prototype.update=function(){var a=[],b=new THREE.Vector3,c=new THREE.Vector3,d=new THREE.Quaternion;return function(f){if(!1!==this.isPlaying&&(this.currentTime+=f*this.timeScale,this.resetIfLooped(),!this.isPlayingOutOfRange())){f=0;for(var g=this.hierarchy.length;f<g;f++){for(var h=this.hierarchy[f],k=h.animationCache[this.data.name],l=0;l<this.keyTypes.length;l++){var m=this.keyTypes[l],p=k.prevKey[m],n=k.nextKey[m];if(n.time<=this.currentTime||p.time>=this.currentTime){p=
this.data.hierarchy[f].keys[0];for(n=this.getNextKeyWith(m,f,1);n.time<this.currentTime&&n.index>p.index;)p=n,n=this.getNextKeyWith(m,f,n.index+1);k.prevKey[m]=p;k.nextKey[m]=n}var q=p[m],r=n[m];if(n.time!==p.time&&void 0!==q&&void 0!==r){var v=(this.currentTime-p.time)/(n.time-p.time);0>v&&(v=0);1<v&&(v=1);if("pos"===m)if(this.interpolationType===Autodesk.Viewing.Private.INTERPOLATION_TYPE.LINEAR)c.x=q[0]+(r[0]-q[0])*v,c.y=q[1]+(r[1]-q[1])*v,c.z=q[2]+(r[2]-q[2])*v,h.position.copy(c);else{if(this.interpolationType===
Autodesk.Viewing.Private.INTERPOLATION_TYPE.CATMULLROM||this.interpolationType===Autodesk.Viewing.Private.INTERPOLATION_TYPE.CATMULLROM_FORWARD)a[0]=this.getPrevKeyWith("pos",f,p.index-1).pos,a[1]=q,a[2]=r,a[3]=this.getNextKeyWith("pos",f,n.index+1).pos,v=0.33*v+0.33,m=interpolateCatmullRom(a,v),c.x=m[0],c.y=m[1],c.z=m[2],h.position.copy(c),this.interpolationType===Autodesk.Viewing.Private.INTERPOLATION_TYPE.CATMULLROM_FORWARD&&(v=interpolateCatmullRom(a,1.01*v),b.set(v[0],v[1],v[2]),b.sub(vector),
b.y=0,b.normalize(),v=Math.atan2(b.x,b.z),h.rotation.set(0,v,0))}else"rot"===m?(THREE.Quaternion.slerp(q,r,d,v),h.quaternion.copy(d)):"scl"===m&&(c.x=q[0]+(r[0]-q[0])*v,c.y=q[1]+(r[1]-q[1])*v,c.z=q[2]+(r[2]-q[2])*v,h.scale.copy(c))}}this.relativeTransform?(this.localMatrix.compose(h.position,h.quaternion,h.scale),h.matrix.multiplyMatrices(this.localMatrix,this.originalMatrix),h.matrixAutoUpdate=!1):h.matrixAutoUpdate=!0;h.matrixWorldNeedsUpdate=!0;h.updateMatrixWorld()}}}}();
Autodesk.Viewing.Private.CameraAnimation=function(a,b,c){Autodesk.Viewing.Private.Animation.call(this,a,b,c)};Autodesk.Viewing.Private.CameraAnimation.prototype=Object.create(Autodesk.Viewing.Private.Animation.prototype);Autodesk.Viewing.Private.CameraAnimation.prototype.constructor=Autodesk.Viewing.Private.CameraAnimation;Autodesk.Viewing.Private.CameraAnimation.prototype.keyTypes=["pos","up","target","fov","perspective"];
Autodesk.Viewing.Private.CameraAnimation.prototype.defaultKey={pos:0,up:0,target:0,fov:0,perspective:0};
Autodesk.Viewing.Private.CameraAnimation.prototype.update=function(){var a=[],b=new THREE.Vector3,c=new THREE.Vector3;return function(d){if(!1!==this.isPlaying&&(this.currentTime+=d*this.timeScale,this.resetIfLooped(),!this.isPlayingOutOfRange())){d=0;for(var f=this.hierarchy.length;d<f;d++){for(var g=this.hierarchy[d],h=g.animationCache[this.data.name],k=0;k<this.keyTypes.length;k++){var l=this.keyTypes[k],m=h.prevKey[l],p=h.nextKey[l];if(p.time<=this.currentTime||m.time>=this.currentTime){m=this.data.hierarchy[d].keys[0];
for(p=this.getNextKeyWith(l,d,1);p.time<this.currentTime&&p.index>m.index;)m=p,p=this.getNextKeyWith(l,d,p.index+1);h.prevKey[l]=m;h.nextKey[l]=p}var n=m[l],q=p[l];if(p.time!==m.time&&void 0!==n&&void 0!==q){var r=(this.currentTime-m.time)/(p.time-m.time);0>r&&(r=0);1<r&&(r=1);var v;if("pos"===l)v=g.position;else if("up"===l)v=g.up;else if("target"===l)v=g.target;else if("fov"===l){g.setFov(n+(q-n)*r);continue}else if("perspective"===l){(0.5<r?q:n)?g.toPerspective():g.toOrthographic();continue}if(this.interpolationType===
Autodesk.Viewing.Private.INTERPOLATION_TYPE.LINEAR)c.x=n[0]+(q[0]-n[0])*r,c.y=n[1]+(q[1]-n[1])*r,c.z=n[2]+(q[2]-n[2])*r,v.copy(c);else if(this.interpolationType===Autodesk.Viewing.Private.INTERPOLATION_TYPE.CATMULLROM||this.interpolationType===Autodesk.Viewing.Private.INTERPOLATION_TYPE.CATMULLROM_FORWARD)a[0]=this.getPrevKeyWith(l,d,m.index-1)[l],a[1]=n,a[2]=q,a[3]=this.getNextKeyWith(l,d,p.index+1)[l],r=0.33*r+0.33,l=interpolateCatmullRom(a,r),c.x=l[0],c.y=l[1],c.z=l[2],v.copy(c),this.interpolationType===
Autodesk.Viewing.Private.INTERPOLATION_TYPE.CATMULLROM_FORWARD&&(r=interpolateCatmullRom(a,1.01*r),b.set(r[0],r[1],r[2]),b.sub(v),b.y=0,b.normalize(),r=Math.atan2(b.x,b.z),g.rotation.set(0,r,0))}}g.matrixAutoUpdate=!0;g.matrixWorldNeedsUpdate=!0}g.lookAt(g.target);this.animator.updateFlag|=this.animator.UPDATE_CAMERA}}}();Autodesk.Viewing.Private.VisibilityAnimation=function(a,b,c,d){Autodesk.Viewing.Private.Animation.call(this,a,b,d);this.node=c;this.epsilon=0.1;this.root.material=this.viewer.matman().cloneMaterial(a.material)};
Autodesk.Viewing.Private.VisibilityAnimation.prototype=Object.create(Autodesk.Viewing.Private.Animation.prototype);Autodesk.Viewing.Private.VisibilityAnimation.prototype.constructor=Autodesk.Viewing.Private.VisibilityAnimation;Autodesk.Viewing.Private.VisibilityAnimation.prototype.keyTypes=["vis","opa"];Autodesk.Viewing.Private.VisibilityAnimation.prototype.defaultKey={viz:1,opa:1};
Autodesk.Viewing.Private.VisibilityAnimation.prototype.update=function(){return function(a){if(!1!==this.isPlaying&&(this.currentTime+=a*this.timeScale,this.resetIfLooped(),!this.isPlayingOutOfRange())){a=0;for(var b=this.hierarchy.length;a<b;a++)for(var c=this.hierarchy[a],d=c.animationCache[this.data.name],f=0;f<this.keyTypes.length;f++){var g=this.keyTypes[f],h=d.prevKey[g],k=d.nextKey[g];if(k.time<=this.currentTime||h.time>=this.currentTime){h=this.data.hierarchy[a].keys[0];for(k=this.getNextKeyWith(g,
a,1);k.time<this.currentTime&&k.index>h.index;)h=k,k=this.getNextKeyWith(g,a,k.index+1);d.prevKey[g]=h;d.nextKey[g]=k}var l=h[g],m=k[g];k.time!==h.time&&void 0!==l&&void 0!==m&&("vis"===g?(h=(g=Math.abs(this.currentTime-k.time)<this.epsilon)?k:h,l=g?m:l,1===l&&void 0===h.opa&&(c.material.transparent=!1,c.material.opacity=1),this.viewer.visibilityManager.setVisibilityOnNode(this.node,l)):"opa"===g&&(h=(this.currentTime-h.time)/(k.time-h.time),0>h&&(h=0),1<h&&(h=1),l+=(m-l)*h,c.material.transparent=
1===l?!1:!0,c.material.opacity=l,0<l&&this.viewer.visibilityManager.setVisibilityOnNode(this.node,1)))}}}}();
Autodesk.Viewing.Private.AnnotationAnimation=function(a,b,c){function d(a,b,c){var d=f.container=document.createElement("div");d.id=a;d.style.cursor="pointer";d.style.visibility=c;var m=document.createElement("div");m.id=a+"-txt";m.style.cssText="display: none;position: absolute;z-index: 1;color: #eeeeee;font-family: consolas,courier,monospace;font-size: 14px;background: rgba(34,34,34,0.8);padding: 6px 6px 6px 6px;";d.appendChild(m);c=document.createElement("img");c.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAAKT2lDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVNnVFPpFj333vRCS4iAlEtvUhUIIFJCi4AUkSYqIQkQSoghodkVUcERRUUEG8igiAOOjoCMFVEsDIoK2AfkIaKOg6OIisr74Xuja9a89+bN/rXXPues852zzwfACAyWSDNRNYAMqUIeEeCDx8TG4eQuQIEKJHAAEAizZCFz/SMBAPh+PDwrIsAHvgABeNMLCADATZvAMByH/w/qQplcAYCEAcB0kThLCIAUAEB6jkKmAEBGAYCdmCZTAKAEAGDLY2LjAFAtAGAnf+bTAICd+Jl7AQBblCEVAaCRACATZYhEAGg7AKzPVopFAFgwABRmS8Q5ANgtADBJV2ZIALC3AMDOEAuyAAgMADBRiIUpAAR7AGDIIyN4AISZABRG8lc88SuuEOcqAAB4mbI8uSQ5RYFbCC1xB1dXLh4ozkkXKxQ2YQJhmkAuwnmZGTKBNA/g88wAAKCRFRHgg/P9eM4Ors7ONo62Dl8t6r8G/yJiYuP+5c+rcEAAAOF0ftH+LC+zGoA7BoBt/qIl7gRoXgugdfeLZrIPQLUAoOnaV/Nw+H48PEWhkLnZ2eXk5NhKxEJbYcpXff5nwl/AV/1s+X48/Pf14L7iJIEyXYFHBPjgwsz0TKUcz5IJhGLc5o9H/LcL//wd0yLESWK5WCoU41EScY5EmozzMqUiiUKSKcUl0v9k4t8s+wM+3zUAsGo+AXuRLahdYwP2SycQWHTA4vcAAPK7b8HUKAgDgGiD4c93/+8//UegJQCAZkmScQAAXkQkLlTKsz/HCAAARKCBKrBBG/TBGCzABhzBBdzBC/xgNoRCJMTCQhBCCmSAHHJgKayCQiiGzbAdKmAv1EAdNMBRaIaTcA4uwlW4Dj1wD/phCJ7BKLyBCQRByAgTYSHaiAFiilgjjggXmYX4IcFIBBKLJCDJiBRRIkuRNUgxUopUIFVIHfI9cgI5h1xGupE7yAAygvyGvEcxlIGyUT3UDLVDuag3GoRGogvQZHQxmo8WoJvQcrQaPYw2oefQq2gP2o8+Q8cwwOgYBzPEbDAuxsNCsTgsCZNjy7EirAyrxhqwVqwDu4n1Y8+xdwQSgUXACTYEd0IgYR5BSFhMWE7YSKggHCQ0EdoJNwkDhFHCJyKTqEu0JroR+cQYYjIxh1hILCPWEo8TLxB7iEPENyQSiUMyJ7mQAkmxpFTSEtJG0m5SI+ksqZs0SBojk8naZGuyBzmULCAryIXkneTD5DPkG+Qh8lsKnWJAcaT4U+IoUspqShnlEOU05QZlmDJBVaOaUt2ooVQRNY9aQq2htlKvUYeoEzR1mjnNgxZJS6WtopXTGmgXaPdpr+h0uhHdlR5Ol9BX0svpR+iX6AP0dwwNhhWDx4hnKBmbGAcYZxl3GK+YTKYZ04sZx1QwNzHrmOeZD5lvVVgqtip8FZHKCpVKlSaVGyovVKmqpqreqgtV81XLVI+pXlN9rkZVM1PjqQnUlqtVqp1Q61MbU2epO6iHqmeob1Q/pH5Z/YkGWcNMw09DpFGgsV/jvMYgC2MZs3gsIWsNq4Z1gTXEJrHN2Xx2KruY/R27iz2qqaE5QzNKM1ezUvOUZj8H45hx+Jx0TgnnKKeX836K3hTvKeIpG6Y0TLkxZVxrqpaXllirSKtRq0frvTau7aedpr1Fu1n7gQ5Bx0onXCdHZ4/OBZ3nU9lT3acKpxZNPTr1ri6qa6UbobtEd79up+6Ynr5egJ5Mb6feeb3n+hx9L/1U/W36p/VHDFgGswwkBtsMzhg8xTVxbzwdL8fb8VFDXcNAQ6VhlWGX4YSRudE8o9VGjUYPjGnGXOMk423GbcajJgYmISZLTepN7ppSTbmmKaY7TDtMx83MzaLN1pk1mz0x1zLnm+eb15vft2BaeFostqi2uGVJsuRaplnutrxuhVo5WaVYVVpds0atna0l1rutu6cRp7lOk06rntZnw7Dxtsm2qbcZsOXYBtuutm22fWFnYhdnt8Wuw+6TvZN9un2N/T0HDYfZDqsdWh1+c7RyFDpWOt6azpzuP33F9JbpL2dYzxDP2DPjthPLKcRpnVOb00dnF2e5c4PziIuJS4LLLpc+Lpsbxt3IveRKdPVxXeF60vWdm7Obwu2o26/uNu5p7ofcn8w0nymeWTNz0MPIQ+BR5dE/C5+VMGvfrH5PQ0+BZ7XnIy9jL5FXrdewt6V3qvdh7xc+9j5yn+M+4zw33jLeWV/MN8C3yLfLT8Nvnl+F30N/I/9k/3r/0QCngCUBZwOJgUGBWwL7+Hp8Ib+OPzrbZfay2e1BjKC5QRVBj4KtguXBrSFoyOyQrSH355jOkc5pDoVQfujW0Adh5mGLw34MJ4WHhVeGP45wiFga0TGXNXfR3ENz30T6RJZE3ptnMU85ry1KNSo+qi5qPNo3ujS6P8YuZlnM1VidWElsSxw5LiquNm5svt/87fOH4p3iC+N7F5gvyF1weaHOwvSFpxapLhIsOpZATIhOOJTwQRAqqBaMJfITdyWOCnnCHcJnIi/RNtGI2ENcKh5O8kgqTXqS7JG8NXkkxTOlLOW5hCepkLxMDUzdmzqeFpp2IG0yPTq9MYOSkZBxQqohTZO2Z+pn5mZ2y6xlhbL+xW6Lty8elQfJa7OQrAVZLQq2QqboVFoo1yoHsmdlV2a/zYnKOZarnivN7cyzytuQN5zvn//tEsIS4ZK2pYZLVy0dWOa9rGo5sjxxedsK4xUFK4ZWBqw8uIq2Km3VT6vtV5eufr0mek1rgV7ByoLBtQFr6wtVCuWFfevc1+1dT1gvWd+1YfqGnRs+FYmKrhTbF5cVf9go3HjlG4dvyr+Z3JS0qavEuWTPZtJm6ebeLZ5bDpaql+aXDm4N2dq0Dd9WtO319kXbL5fNKNu7g7ZDuaO/PLi8ZafJzs07P1SkVPRU+lQ27tLdtWHX+G7R7ht7vPY07NXbW7z3/T7JvttVAVVN1WbVZftJ+7P3P66Jqun4lvttXa1ObXHtxwPSA/0HIw6217nU1R3SPVRSj9Yr60cOxx++/p3vdy0NNg1VjZzG4iNwRHnk6fcJ3/ceDTradox7rOEH0x92HWcdL2pCmvKaRptTmvtbYlu6T8w+0dbq3nr8R9sfD5w0PFl5SvNUyWna6YLTk2fyz4ydlZ19fi753GDborZ752PO32oPb++6EHTh0kX/i+c7vDvOXPK4dPKy2+UTV7hXmq86X23qdOo8/pPTT8e7nLuarrlca7nuer21e2b36RueN87d9L158Rb/1tWeOT3dvfN6b/fF9/XfFt1+cif9zsu72Xcn7q28T7xf9EDtQdlD3YfVP1v+3Njv3H9qwHeg89HcR/cGhYPP/pH1jw9DBY+Zj8uGDYbrnjg+OTniP3L96fynQ89kzyaeF/6i/suuFxYvfvjV69fO0ZjRoZfyl5O/bXyl/erA6xmv28bCxh6+yXgzMV70VvvtwXfcdx3vo98PT+R8IH8o/2j5sfVT0Kf7kxmTk/8EA5jz/GMzLdsAAAAgY0hSTQAAeiUAAICDAAD5/wAAgOkAAHUwAADqYAAAOpgAABdvkl/FRgAABoZJREFUeNrEl1uMVVcZx39r329nnzNzzlwYBgq0BAhIQ4iKvShM2xgeDCY02kbl2Rol+GBiE5940QcfjI0xTRMTqm1DFFu5WGwLtqECsY5UNEpLEQiFYZjDmcvZZ++zb2v7MGcI1TntDDXpTtbD3lkr/9/61v/79rdEURR8ko/CJ/xo830UQnRdcNe2/kHFUHYKwSMIsVJAbwENiuJiUfCqTOSBy3+8cb3b+v+OuJjvCOYDWPZgX4/uqHt8v/TEpnvX22tW32P29pRV13VEqxUWjanp/N3zF+Izf/tHND3d/Hka5j+5cmJi8v8BIFY8PDCiGepz2z7/Oe/B+7Y4Sd4SURqS5jG5zAGJqmg4ho9nVoo3T70VHnv9zSCNs69dem38OFDcKYC4a6R/q+1Z+x/b+aXy8hWDRtCeRhEqumqgCAVZSNI8Js4i4qyNqij0+UsZuzKZ/Gr/gemoFX/j0rHxV+YgFgWg2aq1Ylv/5ccf/XJl2Yo+o522sHUPx/SxdAdFUZEyp52GhPEMQTxNlAYA9PtD3ByPkmf2PTf1/qn6ivZkEs0H8GFZoAzfX/v+lk9vdlbePWSEyQy27lF2alS9QWqlIfr8YWqlIareIGWnhmeWMTUbKXMmmmMML+8ztj3wgDO4uefJblpdAarr/F7Hs7418oX73MnWDTTFwDF9fLuXittHj9dPj9tPj9dPxe3Dt3txTB9Ts1EVjSxPmWhe5YsPbXMdz/lmdZ3fuxgAxR2wdmzcsM6SIhF5kaOrJpbuYBsejlnCMUqYmoVjlHDMErbhYekOumqiKLPZ3U4ipGiLz27aZLkD1o759LoBaIomRtasvscM4mkoQBEKiqKiqjqqon9gsqroqKqOoqgoQkEw66ECSStt8qn1601FEyPz1Z1uALpQxcbhoSVaOw0pKJCFRMqcPE/JZfqByblMyfMUKXNkISk6WScQJFmblcuWa0IVGwF9QZUQ0ISg5pdK4kaYogiVNI9ppyFREmDG9q2d5zIljJtESUC7UxukzGZ3pygIoFKuCCGozaenfcg/IhOAEAq5zIiziDCeQVcNAOI0QlV18jwlSgJmogZhPEOcReQyQwiBqmpomo6mal0jrnUt2ZJGq9VeYuqWGsYBcRYRxNMApHnStQ7EWURBga7qGJqJbbgEQVgUksaCf0aAlJm8dLMxtbbUV1bjLCLPM6I0QBY5cRbNuv1/KuHs7lVVxdBNLMPBsytcuzKWyUy+B8iFmjDPovzEP8+9m1a9AUzdRlVVcpkRJQHN9iRTUZ3JcIKpqE6zPUmUBLfETd3CMT1cy6NiVxk9ezbNovwEkC0UIGucD46cHv1LbCl+UXGrWIaNrukgIJMpSRYRZyFJFpHJFATomo5l2LhWCc/2KTs11MIq3jh1Im6cD44sBiCN6vHETD14/sirx8Lh6irKbhXXLmFbDqZhoms6mqahazqmYWJbDq5douRU8N0KZbeXPn8pvz78UjRdb74Q1eMJIF2wB4DW1ZM3f/pK6bXHN6xdp9+9epVxM7hGlIRkWUouMwoKBAJVmXW7qVtYhoNrleh1Bzn3zoXk4B8OR2N/bjwFtBbjAYC4kEVj5v3wez/7xdOt61ca+bLqavrLQ/SUavSW+m6Nufcer0a11M+Av5zLF6+lP3rqx63mtejJPJF1IJ63+/qIfsAE+nrXlL69ZE3tu1/ZsdPYPvIImYiIspA8Tyko0BQVQ3NwDA+lMIsXf/+79vMv7Y+a18K9429PHQAm5gAW3ZAALvCd428c/8HR04ect945Wdz/mS3p5o2blKVDQ2rJLYlWq1VcvT6Wj/79TPry8aPx2OUbv62fm3m23Uj+DdSBdreGRFtA47p29+7dI8NLhp2vPvx1/nX6/OgzTz974Zc9LyxXNGVYKLiFpCUzeSUN879OX2wdao23LwJTQBNIbm/JFmrC2z2yZdeuXVsajQb1er116MXDR4HfAAOA13F2AMwA053R6oQ8v6O2/Lbw37tnz54dlUrFC4KAffv2vQ28BzzUEZ8ELgNXgfGOaLoQ4YV4QAWeGB0d/aGU0qvX663t27e/3AmrBMaAY8AZIOyIyo8SXIwHnOHh4Q3VatVLkoS9e/deB3ygARwH/tSBiRYqvtgI2MBjW7dufdT3/drBgwfPAieB128TnjvnBV8wF5OGBlABVnVS8VLHbHMGyxYjfCcASueIzLkGpZNSdyT8sa5mnVF8HOFuAP8ZACU8JwMXmnEcAAAAAElFTkSuQmCC";
c.id=a+"-img";c.style.cssText="display: block;position: absolute;z-index: 1;";d.appendChild(c);b.api.container.appendChild(d);d.addEventListener("click",function(){m.style.display="none"===m.style.display?"block":"none"});c=new THREE.SphereGeometry(0.01);a=new THREE.MeshPhongMaterial({color:32512,ambient:32512,opacity:0.6,transparent:!0});d=new THREE.MeshPhongMaterial({color:32512,ambient:32512,opacity:0.6,transparent:!0});c=new THREE.Mesh(c,d);c.visible=!1;void 0===b.overlayScenes.annotation&&b.createOverlayScene("annotation",
a,d);b.addOverlay("annotation",c);return c}var f=this;null===a&&(a=d(b.name,c.viewer,"hidden"));Autodesk.Viewing.Private.Animation.call(this,a,b,c);this.id=b.name;this.text="";this.state="hidden";this.epsilon=0.1;f=this;this.viewer.api.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,function(b){f.updateText(a.position,f.text)})};Autodesk.Viewing.Private.AnnotationAnimation.prototype=Object.create(Autodesk.Viewing.Private.Animation.prototype);
Autodesk.Viewing.Private.AnnotationAnimation.prototype.constructor=Autodesk.Viewing.Private.AnnotationAnimation;Autodesk.Viewing.Private.AnnotationAnimation.prototype.keyTypes=["pos","text","vis"];Autodesk.Viewing.Private.AnnotationAnimation.prototype.defaultKey={pos:0,text:"",vis:1};
Autodesk.Viewing.Private.AnnotationAnimation.prototype.stop=function(){Autodesk.Viewing.Private.Animation.prototype.stop.call(this);this.container.parentNode.removeChild(this.container);this.viewer.removeOverlay("annotation",this.root);this.root=null};
Autodesk.Viewing.Private.AnnotationAnimation.prototype.updateText=function(a,b){var c,d;c=this.viewer.camera;d=this.viewer.canvas;var f=a.clone(),g=new THREE.Matrix4;c.updateMatrixWorld();c.matrixWorldInverse.getInverse(c.matrixWorld);g.multiplyMatrices(c.projectionMatrix,c.matrixWorldInverse);f.applyProjection(g);c=(f.x+1)*d.width/2+d.offsetLeft;d=(-f.y+1)*d.height/2+d.offsetTop;if(f=document.getElementById(this.id+"-txt"))f.innerHTML=b,f.style.left=c+"px",f.style.top=d+"px",this.text=b;if(f=document.getElementById(this.id+
"-img"))f.style.left=c+"px",f.style.top=d-24+"px"};
Autodesk.Viewing.Private.AnnotationAnimation.prototype.update=function(){var a=[],b=new THREE.Vector3,c=new THREE.Vector3;return function(d){if(!1!==this.isPlaying&&(this.currentTime+=d*this.timeScale,this.resetIfLooped(),!this.isPlayingOutOfRange()))if(this.isPaused&&this.currentTime<this.startKeyTime){var f=document.getElementById(this.id);f&&(f.style.visibility=this.state)}else{d=0;for(var g=this.hierarchy.length;d<g;d++){for(var h=this.hierarchy[d],k=h.animationCache[this.data.name],l=0;l<this.keyTypes.length;l++){var m=
this.keyTypes[l],p=k.prevKey[m],n=k.nextKey[m];if(n.time<=this.currentTime||p.time>=this.currentTime){p=this.data.hierarchy[d].keys[0];for(n=this.getNextKeyWith(m,d,1);n.time<this.currentTime&&n.index>p.index;)p=n,n=this.getNextKeyWith(m,d,n.index+1);k.prevKey[m]=p;k.nextKey[m]=n}var q=p[m],r=n[m];if(n.time!==p.time&&void 0!==q&&void 0!==r)if(f=(this.currentTime-p.time)/(n.time-p.time),0>f&&(f=0),1<f&&(f=1),"pos"===m)if(this.interpolationType===Autodesk.Viewing.Private.INTERPOLATION_TYPE.LINEAR)c.x=
q[0]+(r[0]-q[0])*f,c.y=q[1]+(r[1]-q[1])*f,c.z=q[2]+(r[2]-q[2])*f,h.position.copy(c);else{if(this.interpolationType===Autodesk.Viewing.Private.INTERPOLATION_TYPE.CATMULLROM||this.interpolationType===Autodesk.Viewing.Private.INTERPOLATION_TYPE.CATMULLROM_FORWARD)a[0]=this.getPrevKeyWith("pos",d,p.index-1).pos,a[1]=q,a[2]=r,a[3]=this.getNextKeyWith("pos",d,n.index+1).pos,f=0.33*f+0.33,n=interpolateCatmullRom(a,f),c.x=n[0],c.y=n[1],c.z=n[2],h.position.copy(c),this.interpolationType===Autodesk.Viewing.Private.INTERPOLATION_TYPE.CATMULLROM_FORWARD&&
(n=interpolateCatmullRom(a,1.01*f),b.set(n[0],n[1],n[2]),b.sub(vector),b.y=0,b.normalize(),n=Math.atan2(b.x,b.z),h.rotation.set(0,n,0))}else"text"===m?(n=Math.abs(this.currentTime-n.time)<this.epsilon?r:q,this.updateText(h.position,n)):"vis"===m&&(f=document.getElementById(this.id))&&(n=Math.abs(this.currentTime-n.time)<this.epsilon?r:q,f.style.visibility=n?"visible":"hidden")}h.matrixAutoUpdate=!0;h.matrixWorldNeedsUpdate=!0}}}}();
Autodesk.Viewing.Private.PolylineAnimation=function(a,b,c){this.viewer=c.viewer;null===a&&(a=this.createPolyline([]));Autodesk.Viewing.Private.Animation.call(this,a,b,c);this.epsilon=0.1};Autodesk.Viewing.Private.PolylineAnimation.prototype=Object.create(Autodesk.Viewing.Private.Animation.prototype);Autodesk.Viewing.Private.PolylineAnimation.prototype.constructor=Autodesk.Viewing.Private.PolylineAnimation;Autodesk.Viewing.Private.PolylineAnimation.prototype.keyTypes=["points","vis"];
Autodesk.Viewing.Private.PolylineAnimation.prototype.defaultKey={points:[],vis:1};Autodesk.Viewing.Private.PolylineAnimation.prototype.stop=function(){Autodesk.Viewing.Private.Animation.prototype.stop.call(this);this.viewer.removeOverlay("polyline",this.root);this.root=null};
Autodesk.Viewing.Private.PolylineAnimation.prototype.update=function(){function a(a){a.root&&(a.viewer.removeOverlay("polyline",a.root),a.root=null)}return function(b){if(!1!==this.isPlaying&&(this.currentTime+=b*this.timeScale,this.resetIfLooped(),!this.isPlayingOutOfRange()))if(this.isPaused&&this.currentTime<this.startKeyTime)a(this);else{b=0;for(var c=this.hierarchy.length;b<c;b++)for(var d=this.hierarchy[b].animationCache[this.data.name],f=0;f<this.keyTypes.length;f++){var g=this.keyTypes[f],
h=d.prevKey[g],k=d.nextKey[g];if(k.time<=this.currentTime||h.time>=this.currentTime){h=this.data.hierarchy[b].keys[0];for(k=this.getNextKeyWith(g,b,1);k.time<this.currentTime&&k.index>h.index;)h=k,k=this.getNextKeyWith(g,b,k.index+1);d.prevKey[g]=h;d.nextKey[g]=k}var l=h[g],m=k[g];if(k.time!==h.time&&void 0!==l&&void 0!==m)if(h=(this.currentTime-h.time)/(k.time-h.time),0>h&&(h=0),1<h&&(h=1),"points"===g){g=0.5>h?l:m;this.viewer.removeOverlay("polyline",this.root);this.root=null;for(var k=[],p=0;p<
g.length;p++){var n=g[p].slice();if(0===p)n[0]=l[p][0]+(m[p][0]-l[p][0])*h,n[1]=l[p][1]+(m[p][1]-l[p][1])*h,n[2]=l[p][2]+(m[p][2]-l[p][2])*h;else if(p===g.length-1){var q=l.length-1,r=m.length-1;n[0]=l[q][0]+(m[r][0]-l[q][0])*h;n[1]=l[q][1]+(m[r][1]-l[q][1])*h;n[2]=l[q][2]+(m[r][2]-l[q][2])*h}n=new THREE.Vector3(n[0],n[1],n[2]);k.push(n)}this.root=this.createPolyline(k)}else"vis"===g&&(l=Math.abs(this.currentTime-k.time)<this.epsilon?m:l,(this.root.visible=l)||a(this))}}}}();
Autodesk.Viewing.Private.PolylineAnimation.prototype.createPolyline=function(a){for(var b=new THREE.Geometry,c=0;c<a.length;c++)b.vertices.push(a[c]);b.computeLineDistances();a=new THREE.LineDashedMaterial({color:0,dashSize:1,gapSize:0.5,linewidth:1});b=new THREE.Line(b,a,THREE.LineStrip);void 0===this.viewer.overlayScenes.polyline&&this.viewer.createOverlayScene("polyline",a,null);this.viewer.addOverlay("polyline",b);return b};
Autodesk.Viewing.Private.interpolateCatmullRom=function(a,b){function c(a,b,c,d,f,g,h){a=0.5*(c-a);d=0.5*(d-b);return(2*(b-c)+a+d)*h+(-3*(b-c)-2*a-d)*g+a*f+b}var d=[],f=[],g,h,k,l,m,p;g=(a.length-1)*b;h=Math.floor(g);g-=h;d[0]=0===h?h:h-1;d[1]=h;d[2]=h>a.length-2?h:h+1;d[3]=h>a.length-3?h:h+2;h=a[d[0]];l=a[d[1]];m=a[d[2]];p=a[d[3]];d=g*g;k=g*d;f[0]=c(h[0],l[0],m[0],p[0],g,d,k);f[1]=c(h[1],l[1],m[1],p[1],g,d,k);f[2]=c(h[2],l[2],m[2],p[2],g,d,k);return f};AutodeskNamespace("Autodesk.Viewing.Private");
Autodesk.Viewing.Private.KeyFrameAnimator=function(a,b){this.animations=[];this.viewer=a;this.keys=[];this.isPlaying=!1;this.isPaused=!0;this.updateFlag=0;this.duration=b;this.currentTime=0;this.onPlayCallback=null;this.animationHandler=new Autodesk.Viewing.Private.AnimationHandler;this.areCameraAnimationsPaused=!1;this.UPDATE_SCENE=1;this.UPDATE_CAMERA=2};
Autodesk.Viewing.Private.KeyFrameAnimator.prototype.add=function(a){if(a.hierarchy&&!(1>a.hierarchy.length||!a.hierarchy[0].keys||2>a.hierarchy[0].keys.length)){var b=null,c=this;if("camera"===a.type)b=new Autodesk.Viewing.Private.CameraAnimation(c.viewer.camera,a,c),c.animations.push(b);else if("annotation"===a.type)b=new Autodesk.Viewing.Private.AnnotationAnimation(null,a,c),c.animations.push(b);else if("polyline"===a.type)b=new Autodesk.Viewing.Private.PolylineAnimation(null,a,c),c.animations.push(b);
else if("mesh"===a.type||"visibility"===a.type)for(var d=c.viewer.model.getNodesByIds([a.id]),f=0;f<d.length;f++)(function l(d){var f=d.fragIds;if(void 0!==f){Array.isArray(f)||(f=[f]);for(var g=0;g<f.length;g++){var h=c.viewer.getRenderProxy(c.viewer.model,f[g]);h&&(b="mesh"===a.type?new Autodesk.Viewing.Private.MeshAnimation(h,a,c):new Autodesk.Viewing.Private.VisibilityAnimation(h,a,d,c),c.animations.push(b))}}if(d.children)for(f=0;f<d.children.length;f++)l(d.children[f])})(d[f]);if(b){for(var d=
0,g=a.hierarchy.length;d<g;d++)for(var h=a.hierarchy[d].keys,f=0;f<h.length;f++)void 0===h[f].xk&&c.keys.push(h[f].time);(function(a){a.sort(function(a,b){return a-b});(function(a,b,c){for(b=a.length;c=--b;)for(;c--;)a[b]!==a[c]||a.splice(c,1)})(a)})(c.keys)}this.updateFlag|=this.UPDATE_SCENE}};
Autodesk.Viewing.Private.KeyFrameAnimator.prototype.update=function(a){this.animationHandler.update(a);var b=this.updateFlag;if(this.isPlaying&&!this.isPaused){this.currentTime+=a;this.currentTime=Math.min(this.currentTime,this.duration);if(this.onPlayCallback)this.onPlayCallback(0<this.duration?this.currentTime/this.duration*100:0);this.currentTime>=this.duration&&this.pause();b|=this.UPDATE_SCENE}this.updateFlag=0;return b};
Autodesk.Viewing.Private.KeyFrameAnimator.prototype.play=function(a,b){this.onPlayCallback=b;this.currentTime>=this.duration&&this.goto(0);if(this.isPlaying)this.pause();else{for(var c=0;c<this.animations.length;c++)this.animations[c].play(a);this.isPlaying=!0;this.isPaused=!1}};Autodesk.Viewing.Private.KeyFrameAnimator.prototype.pause=function(){for(var a=0;a<this.animations.length;a++){var b=this.animations[a];b.isPaused===this.isPaused&&b.pause()}this.areCameraAnimationsPaused=this.isPaused=!this.isPaused};
Autodesk.Viewing.Private.KeyFrameAnimator.prototype.pauseCameraAnimations=function(){for(var a=0;a<this.animations.length;a++){var b=this.animations[a];b instanceof Autodesk.Viewing.Private.CameraAnimation&&b.pause()}this.areCameraAnimationsPaused=!this.areCameraAnimationsPaused};Autodesk.Viewing.Private.KeyFrameAnimator.prototype.stop=function(){for(var a=0;a<this.animations.length;a++)this.animations[a].stop();this.isPaused=this.isPlaying=!1};
Autodesk.Viewing.Private.KeyFrameAnimator.prototype.goto=function(a){if(void 0!==a){for(var b=0;b<this.animations.length;b++)this.animations[b].goto(a);this.isPaused=this.isPlaying=!0;this.currentTime=a;this.updateFlag|=this.UPDATE_SCENE}};Autodesk.Viewing.Private.KeyFrameAnimator.prototype.next=function(){for(var a=this.keys,b=-1,c=0;c<a.length;c++)if(a[c]>this.currentTime){b=a[c];break}this.goto(0>b?a[a.length-1]:b)};
Autodesk.Viewing.Private.KeyFrameAnimator.prototype.prev=function(){for(var a=this.keys,b=-1,c=a.length-1;-1<c;c--)if(a[c]<this.currentTime){b=a[c];break}this.goto(0>b?a[0]:b)};AutodeskNamespace("Autodesk.Viewing.Private");void 0===ENABLE_DEBUG&&(ENABLE_DEBUG=!0);void 0===ENABLE_TRACE&&(ENABLE_TRACE=!0);
Autodesk.Viewing.Private.Viewer3DImpl=function(a,b){function c(a){var b=f.stats;b&&b.begin();D&&(f.camera.aspect=A/E,G.setSize(A,E),f.controls.handleResize(),f.invalidate(!0,!0,!0),D=!1,f.api.fireEvent({type:Autodesk.Viewing.VIEWER_RESIZE_EVENT}));H.updateMaterials();if(f.keyFrameAnimator){var c=0<P?(a-P)/1E3:0,d=f.keyFrameAnimator.update(c);d&&(f.sceneUpdated(),d&f.keyFrameAnimator.UPDATE_CAMERA&&(B=!0))}var g=(d=f.controls.update(a)||B)||I;B=!1;C=C||d;var q=f.model&&f.model.isLoadDone(),c=g||M,
r=N,s=f.progressiveRender?0.5*(f.maxFrameTime+f.minFrameTime):1E10,w=s;if(F){var z;!q&&f.model?(z=f.model.getData().bbox,z.min.__proto__.constructor!==THREE.Vector3&&(z=new THREE.Box3)):z=f.getVisibleBounds(!0,!1);z&&G.sceneDirty(f.camera,z);F=!1}c?(q&&f.signalProgress(0,null),0<Y&&(c=a-Y,S=0.75*S+0.25*c),Y=a,f.updateCameraMatrices(),G.beginScene(f.scene,f.camera,f.lights,g),d&&f.api.fireEvent(f.cameraChangedEvent),r&&f.needGhostedPass&&r.setOverrideMaterial(null),f.idMaterial&&(K=!0),r&&(r.hasHighlighted()?
(n=k,r.reset(f.camera),r.drawHighlightedObjectsOnly(),r.setOverrideMaterial(f.highlightMaterial)):(n=h,r.reset(f.camera,S),r.drawNormalObjectsOnly(),r.setOverrideMaterial(null)))):Y=-1;r&&!r.isDone()&&(g=function(a){var b=n;G.renderScenePart(a,b!=p,b==h,b==p)},w=r.renderSome(g,w),r.isDone()&&n===k&&(n=h,r.reset(f.camera),r.drawNormalObjectsOnly(),r.setOverrideMaterial(null),w=r.renderSome(g,w)),d||C||(0<P&&(ba=0.8*ba+0.2*(a-P)),G.composeFinalFrame()),r.isDone()?(n===h&&!r.areAllVisible()&&f.showGhosting?
(n=l,r.reset(f.camera),r.drawHiddenObjectsOnly(),r.setOverrideMaterial(f.fadeMaterial)):n==p?(n=m,K=!1):(n=m,G.composeFinalFrame(d&&f.skipAOWhenMoving)),q&&f.signalProgress(100,null)):q&&f.signalProgress(100*r.getRenderProgress(),null));C&&(r&&r.isDone()||f.showOverlaysWhileMoving?(f.renderOverlays(),r&&!r.isDone()&&(C=!0)):G.clearAllOverlays(),G.composeFinalFrame(d&&f.skipAOWhenMoving),0<P&&(ba=0.8*ba+0.2*(a-P)));n==m&&K&&(G.hasMRT()?K=!1:(n=p,r&&(r.reset(f.camera),r.drawNormalObjectsOnly(),r.setOverrideMaterial(f.idMaterial))));
w<s&&b&&b.end();v&&!d&&f.skipAOWhenMoving&&G.composeFinalFrame();v=d;P=a;I=M=!1}function d(a,b){b.updateMatrixWorld(!0);b.traverse(function(b){var c=b.geometry;void 0!==c&&(c.boundingBox||c.computeBoundingBox(),U.copy(c.boundingBox),U.applyMatrix4(b.matrixWorld),a.union(U))})}var f=this,g=Autodesk.Viewing.Private,h=0,k=1,l=2,m=3,p=4,n=h,q=-1,r=-1,v=!1,s=new THREE.Vector3(0,1,0),w="y",z,D,A,E,N,H,J,G,I=!1,M=!1,C=!1,K=!1,F=!1,B,R=0,Y=0,S=0,P=0,ba=1E3/60;this.run=function(){z=0;(function V(a){z=window.requestAnimationFrame(V);
c(a)})()};this.toggleProgressive=function(a){this.progressiveRender=a;I=!0};this.toggleGhosting=function(a){this.showGhosting=a;I=!0};this.toggleOverlaysWhileMoving=function(a){this.showOverlaysWhileMoving=a};this.togglePostProcess=function(a,b,c){G.initPostPipeline(a,b,c);this.fireRenderOptionChanged();I=!0};this.toggleGroundShadow=function(a){G.toggleGroundShadow(a);I=!0};this.setOptimizeNavigation=function(a){this.skipAOWhenMoving=a};this.renderOverlays=function(){var a=this.lightsOn;a||this.toggleLights(!0,
!0);var b;this.dir_light1&&(b=this.dir_light1.intensity,this.dir_light1.intensity=1);G.renderOverlays(this.overlayScenes,this.lights);a||this.toggleLights(!1,!0);this.dir_light1&&(this.dir_light1.intensity=b);C=!1};this.setLayerVisible=function(a,b){this.matman().setLayerVisible(a,b)};this.isLayerVisible=function(a){return this.matman().isLayerVisible(a)};this.updateCameraMatrices=function(){var a=this.camera;a.updateMatrixWorld();a.matrixWorldInverse.getInverse(a.matrixWorld);a.worldup&&this.setWorldUp(a.worldup);
if(this.model){var b=this.getVisibleBounds(!0,!0),c=(new THREE.Box3).copy(b);c.applyMatrix4(a.matrixWorldInverse);var d=1E-5*(c.max.z-c.min.z),f=0.2*(c.max.y-c.min.y),g=-(c.max.z+d)-f,c=-(c.min.z-d)+f;a.isPerspective&&(g=Math.max(g,Math.min(1,1E-4*Math.abs(c-g))));c=Math.max(c,g);a.near=g;a.far=c;a.updateProjectionMatrix();this.model.is2d()&&(b=(g=this.intersectGroundViewport(new THREE.Vector3(0,0,1)))?a.position.distanceTo(g):a.position.distanceTo(b.center()),a=G.settings.deviceHeight/(2*b*Math.tan(THREE.Math.degToRad(0.5*
a.fov))),H.updatePixelScale(0.5*a))}};this.initLights=function(a){var b=g.LightPresets[q].lightMultiplier;this.lightNode=new THREE.Object3D;this.dir_light1=new THREE.DirectionalLight((new THREE.Color).setRGB(1,1,1),b);this.dir_light1.position.set(-1,0,1);this.dir_light1.position.multiplyScalar(1E3*a);this.lightNode.add(this.dir_light1);this.amb_light=new THREE.AmbientLight((new THREE.Color).setRGB(1,1,1));this.camera.add(this.lightNode);this.toggleLights(0!==b)};this.toggleLights=function(a,b){if(this.amb_light&&
this.lightNode){a&&!this.lightsOn?(this.lights=[this.dir_light1,this.amb_light],this.lightsOn=!0):!a&&this.lightsOn&&(this.lightsOn=!1,this.lights=[]);var c=g.LightPresets[q],d=c.ambientLightColor,c=c.directLightColor;this.lightsOn?(b&&this.amb_light?this.amb_light.color.setRGB(0.5*c[0],0.5*c[1],0.5*c[2]):d&&this.amb_light&&this.amb_light.color.setRGB(d[0],d[1],d[2]),c&&this.dir_light1&&this.dir_light1.color.setRGB(c[0],c[1],c[2])):d&&this.amb_light&&b&&this.amb_light.color.setRGB(d[0],d[1],d[2])}};
this.syncCamera=function(a){this.camera.updateProjectionMatrix();a&&this.setWorldUp(this.api.navigation.getWorldUpVector());B=!0};this.setViewFromFile=function(a,b){var c;c=a.getDefaultCamera();if(!c){c={};var d=a.getBoundingBox(),f=d.size();c.target=d.center();a.is2d()?(c.isPerspective=!1,d=this.camera.aspect,c.orthoScale=d>f.x/f.y?f.y:f.x/d,c.up=new THREE.Vector3(0,0,1),c.position=c.target.clone(),c.position.z+=c.orthoScale,c.target.y+=1E-6*f.y):(c.isPerspective=!0,c.fov=this.camera.fov,c.up=this.camera.up.clone(),
c.position=c.target.clone(),c.position.z+=Math.max(f.x,f.y,f.z))}this.setViewFromCamera(c,b)};this.setViewFromCamera=function(a,b){if(!a.isPerspective&&this.model){var c=this.model.getBoundingBox(),d=c.size(),f=a.target.clone().sub(a.position);f.length()>1E3*d.length()?(c=a.position.distanceTo(c.center()),a.target.copy(a.position).add(f.normalize().multiplyScalar(c))):a.position.copy(a.target).add(f.normalize().multiplyScalar(-a.orthoScale))}(f=this.model?this.model.getUpVector():null)?c=(new THREE.Vector3).fromArray(f):
(f=(new THREE.Vector3(a.up.x,a.up.y,a.up.z)).clone(),0>f.x&&(f.x=-f.x),0>f.y&&(f.y=-f.y),0>f.z&&(f.z=-f.z),f.x>f.y&&f.x>f.z?f.set(0<f.x?1:-1,0,0):f.y>f.x&&f.y>f.z?f.set(0,0<f.y?1:-1,0):f.set(0,0,0<f.z?1:-1),c=f);a.up=c;f=this.api.navigation;b?(c=this.camera,c.up.copy(a.up),c.position.copy(a.position),c.target.copy(a.target),a.isPerspective?c.fov=a.fov:(c.saveFov=a.fov,c.fov=Autodesk.Viewing.UnifiedCamera.ORTHO_FOV),c.isPerspective=a.isPerspective,c.orthoScale=a.orthoScale,c.dirty=!0,f.setWorldUpVector(c.up),
f.setView(c.position,c.target),this.syncCamera(!0)):(this.camera.isPerspective=a.isPerspective,c=f.computeOrthogonalUp(a.position,a.target),f.setRequestTransitionWithUp(!0,a.position,a.target,a.fov,c,a.up));B=!0};this.setViewFromViewBox=function(a,b,c,d){if(a.is2d()){c={};a=a.getBoundingBox();var f=b[2]-b[0],g=b[3]-b[1],h;h=b[0]+f/2;b=b[1]+g/2;var k=this.camera.aspect;c.orthoScale=k>f/g?g:f/k;c.isPerspective=!1;c.position=new THREE.Vector3(h,b,a.center().z+c.orthoScale);c.target=new THREE.Vector3(h,
b,a.center().z);c.target.y+=1E-6*g;c.up=new THREE.Vector3(0,0,1);this.setViewFromCamera(c,d)}};this.setWorldUp=function(a){if(!s.equals(a)){s.copy(a);var b=Math.abs(a.x);w="x";Math.abs(a.y)>b&&(w="y",b=Math.abs(a.y));Math.abs(a.z)>b&&(w="z");var c=new THREE.Vector3(0,1,0),b=f.camera,d=(new THREE.Vector3).crossVectors(a,c).normalize();a=Math.acos(c.dot(a));a=(new THREE.Matrix4).makeRotationAxis(d,a);b.worldUpTransform=a;this.sceneUpdated()}};this.setModel=function(a){a&&(this.model=a,this.selector.model=
this.model,this.visibilityManager.model=this.model,this.model.setLoader(this.svfloader),this.initScene())};this.initScene=function(){if(this.model){var a=this.model,b=a.getBoundingBox();G.setUnitScale(a.getUnitScale());var c=a.is2d();c&&this.enter2DMode();this.api.navigation.setIs2D(c);this.api.setActiveNavigationTool(c?"pan":"orbit");var d=MAX_FRAGS_PER_GROUP;a.is2d()&&(d/=6);if(isIOSDevice()||isAndroidDevice())d/=3;N=new RenderQueue(a.getData().fragments.length,b,d,a.is2d());this.setViewFromFile(a,
!0);this.controls.recordHomeView();a=0.5*b.size().length();this.initLights(a);c||this.setLightPresetFromFile()||this.setLightPreset(q,!0);this.invalidate(!0)}};this.addMeshInstance=function(a,b,c,d){var f=this.model.getData();if(0!==b||-1==f.basePath.indexOf("SaRang")){var g;if(a.isLines){var h=!!a.attributes.color;g=new THREE.LineBasicMaterial({vertexColors:h});h||(c=H.findMaterial(f,c),g.color=c.color);g=new THREE.Mesh(a,g,!f.animations);g.isLine=!0;f.hasLines=!0}else g=H.findMaterial(f,c),H.applyGeometryFlagsToMaterial(g,
a),g=new THREE.Mesh(a,g,!f.animations),g.materialId=parseInt(c),a.is2d&&(g.is2d=!0);d&&(g.matrix&&g.matrix.copy(d),g.matrixWorld.copy(d));g.matrixAutoUpdate=!1;N.addMesh(b,g)}};this.onLoadComplete=function(){this.signalProgress(100,"");this.is2d&&(this.selectionMaterial2d=H.init2DSelectionMaterial(this.model),this.createOverlayScene("selection2d",this.selectionMaterial2d));this.model.getData().hasLines&&H.togglePolygonOffset(!0);this.api.fireEvent({type:Autodesk.Viewing.GEOMETRY_LOADED_EVENT})};this.signalProgress=
function(a,b){this.api.fireEvent({type:Autodesk.Viewing.PROGRESS_UPDATE_EVENT,percent:a,message:b})};this.resize=function(a,b){D=!0;A=a;E=b};this.enter2DMode=function(){this.is2d=!0;H.initLayersTexture(this.model);var a=H.create2DMaterial(this.model.getData(),{},!0);this.idMaterial=H.findMaterial(this.model.getData(),a);G.enter2DMode(this.idMaterial);r=q;this.setLightPreset(g.DefaultLightPreset2d);a=this.model.getData();if(a.hidePaper){var b=a.bgColor,a=b>>16&255,c=b>>8&255,b=b&255;this.setClearColors(a,
c,b,a,c,b)}this.fireRenderOptionChanged();I=!0};this.unloadCurrentModel=function(){this.is2d&&(this.is2d=void 0,this.selectionMaterial2d=this.idMaterial=null,this.removeOverlay("selection2d"),G.exit2DMode());N&&(N.cleanup(),N=null);this.model&&(H.cleanup(this.model.getData()),this.model=null);0<=r&&(q=r)};this.loadSvf=function(a,b,c,d,f){this.unloadCurrentModel();return this.svfloader.loadSvf(a,b,c,d,f)};this.createOverlayScene=function(a,b,c,d){b&&(b.depthWrite=!1,b.depthTest=!0,H.addMaterialNonHDR("overlayMaterialPre",
b));c&&(c.depthWrite=!1,c.depthTest=!1,H.addMaterialNonHDR("overlayMaterialPost",c));var f=new THREE.Scene(!0);f.__lights=this.scene.__lights;this.overlayScenes[a]={scene:f,camera:d,materialPre:b,materialPost:c}};this.removeOverlayScene=function(a){this.overlayScenes[a]&&delete this.overlayScenes[a]};this.addOverlay=function(a,b){this.overlayScenes[a].scene.add(b);C=!0};this.removeOverlay=function(a,b){this.overlayScenes[a].scene.remove(b);C=!0};this.clearOverlay=function(a){this.overlayScenes[a].scene.clear();
C=!0};this.setClearColors=function(a,b,c,d,f,g){this.clearColorTop=new THREE.Vector4(a/255,b/255,c/255,1);this.clearColorBottom=new THREE.Vector4(d/255,f/255,g/255,1);H.reflectionCube&&!H.reflectionCube.isBgColor||H.setCubeMapFromColors(this.clearColorTop,this.clearColorBottom);G.setClearColors(this.clearColorTop,this.clearColorBottom);I=!0;this.fireRenderOptionChanged()};var U=new THREE.Box3;this.getVisibleBounds=function(a,b){var c=null;if(N&&(c=N.getVisibleBounds(a),b)){var g=new THREE.Box3,h=
f.overlayScenes,k;for(k in h)h.hasOwnProperty(k)&&d(g,h[k].scene);d(g,f.scene);c=g.union(c)}return c};this.getFitBounds=function(a){var b;this.is2d&&(a=!0);a||null===this.selector||(b=this.selector.getSelectionBounds());if(!b||b.empty())b=this.getVisibleBounds();return b};this.getRenderProxy=function(a,b){return N?N.getVizmesh(b):null};this.setFragmentVisibility=function(a,b,c){N&&(N.setVisibility(b,c),this.sceneUpdated())};this.setModelVisibility=function(a,b){N&&(N.setAllVisibility(b),this.sceneUpdated())};
this.isWholeModelVisible=function(a){return N?N.areAllVisible():!0};this.resetIsolation=function(a){N&&(N.setOverrideMaterial(null),this.needGhostedPass=!1,I=!0)};this.highlightObjectNode=function(a,b,c,d){var f=b.fragIds;if("undefined"!=typeof f){Array.isArray(f)||(f=[f]);for(var g=0;g<f.length;++g){var h=f[g],k=this.getRenderProxy(a,h),l=k.is2d?"selection2d":"selection";k.is2d?H.highlightObject2D(b.dbId,c):!d&&c||N.setHighlighted(h,c);c?!d||k.is2d?(k.selectionProxy=new THREE.Mesh(k.geometry,k.material,
!0),k.selectionProxy.matrixWorld=k.matrixWorld,this.addOverlay(l,k.selectionProxy)):this.invalidate(!0):k.selectionProxy?(this.removeOverlay(l,k.selectionProxy),k.selectionProxy=null):k.is2d||this.invalidate(!0)}}};this.highlightFragment=function(a,b,c){this.is2d?H.highlightObject2D(b,c):N.setHighlighted(b,c)};this.explode=function(a){if(a!=R&&this.model){R=a;var b=this.model,c=b.getData(),d=this.getVisibleBounds(!0).center(),g=c.fragments,h=g.transforms,k=a*(c.maxTreeDepth-1)+1,l=0|k,m=k-l;a*=2;
if(c.instanceTree&&c.instanceBoxes&&0!==a){var n=c.instanceBoxes;(function qa(c,d,g,k,p,q,r,K){var s=2*a;d==l&&(s*=m);var v=6*c.dbId,F=0.5*(n[v]+n[v+3]),B=0.5*(n[v+1]+n[v+4]),v=0.5*(n[v+2]+n[v+5]);0<d&&d<=l&&(q+=(F-g)*s,r+=(B-k)*s,K+=(v-p)*s);if(g=c.children)for(k=0,p=g.length;k<p;k++)qa(g[k],d+1,F,B,v,q,r,K);c=c.fragIds;if(void 0!==c)if(Array.isArray(c))for(d=0;d<c.length;d++)F=0|c[d],v=16*F,B=f.getRenderProxy(b,F).matrixWorld.elements,B[12]=h[v+12]+q,B[13]=h[v+13]+r,B[14]=h[v+14]+K;else F=c|0,B=
f.getRenderProxy(b,F).matrixWorld.elements,v=16*F,B[12]=h[v+12]+q,B[13]=h[v+13]+r,B[14]=h[v+14]+K})(c.instanceTree,0,d.x,d.y,d.x,0,0,0)}else for(c=g.boxes,k=0,g=g.length;k<g;k++){var p=6*k,q=16*k,r=0.5*(c[p]+c[p+3]),K=0.5*(c[p+1]+c[p+4]),p=0.5*(c[p+2]+c[p+5]),r=a*(r-d.x),K=a*(K-d.y),p=a*(p-d.z),s=f.getRenderProxy(b,k).matrixWorld.elements;s[12]=h[q+12]+r;s[13]=h[q+13]+K;s[14]=h[q+14]+p}this.sceneUpdated();this.api.fireEvent({type:Autodesk.Viewing.EXPLODE_CHANGE_EVENT})}};this.getExplodeScale=function(){return R};
this.setGhostingBrightness=function(a){this.fadeMaterial.color=a?new THREE.Color(1052688):new THREE.Color(16777215);this.fadeMaterial.needsUpdate=!0};this.setLightPreset=function(a,b){if(q!=a||b){if(0>a||g.LightPresets.length<=a)a=g.DefaultLightPreset;q=a;var c=g.LightPresets[a];if(c&&c.path){var d="res/environments/"+c.path,f=g.getResourceUrl(d+"_mipdrop.logluv.dds"),d=g.getResourceUrl(d+"_irr.logluv.dds");H.setIrradianceMap(d);H.setCubeMap(f);this.setExposureBias(c.E_bias);this.setTonemapMethod(c.tonemap);
this.setGhostingBrightness(c.darkerFade)}else H.setIrradianceMap(null),H.setCubeMap(null),this.setExposureBias(0),this.setTonemapMethod(0),this.setGhostingBrightness(!1);f=SAOShader.uniforms.radius.value;d=SAOShader.uniforms.intensity.value;c.hasOwnProperty("saoRadius")&&(f=c.saoRadius);c.hasOwnProperty("saoIntensity")&&(d=c.saoIntensity);G.setAOOptions(f,d);(f=c.bgColorGradient)||(f=g.BackgroundPresets.Custom);this.setClearColors(f[0],f[1],f[2],f[3],f[4],f[5]);f=1;null!==c.lightMultiplier&&void 0!==
c.lightMultiplier&&(f=c.lightMultiplier);this.dir_light1&&(this.toggleLights(0!==f),this.dir_light1.intensity=f);this.invalidate(!0,!1,!0);this.fireRenderOptionChanged()}};this.setLightPresetFromFile=function(){var a=this.model.getMetadata("renderEnvironmentStyle","value",null);if(null===a||""===a)return!1;for(var b=this.model.getMetadata("renderEnvironmentExposureBias","value",null),c=this.model.getMetadata("renderEnvironmentExposureBase","value",null),d=0;d<g.LightPresets.length;d++)if(a===g.LightPresets[d].name)return null!==
b&&null!==c&&(g.LightPresets[d].E_bias=b+c),this.setLightPreset(d),!0;return!1};this.setTonemapMethod=function(a){a!=G.getToneMapMethod()&&(G.setTonemapMethod(a),H.setTonemapMethod(a),this.fireRenderOptionChanged(),this.invalidate(!0))};this.setExposureBias=function(a){a!=G.getExposureBias()&&(G.setExposureBias(a),H.setExposureBias(a),this.fireRenderOptionChanged(),this.invalidate(!0))};this.uninitialize=function(){window.cancelAnimationFrame(z);this.controls.uninitialize();this.canvas=this.controls=
null;this.svfloader.uninitialize();this.svfloader=null;this.selector.uninitialize();H=G=N=this.visibilityManager=this.model=this.selector=null};this.hideLines=function(a){return N?(N.hideLines(a),this.sceneUpdated(),!0):!1};this.setCutplanes=function(a){H.setCutplanes(a);this.invalidate(!0)};this.fireRenderOptionChanged=function(){var a=G.hasMRT()&&G.settings.sao;H.toggleMRTSetting(a);this.api.fireEvent({type:Autodesk.Viewing.RENDER_OPTION_CHANGED_EVENT})};this.viewportToRay=function(a,b){var c=this.camera;
a.z=-1;var d=new THREE.Vector3(a.x,a.y,1);a=a.unproject(c);d=d.unproject(c);d.sub(a).normalize();b||(b=new THREE.Ray);b.set(c.isPerspective?c.position:a,d);return b};this.castRayViewport=function(){var a=new THREE.Ray;return function(b,c){if(!N)return{};this.viewportToRay(b,a);var d=N.rayIntersect(a.origin,a.direction,c),f=d[0],d=d[1],g=null;f&&(g=(g=this.model.getData())?g.fragments:null,f=f.fragId,g=g.fragToDbNode&&g.fragToDbNode[f]?g.fragToDbNode[f]:{dbId:f,fragIds:f});return{node:g,intersectPoint:d}}}();
this.clientToViewport=function(a,b){var c=f.canvas.getBoundingClientRect();return new THREE.Vector3((a+0.5-c.left)/c.width*2-1,2*-((b+0.5-c.top)/c.height)+1,1)};this.viewportToClient=function(a,b){var c=f.canvas.getBoundingClientRect();return new THREE.Vector3(0.5*(a+1)*c.width+c.left-0.5,-0.5*(b-1)*c.height+c.top-0.5,0)};this.castRay=function(a,b,c){return this.castRayViewport(this.clientToViewport(a,b),c)};this.intersectGroundViewport=function(a){var b=this.camera,c="z";this.is2d||(c=w);a.z=-1;
var d=new THREE.Vector3(a.x,a.y,1);a=a.unproject(b);d=d.unproject(b);d.sub(a).normalize();a=d;if(1E-6>Math.abs(a[c]))return null;c=((this.model?this.model.getBoundingBox().min[c]:0)-b.position[c])/a[c];a.multiplyScalar(c);a.add(b.position);return a};this.intersectGround=function(a,b){return this.intersectGroundViewport(this.clientToViewport(a,b))};this.hitTestViewport=function(a,b){var c;if(f.is2d){var d=G.idAtPixel(a.x,a.y);c=this.intersectGroundViewport(a);var g=d?{dbId:d,fragIds:f.model.getData().fragments.dbId2fragId[d]}:
null;c={intersectPoint:c,node:g};d&&stderr("dbId "+d)}else c=this.castRayViewport(a,b);return c};this.hitTest=function(a,b,c){return f.hitTestViewport(this.clientToViewport(a,b),c)};this.rolloverObjectViewport=function(a){K||(G.rolloverObjectViewport(a.x,a.y),C=!0)};this.rolloverObject=function(a,b){this.rolloverObjectViewport(this.clientToViewport(a,b))};this.modelQueue=function(){return N};this.glrenderer=function(){return J};this.renderer=function(){return G};this.worldUp=function(){return s};
this.worldUpName=function(){return w};this.setUserRenderContext=function(a){G=a?a:new RenderContext;G.init(J,this.canvas.clientWidth,this.canvas.clientHeight);G.setClearColors(this.clearColorTop,this.clearColorBottom);this.invalidate(!0);this.sceneUpdated()};this.invalidate=function(a,b,c){I=I||a;M=M||b;C=C||c};this.sceneUpdated=function(){this.invalidate(!0,!1,!0);N&&(N.visibleBoundsDirty=!0);F=!0};this.currentLightPreset=function(){return q};this.matman=function(){return H};this.fps=function(){return 1E3/
ba};this.api=b;this.canvas=a;this.svfloader=new g.SvfLoader(this);J=function(a){var b=window.devicePixelRatio;b||(b=1);a=new FireflyWebGLRenderer({canvas:a,antialias:!1,alpha:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,stencil:!1,depth:!1,devicePixelRatio:b});a.autoClear=!1;a.sortObjects=!1;return a}(a);G=new RenderContext;G.init(J,a.clientWidth,a.clientHeight);H=new g.MaterialManager(this);this.camera=new Autodesk.Viewing.UnifiedCamera(a.clientWidth,a.clientHeight);this.lights=[];this.cameraChangedEvent=
this.camera.getCameraChangedEvent();this.scene=new THREE.Scene;this.overlayScenes={};this.selectionMaterial2d=null;this.selectionMaterialBase=new THREE.MeshPhongMaterial({color:6724095,specular:526344,emissive:3361911,ambient:0,opacity:1,transparent:!1});this.selectionMaterialTop=new THREE.MeshPhongMaterial({color:6724095,specular:526344,emissive:3361911,ambient:0,opacity:0.15,transparent:!0});this.createOverlayScene("selection",this.selectionMaterialBase,this.selectionMaterialTop);this.fadeMaterial=
new THREE.MeshPhongMaterial({color:16777215,opacity:0.1,reflectivity:0,transparent:!0,depthWrite:!1});H.addMaterial("__fadeMaterial__",this.fadeMaterial,!0);this.highlightMaterial=new THREE.MeshPhongMaterial({color:6724095,specular:526344,emissive:3361911,ambient:0,opacity:1,transparent:!1});H.addMaterial("__highlightMaterial__",this.highlightMaterial,!0);this.idMaterial=null;this.progressiveRender=!0;this.maxFrameTime=50;this.minFrameTime=25;this.controls={update:function(a){},handleResize:function(){},
recordHomeView:function(){},uninitialize:function(){}};this.selector=new g.Selector(this);this.visibilityManager=new g.VisibilityManager(this);this.showOverlaysWhileMoving=this.showGhosting=!0;this.skipAOWhenMoving=!1;this.keyFrameAnimator=null;var W=g.LightPresets[g.DefaultLightPreset].bgColorGradient;this.setClearColors(W[0],W[1],W[2],W[3],W[4],W[5]);G.beginScene(this.scene,this.camera,this.lights,!0);G.composeFinalFrame();window.NOP_VIEWER=this};
Autodesk.Viewing.Private.Viewer3DImpl.prototype.constructor=Autodesk.Viewing.Private.Viewer3DImpl;AutodeskNamespace("Autodesk.Viewing.Private");
Autodesk.Viewing.Private.ViewerState=function(a){this.getState=function(b){var c=a.navigation,d=Autodesk.Viewing.Private,f={},g;g=Math.round(4294967295*Math.random());var h=Date.now();g=g.toString(16)+h.toString(16);f.guid=g;f.seedURN=a.impl.svfloader.svfUrn;f.overrides=this.getTransformsOverrides();g=f.objectSet;Array.isArray(g)||(f.objectSet=g=[]);a.model&&!a.model.is2d()&&(g[0]={id:this.getSelectedNodes(),isolated:this.getIsolatedNodes(),hidden:this.getHiddenNodes(),explodeScale:a.getExplodeScale()});
(g=f.viewport)||(g=f.viewport={});h=c.getCamera().isPerspective;g.name="";g.eye=c.getPosition().toArray();g.target=c.getTarget().toArray();g.up=c.getCameraUpVector().toArray();g.worldUpVector=c.getWorldUpVector().toArray();g.pivotPoint=c.getPivotPoint().toArray();g.distanceToOrbit=c.getPivotPlaneDistance();g.aspectRatio=this.getAspectRatio();g.projection=h?"perspective":"orthographic";g.isOrthographic=!h;h?g.fieldOfView=c.getVerticalFov():g.orthographicHeight=this.getOrthographicHeight();(c=f.renderOptions)||
(c=f.renderOptions={});c.environment=d.LightPresets[a.impl.currentLightPreset()].name;c.ambientOcclusion={enabled:a.impl.renderer().settings.sao,radius:a.impl.renderer().getAORadius(),intensity:a.impl.renderer().getAOIntensity()};c.toneMap={method:a.impl.renderer().getToneMapMethod(),exposure:a.impl.renderer().getExposureBias(),lightMultiplier:this.getToneMapIntensity()};c.appearance={ghostHidden:a.impl.showGhosting,ambientShadow:a.prefs.ambientShadows,antiAliasing:a.impl.renderer().settings.antialias,
progressiveDisplay:a.prefs.progressiveRendering,displayLines:a.prefs.lineRendering};for(var k in a.loadedExtensions)a.loadedExtensions[k].getState(f);b&&!0!==b&&this.applyFilter(f,b);return f};this.restoreState=function(b,c,d){if(!b)return stderr("restoreState has no viewer state to restore from."),!1;if(!a||!a.model)return stderr("restoreState has no viewer or model to restore."),!1;c&&!0!==c&&(b=JSON.parse(JSON.stringify(b)),this.applyFilter(b,c));c=a.navigation;if(c.getTransitionActive())return stderr("Abort restoreState, animation in progress..."),
!1;if(a.model&&!a.model.is2d()&&a.model.getRoot()&&Array.isArray(b.objectSet)&&0<b.objectSet.length){var f=b.objectSet[0],g=a.impl?a.impl.selector:null,h=f.id;h&&g&&(h=this.toIntArray(h),g.setSelectionIds(h));g=f.isolated||[];g=this.toIntArray(g);a.isolateById(g);0===g.length&&(g=f.hidden||null)&&0<g.length&&(g=this.toIntArray(g),a.hideById(g));"explodeScale"in f&&(f=parseFloat(f.explodeScale),a.explode&&a.explodeslider&&(a.explode(f),a.explodeslider.value=100*f))}if(f=b.viewport){var g=this.getVector3FromArray(f.eye,
c.getPosition()),h=this.getVector3FromArray(f.up,c.getCamera().up),k=this.getVector3FromArray(f.target,c.getTarget()),l="fieldOfView"in f?parseFloat(f.fieldOfView):c.getVerticalFov(),m=this.getVector3FromArray(f.pivotPoint,c.getPivotPoint());c.setCameraUpVector(h);"isOrthographic"in f&&(f.isOrthographic?c.toOrthographic():c.toPerspective());d?(c.setVerticalFov(l,!1),c.setView(g,k)):c.setRequestTransition(!0,g,k,l,!1);c.setPivotPoint(m);c.setPivotSetFlag(!0)}if(g=b.renderOptions){c=a.prefs.ambientShadows;
f=a.prefs.antialiasing;if(k=g.ambientOcclusion)"enabled"in k&&(c=k.enabled),h="radius"in k?k.radius:null,k="intensity"in k?k.intensity:null,null!==h&&null!==k&&(a.impl.renderer().setAOOptions(h,k),a.impl.renderer().composeFinalFrame(!1));"environment"in g&&(h=this.getLightPresetIndex(g.environment),-1!==h&&a.setLightPreset(h));if(k=g.toneMap)h="lightMultiplier"in k?k.lightMultiplier:null,k="exposure"in k?k.exposure:null,null!==h&&null!==k&&(a.impl.dir_light1&&(a.impl.dir_light1.intensity=Math.pow(2,
h)),a.impl.renderer().setExposureBias(k,h),a.impl.invalidate(!0));if(g=g.appearance)"antiAliasing"in g&&(f=g.antiAliasing),"progressiveDisplay"in g&&a.setProgressiveRendering(g.progressiveDisplay),"ghostHidden"in g&&a.setGhosting(g.ghostHidden),"displayLines"in g&&a.hideLines(!g.displayLines);a.setQualityLevel(c,f)}for(var p in a.loadedExtensions)a.loadedExtensions[p].restoreState(b,d);return!0};this.toIntArray=function(a){var c=[];if(Array.isArray(a))for(var d=0,f=a.length;d<f;++d)c.push(parseInt(a[d]));
return c};this.extractSelectedNodeIds=function(a){return a&&Array.isArray(a.objectSet)&&0<a.objectSet.length?this.toIntArray(a.objectSet[0].id):[]};this.extractIsolatedNodeIds=function(a){return a&&Array.isArray(a.objectSet)&&0<a.objectSet.length?this.toIntArray(a.objectSet[0].isolated):[]};this.getVector3FromArray=function(a,c){return a instanceof Array&&2<a.length?(a[0]=parseFloat(a[0]),a[1]=parseFloat(a[1]),a[2]=parseFloat(a[2]),(new THREE.Vector3).fromArray(a)):c};this.getSelectedNodes=function(){for(var b=
a.impl&&a.impl.selector?a.impl.selector.getSelection():[],c=b.length,d=[],f=0;f<c;++f)d.push(b[f].dbId);return d};this.getIsolatedNodes=function(){for(var b=a.getIsolatedNodes(),c=0,d=b.length;c<d;++c)b[c]=b[c].dbId;return b};this.getHiddenNodes=function(){for(var b=a.getHiddenNodes(),c=0,d=b.length;c<d;++c)b[c]=b[c].dbId;return b};this.getAspectRatio=function(){var b=a.navigation.getScreenViewport();return b.width/b.height};this.getOrthographicHeight=function(){var b=a.navigation.getCamera();return b.isPerspective?
0:Math.abs(2*b.orthographicCamera.top)};this.getTransformsOverrides=function(){return{transformations:[]}};this.getToneMapIntensity=function(){var b=0;a.impl.dir_light1&&(b=0!=a.impl.dir_light1.intensity?Math.log(a.impl.dir_light1.intensity)/Math.log(2):-1E-20);return b};this.getLightPresetIndex=function(a){for(var c=Autodesk.Viewing.Private,d=0;d<c.LightPresets.length;d++)if(c.LightPresets[d].name===a)return d;return-1};this.applyFilter=function(a,c){if(!0!==c)for(var d in a)if(a.hasOwnProperty(d)){var f=
c[d];void 0===f?(delete a[d],stderr("[applyFilter] C - skipping key ["+d+"] from viewerState; unspecified in filter.")):"boolean"===typeof f?!1===f&&(delete a[d],stderr("[applyFilter] D - skipping key ["+d+"] from viewerState; explicit filtering.")):f instanceof Object?a[d]instanceof Object?this.applyFilter(a[d],c[d]):stderr("[applyFilter] A - Invalid filter Object for key ["+d+"]"):stderr("[applyFilter] B - Invalid filter value for key ["+d+"]")}}};
Autodesk.Viewing.Private.ViewerState.prototype.constructor=Autodesk.Viewing.Private.ViewerState;AutodeskNamespace("Autodesk.Viewing.i18n");
(function(){function a(a,b){if(!b||"function"===typeof b)return a;for(var c in b)a[c]=b[c];return a}function b(a,b,c){var d,f=0,g=a.length,h=void 0===g||"[object Array]"!==Object.prototype.toString.apply(a)||"function"===typeof a;if(c)if(h)for(d in a){if(!1===b.apply(a[d],c))break}else for(;f<g&&!1!==b.apply(a[f++],c););else if(h)for(d in a){if(!1===b.call(a[d],d,a[d]))break}else for(;f<g&&!1!==b.call(a[f],f,a[f++]););return a}function c(a){var b=function(a){if(window.XMLHttpRequest)return a(null,
new XMLHttpRequest);if(window.ActiveXObject)try{return a(null,new ActiveXObject("Msxml2.XMLHTTP"))}catch(b){return a(null,new ActiveXObject("Microsoft.XMLHTTP"))}return a(Error())},c=function(a){if("string"===typeof a)return a;var b=[],c;for(c in a)a.hasOwnProperty(c)&&b.push(encodeURIComponent(c)+"="+encodeURIComponent(a[c]));return b.join("&")},d=function(){for(var a=arguments[0],b=1;b<arguments.length;b++){var c=arguments[b],d;for(d in c)c.hasOwnProperty(d)&&(a[d]=c[d])}return a},f=function(a,
g,h,k){"function"===typeof h&&(k=h,h={});h.doNotCache=h.doNotCache||!1;h.data=h.data||{};h.headers=h.headers||{};h.jsonp=h.jsonp||!1;h.async=void 0===h.async?!0:h.async;var l=d({accept:"*/*","content-type":"application/x-www-form-urlencoded;charset=UTF-8"},f.headers,h.headers),m;m="application/json"===l["content-type"]?JSON.stringify(h.data):c(h.data);if("GET"===a){var n=[];m&&(n.push(m),m=null);h.doNotCache&&n.push("_="+(new Date).getTime());h.jsonp&&(n.push("callback="+h.jsonp),n.push("jsonp="+
h.jsonp));n=n.join("&");1<n.length&&(g=-1<g.indexOf("?")?g+("&"+n):g+("?"+n));if(h.jsonp){var n=document.getElementsByTagName("head")[0],p=document.createElement("script");p.type="text/javascript";p.src=g;n.appendChild(p);return}}b(function(b,c){if(b)return k(b);c.open(a,g,h.async);for(var d in l)l.hasOwnProperty(d)&&c.setRequestHeader(d,l[d]);c.onreadystatechange=function(){if(4===c.readyState){var a=c.responseText||"";k&&k(c.status,a)}};c.send(m)})};({authBasic:function(a,b){var c=f.headers,d;d=
a+":"+b;d=d.replace(/\r\n/g,"\n");for(var g="",h=0;h<d.length;h++){var k=d.charCodeAt(h);128>k?g+=String.fromCharCode(k):(127<k&&2048>k?g+=String.fromCharCode(k>>6|192):(g+=String.fromCharCode(k>>12|224),g+=String.fromCharCode(k>>6&63|128)),g+=String.fromCharCode(k&63|128))}d=g;var g="",l,m,n,p,q=0;do l=d.charCodeAt(q++),h=d.charCodeAt(q++),k=d.charCodeAt(q++),m=l>>2,l=(l&3)<<4|h>>4,n=(h&15)<<2|k>>6,p=k&63,isNaN(h)?n=p=64:isNaN(k)&&(p=64),g+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(m)+
"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(l)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(n)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(p);while(q<d.length);c.Authorization="Basic "+g},connect:function(a,b,c){return f("CONNECT",a,b,c)},del:function(a,b,c){return f("DELETE",a,b,c)},get:function(a,b,c){return f("GET",a,b,c)},head:function(a,b,c){return f("HEAD",a,b,c)},headers:function(a){f.headers=a||{}},
isAllowed:function(a,b,c){this.options(a,function(a,d){c(-1!==d.text().indexOf(b))})},options:function(a,b,c){return f("OPTIONS",a,b,c)},patch:function(a,b,c){return f("PATCH",a,b,c)},post:function(a,b,c){return f("POST",a,b,c)},put:function(a,b,c){return f("PUT",a,b,c)},trace:function(a,b,c){return f("TRACE",a,b,c)}})[a.type?a.type.toLowerCase():"get"](a.url,a,function(b,c){200===b?a.success(c,b,null):a.error(c,b,null)})}function d(a,b){"function"===typeof a&&(b=a,a={});a=a||{};J.extend(A,a);delete A.fixLng;
"string"==typeof A.ns&&(A.ns={namespaces:[A.ns],defaultNs:A.ns});"string"==typeof A.fallbackNS&&(A.fallbackNS=[A.fallbackNS]);if("string"==typeof A.fallbackLng||"boolean"==typeof A.fallbackLng)A.fallbackLng=[A.fallbackLng];A.interpolationPrefixEscaped=J.regexEscape(A.interpolationPrefix);A.interpolationSuffixEscaped=J.regexEscape(A.interpolationSuffix);A.lng||(A.lng=J.detectLanguage());A.lng?A.useCookie&&J.cookie.create(A.cookieName,A.lng,A.cookieExpirationTime,A.cookieDomain):(A.lng=A.fallbackLng[0],
A.useCookie&&J.cookie.remove(A.cookieName));z=J.toLanguages(A.lng);s=z[0];J.log("currentLng set to: "+s);var c=l;a.fixLng&&(c=function(a,b){b=b||{};b.lng=b.lng||c.lng;return l(a,b)},c.lng=s);I.setCurrentLng(s);if(A.resStore)v=A.resStore,D=!0,b&&b(c);else{var d=J.toLanguages(A.lng);"string"===typeof A.preload&&(A.preload=[A.preload]);for(var f=0,g=A.preload.length;f<g;f++)for(var h=J.toLanguages(A.preload[f]),k=0,m=h.length;k<m;k++)0>d.indexOf(h[k])&&d.push(h[k]);Autodesk.Viewing.i18n.sync.load(d,
A,function(a,d){v=d;D=!0;b&&b(c)})}}function f(a,b){var c={dynamicLoad:A.dynamicLoad,resGetPath:A.resGetPath,getAsync:A.getAsync,customLoad:A.customLoad,ns:{namespaces:a,defaultNs:""}},d=J.toLanguages(A.lng);"string"===typeof A.preload&&(A.preload=[A.preload]);for(var f=0,g=A.preload.length;f<g;f++)for(var h=J.toLanguages(A.preload[f]),k=0,l=h.length;k<l;k++)0>d.indexOf(h[k])&&d.push(h[k]);for(var m=[],f=0,g=d.length;f<g;f++){h=!1;if(k=v[d[f]])for(var l=0,n=a.length;l<n;l++)k[a[l]]||(h=!0);else h=
!0;h&&m.push(d[f])}m.length?r.sync._fetch(m,c,function(c,d){var f=a.length*m.length;J.each(a,function(a,c){0>A.ns.namespaces.indexOf(c)&&A.ns.namespaces.push(c);J.each(m,function(a,g){v[g]=v[g]||{};v[g][c]=d[g][c];f--;0===f&&b&&(A.useLocalStorage&&r.sync._storeLocal(v),b())})})}):b&&b()}function g(a,b,c,d){if(!a)return a;d=d||b;if(0>a.indexOf(d.interpolationPrefix||A.interpolationPrefix))return a;var f=d.interpolationPrefix?J.regexEscape(d.interpolationPrefix):A.interpolationPrefixEscaped,h=d.interpolationSuffix?
J.regexEscape(d.interpolationSuffix):A.interpolationSuffixEscaped,k="HTML"+h;J.each(b,function(b,l){var m=c?c+A.keyseparator+b:b;"object"===typeof l&&null!==l?a=g(a,l,m,d):d.escapeInterpolation||A.escapeInterpolation?(a=a.replace(RegExp([f,m,k].join(""),"g"),l),a=a.replace(RegExp([f,m,h].join(""),"g"),J.escape(l))):a=a.replace(RegExp([f,m,h].join(""),"g"),l)});return a}function h(a,b){var c=J.extend({},b);for(delete c.postProcess;-1!=a.indexOf(A.reusePrefix);){w++;if(w>A.maxRecursion)break;var d=
a.lastIndexOf(A.reusePrefix),f=a.indexOf(A.reuseSuffix,d)+A.reuseSuffix.length,d=a.substring(d,f),f=d.replace(A.reusePrefix,"").replace(A.reuseSuffix,"");if(-1!=f.indexOf(",")){var g=f.indexOf(",");if(-1!=f.indexOf("{",g)&&-1!=f.indexOf("}",g)){var h=f.indexOf("{",g),k=f.indexOf("}",h)+1;try{c=J.extend(c,JSON.parse(f.substring(h,k))),f=f.substring(0,g)}catch(l){}}}f=p(f,c);a=a.replace(d,f)}return a}function k(a,b){b=b||{};var c=void 0!==b.defaultValue?b.defaultValue:a,d=n(a,b);return void 0!==d||
d===c}function l(a,b){b=b||{};if(!D){J.log("i18next not finished initialization. you might have called t function before loading resources finished.");var c=a.indexOf(":");0>c?c=0:c++;(c=b.defaultValue||a.substr(c))&&(c=g(c,b));return c}w=0;return p.apply(null,arguments)}function m(){for(var a=[],b=1;b<arguments.length;b++)a.push(arguments[b]);return{postProcess:"sprintf",sprintf:a}}function p(a,b){b&&"object"!==typeof b?"sprintf"===A.shortcutFunction?b=m.apply(null,arguments):"defaultValue"===A.shortcutFunction&&
(b={defaultValue:b}):b=b||{};if(void 0===a||null===a)return"";"string"==typeof a&&(a=[a]);var c=a[0];if(1<a.length)for(var d=0;d<a.length&&(c=a[d],!k(c,b));d++);var d=void 0!==b.defaultValue?b.defaultValue:c,f=n(c,b),l=b.lng?J.toLanguages(b.lng):z,p=b.ns||A.ns.defaultNs,q;-1<c.indexOf(A.nsseparator)&&(q=c.split(A.nsseparator),p=q[0],c=q[1]);void 0===f&&A.sendMissing&&(b.lng?G.postMissing(l[0],p,c,d,l):G.postMissing(A.lng,p,c,d,l));l=b.postProcess||A.postProcess;void 0!==f&&l&&M[l]&&(f=M[l](f,c,b));
q=d;-1<d.indexOf(A.nsseparator)&&(q=d.split(A.nsseparator),q=q[1]);q===c&&A.parseMissingKey&&(d=A.parseMissingKey(d));void 0===f&&(d=g(d,b),d=h(d,b),l&&M[l]&&(f=M[l](void 0!==b.defaultValue?b.defaultValue:c,c,b)));return void 0!==f?f:d}function n(a,b){b=b||{};var c,d=void 0!==b.defaultValue?b.defaultValue:a,f=z;if(!v||"cimode"===f[0].toLowerCase())return d;if(b.lng&&(f=J.toLanguages(b.lng),!v[f[0]])){var k=A.getAsync;A.getAsync=!1;Autodesk.Viewing.i18n.sync.load(f,A,function(a,b){J.extend(v,b);A.getAsync=
k})}var m=b.ns||A.ns.defaultNs;-1<a.indexOf(A.nsseparator)&&(c=a.split(A.nsseparator),m=c[0],a=c[1]);if(b.context&&("string"==typeof b.context||"number"==typeof b.context)&&(c=J.extend({},b),delete c.context,c.defaultValue=A.contextNotFound,c=l(m+A.nsseparator+a+"_"+b.context,c),c!=A.contextNotFound))return g(c,{context:b.context});if(void 0!==b.count&&"string"!=typeof b.count&&1!==b.count){c=J.extend({},b);delete c.count;c.defaultValue=A.pluralNotFound;var q=m+A.nsseparator+a+A.pluralSuffix,r=I.get(f[0],
b.count);0<=r?q=q+"_"+r:1===r&&(q=m+A.nsseparator+a);c=l(q,c);if(c!=A.pluralNotFound)return g(c,{count:b.count,interpolationPrefix:b.interpolationPrefix,interpolationSuffix:b.interpolationSuffix})}var s;c=a.split(A.keyseparator);q=0;for(r=f.length;q<r&&void 0===s;q++){for(var w=f[q],D=0,C=v[w]&&v[w][m];c[D];)C=C&&C[c[D]],D++;if(void 0!==C){s=Object.prototype.toString.apply(C);if("string"===typeof C)C=g(C,b),C=h(C,b);else if("[object Array]"===s&&!A.returnObjectTrees&&!b.returnObjectTrees)C=C.join("\n"),
C=g(C,b),C=h(C,b);else if(null===C&&!0===A.fallbackOnNull)C=void 0;else if(null!==C)if(!A.returnObjectTrees&&!b.returnObjectTrees)A.objectTreeKeyHandler&&"function"==typeof A.objectTreeKeyHandler?C=A.objectTreeKeyHandler(a,C,w,m,b):(C="key '"+m+":"+a+" ("+w+")' returned an object instead of string.",J.log(C));else if("[object Number]"!==s&&"[object Function]"!==s&&"[object RegExp]"!==s){var E="[object Array]"===s?[]:{};J.each(C,function(c){E[c]=p(m+A.nsseparator+a+A.keyseparator+c,b)});C=E}"string"===
typeof C&&""===C.trim()&&!0===A.fallbackOnEmpty&&(C=void 0);s=C}}if(void 0===s&&!b.isFallbackLookup&&(!0===A.fallbackToDefaultNS||A.fallbackNS&&0<A.fallbackNS.length))if(b.isFallbackLookup=!0,A.fallbackNS.length)for(f=0,c=A.fallbackNS.length;f<c;f++){if(s=n(A.fallbackNS[f]+A.nsseparator+a,b))if(q=-1<s.indexOf(A.nsseparator)?s.split(A.nsseparator)[1]:s,r=-1<d.indexOf(A.nsseparator)?d.split(A.nsseparator)[1]:d,q!==r)break}else s=n(a,b);return s}Array.prototype.indexOf||(Array.prototype.indexOf=function(a){if(null==
this)throw new TypeError;var b=Object(this),c=b.length>>>0;if(0===c)return-1;var d=0;0<arguments.length&&(d=Number(arguments[1]),d!=d?d=0:0!=d&&Infinity!=d&&-Infinity!=d&&(d=(0<d||-1)*Math.floor(Math.abs(d))));if(d>=c)return-1;for(d=0<=d?d:Math.max(c-Math.abs(d),0);d<c;d++)if(d in b&&b[d]===a)return d;return-1});Array.prototype.lastIndexOf||(Array.prototype.lastIndexOf=function(a){if(null==this)throw new TypeError;var b=Object(this),c=b.length>>>0;if(0===c)return-1;var d=c;1<arguments.length&&(d=
Number(arguments[1]),d!=d?d=0:0!=d&&d!=1/0&&d!=-(1/0)&&(d=(0<d||-1)*Math.floor(Math.abs(d))));for(c=0<=d?Math.min(d,c-1):c-Math.abs(d);0<=c;c--)if(c in b&&b[c]===a)return c;return-1});"function"!==typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});var q=this.jQuery||this.Zepto,r={},v={},s,w=0,z=[],D=!1;"undefined"!==typeof module&&module.exports?module.exports=r:(q&&(q.i18n=q.i18n||r),this.i18n=this.i18n||r);var A={lng:void 0,load:"all",preload:[],
lowerCaseLng:!1,returnObjectTrees:!1,fallbackLng:["dev"],fallbackNS:[],detectLngQS:"setLng",ns:"translation",fallbackOnNull:!0,fallbackOnEmpty:!1,fallbackToDefaultNS:!1,nsseparator:":",keyseparator:".",selectorAttr:"data-i18n",debug:!1,resGetPath:"res/locales/__lng__/__ns__.json",resPostPath:"res/locales/add/__lng__/__ns__",getAsync:!0,postAsync:!0,resStore:void 0,useLocalStorage:!1,localStorageExpirationTime:6048E5,dynamicLoad:!1,sendMissing:!1,sendMissingTo:"fallback",sendType:"POST",interpolationPrefix:"__",
interpolationSuffix:"__",reusePrefix:"$t(",reuseSuffix:")",pluralSuffix:"_plural",pluralNotFound:["plural_not_found",Math.random()].join(""),contextNotFound:["context_not_found",Math.random()].join(""),escapeInterpolation:!1,defaultValueFromContent:!0,useDataAttrOptions:!1,cookieExpirationTime:void 0,useCookie:!0,cookieName:"i18next",cookieDomain:void 0,objectTreeKeyHandler:void 0,postProcess:void 0,parseMissingKey:void 0,shortcutFunction:"sprintf"},E={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;",
"'":"&#39;","/":"&#x2F;"},N={create:function(a,b,c,d){if(c){var f=new Date;f.setTime(f.getTime()+6E4*c);c="; expires="+f.toGMTString()}else c="";document.cookie=a+"="+b+c+";"+(d?"domain="+d+";":"")+"path=/"},read:function(a){a+="=";for(var b=document.cookie.split(";"),c=0;c<b.length;c++){for(var d=b[c];" "==d.charAt(0);)d=d.substring(1,d.length);if(0===d.indexOf(a))return d.substring(a.length,d.length)}return null},remove:function(a){this.create(a,"",-1)}},H={create:function(a,b,c,d){},read:function(a){return null},
remove:function(a){}},J={extend:q?q.extend:a,each:q?q.each:b,ajax:q?q.ajax:"undefined"!==typeof document?c:function(){},cookie:"undefined"!==typeof document?N:H,detectLanguage:function(){var a,b=[];if("undefined"!==typeof window){for(var c=window.location.search.substring(1).split("&"),d=0;d<c.length;d++){var f=c[d].indexOf("=");if(0<f){var g=c[d].substring(0,f),f=c[d].substring(f+1);b[g]=f}}b[A.detectLngQS]&&(a=b[A.detectLngQS])}!a&&"undefined"!==typeof document&&A.useCookie&&(b=J.cookie.read(A.cookieName))&&
(a=b);a||"undefined"===typeof navigator||(a=navigator.language?navigator.language:navigator.userLanguage);return a},escape:function(a){return"string"===typeof a?a.replace(/[&<>"'\/]/g,function(a){return E[a]}):a},log:function(a){A.debug&&"undefined"!==typeof console&&console.log(a)},toLanguages:function(a){var b=[];if("string"===typeof a&&-1<a.indexOf("-")){var c=a.split("-");a=A.lowerCaseLng?c[0].toLowerCase()+"-"+c[1].toLowerCase():c[0].toLowerCase()+"-"+c[1].toUpperCase();"unspecific"!==A.load&&
b.push(a);"current"!==A.load&&b.push(c[0])}else b.push(a);for(a=0;a<A.fallbackLng.length;a++)-1===b.indexOf(A.fallbackLng[a])&&A.fallbackLng[a]&&b.push(A.fallbackLng[a]);return b},regexEscape:function(a){return a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}};J.applyReplacement=g;var G={load:function(a,b,c){b.useLocalStorage?G._loadLocal(a,b,function(d,f){for(var g=[],h=0,k=a.length;h<k;h++)f[a[h]]||g.push(a[h]);0<g.length?G._fetch(g,b,function(a,b){J.extend(f,b);G._storeLocal(b);c(null,
f)}):c(null,f)}):G._fetch(a,b,function(a,b){c(null,b)})},_loadLocal:function(a,b,c){var d={},f=(new Date).getTime();if(window.localStorage){var g=a.length;J.each(a,function(a,h){var k=window.localStorage.getItem("res_"+h);k&&(k=JSON.parse(k),k.i18nStamp&&k.i18nStamp+b.localStorageExpirationTime>f&&(d[h]=k));g--;0===g&&c(null,d)})}},_storeLocal:function(a){if(window.localStorage)for(var b in a)a[b].i18nStamp=(new Date).getTime(),window.localStorage.setItem("res_"+b,JSON.stringify(a[b]))},_fetch:function(a,
b,c){var d=b.ns,f={};if(b.dynamicLoad){var h=function(a,b){c(null,b)};if("function"==typeof b.customLoad)b.customLoad(a,d.namespaces,b,h);else{var k=g(b.resGetPath,{lng:a.join("+"),ns:d.namespaces.join("+")}),k=Autodesk.Viewing.Private.getResourceUrl(k);J.ajax({url:k,success:function(a,b,d){J.log("loaded: "+k);a=a.json();c(null,a)},error:function(a,b,d){J.log("failed loading: "+k);c(null,void 0)},dataType:"text",async:b.getAsync})}}else{var l=d.namespaces.length*a.length,m;J.each(d.namespaces,function(d,
g){J.each(a,function(a,d){var h=function(a,b){a&&(m=m||[],m.push(a));f[d]=f[d]||{};f[d][g]=b;l--;0===l&&c(m,f)};"function"==typeof b.customLoad?b.customLoad(d,g,b,h):G._fetchOne(d,g,b,h)})})}},_fetchOne:function(a,b,c,d){var f=g(c.resGetPath,{lng:a,ns:b}),f=Autodesk.Viewing.Private.getResourceUrl(f);J.ajax({url:f,success:function(a,b,c){J.log("loaded: "+f);for(var g=!1,h=!1,k="",l=0;l<a.length;l++)if(b=a[l],c=a[l+1],h||"\\"===a[l-1]||'"'!==b||(g=!g),g)k+=b;else{if(!h&&"//"===b+c)h="single",l++;else if("single"===
h&&"\r\n"===b+c)h=!1,l++;else if("single"===h&&"\n"===b)h=!1;else if(!h&&"/*"===b+c){h="multi";l++;continue}else if("multi"===h&&"*/"===b+c){h=!1;l++;continue}h||(k+=b)}d(null,JSON.parse(k))},error:function(a,b,c){b&&200==b||a&&a.status&&200==a.status?J.log("There is a typo in: "+f):b&&404==b||a&&a.status&&404==a.status?J.log("Does not exist: "+f):J.log((b?b:a&&a.status?a.status:null)+" when loading "+f);d(c,{})},dataType:"text",async:c.getAsync})},postMissing:function(a,b,c,d,f){var h={};h[c]=d;
var k=[];if("fallback"===A.sendMissingTo&&!1!==A.fallbackLng[0])for(a=0;a<A.fallbackLng.length;a++)k.push({lng:A.fallbackLng[a],url:g(A.resPostPath,{lng:A.fallbackLng[a],ns:b})});else if("current"===A.sendMissingTo||"fallback"===A.sendMissingTo&&!1===A.fallbackLng[0])k.push({lng:a,url:g(A.resPostPath,{lng:a,ns:b})});else if("all"===A.sendMissingTo){a=0;for(var l=f.length;a<l;a++)k.push({lng:f[a],url:g(A.resPostPath,{lng:f[a],ns:b})})}f=0;for(a=k.length;f<a;f++){var m=k[f];J.ajax({url:m.url,type:A.sendType,
data:h,success:function(a,f,g){J.log("posted missing key '"+c+"' to: "+m.url);a=c.split(".");f=0;for(g=v[m.lng][b];a[f];)g=f===a.length-1?g[a[f]]=d:g[a[f]]=g[a[f]]||{},f++},error:function(a,b,d){J.log("failed posting missing key '"+c+"' to: "+m.url)},dataType:"json",async:A.postAsync})}}},I={rules:{ach:{name:"Acholi",numbers:[1,2],plurals:function(a){return Number(1<a)}},af:{name:"Afrikaans",numbers:[1,2],plurals:function(a){return Number(1!=a)}},ak:{name:"Akan",numbers:[1,2],plurals:function(a){return Number(1<
a)}},am:{name:"Amharic",numbers:[1,2],plurals:function(a){return Number(1<a)}},an:{name:"Aragonese",numbers:[1,2],plurals:function(a){return Number(1!=a)}},ar:{name:"Arabic",numbers:[0,1,2,3,11,100],plurals:function(a){return Number(0===a?0:1==a?1:2==a?2:3<=a%100&&10>=a%100?3:11<=a%100?4:5)}},arn:{name:"Mapudungun",numbers:[1,2],plurals:function(a){return Number(1<a)}},ast:{name:"Asturian",numbers:[1,2],plurals:function(a){return Number(1!=a)}},ay:{name:"Aymar\u00e1",numbers:[1],plurals:function(a){return 0}},
az:{name:"Azerbaijani",numbers:[1,2],plurals:function(a){return Number(1!=a)}},be:{name:"Belarusian",numbers:[1,2,5],plurals:function(a){return Number(1==a%10&&11!=a%100?0:2<=a%10&&4>=a%10&&(10>a%100||20<=a%100)?1:2)}},bg:{name:"Bulgarian",numbers:[1,2],plurals:function(a){return Number(1!=a)}},bn:{name:"Bengali",numbers:[1,2],plurals:function(a){return Number(1!=a)}},bo:{name:"Tibetan",numbers:[1],plurals:function(a){return 0}},br:{name:"Breton",numbers:[1,2],plurals:function(a){return Number(1<
a)}},bs:{name:"Bosnian",numbers:[1,2,5],plurals:function(a){return Number(1==a%10&&11!=a%100?0:2<=a%10&&4>=a%10&&(10>a%100||20<=a%100)?1:2)}},ca:{name:"Catalan",numbers:[1,2],plurals:function(a){return Number(1!=a)}},cgg:{name:"Chiga",numbers:[1],plurals:function(a){return 0}},cs:{name:"Czech",numbers:[1,2,5],plurals:function(a){return Number(1==a?0:2<=a&&4>=a?1:2)}},csb:{name:"Kashubian",numbers:[1,2,5],plurals:function(a){return Number(1==a?0:2<=a%10&&4>=a%10&&(10>a%100||20<=a%100)?1:2)}},cy:{name:"Welsh",
numbers:[1,2,3,8],plurals:function(a){return Number(1==a?0:2==a?1:8!=a&&11!=a?2:3)}},da:{name:"Danish",numbers:[1,2],plurals:function(a){return Number(1!=a)}},de:{name:"German",numbers:[1,2],plurals:function(a){return Number(1!=a)}},dz:{name:"Dzongkha",numbers:[1],plurals:function(a){return 0}},el:{name:"Greek",numbers:[1,2],plurals:function(a){return Number(1!=a)}},en:{name:"English",numbers:[1,2],plurals:function(a){return Number(1!=a)}},eo:{name:"Esperanto",numbers:[1,2],plurals:function(a){return Number(1!=
a)}},es:{name:"Spanish",numbers:[1,2],plurals:function(a){return Number(1!=a)}},es_ar:{name:"Argentinean Spanish",numbers:[1,2],plurals:function(a){return Number(1!=a)}},et:{name:"Estonian",numbers:[1,2],plurals:function(a){return Number(1!=a)}},eu:{name:"Basque",numbers:[1,2],plurals:function(a){return Number(1!=a)}},fa:{name:"Persian",numbers:[1],plurals:function(a){return 0}},fi:{name:"Finnish",numbers:[1,2],plurals:function(a){return Number(1!=a)}},fil:{name:"Filipino",numbers:[1,2],plurals:function(a){return Number(1<
a)}},fo:{name:"Faroese",numbers:[1,2],plurals:function(a){return Number(1!=a)}},fr:{name:"French",numbers:[1,2],plurals:function(a){return Number(1<a)}},fur:{name:"Friulian",numbers:[1,2],plurals:function(a){return Number(1!=a)}},fy:{name:"Frisian",numbers:[1,2],plurals:function(a){return Number(1!=a)}},ga:{name:"Irish",numbers:[1,2,3,7,11],plurals:function(a){return Number(1==a?0:2==a?1:7>a?2:11>a?3:4)}},gd:{name:"Scottish Gaelic",numbers:[1,2,3,20],plurals:function(a){return Number(1==a||11==a?
0:2==a||12==a?1:2<a&&20>a?2:3)}},gl:{name:"Galician",numbers:[1,2],plurals:function(a){return Number(1!=a)}},gu:{name:"Gujarati",numbers:[1,2],plurals:function(a){return Number(1!=a)}},gun:{name:"Gun",numbers:[1,2],plurals:function(a){return Number(1<a)}},ha:{name:"Hausa",numbers:[1,2],plurals:function(a){return Number(1!=a)}},he:{name:"Hebrew",numbers:[1,2],plurals:function(a){return Number(1!=a)}},hi:{name:"Hindi",numbers:[1,2],plurals:function(a){return Number(1!=a)}},hr:{name:"Croatian",numbers:[1,
2,5],plurals:function(a){return Number(1==a%10&&11!=a%100?0:2<=a%10&&4>=a%10&&(10>a%100||20<=a%100)?1:2)}},hu:{name:"Hungarian",numbers:[1,2],plurals:function(a){return Number(1!=a)}},hy:{name:"Armenian",numbers:[1,2],plurals:function(a){return Number(1!=a)}},ia:{name:"Interlingua",numbers:[1,2],plurals:function(a){return Number(1!=a)}},id:{name:"Indonesian",numbers:[1],plurals:function(a){return 0}},is:{name:"Icelandic",numbers:[1,2],plurals:function(a){return Number(1!=a%10||11==a%100)}},it:{name:"Italian",
numbers:[1,2],plurals:function(a){return Number(1!=a)}},ja:{name:"Japanese",numbers:[1],plurals:function(a){return 0}},jbo:{name:"Lojban",numbers:[1],plurals:function(a){return 0}},jv:{name:"Javanese",numbers:[0,1],plurals:function(a){return Number(0!==a)}},ka:{name:"Georgian",numbers:[1],plurals:function(a){return 0}},kk:{name:"Kazakh",numbers:[1],plurals:function(a){return 0}},km:{name:"Khmer",numbers:[1],plurals:function(a){return 0}},kn:{name:"Kannada",numbers:[1,2],plurals:function(a){return Number(1!=
a)}},ko:{name:"Korean",numbers:[1],plurals:function(a){return 0}},ku:{name:"Kurdish",numbers:[1,2],plurals:function(a){return Number(1!=a)}},kw:{name:"Cornish",numbers:[1,2,3,4],plurals:function(a){return Number(1==a?0:2==a?1:3==a?2:3)}},ky:{name:"Kyrgyz",numbers:[1],plurals:function(a){return 0}},lb:{name:"Letzeburgesch",numbers:[1,2],plurals:function(a){return Number(1!=a)}},ln:{name:"Lingala",numbers:[1,2],plurals:function(a){return Number(1<a)}},lo:{name:"Lao",numbers:[1],plurals:function(a){return 0}},
lt:{name:"Lithuanian",numbers:[1,2,10],plurals:function(a){return Number(1==a%10&&11!=a%100?0:2<=a%10&&(10>a%100||20<=a%100)?1:2)}},lv:{name:"Latvian",numbers:[1,2,0],plurals:function(a){return Number(1==a%10&&11!=a%100?0:0!==a?1:2)}},mai:{name:"Maithili",numbers:[1,2],plurals:function(a){return Number(1!=a)}},mfe:{name:"Mauritian Creole",numbers:[1,2],plurals:function(a){return Number(1<a)}},mg:{name:"Malagasy",numbers:[1,2],plurals:function(a){return Number(1<a)}},mi:{name:"Maori",numbers:[1,2],
plurals:function(a){return Number(1<a)}},mk:{name:"Macedonian",numbers:[1,2],plurals:function(a){return Number(1==a||1==a%10?0:1)}},ml:{name:"Malayalam",numbers:[1,2],plurals:function(a){return Number(1!=a)}},mn:{name:"Mongolian",numbers:[1,2],plurals:function(a){return Number(1!=a)}},mnk:{name:"Mandinka",numbers:[0,1,2],plurals:function(a){return Number(1==a?1:2)}},mr:{name:"Marathi",numbers:[1,2],plurals:function(a){return Number(1!=a)}},ms:{name:"Malay",numbers:[1],plurals:function(a){return 0}},
mt:{name:"Maltese",numbers:[1,2,11,20],plurals:function(a){return Number(1==a?0:0===a||1<a%100&&11>a%100?1:10<a%100&&20>a%100?2:3)}},nah:{name:"Nahuatl",numbers:[1,2],plurals:function(a){return Number(1!=a)}},nap:{name:"Neapolitan",numbers:[1,2],plurals:function(a){return Number(1!=a)}},nb:{name:"Norwegian Bokmal",numbers:[1,2],plurals:function(a){return Number(1!=a)}},ne:{name:"Nepali",numbers:[1,2],plurals:function(a){return Number(1!=a)}},nl:{name:"Dutch",numbers:[1,2],plurals:function(a){return Number(1!=
a)}},nn:{name:"Norwegian Nynorsk",numbers:[1,2],plurals:function(a){return Number(1!=a)}},no:{name:"Norwegian",numbers:[1,2],plurals:function(a){return Number(1!=a)}},nso:{name:"Northern Sotho",numbers:[1,2],plurals:function(a){return Number(1!=a)}},oc:{name:"Occitan",numbers:[1,2],plurals:function(a){return Number(1<a)}},or:{name:"Oriya",numbers:[2,1],plurals:function(a){return Number(1!=a)}},pa:{name:"Punjabi",numbers:[1,2],plurals:function(a){return Number(1!=a)}},pap:{name:"Papiamento",numbers:[1,
2],plurals:function(a){return Number(1!=a)}},pl:{name:"Polish",numbers:[1,2,5],plurals:function(a){return Number(1==a?0:2<=a%10&&4>=a%10&&(10>a%100||20<=a%100)?1:2)}},pms:{name:"Piemontese",numbers:[1,2],plurals:function(a){return Number(1!=a)}},ps:{name:"Pashto",numbers:[1,2],plurals:function(a){return Number(1!=a)}},pt:{name:"Portuguese",numbers:[1,2],plurals:function(a){return Number(1!=a)}},pt_br:{name:"Brazilian Portuguese",numbers:[1,2],plurals:function(a){return Number(1!=a)}},rm:{name:"Romansh",
numbers:[1,2],plurals:function(a){return Number(1!=a)}},ro:{name:"Romanian",numbers:[1,2,20],plurals:function(a){return Number(1==a?0:0===a||0<a%100&&20>a%100?1:2)}},ru:{name:"Russian",numbers:[1,2,5],plurals:function(a){return Number(1==a%10&&11!=a%100?0:2<=a%10&&4>=a%10&&(10>a%100||20<=a%100)?1:2)}},sah:{name:"Yakut",numbers:[1],plurals:function(a){return 0}},sco:{name:"Scots",numbers:[1,2],plurals:function(a){return Number(1!=a)}},se:{name:"Northern Sami",numbers:[1,2],plurals:function(a){return Number(1!=
a)}},si:{name:"Sinhala",numbers:[1,2],plurals:function(a){return Number(1!=a)}},sk:{name:"Slovak",numbers:[1,2,5],plurals:function(a){return Number(1==a?0:2<=a&&4>=a?1:2)}},sl:{name:"Slovenian",numbers:[5,1,2,3],plurals:function(a){return Number(1==a%100?1:2==a%100?2:3==a%100||4==a%100?3:0)}},so:{name:"Somali",numbers:[1,2],plurals:function(a){return Number(1!=a)}},son:{name:"Songhay",numbers:[1,2],plurals:function(a){return Number(1!=a)}},sq:{name:"Albanian",numbers:[1,2],plurals:function(a){return Number(1!=
a)}},sr:{name:"Serbian",numbers:[1,2,5],plurals:function(a){return Number(1==a%10&&11!=a%100?0:2<=a%10&&4>=a%10&&(10>a%100||20<=a%100)?1:2)}},su:{name:"Sundanese",numbers:[1],plurals:function(a){return 0}},sv:{name:"Swedish",numbers:[1,2],plurals:function(a){return Number(1!=a)}},sw:{name:"Swahili",numbers:[1,2],plurals:function(a){return Number(1!=a)}},ta:{name:"Tamil",numbers:[1,2],plurals:function(a){return Number(1!=a)}},te:{name:"Telugu",numbers:[1,2],plurals:function(a){return Number(1!=a)}},
tg:{name:"Tajik",numbers:[1,2],plurals:function(a){return Number(1<a)}},th:{name:"Thai",numbers:[1],plurals:function(a){return 0}},ti:{name:"Tigrinya",numbers:[1,2],plurals:function(a){return Number(1<a)}},tk:{name:"Turkmen",numbers:[1,2],plurals:function(a){return Number(1!=a)}},tr:{name:"Turkish",numbers:[1,2],plurals:function(a){return Number(1<a)}},tt:{name:"Tatar",numbers:[1],plurals:function(a){return 0}},ug:{name:"Uyghur",numbers:[1],plurals:function(a){return 0}},uk:{name:"Ukrainian",numbers:[1,
2,5],plurals:function(a){return Number(1==a%10&&11!=a%100?0:2<=a%10&&4>=a%10&&(10>a%100||20<=a%100)?1:2)}},ur:{name:"Urdu",numbers:[1,2],plurals:function(a){return Number(1!=a)}},uz:{name:"Uzbek",numbers:[1,2],plurals:function(a){return Number(1<a)}},vi:{name:"Vietnamese",numbers:[1],plurals:function(a){return 0}},wa:{name:"Walloon",numbers:[1,2],plurals:function(a){return Number(1<a)}},wo:{name:"Wolof",numbers:[1],plurals:function(a){return 0}},yo:{name:"Yoruba",numbers:[1,2],plurals:function(a){return Number(1!=
a)}},zh:{name:"Chinese",numbers:[1],plurals:function(a){return 0}}},addRule:function(a,b){I.rules[a]=b},setCurrentLng:function(a){if(!I.currentRule||I.currentRule.lng!==a){var b=a.split("-");I.currentRule={lng:a,rule:I.rules[b[0]]}}},get:function(a,b){var c=a.split("-");if(c=I.currentRule&&I.currentRule.lng===a?I.currentRule.rule:I.rules[c[0]]){var d=c.plurals(b),d=c.numbers[d];2===c.numbers.length&&1===c.numbers[0]&&(2===d?d=-1:1===d&&(d=1));c=d}else c=1===b?"1":"-1";return c}},M={},q=function(a,
b){M[a]=b},C=function(){function a(b){return Object.prototype.toString.call(b).slice(8,-1).toLowerCase()}var b=function(){b.cache.hasOwnProperty(arguments[0])||(b.cache[arguments[0]]=b.parse(arguments[0]));return b.format.call(null,b.cache[arguments[0]],arguments)};b.format=function(b,c){var d=1,f=b.length,g="",h=[],k,l,m,n;for(k=0;k<f;k++)if(g=a(b[k]),"string"===g)h.push(b[k]);else if("array"===g){m=b[k];if(m[2])for(g=c[d],l=0;l<m[2].length;l++){if(!g.hasOwnProperty(m[2][l]))throw C('[sprintf] property "%s" does not exist',
m[2][l]);g=g[m[2][l]]}else g=m[1]?c[m[1]]:c[d++];if(/[^s]/.test(m[8])&&"number"!=a(g))throw C("[sprintf] expecting number but found %s",a(g));switch(m[8]){case "b":g=g.toString(2);break;case "c":g=String.fromCharCode(g);break;case "d":g=parseInt(g,10);break;case "e":g=m[7]?g.toExponential(m[7]):g.toExponential();break;case "f":g=m[7]?parseFloat(g).toFixed(m[7]):parseFloat(g);break;case "o":g=g.toString(8);break;case "s":g=(g=String(g))&&m[7]?g.substring(0,m[7]):g;break;case "u":g=Math.abs(g);break;
case "x":g=g.toString(16);break;case "X":g=g.toString(16).toUpperCase()}g=/[def]/.test(m[8])&&m[3]&&0<=g?"+"+g:g;l=m[4]?"0"==m[4]?"0":m[4].charAt(1):" ";n=m[6]-String(g).length;if(m[6]){for(var p=[];0<n;p[--n]=l);l=p.join("")}else l="";h.push(m[5]?g+l:l+g)}return h.join("")};b.cache={};b.parse=function(a){for(var b=[],c=[],d=0;a;){if(null!==(b=/^[^\x25]+/.exec(a)))c.push(b[0]);else if(null!==(b=/^\x25{2}/.exec(a)))c.push("%");else if(null!==(b=/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(a))){if(b[2]){var d=
d|1,f=[],g=b[2],h=[];if(null!==(h=/^([a-z_][a-z_\d]*)/i.exec(g)))for(f.push(h[1]);""!==(g=g.substring(h[0].length));)if(null!==(h=/^\.([a-z_][a-z_\d]*)/i.exec(g)))f.push(h[1]);else if(null!==(h=/^\[(\d+)\]/.exec(g)))f.push(h[1]);else throw"[sprintf] huh?";else throw"[sprintf] huh?";b[2]=f}else d|=2;if(3===d)throw"[sprintf] mixing positional and named placeholders is not (yet) supported";c.push(b)}else throw"[sprintf] huh?";a=a.substring(b[0].length)}return c};return b}();q("sprintf",function(a,b,
c){return c.sprintf?"[object Array]"===Object.prototype.toString.apply(c.sprintf)?(b=c.sprintf,b.unshift(a),C.apply(null,b)):"object"===typeof c.sprintf?C(a,c.sprintf):a:a});Autodesk.Viewing.i18n.init=d;Autodesk.Viewing.i18n.setLng=function(a,b,c){"function"===typeof b?(c=b,b={}):b||(b={});b.lng=a;return d(b,c)};Autodesk.Viewing.i18n.preload=function(a,b){"string"===typeof a&&(a=[a]);for(var c=0,f=a.length;c<f;c++)0>A.preload.indexOf(a[c])&&A.preload.push(a[c]);return d(b)};Autodesk.Viewing.i18n.addResourceBundle=
function(a,b,c){"string"!==typeof b?(c=b,b=A.ns.defaultNs):0>A.ns.namespaces.indexOf(b)&&A.ns.namespaces.push(b);v[a]=v[a]||{};v[a][b]=v[a][b]||{};J.extend(v[a][b],c)};Autodesk.Viewing.i18n.removeResourceBundle=function(a,b){"string"!==typeof b&&(b=A.ns.defaultNs);v[a]=v[a]||{};v[a][b]={}};Autodesk.Viewing.i18n.loadNamespace=function(a,b){f([a],b)};Autodesk.Viewing.i18n.loadNamespaces=f;Autodesk.Viewing.i18n.localize=function(){Array.prototype.forEach.call(document.querySelectorAll("[data-i18n]"),
function(a){var b,c,d=a.getAttribute("data-i18n").split(/\[|\]/);1===d.length?(c=null,b=d[0]):3===d.length&&(c=d[1],b=d[2]);b=[c,b];c=b[0];b=b[1];(d=Autodesk.Viewing.i18n.translate(b))?c?a.setAttribute(c,d):a.textContent=d:c?a.setAttribute(c,b):a.textContent=b})};Autodesk.Viewing.i18n.setDefaultNamespace=function(a){A.ns.defaultNs=a};Autodesk.Viewing.i18n.t=l;Autodesk.Viewing.i18n.translate=l;Autodesk.Viewing.i18n.exists=k;Autodesk.Viewing.i18n.detectLanguage=J.detectLanguage;Autodesk.Viewing.i18n.pluralExtensions=
I;Autodesk.Viewing.i18n.sync=G;Autodesk.Viewing.i18n.functions=J;Autodesk.Viewing.i18n.lng=function(){return s};Autodesk.Viewing.i18n.addPostProcessor=q;Autodesk.Viewing.i18n.options=A})();AutodeskNamespace("Autodesk.Viewing.UI");
Autodesk.Viewing.UI.DockingPanel=function(a,b,c,d){this.kMinHeight=this.kMinWdth=100;this.visibilityCallbacks=[];this.movedSinceLastClick=!1;this.parentContainer=a;this.container=document.createElement("div");this.container.id=b;this.container.lastWidth="";this.container.dockRight=!1;this.container.dockBottom=!1;this.titleLabel=c;d=d||{};d.hasOwnProperty("localizeTitle")||(d.localizeTitle=!0);this.options=d;this.container.classList.add("dockingPanel");(d&&void 0!==d.shadow?d.shadow:1)&&this.container.classList.add("shadow");
a.appendChild(this.container);this.listeners=[];this.initialize();this.setVisible(!1)};Autodesk.Viewing.UI.DockingPanel.prototype.initialize=function(){this.title=this.createTitleBar(this.titleLabel||this.container.id);this.container.appendChild(this.title);this.initializeMoveHandlers(this.title);this.setTitle(this.titleLabel||this.container.id,this.options);this.closer=this.createCloseButton();this.container.appendChild(this.closer)};
Autodesk.Viewing.UI.DockingPanel.prototype.uninitialize=function(){for(var a=0;a<this.listeners.length;++a){var b=this.listeners[a];b.target.removeEventListener(b.eventId,b.callback)}this.listeners=[];this.visibilityCallbacks=[];this.parentContainer.removeChild(this.container);this.closer=this.title=this.container=this.parentContainer=null};Autodesk.Viewing.UI.DockingPanel.prototype.addVisibilityListener=function(a){this.visibilityCallbacks.push(a)};
Autodesk.Viewing.UI.DockingPanel.prototype.setVisible=function(a,b){this.container.style.display=a?"block":"none";if(a){if(this.container.dockRight){var c=this.getContainerBoundingRect().width,d=this.container.lastWidth;d||(d=this.container.style.width?this.container.style.width:this.container.getBoundingClientRect().width);d=""===d?300:parseInt(d);this.container.style.left=c-d+"px"}this.container.dockBottom&&(c=this.getContainerBoundingRect().height,(d=this.container.lastHeight)||(d=this.container.style.height?
this.container.style.height:this.container.getBoundingClientRect().height),d=""===d?300:parseInt(d),this.container.style.top=c-d+"px");this.container.style.maxHeight=this.getContainerBoundingRect().height+"px";this.container.style.maxWidth=this.getContainerBoundingRect().width+"px";if(!b){var f=this;setTimeout(function(){f.container.classList.add("dockingPanelVisible");f.container.classList.remove("dockingPanelHidden")},400)}}else this.container.lastWidth=this.container.style.width,this.container.lastHeight=
this.container.style.height,b||(this.container.classList.remove("dockingPanelVisible"),this.container.classList.add("dockingPanelHidden"));for(c=0;c<this.visibilityCallbacks.length;c++)this.visibilityCallbacks[c](a)};Autodesk.Viewing.UI.DockingPanel.prototype.isVisible=function(){return Boolean("block"===this.container.style.display)};Autodesk.Viewing.UI.DockingPanel.prototype.visibilityChanged=function(){};
Autodesk.Viewing.UI.DockingPanel.prototype.initializeMoveHandlers=function(a){function b(a){var b=q.style.minWidth?parseInt(q.style.minWidth):r.kMinWdth,c=q.style.minHeight?parseInt(q.style.minHeight):r.kMinHeight,d=r.getContainerBoundingRect();q.style.maxWidth&&parseInt(q.style.width)>parseInt(q.style.maxWidth)&&(q.style.width=q.style.maxWidth);q.style.maxHeight&&parseInt(q.style.height)>parseInt(q.style.maxHeight)&&(q.style.height=q.style.maxHeight);parseInt(q.style.width)<b&&(q.style.width=b+"px");
parseInt(q.style.height)<c&&(q.style.height=c+"px");"touchmove"===a.type&&(a.screenX=a.touches[0].screenX,a.screenY=a.touches[0].screenY);p+=a.screenX-h;n+=a.screenY-k;f=l+p;g=m+n;b=parseInt(q.style.width);c=parseInt(q.style.height);isNaN(b)&&(b=r.container.getBoundingClientRect().width);isNaN(c)&&(c=r.container.getBoundingClientRect().height);5>f&&(f=0);5>g&&(g=0);q.dockRight=!1;q.dockBottom=!1;d.width-5<f+b&&(f=d.width-b,q.dockRight=!0);d.height-5<g+c&&(g=d.height-c,q.dockBottom=!0);q.style.left=
f+"px";q.style.top=g+"px";q.style.maxWidth=d.width-f+"px";q.style.maxHeight=d.height-g+"px";h=a.screenX;k=a.screenY;r.onMove(a,f,g)}function c(a){window.removeEventListener("mousemove",b);window.removeEventListener("mouseup",c);window.removeEventListener("touchmove",b);window.removeEventListener("touchend",c);r.onEndMove(a,f,g)}function d(a){"touchstart"===a.type&&(a.screenX=a.touches[0].screenX,a.screenY=a.touches[0].screenY);h=a.screenX;k=a.screenY;n=p=0;l=r.container.offsetLeft;m=r.container.offsetTop;
window.addEventListener("mousemove",b,!1);window.addEventListener("mouseup",c,!1);window.addEventListener("touchmove",b,!1);window.addEventListener("touchend",c,!1);a.preventDefault();r.onStartMove(a,l,m)}var f,g,h,k,l,m,p,n,q=this.container,r=this;r.addEventListener(a,"mousedown",d);r.addEventListener(a,"touchstart",d)};Autodesk.Viewing.UI.DockingPanel.prototype.initializeCloseHandler=function(a){var b=this;b.addEventListener(a,"click",function(a){b.setVisible(!1)},!1)};
Autodesk.Viewing.UI.DockingPanel.prototype.createScrollContainer=function(a){var b=document.createElement("div"),c=b.classList;c.add("dockingPanelScroll");c.add(a&&a.left?"left":"right");a&&a.heightAdjustment&&(b.style.height="calc(100% - "+a.heightAdjustment+"px)");return b};
Autodesk.Viewing.UI.DockingPanel.prototype.createTitleBar=function(a){var b=document.createElement("div");b.className="dockingPanelTitle";b.textContent=a;var c=this;c.addEventListener(b,"click",function(a){if(!c.movedSinceLastClick)c.onTitleClick(a);c.movedSinceLastClick=!1});c.addEventListener(b,"dblclick",function(a){c.onTitleDoubleClick(a)});return b};
Autodesk.Viewing.UI.DockingPanel.prototype.setTitle=function(a,b){b&&b.localizeTitle?(this.title.setAttribute("data-i18n",a),a=Autodesk.Viewing.i18n.translate(a)):this.title.removeAttribute("data-i18n");this.title.textContent=a};Autodesk.Viewing.UI.DockingPanel.prototype.createCloseButton=function(){var a=document.createElement("div");a.className="dockingPanelClose";a.innerHTML="&times;";this.initializeCloseHandler(a);return a};Autodesk.Viewing.UI.DockingPanel.prototype.onStartMove=function(a,b,c){};
Autodesk.Viewing.UI.DockingPanel.prototype.onEndMove=function(a,b,c){};Autodesk.Viewing.UI.DockingPanel.prototype.onMove=function(a,b,c){this.movedSinceLastClick=!0};Autodesk.Viewing.UI.DockingPanel.prototype.onTitleClick=function(a){};Autodesk.Viewing.UI.DockingPanel.prototype.onTitleDoubleClick=function(a){};Autodesk.Viewing.UI.DockingPanel.prototype.addEventListener=function(a,b,c){a.addEventListener(b,c);this.listeners.push({target:a,eventId:b,callback:c})};
Autodesk.Viewing.UI.DockingPanel.prototype.removeEventListener=function(a,b,c){for(var d=0;d<this.listeners.length;++d){var f=this.listeners[d];if(f.target===a&&f.eventId===b&&f.callback===c)return a.removeEventListener(b,c),this.listeners.splice(d,1),!0}return!1};Autodesk.Viewing.UI.DockingPanel.prototype.getContentSize=function(){return{height:this.container.clientHeight,width:this.container.clientWidth}};
Autodesk.Viewing.UI.DockingPanel.prototype.resizeToContent=function(a){var b=this.getContentSize().height,c=this.container.getBoundingClientRect(),d=this.getContainerBoundingRect();a=a&&a.maxHeight?a.maxHeight-c.top:d.height-c.top;b>a&&(b=a);this.container.style.height=b.toString()+"px"};Autodesk.Viewing.UI.DockingPanel.prototype.getContainerBoundingRect=function(){return this.parentContainer.getBoundingClientRect()};AutodeskNamespace("Autodesk.Viewing.UI");
Autodesk.Viewing.UI.ModelStructurePanel=function(a,b,c,d){Autodesk.Viewing.UI.DockingPanel.call(this,a,b,c,d);this.container.classList.add("modelStructurePanel");this.scrollContainer=this.createScrollContainer({left:!1,heightAdjustment:70});this.scrollContainer.style.marginTop="20px";this.container.appendChild(this.scrollContainer);this.scrollContainer.id=this.container.id+"-scroll-container";this.tree=this.modelRoot=null;this.selectedNodes=[];var f=this;this.addVisibilityListener(function(){f.resizeToContent()})};
Autodesk.Viewing.UI.ModelStructurePanel.prototype=Object.create(Autodesk.Viewing.UI.DockingPanel.prototype);Autodesk.Viewing.UI.ModelStructurePanel.prototype.constructor=Autodesk.Viewing.UI.ModelStructurePanel;
Autodesk.Viewing.UI.ModelStructurePanel.prototype.setModel=function(a,b){var c=this,d=function(){var a=new Autodesk.Viewing.UI.TreeDelegate;a.getTreeNodeId=function(a){return a.dbId};a.getTreeNodeLabel=function(a){return c.getNodeLabel(a)};a.getTreeNodeClass=function(a){return c.getNodeClass(a)};a.isTreeNodeGroup=function(a){return c.isGroupNode(a)};a.shouldCreateTreeNode=function(a){return c.shouldInclude(a)};a.onTreeNodeHover=function(a,b,d){c.onHover(b,d)};a.onTreeNodeClick=function(a,b,d){c.onClick(b,
d)};a.onTreeNodeRightClick=function(a,b,d){c.onRightClick(b,d)};a.onTreeNodeDoubleClick=function(a,b,d){c.onDoubleClick(b,d)};a.onTreeNodeIconClick=function(a,b,d){c.onIconClick(b,d)};return a};c.selectedNodes=[];var f=b;f||(c.options&&c.options.defaultTitle?f=c.options.defaultTitle:a&&(f=a.name));var g={};f||(f="Model Structure",g.localizeTitle=!0);c.setTitle(f,g);if(c.tree){for(;c.scrollContainer.hasChildNodes();)c.scrollContainer.removeChild(c.scrollContainer.lastChild);c.title.removeEventListener("click",
c.onTitleClick);c.title.removeEventListener("dblclick",c.onTitleDoubleClick)}if(c.modelRoot=a)d=d(),c.tree=new Autodesk.Viewing.UI.Tree(d,a,c.scrollContainer,{}),c.options&&c.options.hasOwnProperty("startCollapsed")&&!c.options.startCollapsed||(c.tree.setAllCollapsed(!0),c.tree.setCollapsed(d.getTreeNodeId(a),!1)),c.options&&c.options.hasOwnProperty("excludeRoot")&&!c.options.excludeRoot||c.tree.addClass(d.getTreeNodeId(a),"exclude"),this.resizeToContent()};
Autodesk.Viewing.UI.ModelStructurePanel.prototype.getNodeLabel=function(a){return a.name&&""!==a.name?a.name:"Object "+a.dbId};Autodesk.Viewing.UI.ModelStructurePanel.prototype.getNodeClass=function(a){return""};Autodesk.Viewing.UI.ModelStructurePanel.prototype.isGroupNode=function(a){return a.children&&Array.isArray(a.children)&&0<a.children.length};Autodesk.Viewing.UI.ModelStructurePanel.prototype.shouldInclude=function(a){return!0};
Autodesk.Viewing.UI.ModelStructurePanel.prototype.onHover=function(a,b){};Autodesk.Viewing.UI.ModelStructurePanel.prototype.onClick=function(a,b){this.setSelection([a])};Autodesk.Viewing.UI.ModelStructurePanel.prototype.onDoubleClick=function(a,b){};Autodesk.Viewing.UI.ModelStructurePanel.prototype.onIconClick=function(a,b){this.setGroupCollapsed(a,!this.isGroupCollapsed(a))};
Autodesk.Viewing.UI.ModelStructurePanel.prototype.setGroupCollapsed=function(a,b){var c=this.tree.delegate();c.isTreeNodeGroup(a)&&(c=c.getTreeNodeId(a),this.tree.setCollapsed(c,b),this.resizeToContent({maxHeight:this.parentContainer.offsetHeight-75}))};Autodesk.Viewing.UI.ModelStructurePanel.prototype.isGroupCollapsed=function(a){var b=this.tree.delegate();return b.isTreeNodeGroup(a)?(a=b.getTreeNodeId(a),this.tree.isCollapsed(a)):!1};
Autodesk.Viewing.UI.ModelStructurePanel.prototype.onRightClick=function(a,b){};Autodesk.Viewing.UI.ModelStructurePanel.prototype.onTitleClick=function(a){this.onClick(this.modelRoot,a)};Autodesk.Viewing.UI.ModelStructurePanel.prototype.onTitleDoubleClick=function(a){this.onDoubleClick(this.modelRoot,a)};
Autodesk.Viewing.UI.ModelStructurePanel.prototype.setSelection=function(a){if(this.tree){var b,c;for(b=0;b<this.selectedNodes.length;++b)for(c=this.selectedNodes[b].parent;c;)this.tree.removeClass(this.tree.delegate().getTreeNodeId(c),"ancestor-selected"),c=c.parent;var d=[];for(b=0;b<a.length;++b)for(d.push(a[b].dbId),c=a[b].parent;c;)this.tree.addClass(this.tree.delegate().getTreeNodeId(c),"ancestor-selected"),c=c.parent;this.selectedNodes=a;this.tree.setSelection(d)}};
Autodesk.Viewing.UI.ModelStructurePanel.prototype.getContentSize=function(){var a=this.tree;return a&&(a=document.getElementById(a.getRootContainerId()))?{height:a.clientHeight+75,width:a.clientWidth}:{height:0,width:0}};Autodesk.Viewing.UI.ModelStructurePanel.prototype.addClass=function(a,b){return null!==this.tree&&this.tree.addClass(a,b)};Autodesk.Viewing.UI.ModelStructurePanel.prototype.removeClass=function(a,b){return null!==this.tree&&this.tree.removeClass(a,b)};AutodeskNamespace("Autodesk.Viewing.UI");
Autodesk.Viewing.UI.PropertyPanel=function(a,b,c,d){Autodesk.Viewing.UI.DockingPanel.call(this,a,b,c,d);this.container.classList.add("propertyPanel");this.container.dockRight=!0;this.scrollContainer=this.createScrollContainer({left:!1,heightAdjustment:75});this.scrollContainer.style.marginTop="20px";this.container.appendChild(this.scrollContainer);this.scrollContainer.id=this.container.id+"-scroll-container";this.highlightableElements={};var f=this;a=function(){function a(b){return"category"===b.type}
var b=new Autodesk.Viewing.UI.TreeDelegate;b.getTreeNodeId=function(a){return a.name+(a.hasOwnProperty("value")?a.value:"")+(a.hasOwnProperty("category")?a.category:"")};b.getTreeNodeClass=function(b){return a(b)?f.getCategoryClass(b):f.getPropertyClass(b)};b.isTreeNodeGroup=function(b){return a(b)};b.onTreeNodeHover=function(b,c,d){if(a(c))f.onCategoryHover(c,d);else f.onPropertyHover(c,d)};b.onTreeNodeClick=function(b,c,d){if(a(c))f.onCategoryClick(c,d);else f.onPropertyClick(c,d)};b.onTreeNodeRightClick=
function(b,c,d){if(a(c))f.onCategoryRightClick(c,d);else f.onPropertyRightClick(c,d)};b.onTreeNodeDoubleClick=function(b,c,d){if(a(c))f.onCategoryDoubleClick(c,d);else f.onPropertyDoubleClick(c,d)};b.onTreeNodeIconClick=function(b,c,d){if(a(c))f.onCategoryIconClick(c,d);else f.onPropertyIconClick(c,d)};b.createTreeNode=function(b,c,d){var h=null;(h=a(b)?f.displayCategory(b,c,d):f.displayProperty(b,c,d))&&(f.highlightableElements[this.getTreeNodeId(b)]=h)};return b}();this.tree=new Autodesk.Viewing.UI.Tree(a,
null,this.scrollContainer,{})};Autodesk.Viewing.UI.PropertyPanel.prototype=Object.create(Autodesk.Viewing.UI.DockingPanel.prototype);Autodesk.Viewing.UI.PropertyPanel.prototype.constructor=Autodesk.Viewing.UI.PropertyPanel;
Autodesk.Viewing.UI.PropertyPanel.prototype.setProperties=function(a,b){this.removeAllProperties();for(var c=[],d=[],f=0;f<a.length;f++){var g=a[f];if(!g.hidden){var h=a[f].displayCategory;h&&"string"===typeof h&&""!==h?c.push(g):d.push(g)}}if(0===c.length+d.length)this.showNoProperties();else{for(f=0;f<c.length;f++)g=c[f],h=Autodesk.Viewing.Private.formatValueWithUnits(g.displayValue,g.units,g.type),this.addProperty(g.displayName,h,g.displayCategory);c=0<c.length;for(f=0;f<d.length;f++)g=d[f],h=
Autodesk.Viewing.Private.formatValueWithUnits(g.displayValue,g.units,g.type),this.addProperty(g.displayName,h,c?"Other":"",c?{localizeCategory:!0}:{})}};Autodesk.Viewing.UI.PropertyPanel.prototype.showNoProperties=function(){this.removeAllProperties();var a=document.getElementById(this.tree.myRootContainerId),b=document.createElement("div");b.className="noProperties";b.setAttribute("data-i18n","No properties to display");b.textContent=Autodesk.Viewing.i18n.translate("No properties to display");a.appendChild(b)};
Autodesk.Viewing.UI.PropertyPanel.prototype.showDefaultProperties=function(){this.showNoProperties();var a=this.viewer.getDimensions();this.resizeToContent({maxHeight:a.height})};Autodesk.Viewing.UI.PropertyPanel.prototype.areDefaultPropertiesShown=function(){return!this.hasProperties()};
Autodesk.Viewing.UI.PropertyPanel.prototype.addProperty=function(a,b,c,d){if(this.tree.getElementByNode({name:a,value:b,category:c}))return!1;var f=null;a={name:a,value:b,type:"property"};c?((f=this.tree.getElementByNode({name:c}))||(f=this.tree.createElement_({name:c,type:"category"},document.getElementById(this.tree.myRootContainerId),d&&d.localizeCategory?{localize:!0}:null)),a.category=c):f=document.getElementById(this.tree.myRootContainerId);this.tree.createElement_(a,f,d&&d.localizeProperty?
{localize:!0}:null);return!0};Autodesk.Viewing.UI.PropertyPanel.prototype.hasProperties=function(){for(var a in this.highlightableElements)return!0;return!1};Autodesk.Viewing.UI.PropertyPanel.prototype.removeProperty=function(a,b,c,d){a={name:a,value:b,category:c};return(b=this.tree.getElementByNode(a))?(delete this.highlightableElements[this.tree.delegate().getTreeNodeId(a)],b.parentNode.removeChild(b),!0):!1};
Autodesk.Viewing.UI.PropertyPanel.prototype.removeAllProperties=function(){this.highlightableElements={};for(var a=document.getElementById(this.tree.myRootContainerId);a.hasChildNodes();)a.removeChild(a.lastChild)};Autodesk.Viewing.UI.PropertyPanel.prototype.setCategoryCollapsed=function(a,b){var c=this.tree.delegate().getTreeNodeId(a);this.tree.setCollapsed(c,b)};Autodesk.Viewing.UI.PropertyPanel.prototype.isCategoryCollapsed=function(a){a=this.tree.delegate().getTreeNodeId(a);return this.tree.isCollapsed(a)};
Autodesk.Viewing.UI.PropertyPanel.prototype.getContentSize=function(){var a=document.getElementById(this.tree.myRootContainerId);return{height:a.clientHeight+75,width:a.clientWidth}};
Autodesk.Viewing.UI.PropertyPanel.prototype.highlight=function(a,b){for(var c in this.highlightableElements)for(var d=this.highlightableElements[c],f=0;f<d.length;++f){var g=d[f],h=g.innerHTML,k=h.replace(/(<highlight>|<\/highlight>)/igm,"");h!==k&&(g.innerHTML=k);a&&""!==a&&(h=k.replace(RegExp("(\\b"+a+"\\b)","gim"),"<highlight>$1</highlight>"),g.innerHTML=h)}};
Autodesk.Viewing.UI.PropertyPanel.prototype.displayCategory=function(a,b,c){var d=document.createElement("div");a=a.name;c&&c.localize&&(d.setAttribute("data-i18n",a),a=Autodesk.Viewing.i18n.translate(a));d.textContent=a;d.title=a;d.className="categoryName";b.appendChild(d);return[d]};
Autodesk.Viewing.UI.PropertyPanel.prototype.displayProperty=function(a,b,c){var d=document.createElement("div"),f=a.name;c&&c.localize&&(d.setAttribute("data-i18n",f),f=Autodesk.Viewing.i18n.translate(f));d.textContent=f;d.title=f;d.className="propertyName";c=document.createElement("div");c.className="separator";f=document.createElement("div");f.textContent=a.value;f.title=a.value;f.className="propertyValue";b.appendChild(d);b.appendChild(c);b.appendChild(f);return[d,f]};
Autodesk.Viewing.UI.PropertyPanel.prototype.getCategoryClass=function(a){return"category"};Autodesk.Viewing.UI.PropertyPanel.prototype.getPropertyClass=function(a){return"property"};Autodesk.Viewing.UI.PropertyPanel.prototype.onCategoryHover=function(a,b){};Autodesk.Viewing.UI.PropertyPanel.prototype.onPropertyHover=function(a,b){};Autodesk.Viewing.UI.PropertyPanel.prototype.onCategoryClick=function(a,b){this.setCategoryCollapsed(a,!this.isCategoryCollapsed(a))};
Autodesk.Viewing.UI.PropertyPanel.prototype.onPropertyClick=function(a,b){};Autodesk.Viewing.UI.PropertyPanel.prototype.onCategoryIconClick=function(a,b){this.setCategoryCollapsed(a,!this.isCategoryCollapsed(a))};Autodesk.Viewing.UI.PropertyPanel.prototype.onPropertyIconClick=function(a,b){};Autodesk.Viewing.UI.PropertyPanel.prototype.onCategoryDoubleClick=function(a,b){};Autodesk.Viewing.UI.PropertyPanel.prototype.onPropertyDoubleClick=function(a,b){};
Autodesk.Viewing.UI.PropertyPanel.prototype.onCategoryRightClick=function(a,b){};Autodesk.Viewing.UI.PropertyPanel.prototype.onPropertyRightClick=function(a,b){};AutodeskNamespace("Autodesk.Viewing.Private");Autodesk.Viewing.Private.ContextMenu=function(a){this.viewer=a;this.menus=[];this.open=!1};Autodesk.Viewing.Private.ContextMenu.prototype.constructor=Autodesk.Viewing.Private.ContextMenu;
Autodesk.Viewing.Private.ContextMenu.prototype.show=function(a,b){var c=this.viewer.container.getBoundingClientRect(),d=a.clientX-c.left,c=a.clientY-c.top;if(!this.open){var f=this;this.showMenu(b,d,c);this.open=!0;this.hideEventListener=function(a){"menuItem"!==a.target.className&&f.hide(a)};this.isTouch="press"===a.type;document.body.addEventListener(this.isTouch?"touchstart":"mousedown",this.hideEventListener,!0)}};
Autodesk.Viewing.Private.ContextMenu.prototype.showMenu=function(a,b,c){var d=document.createElement("div"),f,g=[];d.className="menu";this.viewer.container.appendChild(d);this.menus.push(d);for(var h=0;h<a.length;++h){f=a[h];var k=f.title,l=f.target;f=this.createMenuItem(d,k);"function"===typeof l?this.addCallbackToMenuItem(f,l):Array.isArray(l)?g.push({menuItem:f,target:l}):console.warn("Invalid context menu option:",k,l)}l=d.getBoundingClientRect();h=l.width;f=l.height;a=this.viewer.container.getBoundingClientRect();
var l=a.width,m=a.height;(k=isTouchDevice()&&!this.viewer.navigation.getUseLeftHandedInput())&&(b-=h);0>b&&(b=0);l<b+h&&(b=l-h,0>b&&(b=0));0>c&&(c=0);m<c+f&&(c=m-f,0>c&&(c=0));d.style.top=Math.round(c)+"px";d.style.left=Math.round(b)+"px";for(h=0;h<g.length;++h)d=g[h],f=d.menuItem,l=f.getBoundingClientRect(),b=Math.round((k?l.left:l.right)-a.left),c=Math.round(l.top-a.top),this.addSubmenuCallbackToMenuItem(f,d.target,b,c)};
Autodesk.Viewing.Private.ContextMenu.prototype.createMenuItem=function(a,b){var c=document.createElement("div");c.className="menuItem";c.setAttribute("data-i18n",b);c.textContent=Autodesk.Viewing.i18n.translate(b);a.appendChild(c);return c};Autodesk.Viewing.Private.ContextMenu.prototype.addCallbackToMenuItem=function(a,b){var c=this;a.addEventListener("click",function(a){c.hide();b();a.preventDefault();return!1},!1)};
Autodesk.Viewing.Private.ContextMenu.prototype.addSubmenuCallbackToMenuItem=function(a,b,c,d){var f=this;a.addEventListener("click",function(){f.showMenu(b,c,d)},!1)};Autodesk.Viewing.Private.ContextMenu.prototype.hide=function(){if(this.open){for(var a=0;a<this.menus.length;++a)this.menus[a]&&this.menus[a].parentNode.removeChild(this.menus[a]);this.menus=[];this.open=!1;document.body.removeEventListener(this.isTouch?"touchstart":"mousedown",this.hideEventListener);this.isTouch=!1;return!0}return!1};
AutodeskNamespace("Autodesk.Viewing.UI");Autodesk.Viewing.UI.ObjectContextMenu=function(a){this.viewer=a;this.contextMenu=new Autodesk.Viewing.Private.ContextMenu(a)};Autodesk.Viewing.UI.ObjectContextMenu.prototype.constructor=Autodesk.Viewing.UI.ObjectContextMenu;
Autodesk.Viewing.UI.ObjectContextMenu.prototype.show=function(a){var b=this.viewer.getSelectionCount(),c=this.viewer.getSelectionVisibility(),b={numSelected:b,hasSelected:0<b,hasVisible:c.hasVisible,hasHidden:c.hasHidden},c=this.buildMenu(a,b);this.viewer.runContextMenuCallbacks(c,b);c&&0<c.length&&this.contextMenu.show(a,c)};Autodesk.Viewing.UI.ObjectContextMenu.prototype.hide=function(){return this.contextMenu.hide()};Autodesk.Viewing.UI.ObjectContextMenu.prototype.buildMenu=function(a,b){return null};
AutodeskNamespace("Autodesk.Viewing.Private");
Autodesk.Viewing.Private.Preferences=function(a,b){function c(a,c){if(k)return a=b+a,"undefined"!==typeof c?localStorage[a]=c:c=localStorage[a],c}function d(a,b){if("string"!==typeof a||"function"===typeof l[a])stderr("Preferences: invalid name="+a);else{var d=c(a);ok=!1;if(void 0!==d)try{d=JSON.parse(d),ok=!0}catch(f){}l[a]=ok?d:b;h[a]={}}}b||(b="Autodesk.Viewing.Preferences.");var f={},g={},h={},k=function(){var a=b+"test",c=window.localStorage;try{return c.setItem(a,"1"),c.removeItem(a),!0}catch(d){return!1}}(),
l=this;a.addEventListener("PrefChanged",function(a){var b=g[a.name];b&&(b=b.changed)&&b(a.value)});a.addEventListener("PrefReset",function(a){for(var b in g)g.hasOwnProperty(b)&&(a=g[b].reset)&&a(l[b])});this.load=function(a){f=a;for(var b in f)f.hasOwnProperty(b)&&d(b,f[b])};this.tag=function(a,b){if(a){b?Array.isArray(b)||(b=[b]):b=Object.keys(f);for(var c=0;c<b.length;++c)h[b[c]][a]=!0}};this.untag=function(a,b){if(a){b?Array.isArray(b)||(b=[b]):b=Object.keys(f);for(var c=0;c<b.length;++c)h[b[c]][a]=
!1}};this.add=function(a,b,c){if(f.hasOwnProperty(a))stderr("Preferences: "+a+" already exists");else{f[a]=b;d(a,b);if(c)for(Array.isArray(c)||(c=[c]),b=0;b<c.length;++b)this.tag(c[b],a);return!0}return!1};this.remove=function(a,c){return f.hasOwnProperty(a)?(delete f[a],delete h[a],delete this[a],c&&k&&(a=b+a,delete localStorage[a]),!0):!1};this.reset=function(b,c){b&&void 0===c&&(c=!0);for(var d in f)if(f.hasOwnProperty(d)){if(b){var g=!!h[d][b];if(c&&!g||!c&&g)continue}this.set(d,f[d],!1)&&a.fireEvent({type:"PrefReset",
name:d,value:this[d]})}};this.get=function(a){return this[a]};this.set=function(b,d,f){return this[b]!==d?(this[b]=d,c(b,d),(void 0===f||f)&&a.fireEvent({type:"PrefChanged",name:b,value:d}),!0):!1};this.addListeners=function(a,b,c){g[a]={changed:b,reset:c}};this.removeListeners=function(a){void 0!==g[a]&&delete g[a]}};AutodeskNamespace("Autodesk.Viewing.Private");
Autodesk.Viewing.Private.formatValueWithUnits=function(a,b,c,d){function f(a){var b=0<=a?Math.floor(a):Math.ceil(a);return{intPart:b,fracPart:a-b}}function g(a,b,c){var d="";c&&0===a&&(d+="-");0===f(a).fracPart?d+=a:0<b?(a=a.toFixed(b),b=/^\-?([0-9]+)\.0+$/.exec(a),d=null!==b?d+b[1]:d+a):d+=a.toFixed(0);return d}function h(a,b,c){for(var d="",h=1,k=0>a,v=0;v<b;++v)h*=2;a=0<a?a+0.5/h:a-0.5/h;c?k=a:(b=f(a/12).intPart,d+=g(b,0,k)+"' ",k=a-12*b,0>k&&(k=-k));a=f(k).intPart;k=f((k-a)*h).intPart;if(0===
k||0!==a)d+=g(a,0);if(0!==k){for(0>a&&0>k&&(k=-k);0===k%2;)k/=2,h/=2;0!==a&&(d+="-");d+=g(k,0)+"/"+g(h,0)}return d+'"'}function k(a,b){var c="";0>a&&(c="-",a=Math.abs(a));var d=f(a),h=100*d.fracPart;return c+g(d.intPart,0)+" m "+g(h,b)+" cm"}void 0===d&&(d=3);1===c?a=Autodesk.Viewing.i18n.translate(a?"Yes":"No"):2!==c&&3!==c||!isNaN(a)?"ft"===b||"feet"===b||"foot"===b?a=h(12*a,d):"in"===b||"inch"===b?a=h(a,d):"decimal-in"===b?a=g(a,d)+'"':"decimal-ft"===b?a=g(a,d)+"'":"fractional-in"===b?a=h(12*a,
d,!0):"m-and-cm"===b?a=k(a,d):3===c&&b?(b=b.replace("^2",String.fromCharCode(178)),b=b.replace("^3",String.fromCharCode(179)),a=g(a,d)+" "+b):a=b?a+" "+b:3===c?g(a,d):a:a="NaN";return a};
Autodesk.Viewing.Private.convertUnits=function(a,b,c){if(a===b)return c;var d=1;switch(b){case "mm":d=1E3;break;case "cm":d=100;break;case "m":d=1;break;case "in":d=39.37007874;break;case "ft":d=3.280839895;break;case "decimal-in":d=39.37007874;break;case "decimal-ft":d=3.280839895;break;case "fractional-in":d=39.37007874;break;case "m-and-cm":d=1}b=1;switch(a){case "mm":b=0.0010;break;case "cm":b=0.01;break;case "m":b=1;break;case "in":b=0.0254;break;case "ft":b=0.3048;break;case "decimal-in":b=
0.0254;break;case "decimal-ft":b=0.3048;break;case "fractional-in":b=0.0254;break;case "m-and-cm":b=1}return c*d*b};AutodeskNamespace("Autodesk.Viewing.Private");
Autodesk.Viewing.Private.OptionSlider=function(a,b,c,d,f){function g(a){a.target!=h.stepperElement&&(h.stepperElement.value=h.sliderElement.value);h.fireChangeEvent()}var h=this;this.tbody=d;this.sliderRow=this.tbody.insertRow(f&&f.insertAtIndex?f.insertAtIndex:-1);d=this.sliderRow.insertCell(0);this.caption=document.createElement("div");this.caption.setAttribute("data-i18n",a);this.caption.textContent=Autodesk.Viewing.i18n.translate(a);this.sliderElement=document.createElement("input");this.sliderElement.type=
"range";this.sliderElement.id=a+"_slider";this.sliderElement.min=b;this.sliderElement.max=c;d.appendChild(this.caption);d.appendChild(this.sliderElement);d=this.sliderRow.insertCell(1);this.stepperElement=document.createElement("input");this.stepperElement.type="number";this.stepperElement.id=a+"_stepper";this.stepperElement.min=b;this.stepperElement.max=c;this.stepperElement.step=1;this.stepperElement.style.width="64px";d.appendChild(this.stepperElement);this.blockEvent=!1;this.stepperElement.addEventListener("change",
function(a){a.target!=h.sliderElement&&(h.sliderElement.value=h.stepperElement.value);h.fireChangeEvent()},!1);this.sliderElement.addEventListener("change",g,!1);this.sliderElement.addEventListener("input",g,!1)};Autodesk.Viewing.Private.OptionSlider.prototype=Object.create(THREE.EventDispatcher.prototype);
Autodesk.Viewing.Private.OptionSlider.prototype.fireChangeEvent=function(){if(!this.blockEvent){this.value=this.sliderElement.value;var a=new CustomEvent("change",{detail:{target:this,value:this.sliderElement.value}});this.dispatchEvent(a)}};Autodesk.Viewing.Private.OptionSlider.prototype.setValue=function(a){this.blockEvent=!0;this.value=a;this.sliderElement.value=a;this.stepperElement.value=a;this.blockEvent=!1};
Autodesk.Viewing.Private.OptionSlider.prototype.setDisabled=function(a){this.sliderElement.disabled=a;this.stepperElement.disabled=a;this.caption.disabled=a};
Autodesk.Viewing.Private.OptionCheckbox=function(a,b,c,d){THREE.EventDispatcher.call(this.prototype);var f=this;this.tbody=b;this.sliderRow=this.tbody.insertRow(d&&d.insertAtIndex?d.insertAtIndex:-1);b=this.sliderRow.insertCell(0);this.caption=document.createElement("div");this.caption.setAttribute("data-i18n",a);this.caption.textContent=Autodesk.Viewing.i18n.translate(a);b.appendChild(this.caption);b=this.sliderRow.insertCell(1);this.checkElement=document.createElement("input");this.checkElement.type=
"checkbox";this.checkElement.id=a+"_check";this.checkElement.checked=c;b.appendChild(this.checkElement);this.blockEvent=!1;this.checked=c;this.checkElement.addEventListener("change",function(a){f.fireChangeEvent()},!1);isTouchDevice()&&(this.sliderRowHammer=new Hammer.Manager(this.sliderRow,{recognizers:[[Hammer.Tap]],inputClass:Hammer.TouchInput}),this.sliderRowHammer.on("tap",function(a){a.preventDefault();a.target.click()}));this.checkElement.addEventListener("click",function(a){a.stopPropagation()},
!1);this.sliderRow.addEventListener("click",function(a){f.checkElement.checked=!f.checkElement.checked;f.fireChangeEvent()},!1)};Autodesk.Viewing.Private.OptionCheckbox.prototype=Object.create(THREE.EventDispatcher.prototype);Autodesk.Viewing.Private.OptionCheckbox.prototype.fireChangeEvent=function(){if(!this.blockEvent){this.checked=this.checkElement.checked;var a=new CustomEvent("change",{detail:{target:this,value:this.checkElement.checked}});this.dispatchEvent(a)}};
Autodesk.Viewing.Private.OptionCheckbox.prototype.setValue=function(a){this.blockEvent=!0;this.checked=a;this.checkElement.checked=a;this.blockEvent=!1};Autodesk.Viewing.Private.OptionCheckbox.prototype.setDisabled=function(a){this.checkElement.disabled=a;this.caption.disabled=a};Autodesk.Viewing.Private.OptionCheckbox.prototype.setVisibility=function(a){this.sliderRow.style.display=a?"table-row":"none"};
Autodesk.Viewing.Private.OptionDropDown=function(a,b,c,d,f){THREE.EventDispatcher.call(this.prototype);var g=this;this.tbody=b;this.sliderRow=this.tbody.insertRow(f&&f.insertAtIndex?f.insertAtIndex:-1);b=this.sliderRow.insertCell(0);this.caption=document.createElement("div");this.caption.setAttribute("data-i18n",a);this.caption.textContent=Autodesk.Viewing.i18n.translate(a);b.appendChild(this.caption);b=this.sliderRow.insertCell(1);this.dropdownElement=document.createElement("select");this.dropdownElement.id=
a+"_dropdown";this.dropdownElement.className="optionDropDown";for(a=0;a<c.length;a++)f=document.createElement("option"),f.value=a,f.setAttribute("data-i18n",c[a]),f.textContent=Autodesk.Viewing.i18n.translate(c[a]),this.dropdownElement.add(f);this.selectedIndex=this.dropdownElement.selectedIndex=d;b.appendChild(this.dropdownElement);b.style.paddingLeft="5px";b.style.paddingRight="5px";this.blockEvent=!1;this.dropdownElement.addEventListener("change",function(a){g.fireChangeEvent()},!1)};
Autodesk.Viewing.Private.OptionDropDown.prototype=Object.create(THREE.EventDispatcher.prototype);Autodesk.Viewing.Private.OptionDropDown.prototype.setSelectedIndex=function(a){this.blockEvent=!0;this.selectedIndex=this.dropdownElement.selectedIndex=a;this.blockEvent=!1};Autodesk.Viewing.Private.OptionDropDown.prototype.setSelectedValue=function(a){this.blockEvent=!0;this.dropdownElement.selectedValue=a;this.selectedIndex=this.dropdownElement.selectedIndex;this.blockEvent=!1};
Autodesk.Viewing.Private.OptionDropDown.prototype.fireChangeEvent=function(){if(!this.blockEvent){this.selectedIndex=this.dropdownElement.selectedIndex;var a=new CustomEvent("change",{detail:{target:this,value:this.selectedIndex}});this.dispatchEvent(a)}};Autodesk.Viewing.Private.OptionDropDown.prototype.setDisabled=function(a){this.dropdownElement.disabled=a;this.caption.disabled=a};AutodeskNamespace("Autodesk.Viewing.Private");
Autodesk.Viewing.Private.ProgressBar=function(a){this.bg=document.createElement("div");this.bg.className="progressbg";this.fg=document.createElement("div");this.fg.className="progressfg";this.bg.appendChild(this.fg);a.appendChild(this.bg);this.widthScale=this.fg.clientWidth};Autodesk.Viewing.Private.ProgressBar.prototype.setPercent=function(a){99<=a?this.bg.style.visibility="hidden":(this.bg.style.visibility="visible",this.fg.style.width=this.widthScale*a*0.01+"px")};AutodeskNamespace("Autodesk.Viewing.Private");
Autodesk.Viewing.Private.RenderOptionsPanel=function(a){var b=this,c=Autodesk.Viewing.Private;this.viewer=a;Autodesk.Viewing.UI.DockingPanel.call(this,a.container,"RenderOptionsPanel","Rendering Options");this.table=document.createElement("table");this.table.className="tftable";this.tbody=document.createElement("tbody");this.table.appendChild(this.tbody);this.scrollpanel=this.createScrollContainer({heightAdjustment:70});this.scrollpanel.style.marginTop="20px";this.container.appendChild(this.scrollpanel);
this.scrollpanel.appendChild(this.table);this.container.style.width="364px";this.container.style.top="260px";this.container.style.left="220px";this.container.style.height="460px";this.container.dockRight=!0;var d=[],f;for(f in a.impl.BackgroundPresets)d.push(f);this.bgSelect=new c.OptionDropDown("Background Color",this.tbody,d,-1);this.updateBgColorIndex();this.addEventListener(this.bgSelect,"change",function(c){c=a.BackgroundPresets[b.bgSelect.value];a.prefs.set("backgroundColorPreset",JSON.stringify(c));
a.impl.setClearColors(c[0],c[1],c[2],c[3],c[4],c[5])});this.saoToggle=new c.OptionCheckbox("AO Enabled",this.tbody,!0);this.addEventListener(this.saoToggle,"change",function(c){c=b.saoToggle.checked;a.prefs.set("ambientShadows",c);a.setQualityLevel(c,a.impl.renderer().settings.antialias)});this.saoRadius=new c.OptionSlider("AO Radius",0,100,this.tbody);this.saoRadius.setValue(10);this.saoRadius.sliderElement.step=this.saoRadius.stepperElement.step=1;this.addEventListener(this.saoRadius,"change",function(c){a.impl.renderer().setAOOptions(parseInt(b.saoRadius.value),
parseFloat(b.saoIntensity.value));a.impl.renderer().composeFinalFrame(!1)});this.saoIntensity=new c.OptionSlider("AO Intensity",0,3,this.tbody);this.saoIntensity.setValue(0.75);this.saoIntensity.sliderElement.step=this.saoIntensity.stepperElement.step=0.1;this.addEventListener(this.saoIntensity,"change",function(c){a.impl.renderer().setAOOptions(parseInt(b.saoRadius.value),parseFloat(b.saoIntensity.value));a.impl.renderer().composeFinalFrame(!1)});d=[];for(f=0;f<c.LightPresets.length;f++)d.push(c.LightPresets[f].name);
this.envSelect=new c.OptionDropDown("Environment",this.tbody,d,a.impl.currentLightPreset());this.addEventListener(this.envSelect,"change",function(c){a.setLightPreset(b.envSelect.selectedIndex)});d=a.impl.renderer().getToneMapMethod();this.toneMapMethod=new c.OptionDropDown("Tonemap Method",this.tbody,["None","Canon-RGB","Canon-Lum"],d);this.addEventListener(this.toneMapMethod,"change",function(){a.impl.setTonemapMethod(b.toneMapMethod.selectedIndex)});this.exposureBias=new c.OptionSlider("Exposure Bias",
-30,30,this.tbody);this.exposureBias.setValue(a.impl.renderer().getExposureBias());this.exposureBias.sliderElement.step=this.exposureBias.stepperElement.step=0.1;this.addEventListener(this.exposureBias,"change",function(c){a.impl.setExposureBias(b.exposureBias.value,b.whiteScale.value)});this.exposureBias.setDisabled(0==d);this.whiteScale=new c.OptionSlider("Light Intensity",-5,20,this.tbody);d=0;a.impl.dir_light1&&(d=0!=a.impl.dir_light1.intensity?Math.log(a.impl.dir_light1.intensity)/Math.log(2):
-1E-20);this.whiteScale.setValue(d);this.whiteScale.sliderElement.step=this.whiteScale.stepperElement.step=0.1;this.addEventListener(this.whiteScale,"change",function(c){a.impl.dir_light1.intensity=Math.pow(2,b.whiteScale.value);a.impl.setExposureBias(b.exposureBias.value,b.whiteScale.value)});this.fovAngle=new c.OptionSlider("FOV-degrees",6.88,100,this.tbody);this.fovAngle.setValue(a.getFOV());this.addEventListener(this.fovAngle,"change",function(c){a.setFOV(parseFloat(b.fovAngle.value))});this.addEventListener(this.viewer,
Autodesk.Viewing.CAMERA_CHANGE_EVENT,function(c){c=parseFloat(b.fovAngle.value);var d=a.getFOV();c!=d&&b.fovAngle.setValue(d)});this.addEventListener(this.viewer,Autodesk.Viewing.RENDER_OPTION_CHANGED_EVENT,function(a){b.syncUI()});this.addVisibilityListener(function(){b.resizeToContent({maxHeight:b.parentContainer.offsetHeight-75})})};Autodesk.Viewing.Private.RenderOptionsPanel.prototype=Object.create(Autodesk.Viewing.UI.DockingPanel.prototype);
Autodesk.Viewing.Private.RenderOptionsPanel.prototype.constructor=Autodesk.Viewing.Private.RenderOptionsPanel;Autodesk.Viewing.Private.RenderOptionsPanel.prototype.getContentSize=function(){return{height:this.table.clientHeight+75,width:this.table.clientWidth}};
Autodesk.Viewing.Private.RenderOptionsPanel.prototype.updateBgColorIndex=function(){var a=this.viewer.impl,b=a.clearColorTop,a=a.clearColorBottom,b=[255*b.x|0,255*b.y|0,255*b.z|0,255*a.x|0,255*a.y|0,255*a.z|0],c,d;for(d in Autodesk.Viewing.Private.BackgroundPresets){var a=Autodesk.Viewing.Private.BackgroundPresets[d],f;for(f=0;6>f&&a[f]==b[f];f++);if(6==f){c=d;break}}if(!c)for(c="Custom",d=Autodesk.Viewing.Private.BackgroundPresets[c],a=0;6>a;a++)d[a]=b[a];this.bgSelect.setSelectedValue(c)};
Autodesk.Viewing.Private.RenderOptionsPanel.prototype.syncUI=function(){var a=this.viewer.impl,b=0;a.dir_light1&&(b=0!=a.dir_light1.intensity?Math.log(a.dir_light1.intensity)/Math.log(2):-1E-20);this.whiteScale.setValue(b);this.exposureBias.setValue(a.renderer().getExposureBias());this.updateBgColorIndex();b=a.renderer().getToneMapMethod();this.toneMapMethod.setSelectedIndex(b);this.envSelect.setSelectedIndex(a.currentLightPreset());this.exposureBias.setDisabled(0==b);this.saoToggle.setValue(a.renderer().settings.sao);
this.saoRadius.setDisabled(!a.renderer().settings.sao);this.saoIntensity.setDisabled(!a.renderer().settings.sao);this.saoRadius.setValue(a.renderer().getAORadius());this.saoIntensity.setValue(a.renderer().getAOIntensity());this.fovAngle.setValue(this.viewer.getFOV())};
Autodesk.Viewing.Private.RenderOptionsPanel.prototype.uninitialize=function(){Autodesk.Viewing.UI.DockingPanel.prototype.uninitialize.call(this);this.viewer=this.fovAngle=this.whiteScale=this.exposureBias=this.toneMapMethod=this.envSelect=this.saoIntensity=this.saoRadius=this.saoToggle=this.bgSelect=this.tbody=this.table=null};AutodeskNamespace("Autodesk.Viewing.UI");
Autodesk.Viewing.UI.LayersPanel=function(a,b,c){this.viewer=a;this.layersRoot=this.tree=null;this.visibilityImages={};this.isMac=-1!==navigator.userAgent.search("Mac OS");b="Layer Manager";var d=a.config.viewableName;d&&"W2D"!==d&&(b=Autodesk.Viewing.i18n.translate(b)+": "+d);this.filterImageId=c+"-layerFilterImageId";Autodesk.Viewing.UI.DockingPanel.call(this,a.container,c,b,{localizeTitle:!1});this.container.classList.add("layersPanel");this.filterContainer=document.createElement("div");this.filterContainer.className=
"filterBox";this.filterContainer.id=this.container.id+"-search-container";this.container.appendChild(this.filterContainer);this.scrollContainer=this.createScrollContainer({heightAdjustment:105});this.scrollContainer.style.marginTop="5px";this.container.appendChild(this.scrollContainer);this.scrollContainer.id=this.container.id+"-scroll-container";var f=this;a.model?f.build():f.addEventListener(a,Autodesk.Viewing.GEOMETRY_LOADED_EVENT,function(){f.build()});this.addVisibilityListener(function(){f.resizeToContent()})};
Autodesk.Viewing.UI.LayersPanel.prototype=Object.create(Autodesk.Viewing.UI.DockingPanel.prototype);Autodesk.Viewing.UI.LayersPanel.prototype.constructor=Autodesk.Viewing.UI.LayersPanel;Autodesk.Viewing.UI.LayersPanel.prototype.uninitialize=function(){Autodesk.Viewing.UI.DockingPanel.prototype.uninitialize.call(this);this.filterContainer=this.scrollContainer=this.visibilityImages=this.layersRoot=this.tree=this.viewer=null};
Autodesk.Viewing.UI.LayersPanel.prototype.build=function(){function a(){if(f.value){var a=f.value.toLowerCase(),b=function(c){var d=[];if(-1!==c.name.toLowerCase().indexOf(a))d.push(c);else if(!c.isLayer){c=c.children;for(var f=0;f<c.length;++f)d=d.concat(b(c[f]))}return d};k&&0<k.childCount&&h.setLayerVisible(b(k),!0,!0)}else h.setLayerVisible(null,!0);g=null}var b=this,c=document.createElement("div");c.className="filterSearch";b.filterContainer.appendChild(c);var d=document.createElement("div");
d.className="filterImage";d.id=b.filterImageId;d.title=Autodesk.Viewing.i18n.translate("Show/hide all layers");c.appendChild(d);b.visibilityImages[b.filterImageId]=d;b.addEventListener(d,"click",function(a){b.onImageClick(null,a);a.stopPropagation()});var f=this.filterField=document.createElement("input");f.className="filterInput";f.placeholder=Autodesk.Viewing.i18n.translate("Enter filter term");f.setAttribute("data-i18n","[placeholder]Enter filter term");f.type="search";f.incremental="incremental";
c.appendChild(f);var g=null,h=b.viewer;f.addEventListener("keyup",function(b){g&&clearTimeout(g);g=setTimeout(a,500)});f.addEventListener("click",function(a){""===f.value?h.setLayerVisible(null,!0):setTimeout(function(){""===f.value&&(h.setLayerVisible(null,!0),a.preventDefault())},1)});var c=function(){var a=new Autodesk.Viewing.UI.TreeDelegate;a.getTreeNodeId=function(a){return a.id};a.getTreeNodeLabel=function(a){return b.getNodeLabel(a)};a.getTreeNodeClass=function(a){return b.getNodeClass(a)};
a.isTreeNodeGroup=function(a){return b.isGroupNode(a)};a.shouldCreateTreeNode=function(a){return b.shouldInclude(a)};a.onTreeNodeClick=function(a,c,d){b.onClick(c,d)};a.onTreeNodeRightClick=function(a,c,d){b.onRightClick(c,d)};a.onTreeNodeDoubleClick=function(a,c,d){b.onDoubleClick(c,d)};a.onTreeNodeIconClick=function(a,c,d){b.onIconClick(c,d)};a.createTreeNode=function(a,c){b.createNode(a,c)};return a}(),k=b.layersRoot=b.viewer.model.getLayersRoot();k&&(b.tree=new Autodesk.Viewing.UI.Tree(c,k,b.scrollContainer,
{}),b.tree.addClass(c.getTreeNodeId(k),"exclude"),b.resizeToContent(),b.update(),b.addEventListener(b.viewer,Autodesk.Viewing.LAYER_VISIBILITY_CHANGED_EVENT,function(){b.update()}))};
Autodesk.Viewing.UI.LayersPanel.prototype.update=function(){function a(a,b){var c;c=1===b?"layerVisible":0===b?"layerHidden":"layerMixed";a.classList.remove("layerVisible","layerHidden","layerMixed");a.classList.add(c)}function b(a,b){0===b?f.tree.addClass(a.id,"dim"):f.tree.removeClass(a.id,"dim")}function c(a){var b;if(0<a.length)for(var c=0;c<a.length;++c){var d=a[c];void 0===b?b=d:0===d&&1===b?b=-1:1===d&&0===b&&(b=-1);if(-1===b)break}else b=0;return b}function d(g){var k=f.visibilityImages[g.id];
if(!g.isLayer){for(var l=g.children,m=[],p=0;p<l.length;++p)m=m.concat(d(l[p]));l=c(m);a(k,l);b(g,l);return m}m=f.viewer.isLayerVisible(g)?1:0;a(k,m);b(g,m);return[m]}var f=this,g=this.layersRoot&&0<this.layersRoot.childCount?d(f.layersRoot):[];a(f.visibilityImages[f.filterImageId],c(g))};Autodesk.Viewing.UI.LayersPanel.prototype.setLayerVisible=function(a,b){this.viewer.setLayerVisible(a,"layerVisible"!==this.visibilityImages[a?a.id:this.filterImageId].className,b);this.filterField.value=""};
Autodesk.Viewing.UI.LayersPanel.prototype.getNodeLabel=function(a){return a.isLayer||0===a.childCount?a.name:a.name+" ("+a.childCount+")"};Autodesk.Viewing.UI.LayersPanel.prototype.getNodeClass=function(a){return""};Autodesk.Viewing.UI.LayersPanel.prototype.isGroupNode=function(a){return!a.isLayer};Autodesk.Viewing.UI.LayersPanel.prototype.shouldInclude=function(a){return!0};Autodesk.Viewing.UI.LayersPanel.prototype.onIconClick=function(a,b){this.setGroupCollapsed(a,!this.isGroupCollapsed(a))};
Autodesk.Viewing.UI.LayersPanel.prototype.setGroupCollapsed=function(a,b){var c=this.tree.delegate();c.isTreeNodeGroup(a)&&(c=c.getTreeNodeId(a),this.tree.setCollapsed(c,b),this.resizeToContent())};Autodesk.Viewing.UI.LayersPanel.prototype.isGroupCollapsed=function(a){var b=this.tree.delegate();return b.isTreeNodeGroup(a)?(a=b.getTreeNodeId(a),this.tree.isCollapsed(a)):!1};Autodesk.Viewing.UI.LayersPanel.prototype.onClick=function(a,b){};
Autodesk.Viewing.UI.LayersPanel.prototype.onDoubleClick=function(a,b){};Autodesk.Viewing.UI.LayersPanel.prototype.onRightClick=function(a,b){};Autodesk.Viewing.UI.LayersPanel.prototype.onImageClick=function(a,b){};Autodesk.Viewing.UI.LayersPanel.prototype.getContentSize=function(){var a=this.filterContainer,b=a.clientHeight+80,a=a.clientWidth,c=this.tree;return c&&(c=document.getElementById(c.getRootContainerId()))?{height:c.clientHeight+b,width:Math.max(c.clientWidth,a)}:{height:b,width:a}};
Autodesk.Viewing.UI.LayersPanel.prototype.createNode=function(a,b){var c=document.createElement("div");b.children&&0<b.children.length?b.insertBefore(c,b.children[0]):b.appendChild(c);c.title=Autodesk.Viewing.i18n.translate("Show/hide this layer");this.visibilityImages[a.id]=c;var d=document.createElement("label");d.textContent=this.getNodeLabel(a);b.appendChild(d);var f=this;this.addEventListener(c,"click",function(b){f.onImageClick(a,b);b.stopPropagation()})};AutodeskNamespace("Autodesk.Viewing.UI");
Autodesk.Viewing.UI.SettingsPanel=function(a,b,c,d){Autodesk.Viewing.UI.DockingPanel.call(this,a,b,c,d);this.panelTabs=[];this.tabIdToIndex={};this.controls={};this.controlIdCount=0;var f=this;this.container.style.maxWidth="800px";this.container.style.top="100px";this.container.style.left="220px";this.container.style.position="absolute";this.container.dockRight=!0;this.tabContainer=document.createElement("div");this.tabContainer.className="settings-tabs";this.container.appendChild(this.tabContainer);
this.tabs=document.createElement("ul");this.tabContainer.appendChild(this.tabs);this.heightAdjustment=d&&d.heightAdjustment?d.heightAdjustment:110;this.scrollContainer=this.createScrollContainer({left:!1,heightAdjustment:this.heightAdjustment});this.scrollContainer.id=this.container.id+"-scroll-container";this.scrollContainer.style.marginTop="0px";this.container.appendChild(this.scrollContainer);this.mouseOver=!1;this.addEventListener(this.container,"mouseover",function(a){a=a.toElement||a.relatedTarget;
if(f.mouseOver)return!0;for(var b=0;a&&a.parentNode&&a.parentNode!=window;){if(a.parentNode==this||a==this){a.preventDefault&&a.preventDefault();f.mouseOver=!0;for(b=0;b<f.panelTabs.length;b++)f.panelTabs[b].classList.remove("selectedmouseout");return!0}a=a.parentNode}});this.addEventListener(this.container,"mouseout",function(a){a=a.toElement||a.relatedTarget;if(f.mouseOver){for(;a&&a.parentNode&&a.parentNode!=window;){if(a.parentNode==this||a==this)return a.preventDefault&&a.preventDefault(),!1;
a=a.parentNode}f.mouseOver=!1;for(a=0;a<f.panelTabs.length;a++)f.panelTabs[a].classList.contains("tabselected")&&f.panelTabs[a].classList.add("selectedmouseout")}})};Autodesk.Viewing.UI.SettingsPanel.prototype=Object.create(Autodesk.Viewing.UI.DockingPanel.prototype);Autodesk.Viewing.UI.SettingsPanel.prototype.constructor=Autodesk.Viewing.UI.SettingsPanel;
Autodesk.Viewing.UI.SettingsPanel.prototype.setVisible=function(a){a&&(this.container.style.display="block");Autodesk.Viewing.UI.DockingPanel.prototype.setVisible.call(this,a)};
Autodesk.Viewing.UI.SettingsPanel.prototype.addTab=function(a,b,c){var d=this;if(void 0!==this.tabIdToIndex[a])return!1;var f=c&&void 0!==c.className?c.className:null,g=c&&void 0!==c.width?c.width:200;c=c&&void 0!==c.index?c.index:this.panelTabs.length;var h=document.createElement("li");h.id=a;var k=document.createElement("a"),l=document.createElement("span");l.setAttribute("data-i18n",b);l.textContent=Autodesk.Viewing.i18n.translate(b);k.appendChild(l);h.appendChild(k);this.tabs.appendChild(h);b=
document.createElement("table");b.id=a+"-table";b.className="settings-table tftable "+f;f=document.createElement("tbody");b.appendChild(f);this.scrollContainer.appendChild(b);this.addEventListener(h,"touchstart",touchStartToClick);this.addEventListener(h,"click",function(b){d.selectTab(a)});this.panelTabs.push(h);this.tabIdToIndex[a]=c;f=this.container.style.minWidth?parseInt(this.container.style.minWidth):0;this.container.style.minWidth=f+g+"px";return!0};
Autodesk.Viewing.UI.SettingsPanel.prototype.removeTab=function(a){a=this.tabIdToIndex[a];if(!a)return!1;this.panelTabs.splice(a,1);this.tabs.removeChild(tabDom);this.tabIdToIndex={};a=this.panelTabs.length;for(var b=0;b<a;b++)this.tabIdToIndex[this.panelTabs[b].id]=b;return!0};Autodesk.Viewing.UI.SettingsPanel.prototype.hasTab=function(a){return void 0!==this.panelTabs[this.tabIdToIndex[a]]};
Autodesk.Viewing.UI.SettingsPanel.prototype.selectTab=function(a){if(this.isTabSelected(a))return!1;for(var b=this.panelTabs.length,c=0;c<b;c++){var d=this.panelTabs[c],f=document.getElementById(d.id+"-table");a===d.id?(d.classList.add("tabselected"),f.style.display="table",this.mouseOver||d.classList.add("selectedmouseout")):(d.classList.remove("tabselected"),f.style.display="none",this.mouseOver||this.panelTabs[c].classList.remove("selectedmouseout"))}this.resizeToContent({maxHeight:this.parentContainer.offsetHeight-
75});return!0};Autodesk.Viewing.UI.SettingsPanel.prototype.isTabSelected=function(a){return(a=this.panelTabs[this.tabIdToIndex[a]])&&a.classList.contains("tabselected")};
Autodesk.Viewing.UI.SettingsPanel.prototype.addCheckbox=function(a,b,c,d,f){if(void 0===this.tabIdToIndex[a])return null;var g=document.getElementById(a+"-table");b=new Autodesk.Viewing.Private.OptionCheckbox(b,g.tBodies[0],c,f);b.changeListener=function(a){d(a.detail.target.checked)};this.addEventListener(b,"change",b.changeListener);return this.addControl(a,b)};
Autodesk.Viewing.UI.SettingsPanel.prototype.addSlider=function(a,b,c,d,f,g,h){if(void 0===this.tabIdToIndex[a])return null;var k=document.getElementById(a+"-table");b=new Autodesk.Viewing.Private.OptionSlider(b,c,d,k.tBodies[0],h);b.setValue(f);b.sliderElement.step=b.stepperElement.step=1;this.addEventListener(b,"change",function(a){g(a)});return this.addControl(a,b)};
Autodesk.Viewing.UI.SettingsPanel.prototype.addDropDownMenu=function(a,b,c,d,f,g){if(void 0===this.tabIdToIndex[a])return null;var h=document.getElementById(a+"-table");b=new Autodesk.Viewing.Private.OptionDropDown(b,h.tBodies[0],c,d,g);this.addEventListener(b,"change",function(a){f(a)});return this.addControl(a,b)};
Autodesk.Viewing.UI.SettingsPanel.prototype.addControl=function(a,b,c){if(void 0===this.tabIdToIndex[a])return null;if(!b.hasOwnProperty("sliderRow")){var d=c&&c.insertAtIndex?c.insertAtIndex:-1;c=c&&c.caption?c.caption:null;a=document.getElementById(a+"-table");d>a.length&&(d=-1);var d=a.tBodies[0].insertRow(d),f=d.insertCell(0);if(c){var g=document.createElement("div");g.setAttribute("data-i18n",c);g.textContent=Autodesk.Viewing.i18n.translate(c);f.appendChild(g);f=d.insertCell(1)}else f.colSpan=
2;f.appendChild(b);b.sliderRow=d;b.tbody=a.tBodies[0]}c="adsk_settings_control_id_"+this.controlIdCount.toString();this.controlIdCount+=1;this.controls[c]=b;this.resizeToContent({maxHeight:this.parentContainer.offsetHeight-75});return c};Autodesk.Viewing.UI.SettingsPanel.prototype.removeCheckbox=function(a){return this.removeControl(a)};Autodesk.Viewing.UI.SettingsPanel.prototype.removeSlider=function(a){return this.removeControl(a)};Autodesk.Viewing.UI.SettingsPanel.prototype.removeCheckbox=function(a){return this.removeControl(a)};
Autodesk.Viewing.UI.SettingsPanel.prototype.removeControl=function(a){var b=this.controls[a];if(void 0===b)return!1;b.tbody.deleteRow(b.sliderRow.rowIndex);delete this.controls[a];this.resizeToContent({maxHeight:this.parentContainer.offsetHeight-75});return!0};Autodesk.Viewing.UI.SettingsPanel.prototype.getControl=function(a){return void 0!==this.controls[a]?this.controls[a]:null};
Autodesk.Viewing.UI.SettingsPanel.prototype.getContentSize=function(){for(var a=this.heightAdjustment,b=this.panelTabs.length>this.panelTabs[0]?0:null,c=0;c<this.panelTabs.length;c++){var d=this.panelTabs[c];if(this.isTabSelected(d.id)){b=d;break}}b&&(b=document.getElementById(d.id+"-table"),a+=b.clientHeight);return{height:a,width:this.container.clientWidth}};AutodeskNamespace("Autodesk.Viewing.Private");Autodesk.Viewing.Private.AlertBox=function(){};Autodesk.Viewing.Private.AlertBox.instances=[];
Autodesk.Viewing.Private.AlertBox.displayError=function(a,b,c,d,f){var g=document.createElement("div");g.className="alertBox error";a.appendChild(g);d||(d="img-item-not-found");var h=document.createElement("div");h.className="alertBoxImage "+d;g.appendChild(h);d=document.createElement("div");d.className="alertBoxMsg";g.appendChild(d);c||(c=Autodesk.Viewing.i18n.translate("Error Occurred",{defaultValue:"Error Occurred"}));h=document.createElement("div");h.className="alertBoxTitle";h.textContent=c;
d.appendChild(h);c=document.createElement("div");c.className="alertBoxText";c.textContent=b;d.appendChild(c);if(f){b=document.createElement("div");b.className="alertBoxContent";d.appendChild(b);d=document.createElement("ul");d.className="alertBoxContent";for(c=0;c<f.length;c++){var k=f[c];if(k){h=document.createElement("li");d.appendChild(h);k=this.extractList(k);if(k.list.length){var l=this.generateListElement(list);d.appendChild(l)}h.innerHTML=k.msg}}b.appendChild(d)}f=document.createElement("div");
f.className="alertBoxOK";f.textContent=Autodesk.Viewing.i18n.translate("OK",{defaultValue:"OK"});var m={alertBox:g,container:a};f.addEventListener("click",function(b){g.style.visibility="hidden";a.removeChild(g);Autodesk.Viewing.Private.AlertBox.instances.splice(Autodesk.Viewing.Private.AlertBox.instances.indexOf(m),1)});g.appendChild(f);g.style.visibility="visible";Autodesk.Viewing.Private.AlertBox.instances.push(m)};
Autodesk.Viewing.Private.AlertBox.displayErrors=function(a,b,c){var d=document.createElement("div");d.className="alertBox errors";a.appendChild(d);b||(b="img-item-not-found");var f=document.createElement("div");f.className="alertBoxImage "+b;d.appendChild(f);b=document.createElement("div");b.className="alertBoxMsg errors";d.appendChild(b);for(f=0;f<c.length;f++){var g=c[f].header;g||(g=Autodesk.Viewing.i18n.translate("Error",{defaultValue:"Error"}));var h=document.createElement("div");h.className=
"alertBoxTitle errors";h.textContent=g;b.appendChild(h);var k=document.createElement("div");k.className="alertBoxText errors";h=c[f].msg;g=this.extractList(h);if(g.list.length){var l=document.createElement("div"),h=this.generateListElement(g.list);l.appendChild(h);k.textContent=g.msg;k.appendChild(l)}else k.textContent=h;b.appendChild(k);if(c[f].hints){k=document.createElement("ul");k.className="alertBoxContent";for(var l=c[f].hints,m=0;m<l.length;m++)if(g=l[m]){var p=document.createElement("li");
k.appendChild(p);g=this.extractList(g);g.list.length&&(h=this.generateListElement(g.list),k.appendChild(h));p.innerHTML=g.msg}b.appendChild(k)}}c=document.createElement("div");c.className="alertBoxOK";c.textContent=Autodesk.Viewing.i18n.translate("OK",{defaultValue:"OK"});var n={alertBox:d,container:a};c.addEventListener("click",function(b){d.style.visibility="hidden";a.removeChild(d);Autodesk.Viewing.Private.AlertBox.instances.splice(Autodesk.Viewing.Private.AlertBox.instances.indexOf(n),1)});d.appendChild(c);
d.style.visibility="visible";Autodesk.Viewing.Private.AlertBox.instances.push(n)};Autodesk.Viewing.Private.AlertBox.extractList=function(a){var b={msg:a,list:[]};a&&-1!=a.indexOf("<ul>")&&(a=a.split("<ul>"),b.msg=a[0],a=a[1].split("</ul>"),b.list=a[0].split(", "),1===b.list.length&&(b.list=a[0].split(",")));return b};Autodesk.Viewing.Private.AlertBox.generateListElement=function(a){for(var b=document.createElement("ul"),c=0;c<a.length;c++){var d=document.createElement("li");d.textContent=a[c];b.appendChild(d)}return b};
Autodesk.Viewing.Private.AlertBox.dismiss=function(){if(0<Autodesk.Viewing.Private.AlertBox.instances.length){var a=Autodesk.Viewing.Private.AlertBox.instances.pop();a.alertBox.style.visibility="hidden";a.container.removeChild(a.alertBox);return!0}return!1};AutodeskNamespace("Autodesk.Viewing.Private");Autodesk.Viewing.Private.HudMessage=function(){};Autodesk.Viewing.Private.HudMessage.instances=[];
Autodesk.Viewing.Private.HudMessage.displayMessage=function(a,b,c,d,f){if(!(0<Autodesk.Viewing.Private.HudMessage.instances.length)){var g=b.msgTitleKey,h=b.msgTitleDefaultValue?b.msgTitleDefaultValue:g,k=b.messageKey,l=b.messageDefaultValue?b.messageDefaultValue:k;b=b.buttonText;var m=document.createElement("div");m.className="hud";a.appendChild(m);var p=document.createElement("div");p.className="hudTitle";p.textContent=Autodesk.Viewing.i18n.translate(g,{defaultValue:h});p.setAttribute("data-i18n",
g);m.appendChild(p);c&&(g=document.createElement("div"),g.className="hudClose",g.innerHTML="&times;",g.addEventListener("click",function(b){a.removeChild(m);c&&c(b)}),m.appendChild(g));g=document.createElement("div");g.className="hudMessage";g.textContent=Autodesk.Viewing.i18n.translate(k,{defaultValue:l});g.setAttribute("data-i18n",k);m.appendChild(g);d&&(k=document.createElement("div"),k.className="hudButton",k.textContent=Autodesk.Viewing.i18n.translate(b,{defaultValue:b}),k.setAttribute("data-i18n",
b),k.addEventListener("click",d),m.appendChild(k));f&&(d=document.createElement("div"),k=document.createElement("input"),k.className="hudCheckbox",k.type="checkbox",d.appendChild(k),l=document.createElement("label"),l.setAttribute("for","Do not show this message again"),l.setAttribute("data-i18n","Do not show this message again"),l.textContent=Autodesk.Viewing.i18n.translate("Do not show this message again",{defaultValue:"Do not show this message again"}),d.appendChild(l),k.addEventListener("change",
f),m.appendChild(d));Autodesk.Viewing.Private.HudMessage.instances.push({hudMessage:m,container:a})}};Autodesk.Viewing.Private.HudMessage.dismiss=function(){if(0<Autodesk.Viewing.Private.HudMessage.instances.length){var a=Autodesk.Viewing.Private.HudMessage.instances.pop();a.hudMessage.style.visibility="hidden";a.container.removeChild(a.hudMessage);return!0}return!1};"use strict";AutodeskNamespace("Autodesk.Viewing.UI");Autodesk.Viewing.UI.TreeDelegate=function(){};
Autodesk.Viewing.UI.TreeDelegate.prototype.constructor=Autodesk.Viewing.UI.TreeDelegate;Autodesk.Viewing.UI.TreeDelegate.prototype.isTreeNodeGroup=function(a){throw"isTreeNodeGroup is not implemented.";};Autodesk.Viewing.UI.TreeDelegate.prototype.getTreeNodeId=function(a){throw"getTreeNodeId is not implemented.";};Autodesk.Viewing.UI.TreeDelegate.prototype.getTreeNodeLabel=function(a){return a.name};Autodesk.Viewing.UI.TreeDelegate.prototype.shouldCreateTreeNode=function(a){return!0};
Autodesk.Viewing.UI.TreeDelegate.prototype.createTreeNode=function(a,b,c){var d=document.createElement("label");b.appendChild(d);a=this.getTreeNodeLabel(a);c&&c.localize&&(d.setAttribute("data-i18n",a),a=Autodesk.Viewing.i18n.translate(a));d.textContent=a};Autodesk.Viewing.UI.TreeDelegate.prototype.onTreeNodeClick=function(a,b,c){};Autodesk.Viewing.UI.TreeDelegate.prototype.onTreeNodeIconClick=function(a,b,c){a.delegate().isTreeNodeGroup(b)&&(b=a.delegate().getTreeNodeId(b),a.setCollapsed(b,!a.isCollapsed(b)))};
Autodesk.Viewing.UI.TreeDelegate.prototype.onTreeNodeDoubleClick=function(a,b,c){};Autodesk.Viewing.UI.TreeDelegate.prototype.onTreeNodeRightClick=function(a,b,c){};Autodesk.Viewing.UI.TreeDelegate.prototype.onTreeNodeEnter=function(a,b,c){};Autodesk.Viewing.UI.TreeDelegate.prototype.onTreeNodeLeave=function(a,b,c){};Autodesk.Viewing.UI.TreeDelegate.prototype.onTreeNodeHover=function(a,b,c){};Autodesk.Viewing.UI.TreeDelegate.prototype.getTreeNodeClass=function(a){return""};
Autodesk.Viewing.UI.Tree=function(a,b,c,d){this.myDelegate=a;this.mySelectedIds=[];this.myOptions=d;"string"===typeof c?(a=c,c=document.getElementById(a)):a=c.id;this.myRootContainerId=a+"-treeview";this.myInternalIds={};this.myInternalIdCounter=0;this.myGroupNodes=[];c=this.createHtmlElement_(c,"div",this.myRootContainerId,"treeview");this.createElement_(b,c)};Autodesk.Viewing.UI.Tree.prototype.constructor=Autodesk.Viewing.UI.Tree;
Autodesk.Viewing.UI.Tree.prototype.show=function(a){document.getElementById(this.myRootContainerId).style.display=a?"block":"none"};Autodesk.Viewing.UI.Tree.prototype.getRootContainerId=function(){return this.myRootContainerId};Autodesk.Viewing.UI.Tree.prototype.delegate=function(){return this.myDelegate};Autodesk.Viewing.UI.Tree.prototype.isCollapsed=function(a){return this.hasClass(a,"collapsed")};
Autodesk.Viewing.UI.Tree.prototype.setCollapsed=function(a,b){var c=this.isCollapsed(a);if(b){if(!c)return this.addClass(a,"collapsed"),this.removeClass(a,"expanded"),!0}else if(c)return this.addClass(a,"expanded"),this.removeClass(a,"collapsed"),!0;return!1};
Autodesk.Viewing.UI.Tree.prototype.setAllCollapsed=function(a){var b;a?(a=function(a){return a.classList.contains("expanded")},b=function(a){a.classList.add("collapsed");a.classList.remove("expanded")}):(a=function(a){return a.classList.contains("collapsed")},b=function(a){a.classList.add("expanded");a.classList.remove("collapsed")});for(var c=0;c<this.myGroupNodes.length;++c){var d=this.myGroupNodes[c];a(d)&&b(d)}};
Autodesk.Viewing.UI.Tree.prototype.addToSelection=function(a){for(var b=a.length,c=0;c<b;++c){var d=a[c],f;f=d;-1===this.mySelectedIds.indexOf(f)?(this.mySelectedIds.push(f),f=!0):f=!1;f&&this.addClass(d,"selected")}};Autodesk.Viewing.UI.Tree.prototype.removeFromSelection=function(a){for(var b=a.length-1;0<=b;--b){var c=a[b],d;d=this.mySelectedIds.indexOf(c);-1!==d?(this.mySelectedIds.splice(d,1),d=!0):d=!1;d&&this.removeClass(c,"selected")}};
Autodesk.Viewing.UI.Tree.prototype.setSelection=function(a){this.removeFromSelection(this.mySelectedIds);this.addToSelection(a);return this.mySelectedIds};Autodesk.Viewing.UI.Tree.prototype.clearSelection=function(){this.removeFromSelection(this.mySelectedIds)};Autodesk.Viewing.UI.Tree.prototype.isSelected=function(a){return this.hasClass(a,"selected")};
Autodesk.Viewing.UI.Tree.prototype.addClass=function(a,b){var c=this.getInternalId_(a,!1);return c&&(c=document.getElementById(c))&&!c.classList.contains(b)?(c.classList.add(b),!0):!1};Autodesk.Viewing.UI.Tree.prototype.removeClass=function(a,b){var c=this.getInternalId_(a,!1);return c&&(c=document.getElementById(c))&&c.classList.contains(b)?(c.classList.remove(b),!0):!1};
Autodesk.Viewing.UI.Tree.prototype.hasClass=function(a,b){var c=this.getInternalId_(a,!1);return c?document.getElementById(c).classList.contains(b):!1};Autodesk.Viewing.UI.Tree.prototype.getInternalId_=function(a,b){void 0===this.myInternalIds[a]&&b&&(this.myInternalIds[a]=this.myRootContainerId+"-node-"+this.myInternalIdCounter,this.myInternalIdCounter++);return this.myInternalIds[a]};
Autodesk.Viewing.UI.Tree.prototype.createElement_=function(a,b,c){function d(b,d,f,g){b=h.createHtmlElement_(b,f,d,g);d=h.createHtmlElement_(b,"header","header"+d);h.createHtmlElement_(d,"icon").addEventListener("click",function(b){h.myDelegate.onTreeNodeIconClick(h,a,b);b.stopPropagation();b.preventDefault()},!1);h.myDelegate.createTreeNode(a,d,c);return b}function f(b){h.myDelegate.onTreeNodeEnter(h,a,b);h.myDelegate.onTreeNodeHover(h,a,b);b.stopPropagation();b.preventDefault()}function g(b){h.myDelegate.onTreeNodeLeave(h,
a,b);h.myDelegate.onTreeNodeHover(h,a,b);b.stopPropagation();b.preventDefault()}if(!a||!this.myDelegate.shouldCreateTreeNode(a))return null;var h=this,k=h.myDelegate.getTreeNodeId(a),k=this.getInternalId_(k,!0);if(h.myDelegate.isTreeNodeGroup(a)){b=d(b,k,"group","expanded");h.myGroupNodes.push(b);for(var k=a.children?a.children.length:0,l=0;l<k;++l)h.createElement_(a.children[l],b,c)}else b=d(b,k,"leaf","expanded");isTouchDevice()&&(b.hammer=new Hammer.Manager(b,{recognizers:[[Hammer.Tap,{event:"doubletap",
taps:2,interval:400,threshold:6,posThreshold:30}],[Hammer.Tap]],inputClass:Hammer.TouchInput}),b.hammer.on("doubletap",function(b){h.myDelegate.onTreeNodeDoubleClick(h,a,b);b.srcEvent.stopPropagation();b.preventDefault()}),b.hammer.on("tap",function(b){h.myDelegate.onTreeNodeClick(h,a,b);b.srcEvent.stopPropagation();b.preventDefault()}));b.addEventListener("click",function(b){h.myDelegate.onTreeNodeClick(h,a,b);b.stopPropagation();b.preventDefault()},!1);b.addEventListener("dblclick",function(b){h.myDelegate.onTreeNodeDoubleClick(h,
a,b);b.stopPropagation();b.preventDefault()},!1);b.addEventListener("contextmenu",function(b){h.myDelegate.onTreeNodeRightClick(h,a,b);b.stopPropagation();b.preventDefault()},!1);b.addEventListener("mouseenter",function(a){f(a)},!1);b.addEventListener("mouseleave",function(a){g(a)},!1);b.addEventListener("mouseover",function(a){f(a)},!1);b.addEventListener("mouseout",function(a){g(a)},!1);(k=h.myDelegate.getTreeNodeClass(a))&&b.classList.add(k);return b};
Autodesk.Viewing.UI.Tree.prototype.createHtmlElement_=function(a,b,c,d){b=document.createElement(b);a.appendChild(b);c&&(b.id=c);d&&(b.className=d);return b};Autodesk.Viewing.UI.Tree.prototype.getElementByNode=function(a){return document.getElementById(this.getInternalId_(this.delegate().getTreeNodeId(a),!1))};
Autodesk.Viewing.UI.Tree.prototype.iterate=function(a,b){if(a&&this.myDelegate.shouldCreateTreeNode(a)){var c=this.getElementByNode(a);if(c&&(b(a,c),this.myDelegate.isTreeNodeGroup(a)))for(var c=a.children,d=0;d<c.length;++d)this.iterate(a.children[d],b)}};AutodeskNamespace("Autodesk.Viewing.Private");Autodesk.Viewing.Private.TreeDelegate=Autodesk.Viewing.UI.TreeDelegate;Autodesk.Viewing.Private.TreeDelegate.prototype=Autodesk.Viewing.UI.TreeDelegate.prototype;Autodesk.Viewing.Private.Tree=Autodesk.Viewing.UI.Tree;
Autodesk.Viewing.Private.Tree.prototype=Autodesk.Viewing.UI.Tree.prototype;"use strict";AutodeskNamespace("Autodesk.Viewing.Private");Autodesk.Viewing.Private.BrowserDelegate=function(){};Autodesk.Viewing.Private.BrowserDelegate.prototype.constructor=Autodesk.Viewing.Private.BrowserDelegate;Autodesk.Viewing.Private.BrowserDelegate.prototype.getNodeId=function(a){throw"getId is not implemented.";};Autodesk.Viewing.Private.BrowserDelegate.prototype.getNodeLabel=function(a){return a.name};
Autodesk.Viewing.Private.BrowserDelegate.prototype.getNodeClass=function(a){return""};Autodesk.Viewing.Private.BrowserDelegate.prototype.hasThumbnail=function(a){return!1};Autodesk.Viewing.Private.BrowserDelegate.prototype.getThumbnail=function(a){return null};Autodesk.Viewing.Private.BrowserDelegate.prototype.onNodeClick=function(a,b,c){};Autodesk.Viewing.Private.BrowserDelegate.prototype.onNodeHover=function(a,b,c){};Autodesk.Viewing.Private.BrowserDelegate.prototype.selectItem=function(a){};
Autodesk.Viewing.Private.BrowserDelegate.prototype.deselectItem=function(a){};Autodesk.Viewing.Private.BrowserDelegate.prototype.hasContent=function(a){return!1};Autodesk.Viewing.Private.BrowserDelegate.prototype.addContent=function(a,b){};
Autodesk.Viewing.Private.Browser=function(a,b,c,d){this.myDelegate=a;this.mySelectedIds=[];this.myParentContainderId=c;this.myRootContainerId=c+"-browserview";this.myInternalIds=[];this.myInternalIdCounter=0;this.jQuery=(this.myOptions=d)&&d.jQuery?d.jQuery:$;this.jQuery('<div id="'+this.myRootContainerId+'" class="browserview"></div>').appendTo("#"+this.myParentContainderId);this.createElements(b,this.myRootContainerId)};Autodesk.Viewing.Private.Browser.prototype.constructor=Autodesk.Viewing.Private.Browser;
Autodesk.Viewing.Private.Browser.prototype.show=function(a){a?this.jQuery("#"+this.myRootContainerId).fadeIn():this.jQuery("#"+this.myRootContainerId).hide()};Autodesk.Viewing.Private.Browser.prototype.getRootContainerId=function(){return this.myRootContainerId};Autodesk.Viewing.Private.Browser.prototype.delegate=function(){return this.myDelegate};
Autodesk.Viewing.Private.Browser.prototype.addToSelection=function(a){for(var b in a){var c=a[b],d;d=c;-1==this.mySelectedIds.indexOf(d)?(this.mySelectedIds.push(d),d=!0):d=!1;d&&(d=this.getInternalId(c,!1),void 0===d?this.myDelegate.selectItem(c):this.jQuery("#"+d).addClass("selected"))}};
Autodesk.Viewing.Private.Browser.prototype.removeFromSelection=function(a){for(var b in a){var c=a[b],d;d=this.mySelectedIds.indexOf(c);-1!=d?(this.mySelectedIds.splice(d,1),d=!0):d=!1;d&&(d=this.getInternalId(c,!1),void 0===d?this.myDelegate.deselectItem(c):this.jQuery("#"+d).removeClass("selected"))}};Autodesk.Viewing.Private.Browser.prototype.setSelection=function(a){this.removeFromSelection(this.mySelectedIds);this.addToSelection(a);return this.mySelectedIds};
Autodesk.Viewing.Private.Browser.prototype.clearSelection=function(){this.removeFromSelection(this.mySelectedIds)};Autodesk.Viewing.Private.Browser.prototype.getInternalId=function(a,b){void 0===this.myInternalIds[a]&&b&&(this.myInternalIds[a]=this.myRootContainerId+"-node-"+this.myInternalIdCounter,this.myInternalIdCounter++);return this.myInternalIds[a]};Autodesk.Viewing.Private.Browser.prototype.createElements=function(a,b){if(a)for(var c=0;c<a.length;c++)this.createElement(a[c],b)};
Autodesk.Viewing.Private.Browser.prototype.createElement=function(a,b){var c=this,d=c.myDelegate.getNodeId(a),d=c.getInternalId(d,!0),f="#"+d;this.jQuery('<item id="'+d+'"></item>').appendTo(this.jQuery("#"+b)).hover(function(){c.myDelegate.onNodeHover(c,a)});this.jQuery("#"+d).click(function(b){c.jQuery(".flipped").removeClass("flipped");c.myDelegate.onNodeClick(c,a,b)});var g=this.jQuery('<div id="card'+d+'" class="card"></div>');g.appendTo(this.jQuery(f));var h=this.jQuery('<div class="browserElement"></div>');
h.appendTo(g);g=c.myDelegate.getNodeLabel(a);this.jQuery("<label>"+g+"</label>").appendTo(h).click(function(b){c.myDelegate.onNodeClick(c,a,b)});(g=c.myDelegate.getThumbnail(a))&&this.jQuery('<img class="thumb" src="'+g+'" ></img>').appendTo(h).click(function(b){c.myDelegate.onNodeClick(c,a,b)});c.myDelegate.hasContent(a)&&c.myDelegate.addContent(a,d);this.jQuery(f).addClass(c.myDelegate.getNodeClass(a))};AutodeskNamespace("Autodesk.Viewing.Private");Autodesk.Viewing.Private.WEBGL_HELP_LINK=null;
Autodesk.Viewing.Private.ErrorInfoData={1:{img:"img-reload","globalized-msg":"Viewer-UnknownFailure","default-msg":"<title> Sorry </title><message>We seem to have some technical difficulties and couldn't complete your request.</message> <hint>Try loading the item again. </hint><hint>Please verify your Internet connection, and refresh the browser to see if that fixes the problem.</hint>"},2:{img:"img-unsupported","globalized-msg":"Viewer-BadData","default-msg":"<title> Sorry </title><message>The item you are trying to view was not processed completely. </message><hint>Try loading the item again.</hint><hint>Please upload the file again to see if that fixes the issue.</hint>"},
3:{img:"img-reload","globalized-msg":"Viewer-NetworkError","default-msg":"<title> Sorry </title><message>We seem to have some technical difficulties and couldn't complete your request.</message><hint> Try loading the item again.</hint><hint> Please verify your Internet connection, and refresh the browser to see if that fixes the problem.</hint>"},4:{img:"img-unloack","globalized-msg":"Viewer-AccessDenied","default-msg":"<title> No access </title><message>Sorry. You don\u2019t have the required privileges to access this item.</message><hint> Please contact the author</hint>"},
5:{img:"img-item-not-found","globalized-msg":"Viewer-FileNotFound","default-msg":'<title> Sorry </title><message>We can\u2019t display the item you are looking for. It may not have been processed yet. It may have been moved, deleted, or you may be using a corrupt file or unsupported file format.</message><hint> Try loading the item again.</hint><hint> Please upload the file again to see if that fixes the issue.</hint><hint> <a href="http://help.autodesk.com/view/ADSK360/ENU/?guid=GUID-488804D0-B0B0-4413-8741-4F5EE0FACC4A" target="_blank">See a list of supported formats.</a></hint>'},
6:{img:"img-reload","globalized-msg":"Viewer-ServerError","default-msg":"<title> Sorry </title><message>We seem to have some technical difficulties and couldn't complete your request.</message><hint> Try loading the item again.</hint><hint> Please verify your Internet connection, and refresh the browser to see if that fixes the problem.</hint>"},7:{img:"img-reload","globalized-msg":"Viewer-UnhandledResponseCode","default-msg":"<title> Network problem </title><message>Sorry. We seem to have some technical difficulties and couldn't complete your request.</message><hint> Try loading the item again.</hint><hint> Please verify your Internet connection, and refresh the browser to see if that fixes the problem.</hint>"},
8:{img:"img-unsupported","globalized-msg":"Viewer-WebGlNotSupported","default-msg":'<title> Sorry </title><message>We couldn\u2019t show the item because your browser doesn\u2019t support 3D viewing.</message><hint> Please use Google Chrome, Firefox or another browser that supports WebGL 3D graphics.</hint><hint> <a href="WEBGL_HELP" target="_blank">See a list of browsers supporting WebGL 3D graphics.</a></hint>'},9:{img:"img-item-not-found","globalized-msg":"Viewer-NoViewable","default-msg":"<title> No viewable content </title><message>There\u2019s nothing to display for this item. It may not have been processed or it may not have content we can display.</message><hint> Please contact the author.</hint><hint> Please upload the file again to see if that fixes the issue.</hint>"},
10:{img:"img-unsupported","globalized-msg":"Viewer-WebGlDisabled","default-msg":'<title> Sorry </title><message>We couldn\u2019t show the item because you haven\'t enabled 3D viewing in your browser.</message><hint> Please use Google Chrome, Firefox or enable WebGL 3D graphics in your browser.</hint><hint> <a href="WEBGL_HELP" target="_blank">See a list of browsers supporting WebGL 3D graphics.</a></hint>'},11:{img:"img-unsupported","globalized-msg":"Viewer-RTCError","default-msg":"<title> Sorry </title><message>We couldn\u2019t connect to the Collaboration server.</message><hint> Please verify your Internet connection, and refresh the browser to see if that fixes the problem.</hint>"}};
Autodesk.Viewing.Private.currentError=null;Autodesk.Viewing.Private.currentErrors=null;Autodesk.Viewing.Private.ErrorHandler=function(){};Autodesk.Viewing.Private.ErrorHandler.prototype.constructor=Autodesk.Viewing.Private.ErrorHandler;Autodesk.Viewing.Private.ErrorHandler.getErrorCode=function(a){return 403===a||401===a?Autodesk.Viewing.ErrorCodes.NETWORK_ACCESS_DENIED:404===a?Autodesk.Viewing.ErrorCodes.NETWORK_FILE_NOT_FOUND:500<=a?Autodesk.Viewing.ErrorCodes.NETWORK_SERVER_ERROR:Autodesk.Viewing.ErrorCodes.NETWORK_UNHANDLED_RESPONSE_CODE};
Autodesk.Viewing.Private.ErrorHandler.reportError=function(a,b,c,d){Autodesk.Viewing.Private.ErrorHandler.currentError=null;Autodesk.Viewing.Private.ErrorHandler.currentErrors=null;if(b){Autodesk.Viewing.Private.ErrorHandler.currentError=[a,b,c,d];var f=Autodesk.Viewing.Private.ErrorInfoData[b];if(f){var g={defaultValue:""};g.defaultValue=f["default-msg"];var h=f.img;c=this.parseErrorString(f["globalized-msg"],g);if(b===Autodesk.Viewing.ErrorCodes.BROWSER_WEBGL_DISABLED||b===Autodesk.Viewing.ErrorCodes.BROWSER_WEBGL_NOT_SUPPORTED)for(b=
Autodesk.Viewing.Private.WEBGL_HELP_LINK||Autodesk.Viewing.Private.getResourceUrl("webGLHelp.html"),d=0;d<c.hints.length;d++)-1!==c.hints[d].indexOf('href="WEBGL_HELP"')&&(c.hints[d]=c.hints[d].replace('href="WEBGL_HELP"','href="'+b+'"'))}else h="img-unsupported",g={defaultValue:"",interpolationPrefix:"{",interpolationSuffix:"}"},this.parseArguments(c,g),c=this.parseErrorString(b,g),c.header||(c.header="warning"===d?Autodesk.Viewing.i18n.translate("header-warning"):"");Autodesk.Viewing.Private.AlertBox.displayError(a,
c.msg,c.header,h,c.hints)}};
Autodesk.Viewing.Private.ErrorHandler.reportErrors=function(a,b){Autodesk.Viewing.Private.ErrorHandler.currentError=null;Autodesk.Viewing.Private.ErrorHandler.currentErrors=null;if(b){Autodesk.Viewing.Private.ErrorHandler.currentErrors=[a,b];for(var c={defaultValue:"",interpolationPrefix:"{",interpolationSuffix:"}"},d=[],f=0;f<b.length;f++)if(b[f].code){this.parseArguments(b[f].message,c);var g=this.parseErrorString(b[f].code,c);g.header||(g.header="warning"===b[0].type?Autodesk.Viewing.i18n.translate("header-warning",
{defaultValue:"Warning"}):"");d.push(g)}d.length&&Autodesk.Viewing.Private.AlertBox.displayErrors(a,"img-unsupported",d)}};Autodesk.Viewing.Private.ErrorHandler.parseArguments=function(a,b){if(a)if("string"===typeof a)b.defaultValue=a;else{b.defaultValue=a[0];for(var c=1;c<a.length;c++)b[(c-1).toString()]=a[c]}};
Autodesk.Viewing.Private.ErrorHandler.parseErrorString=function(a,b){var c={msg:null,msgList:null,header:null,hints:null};if(!a)return c;var d=Autodesk.Viewing.i18n.translate(a,b);if(!d)return c;-1!=d.indexOf("<title>")&&(d=d.split("<title>")[1].split("</title>"),c.header=d[0],d=d[1]);d&&-1!=d.indexOf("<message>")?(d=d.split("<message>")[1].split("</message>"),c.msg=d[0],d=d[1]):c.msg=d;if(d&&-1!=d.indexOf("<hint>")){c.hints=[];for(var d=d.split("<hint>"),f=0;f<d.length;f++){var g=d[f].split("</hint")[0];
c.hints.push(g)}}return c};
Autodesk.Viewing.Private.ErrorHandler.localize=function(){if(0<Autodesk.Viewing.Private.AlertBox.instances.length)if(Autodesk.Viewing.Private.AlertBox.dismiss(),Autodesk.Viewing.Private.ErrorHandler.currentError){var a=Autodesk.Viewing.Private.ErrorHandler.currentError.shift(),b=Autodesk.Viewing.Private.ErrorHandler.currentError;Autodesk.Viewing.Private.ErrorHandler.reportError(a,b[0],b[1],b[2])}else a=Autodesk.Viewing.Private.ErrorHandler.currentErrors.shift(),Autodesk.Viewing.Private.ErrorHandler.reportErrors(a,Autodesk.Viewing.Private.ErrorHandler.currentErrors[0])};
"use strict";Autodesk.Viewing.Extension=function(a,b){this.viewer=a;this.options=b};Autodesk.Viewing.Extension.prototype.load=function(){return!0};Autodesk.Viewing.Extension.prototype.unload=function(){return!0};Autodesk.Viewing.Extension.prototype.getState=function(a){};Autodesk.Viewing.Extension.prototype.restoreState=function(a,b){return!0};"use strict";AutodeskNamespace("Autodesk.Viewing.Private");
Autodesk.Viewing.ExtensionManager=function(){var a={};return{registerExtension:function(b,c){return a.hasOwnProperty(b)?!1:(a[b]=c,!0)},getExtension:function(b){return a.hasOwnProperty(b)?a[b]:null},unregisterExtension:function(b){return a.hasOwnProperty(b)?(delete a[b],!0):!1}}};Autodesk.Viewing.theExtensionManager=new Autodesk.Viewing.ExtensionManager;AutodeskNamespace("Autodesk.Viewing");
Autodesk.Viewing.UnifiedCamera=function(a,b){THREE.Camera.call(this);this.fov=45;this.near=0.1;this.far=1E5;this.aspect=a/b;this.left=-a/2;this.right=a/2;this.top=b/2;this.bottom=-b/2;this.target=new THREE.Vector3(0,0,-1);this.worldup=new THREE.Vector3(0,1,0);this.orthographicCamera=new THREE.OrthographicCamera(this.left,this.right,this.top,this.bottom,this.near,this.far);this.perspectiveCamera=new THREE.PerspectiveCamera(this.fov,this.aspect,this.near,this.far);this.zoom=1;this.toPerspective()};
Autodesk.Viewing.UnifiedCamera.ORTHO_FOV=THREE.Math.radToDeg(2*Math.atan(0.5));Autodesk.Viewing.UnifiedCamera.prototype=Object.create(THREE.Camera.prototype);
Autodesk.Viewing.UnifiedCamera.prototype.clone=function(){var a=new Autodesk.Viewing.UnifiedCamera(2*this.right,2*this.top);THREE.Camera.prototype.clone.call(this,a);a.position.copy(this.position);a.up.copy(this.up);this.target&&(a.target=this.target.clone());this.worldup&&(a.worldup=this.worldup.clone());a.left=this.left;a.right=this.right;a.top=this.top;a.bottom=this.bottom;a.near=this.near;a.far=this.far;a.fov=this.fov;a.aspect=this.aspect;a.zoom=this.zoom;a.isPerspective=this.isPerspective;this.updateProjectionMatrix();
return a};Autodesk.Viewing.UnifiedCamera.prototype.__computeFovPosition=function(a){if(1E-4>=Math.abs(this.fov-a))return this.position.clone();var b=this.target.clone().sub(this.position),c=THREE.Math.degToRad(this.fov);a=THREE.Math.degToRad(a);c=b.length()*Math.tan(0.5*c)/Math.tan(0.5*a);b=b.normalize().multiplyScalar(-c);return this.target.clone().add(b)};
Autodesk.Viewing.UnifiedCamera.prototype.toPerspective=function(){!this.isPerspective&&this.saveFov&&(this.position.copy(this.__computeFovPosition(this.saveFov)),this.fov=this.saveFov);this.perspectiveCamera.aspect=this.aspect;this.perspectiveCamera.near=this.near;this.perspectiveCamera.far=this.far;this.perspectiveCamera.fov=this.fov/this.zoom;this.perspectiveCamera.updateProjectionMatrix();this.projectionMatrix=this.perspectiveCamera.projectionMatrix;this.isPerspective=!0};
Autodesk.Viewing.UnifiedCamera.prototype.toOrthographic=function(){if(this.isPerspective){this.saveFov=this.fov;var a=Autodesk.Viewing.UnifiedCamera.ORTHO_FOV;this.position.copy(this.__computeFovPosition(a));this.fov=a}this.orthoScale=this.target.clone().sub(this.position).length();var a=0.5*this.orthoScale,b=a*this.aspect;this.left=this.orthographicCamera.left=-b;this.right=this.orthographicCamera.right=b;this.top=this.orthographicCamera.top=a;this.bottom=this.orthographicCamera.bottom=-a;this.orthographicCamera.near=
this.near;this.orthographicCamera.far=this.far;this.orthographicCamera.updateProjectionMatrix();this.projectionMatrix=this.orthographicCamera.projectionMatrix;this.isPerspective=!1};Autodesk.Viewing.UnifiedCamera.prototype.updateProjectionMatrix=function(){this.isPerspective?this.toPerspective():this.toOrthographic()};Autodesk.Viewing.UnifiedCamera.prototype.setSize=function(a,b){this.aspect=a/b;this.left=-a/2;this.right=a/2;this.top=b/2;this.bottom=-b/2};
Autodesk.Viewing.UnifiedCamera.prototype.setFov=function(a){this.fov=a;this.updateProjectionMatrix()};Autodesk.Viewing.UnifiedCamera.prototype.setLens=function(a,b){void 0===b&&(b=24);var c=2*THREE.Math.radToDeg(Math.atan(b/(2*a)));this.setFov(c);return c};Autodesk.Viewing.UnifiedCamera.prototype.getCameraChangedEvent=function(){return{type:Autodesk.Viewing.CAMERA_CHANGE_EVENT,camera:this}};AutodeskNamespace("Autodesk.Viewing.UI");
Autodesk.Viewing.UI.Toolbar=function(a){this.parentContainer=a;this.container=document.createElement("div");this.container.className="toolbar-menuplacer";this.menu=document.createElement("ul");this.menu.className="toolbar-menu";this.container.appendChild(this.menu);this.parentContainer.appendChild(this.container);this.subToolbars={}};Autodesk.Viewing.UI.Toolbar.prototype.constructor=Autodesk.Viewing.UI.Toolbar;Autodesk.Viewing.UI.Toolbar.toolButtons={};
Autodesk.Viewing.UI.Toolbar.createMenuButton=function(a,b,c,d){var f=document.createElement("li");f.className="toolbar-generic-button";f.id=a;var g=null;if(b){var h=b;d&&d.defaultTooltipValue&&(h=d.defaultTooltipValue);g=document.createElement("div");g.className="toolbar-tooltip";g.setAttribute("data-i18n",b);g.setAttribute("tooltipText",b);g.textContent=Autodesk.Viewing.i18n.translate(b,{defaultValue:h});g.id=a+"Tip";f.appendChild(g)}var k=document.createElement("div");k.className="toolbar-button";
k.id=Autodesk.Viewing.UI.SubToolbar.getInternalButtonId(a);f.appendChild(k);k.addEventListener("touchstart",touchStartToClick);k.addEventListener("click",function(a){if(!Autodesk.Viewing.UI.SubToolbar.isDisabled(k)&&(c&&c(a),isTouchDevice())){for(var b in Autodesk.Viewing.UI.Toolbar.toolButtons)if(a=Autodesk.Viewing.UI.Toolbar.toolButtons[b],a.id!==f.id&&a.hasSubmenu){var d=a.classList.contains("toolbar-submenu-visible");d&&a.classList.remove("toolbar-submenu-visible")}f.hasSubmenu&&((d=f.classList.contains("toolbar-submenu-visible"))?
f.classList.remove("toolbar-submenu-visible"):f.classList.add("toolbar-submenu-visible"))}});k.onToolStateChangedCB=null;d&&d.onToolStateChangedCB&&(k.onToolStateChangedCB=d.onToolStateChangedCB);!isTouchDevice()&&g&&(f.addEventListener("mouseover",function(a){if(a.target===f||a.target===k)g.style.visibility="visible"}),f.addEventListener("mouseout",function(a){if(a.target===f||a.target===k)g.style.visibility="hidden"}));return Autodesk.Viewing.UI.Toolbar.toolButtons[a]=f};
Autodesk.Viewing.UI.Toolbar.getToolButton=function(a){return Autodesk.Viewing.UI.Toolbar.toolButtons[a]};Autodesk.Viewing.UI.Toolbar.destroy=function(){Autodesk.Viewing.UI.Toolbar.toolButtons={}};Autodesk.Viewing.UI.Toolbar.prototype.addSubToolbar=function(a,b){var c=new Autodesk.Viewing.UI.SubToolbar(this.menu,a,b);return this.subToolbars[a]=c};Autodesk.Viewing.UI.Toolbar.prototype.getSubToolbars=function(){return this.subToolbars};Autodesk.Viewing.UI.Toolbar.prototype.getSubToolbarById=function(a){return this.subToolbars[a]};
Autodesk.Viewing.UI.Toolbar.prototype.removeSubToolbar=function(a){if("string"===typeof a){var b=this.subToolbars[a];b&&(this.menu.removeChild(b.subtoolbar),delete this.subToolbars[a])}else a&&(this.menu.removeChild(a.subtoolbar),a.id&&delete this.subToolbars[a.id])};Autodesk.Viewing.UI.Toolbar.prototype.removeAllSubToolbars=function(){for(;this.menu.firstChild;)this.menu.removeChild(this.menu.firstChild);this.subToolbars={}};
Autodesk.Viewing.UI.Toolbar.prototype.addToSubToolbar=function(a,b){this.subToolbars[a]&&this.subToolbars[a].addTool(b)};Autodesk.Viewing.UI.Toolbar.prototype.removeFromSubToolbar=function(a,b){this.subToolbars[a]&&this.subToolbars[a].removeTool(b)};
Autodesk.Viewing.UI.Toolbar.prototype.attachSubMenu=function(a,b){a.appendChild(b);a.hasSubmenu=!0;if(isTouchDevice()){var c=function(){a.classList.remove("toolbar-submenu-visible")};b.addEventListener("click",c);document.addEventListener("touchstart",c)}};Autodesk.Viewing.UI.Toolbar.prototype.collapse=function(a){this.container.classList.toggle("toolbar-menu-collapsed",a)};Autodesk.Viewing.UI.Toolbar.prototype.isCollapsed=function(){return this.container.classList.contains("toolbar-menu-collapsed")};
Autodesk.Viewing.UI.Toolbar.prototype.addEventListener=function(a,b){this.menu.addEventListener(a,b)};Autodesk.Viewing.UI.Toolbar.prototype.removeEventListener=function(a,b){this.menu.removeEventListener(a,b)};Autodesk.Viewing.UI.SubToolbar=function(a,b,c){this.parentContainer=a;this.subtoolbar=document.createElement("div");this.subtoolbar.className="toolbar-subtoolbar";this.id=this.subtoolbar.id=b;this.parentContainer.appendChild(this.subtoolbar);this.buttons={};this.isRadio=c};
Autodesk.Viewing.UI.SubToolbar.prototype.constructor=Autodesk.Viewing.SubToolbar;Autodesk.Viewing.UI.SubToolbar.STATE_NOTACTIVE=0;Autodesk.Viewing.UI.SubToolbar.STATE_ACTIVE=1;Autodesk.Viewing.UI.SubToolbar.STATE_DISABLED=-1;Autodesk.Viewing.UI.SubToolbar.getInternalButtonId=function(a){return a+"Button"};Autodesk.Viewing.UI.SubToolbar.prototype.addTool=function(a){this.buttons[a.id]=a;this.subtoolbar.appendChild(a);Autodesk.Viewing.UI.SubToolbar.setToolState(a.id,Autodesk.Viewing.UI.SubToolbar.STATE_NOTACTIVE)};
Autodesk.Viewing.UI.SubToolbar.prototype.insertToolBefore=function(a,b){this.buttons[a.id]=a;this.subtoolbar.insertBefore(a,b);Autodesk.Viewing.UI.SubToolbar.setToolState(a.id,Autodesk.Viewing.UI.SubToolbar.STATE_NOTACTIVE)};
Autodesk.Viewing.UI.SubToolbar.setToolState=function(a,b){if("string"===typeof a){var c=Autodesk.Viewing.UI.SubToolbar.getInternalButtonId(a);a=document.getElementById(c)}if(a){switch(b){case Autodesk.Viewing.UI.SubToolbar.STATE_NOTACTIVE:a.classList.remove("active-button");a.classList.remove("disabled-button");break;case Autodesk.Viewing.UI.SubToolbar.STATE_ACTIVE:a.classList.remove("disabled-button");a.classList.add("active-button");break;case Autodesk.Viewing.UI.SubToolbar.STATE_DISABLED:a.classList.remove("active-button"),
a.classList.add("disabled-button")}if(a.onToolStateChangedCB)a.onToolStateChangedCB()}};Autodesk.Viewing.UI.SubToolbar.getToolState=function(a){"string"===typeof a&&(a=Autodesk.Viewing.UI.SubToolbar.getInternalButtonId(a),a=document.getElementById(a));return a?a.classList.contains("active-button")||a.classList.contains("disabled-button")?Autodesk.Viewing.UI.SubToolbar.STATE_ACTIVE:Autodesk.Viewing.UI.SubToolbar.STATE_NOTACTIVE:Autodesk.Viewing.UI.SubToolbar.STATE_NOTACTIVE};
Autodesk.Viewing.UI.SubToolbar.prototype.insertToolAtIndex=function(a,b){this.buttons[a.id]=a;b<this.getToolCount()?this.subtoolbar.insertBefore(a,this.subtoolbar.children[b]):this.subtoolbar.appendChild(a);Autodesk.Viewing.UI.SubToolbar.setToolState(a.id,Autodesk.Viewing.UI.SubToolbar.STATE_NOTACTIVE)};Autodesk.Viewing.UI.SubToolbar.prototype.setToolImage=function(a,b){var c=document.getElementById(a+"Button");c&&(c.style.backgroundImage="url('"+b+"')")};
Autodesk.Viewing.UI.SubToolbar.prototype.setToolBackgroundColor=function(a,b){var c=this.buttons[a];c&&(c.style.backgroundColor=b)};Autodesk.Viewing.UI.SubToolbar.prototype.setToolText=function(a,b){var c=document.getElementById(a+"Button");if(c){var d=document.createElement("span");d.textContent=Autodesk.Viewing.i18n.translate(b);d.style.fontSize="12px";d.style.color="black";d.style.zIndex="10";d.setAttribute("data-i18n",b);c.appendChild(d)}};
Autodesk.Viewing.UI.SubToolbar.prototype.removeTool=function(a){if("string"===typeof a){var b=this.buttons[a];b&&(this.subtoolbar.removeChild(b),delete this.buttons[a])}else a&&(this.subtoolbar.removeChild(a),a.id&&delete this.buttons[a.id])};Autodesk.Viewing.UI.SubToolbar.prototype.getTool=function(a){return this.buttons[a]};
Autodesk.Viewing.UI.SubToolbar.prototype.getAllToolIds=function(){for(var a=[],b=this.subtoolbar.children?this.subtoolbar.children.length:0,c=0;c<b;c++)a.push(this.subtoolbar.children[c].id);return a};Autodesk.Viewing.UI.SubToolbar.prototype.getToolCount=function(){return this.subtoolbar.children?this.subtoolbar.children.length:0};
Autodesk.Viewing.UI.SubToolbar.prototype.select=function(a,b){b||void 0===b?Autodesk.Viewing.UI.SubToolbar.getToolState(a)!==Autodesk.Viewing.UI.SubToolbar.STATE_DISABLED&&(this.isRadio&&this.deselectAll(),Autodesk.Viewing.UI.SubToolbar.setToolState(a,Autodesk.Viewing.UI.SubToolbar.STATE_ACTIVE)):this.deselect(a)};Autodesk.Viewing.UI.SubToolbar.prototype.deselect=function(a){a in this.buttons&&Autodesk.Viewing.UI.SubToolbar.setToolState(a,Autodesk.Viewing.UI.SubToolbar.STATE_NOTACTIVE)};
Autodesk.Viewing.UI.SubToolbar.prototype.deselectAll=function(){for(var a in this.buttons)this.buttons.hasOwnProperty(a)&&this.deselect(a)};Autodesk.Viewing.UI.SubToolbar.isActive=function(a){return a.classList.contains("active-button")};Autodesk.Viewing.UI.SubToolbar.isDisabled=function(a){return a.classList.contains("disabled-button")};Autodesk.Viewing.UI.SubToolbar.prototype.setToolVisibility=function(a,b){a in this.buttons&&(this.buttons[a].style.display=b?"list-item":"none")};
Autodesk.Viewing.UI.SubToolbar.prototype.isToolVisible=function(a){return a in this.buttons?!(this.buttons[a].style.display&&"none"===this.buttons[a].style.display):!1};Autodesk.Viewing.UI.SubToolbar.prototype.setVisibility=function(a){this.subtoolbar.style.display=a?"":"none"};Autodesk.Viewing.UI.SubToolbar.prototype.isVisible=function(){return!(this.subtoolbar.style.display&&"none"===this.subtoolbar.style.display)};Autodesk.Viewing.UI.ToolBar=Autodesk.Viewing.UI.Toolbar;
Autodesk.Viewing.UI.ToolBar.prototype=Autodesk.Viewing.UI.Toolbar.prototype;AutodeskNamespace("Autodesk.Viewing");Autodesk.Viewing.GEOMETRY_LOADED_EVENT="geometry_loaded";Autodesk.Viewing.OBJECT_TREE_CREATED_EVENT="frag->node array created";Autodesk.Viewing.SELECTION_CHANGED_EVENT="selection";Autodesk.Viewing.ISOLATE_EVENT="isolate";Autodesk.Viewing.HIDE_EVENT="hide";Autodesk.Viewing.SHOW_EVENT="show";Autodesk.Viewing.HIGHLIGHT_EVENT="highlight";Autodesk.Viewing.CAMERA_CHANGE_EVENT="cameraChanged";
Autodesk.Viewing.EXPLODE_CHANGE_EVENT="explodeChanged";Autodesk.Viewing.TOOL_CHANGE_EVENT="toolChanged";Autodesk.Viewing.RENDER_OPTION_CHANGED_EVENT="renderOptionChanged";Autodesk.Viewing.LAYER_VISIBILITY_CHANGED_EVENT="layerVisibility";Autodesk.Viewing.RESET_EVENT="reset";Autodesk.Viewing.NAVIGATION_MODE={ORBIT:0,PAN:1,DOLLY:2,ROLL:3,FOV:4,TOUCH_PAN_DOLLY:5,TOUCH_ROLL:6,OTHER:7};Autodesk.Viewing.TOOLBAR={NAVTOOLSID:"navTools",MODELTOOLSID:"modelTools"};
Autodesk.Viewing.Viewer3D=function(a,b){Autodesk.Viewing.Viewer.call(this,a,b);if("CANVAS"===this.container.nodeName)throw"Viewer must be initialized on a div [temporary]";this.canvas=document.createElement("canvas");this.canvas.tabIndex=0;var c=this.getDimensions();this.canvas.width=c.width;this.canvas.height=c.height;this.container.appendChild(this.canvas);this.canvas.viewer=this;this.toolbar=this.layersPanel=this.modelstructure=null;this.running=!1;this._defaultNavigationTool=this._pushedTool=
"";this.prefs=new Autodesk.Viewing.Private.Preferences(this,"Autodesk.Viewing.Private.GuiViewer3D.SavedSettings.")};Autodesk.Viewing.Viewer3D.prototype=Object.create(Autodesk.Viewing.Viewer.prototype);Autodesk.Viewing.Viewer3D.prototype.constructor=Autodesk.Viewing.Viewer3D;
Autodesk.Viewing.Viewer3D.kDefaultCanvasConfig={click:{onObject:["selectOnly"],offObject:["deselectAll"]},clickAlt:{onObject:["setCOI"],offObject:["setCOI"]},clickCtrl:{onObject:["selectToggle"],offObject:["deselectAll"]},clickShift:{onObject:["selectToggle"],offObject:["deselectAll"]}};
Autodesk.Viewing.Viewer3D.prototype.initialize=function(){function a(){var a,c,d=Autodesk.Viewing.theHotkeyManager.KEYCODES;Autodesk.Viewing.theHotkeyManager.pushHotkeys("Autodesk.FitToView",[{keycodes:[d.f],onPress:function(){b.navigation.setRequestFitToView(!0);return!0}}]);a=function(){b.navigation.setRequestHomeView(!0);return!0};Autodesk.Viewing.theHotkeyManager.pushHotkeys("Autodesk.Home",[{keycodes:[d.h],onPress:a},{keycodes:[d.HOME],onPress:a}]);Autodesk.Viewing.theHotkeyManager.pushHotkeys("Autodesk.Escape",
[{keycodes:[d.ESCAPE],onRelease:function(){if(b.objectContextMenu&&b.objectContextMenu.hide())return!0;b.fireEvent({type:Autodesk.Viewing.ESCAPE_EVENT});return!0}}]);a=function(){previousTool=b.getActiveNavigationTool();return b.setActiveNavigationTool("pan")};c=function(){return b.setActiveNavigationTool(previousTool)};hotkeys=[{keycodes:[d.SHIFT],onPress:a,onRelease:c},{keycodes:[d.SPACE],onPress:a,onRelease:c}];Autodesk.Viewing.theHotkeyManager.pushHotkeys("Autodesk.Pan",hotkeys,{tryUntilSuccess:!0})}
var b=this,c=this.detectWebGL();if(0>=c)return-1===c?Autodesk.Viewing.ErrorCodes.BROWSER_WEBGL_NOT_SUPPORTED:Autodesk.Viewing.ErrorCodes.BROWSER_WEBGL_DISABLED;Autodesk.Viewing.Viewer.prototype.initialize.call(this);this.impl=new Autodesk.Viewing.Private.Viewer3DImpl(this.canvas,this);this.impl.controls=function(c){b.navigation=new Autodesk.Viewing.Navigation(c.camera);b.__initAutoCam(c);b.utilities=new Autodesk.Viewing.ViewingUtilities(c,b.autocam,b.navigation);b.clickHandler=new Autodesk.Viewing.DefaultHandler(c,
b.navigation,b.utilities);b.toolController=new Autodesk.Viewing.ToolController(c,b,b.autocam,b.utilities,b.clickHandler);b.toolController.registerTool(new Autodesk.Viewing.GestureHandler(b));b.toolController.registerTool(Autodesk.Viewing.theHotkeyManager);b.toolController.activateTool(Autodesk.Viewing.theHotkeyManager.getName());a();b.toolController.registerTool(new Autodesk.Viewing.OrbitDollyPanTool(c,b));b.toolController.activateTool("gestures");return b.toolController}(this.impl);this.setDefaultNavigationTool("orbit");
this.model=null;this.impl.controls&&this.impl.controls.setAutocam(b.autocam);c=this.config&&this.config.canvasConfig?this.config.canvasConfig:Autodesk.Viewing.Viewer3D.kDefaultCanvasConfig;this.setCanvasClickBehavior(c);this.loader=document.createElement("div");this.loader.id="loader";this.loader.className="spinner";this.container.appendChild(this.loader);if(!c.disableSpinner)for(c=1;3>=c;c++){var d=document.createElement("div");d.className="bounce"+c;this.loader.appendChild(d)}this.initSettings();
this.viewerState=new Autodesk.Viewing.Private.ViewerState(this);this.config&&this.config.hasOwnProperty("startOnInitialize")&&!this.config.startOnInitialize||this.run();return 0};Autodesk.Viewing.Viewer3D.prototype.setUp=function(a){Autodesk.Viewing.Viewer.prototype.setUp.call(this,a);this.setCanvasClickBehavior(this.config&&this.config.canvasConfig?this.config.canvasConfig:Autodesk.Viewing.Viewer3D.kDefaultCanvasConfig)};
Autodesk.Viewing.Viewer3D.prototype.tearDown=function(){this.clearSelection();Autodesk.Viewing.Viewer.prototype.tearDown.call(this);this.modelstructure&&this.setModelStructurePanel(null);this.propertygrid&&this.setPropertyPanel(null);this.viewerSettingsPanel&&this.setSettingsPanel(null);this.layersPanel&&this.setLayersPanel(null);this.renderoptions&&(this.removePanel(this.renderoptions),this.renderoptions.uninitialize(),this.renderoptions=null);this.toolbar&&(this.toolbar.container.parentNode.removeChild(this.toolbar.container),
this.toolbar=null);this.loader.style.display="block";this.model=null};Autodesk.Viewing.Viewer3D.prototype.run=function(){this.running||(this.resize(),this.running=!0,this.impl.run())};
Autodesk.Viewing.Viewer3D.prototype.__initAutoCam=function(a){var b=this,c=a.camera;c.pivot||(c.pivot=new THREE.Vector3(0,0,0));c.target||(c.target=new THREE.Vector3(0,0,0));c.worldup||(c.worldup=c.up.clone());b.autocamCamera=c.clone();b.autocamCamera.target=c.target.clone();b.autocamCamera.pivot=c.pivot.clone();b.autocamCamera.worldup=c.worldup.clone();b.autocam=new Autocam(b.autocamCamera,b.navigation,b.canvas,function(a){b.autocamCamera.isPerspective!==c.isPerspective&&(b.autocamCamera.isPerspective?
b.navigation.toPerspective():b.navigation.toOrthographic());b.navigation.setVerticalFov(b.autocamCamera.fov,!1);b.navigation.setView(b.autocamCamera.position,b.autocamCamera.target);b.navigation.setPivotPoint(b.autocamCamera.pivot);b.navigation.setCameraUpVector(b.autocamCamera.up);a&&b.navigation.setWorldUpVector(b.autocamCamera.worldup);b.impl.syncCamera(a)},function(a){b.utilities?b.utilities.pivotActive(a,!1):b.impl.controls.pivotActive(a,!1)});b.addEventListener("cameraChanged",function(a){b.autocam.sync(a.camera)});
b.autocam.sync(c)};Autodesk.Viewing.Viewer3D.prototype.load=function(a,b,c,d){var f=this;return this.loadModel(a,null,b,function(){var a;f.modelstructure&&(a=function(a){f.modelstructure.setModel(a,f.config.defaultModelStructureTitle?f.config.defaultModelStructureTitle:"")});f.model.getObjectTree(a);c&&c()},d)};
Autodesk.Viewing.Viewer3D.prototype.uninitialize=function(a){this.canvas.parentNode.removeChild(this.canvas);this.viewerState=this.canvas=this.canvas.viewer=null;this.toolController&&(this.toolController.uninitialize(),this.utilities=this.clickHandler=this.toolController=null);this.navigation&&(this.navigation.uninitialize(),this.navigation=null);this.impl&&(this.impl.uninitialize(),this.impl=null);this.prefs=this.model=this.loader=null;Autodesk.Viewing.UI.Toolbar.destroy();this.toolbar=null;Autodesk.Viewing.theHotkeyManager.popHotkeys("Autodesk.FitToView");
Autodesk.Viewing.theHotkeyManager.popHotkeys("Autodesk.Home");Autodesk.Viewing.theHotkeyManager.popHotkeys("Autodesk.Escape");Autodesk.Viewing.theHotkeyManager.popHotkeys("Autodesk.Pan");Autodesk.Viewing.theHotkeyManager.popHotkeys("Autodesk.Orbit");Autodesk.Viewing.Viewer.prototype.uninitialize.call(this)};
Autodesk.Viewing.Viewer3D.prototype.detectWebGL=function(){if(window.WebGLRenderingContext){for(var a=document.createElement("canvas"),b=["webgl","experimental-webgl","moz-webgl","webkit-3d"],c=!1,d=0;4>d;d++)try{if((c=a.getContext(b[d]))&&"function"===typeof c.getParameter)return 1}catch(f){}return 0}return-1};
Autodesk.Viewing.Viewer3D.prototype.loadModel=function(a,b,c,d,f){function g(){if(h.model.is2d())Autodesk.Viewing.theHotkeyManager.popHotkeys("Autodesk.Orbit");else{var a;Autodesk.Viewing.theHotkeyManager.pushHotkeys("Autodesk.Orbit",[{keycodes:[Autodesk.Viewing.theHotkeyManager.KEYCODES.ALT],onPress:function(){a=h.getActiveNavigationTool();return h.setActiveNavigationTool("orbit")},onRelease:function(){return h.setActiveNavigationTool(a)}}],{tryUntilSuccess:!0})}}var h=this;this.addEventListener(Autodesk.Viewing.GEOMETRY_LOADED_EVENT,
function(a){this.impl.needsRender=!0;h.removeEventListener(Autodesk.Viewing.GEOMETRY_LOADED_EVENT)});return this.impl.loadSvf(a,b,c,function(a){h.model=new Autodesk.Viewing.Model(a);h.impl.setModel(h.model);h.loader.style.display="None";h.model.is2d()&&h.activateLayerState("Initial");g();d&&d()},function(a,b){h.loader.style.display="None";f&&f(a,b)})};
Autodesk.Viewing.Viewer3D.prototype.getToolbar=function(a){!this.toolbar&&a&&(this.toolbar=new Autodesk.Viewing.UI.Toolbar(this.container),this.navTools=this.toolbar.addSubToolbar(Autodesk.Viewing.TOOLBAR.NAVTOOLSID,!0),this.modelTools=this.toolbar.addSubToolbar(Autodesk.Viewing.TOOLBAR.MODELTOOLSID,!1));return this.toolbar};Autodesk.Viewing.Viewer3D.prototype.resize=function(){Autodesk.Viewing.Viewer.prototype.resize.call(this);return this.impl.resize(this.container.clientWidth,this.container.clientHeight)};
Autodesk.Viewing.Viewer3D.prototype.getCamera=function(){return this.impl.camera};Autodesk.Viewing.Viewer3D.prototype.getState=function(a){return this.viewerState.getState(a)};Autodesk.Viewing.Viewer3D.prototype.restoreState=function(a,b,c){(a=this.viewerState.restoreState(a,b,c))&&this.fireEvent({type:Autodesk.Viewing.VIEWER_STATE_RESTORED_EVENT,value:a});return a};
Autodesk.Viewing.Viewer3D.prototype.setViewFromArray=function(a,b){this.setActiveNavigationTool("orbit");var c={position:new THREE.Vector3(a[0],a[1],a[2]),target:new THREE.Vector3(a[3],a[4],a[5]),up:new THREE.Vector3(a[6],a[7],a[8]),aspect:a[9],fov:THREE.Math.radToDeg(a[10]),orthoScale:a[11],isPerspective:!a[12]};this.impl.setViewFromCamera(c)};
Autodesk.Viewing.Viewer3D.prototype.setViewFromViewBox=function(a,b){var c=this.model;if(c&&!c.is2d())console.warn("Autodesk.Viewing.Viewer3D.setViewFromViewBox is not applicable to 3D");else{if(b&&b.length){var c=c.getData().metadata.views,d;for(d=0;d<c.length&&c[d].name!=b;d++);d<c.length&&(c=c[d].layer_state)&&this.activateLayerState(c)}this.impl.setViewFromViewBox(this.model,a,b,!1)}};
Autodesk.Viewing.Viewer3D.prototype.activateLayerState=function(a){if(a&&a.length){var b=this.model.getData().metadata,c=b.layer_states;if(c){var d;for(d=0;d<c.length&&c[d].name!=a;d++);if(d<c.length){c=c[d].visible_layers;a={};if(c&&0<c.length)for(d=0;d<c.length;d++)a[c[d]]=1;c=[];d=[];for(var f in b.layers)1===a[b.layers[f].name]?c.push(f):d.push(f);this.impl.setLayerVisible(c,!0);this.impl.setLayerVisible(d,!1);this.fireEvent({type:Autodesk.Viewing.LAYER_VISIBILITY_CHANGED_EVENT})}}}};
Autodesk.Viewing.Viewer3D.prototype.getLayerStates=function(){function a(a,b){var c=Object.getOwnPropertyNames(a),d=Object.getOwnPropertyNames(b);if(c.length!==d.length)return!1;for(d=0;d<c.length;++d){var f=c[d];if(a[f]!==b[f])return!1}return!0}var b=this.model,c=(b=b?b.getData().metadata:null)?b.layers:null,b=b?b.layer_states:null;if(!c||!b)return null;var d,f={},g={},h;for(h in c)if(c.hasOwnProperty(h)){var k=parseInt(h);d=c[h];d="string"===typeof d?d:d.name;f[d]=!0;this.impl.isLayerVisible(k)&&
(g[d]=!0)}h=[];for(c=0;c<b.length;++c){var l=b[c],m=l.visible_layers,p={};if(!l.hidden){if(m&&0<m.length)for(k=0;k<m.length;++k)d=m[k],f.hasOwnProperty(d)&&(p[d]=!0);h.push({name:l.name,description:l.description,active:a(g,p)})}}return 0<h.length?h:null};Autodesk.Viewing.Viewer3D.prototype.setViewFromFile=function(){this.setActiveNavigationTool(this.model.is2d()?"pan":"orbit");this.impl.setViewFromFile(this.model)};
Autodesk.Viewing.Viewer3D.prototype.getProperties=function(a,b,c){this.model?this.model.getProperties(a,b,c):c&&c(Autodesk.Viewing.ErrorCodes.BAD_DATA,"Properties failed to load since model does not exist.")};Autodesk.Viewing.Viewer3D.prototype.getObjectTree=function(a,b){this.model?this.model.getObjectTree(a,b):b&&b(Autodesk.Viewing.ErrorCodes.BAD_DATA,"ObjectTree failed to load since model does not exist.")};
Autodesk.Viewing.Viewer3D.prototype.setCanvasClickBehavior=function(a){this.impl.controls.hasOwnProperty("setClickBehavior")&&this.impl.controls.setClickBehavior(a);this.clickHandler&&this.clickHandler.setClickBehavior(a)};Autodesk.Viewing.Viewer3D.prototype.search=function(a,b,c){this.searchText=a;this.model?this.model.search(a,b,c):c&&c(Autodesk.Viewing.ErrorCodes.BAD_DATA,"Search failed since model does not exist.")};Autodesk.Viewing.Viewer3D.prototype.getHiddenNodes=function(){return this.impl.visibilityManager.getHiddenNodes()};
Autodesk.Viewing.Viewer3D.prototype.getIsolatedNodes=function(){return this.model&&this.model.is2d()?(console.warn("Autodesk.Viewing.Viewer3D.getIsolatedNodes is not yet implemented for 2D"),[]):this.impl.visibilityManager.getIsolatedNodes()};
Autodesk.Viewing.Viewer3D.prototype.isolate=function(a){this.model&&this.model.is2d()?console.warn("Autodesk.Viewing.Viewer3D.isolate is not yet implemented for 2D"):Array.isArray(a)?this.impl.visibilityManager.isolateMultiple(a):(a==this.model.getRoot()&&(a=null),this.impl.visibilityManager.isolate(a))};
Autodesk.Viewing.Viewer3D.prototype.isolateById=function(a){function b(b){(d=f.model.getNodesByIds(Array.isArray(a)?a:[a]))&&f.isolate(d)}function c(a){f.getObjectTree(b);f.removeEventListener(Autodesk.Viewing.GEOMETRY_LOADED_EVENT,c)}if(this.model&&this.model.is2d())console.warn("Autodesk.Viewing.Viewer3D.isolateById is not yet implemented for 2D");else{var d=[],f=this;this.model&&this.model.isLoadDone()?this.getObjectTree(b):this.addEventListener(Autodesk.Viewing.GEOMETRY_LOADED_EVENT,c)}};
Autodesk.Viewing.Viewer3D.prototype.setBackgroundColor=function(a,b,c,d,f,g){this.impl.setClearColors(a,b,c,d,f,g)};Autodesk.Viewing.Viewer3D.prototype.toggleSelect=function(a){this.model&&this.model.is2d()?console.warn("Autodesk.Viewing.Viewer3D.toggleSelect is not yet implemented for 2D"):this.impl.selector.toggleSelectionId(a)};Autodesk.Viewing.Viewer3D.prototype.select=function(a){"number"===typeof a&&(a=[a]);this.impl.selector.setSelectionIds(a)};
Autodesk.Viewing.Viewer3D.prototype.deselect=function(a){throw Error("not implemented yet");};Autodesk.Viewing.Viewer3D.prototype.clearSelection=function(){this.impl.selector.clearSelection()};Autodesk.Viewing.Viewer3D.prototype.getSelectionVisibility=function(){return this.impl.selector.getSelectionVisibility()};Autodesk.Viewing.Viewer3D.prototype.getSelectionCount=function(){return this.impl.selector.getSelectionLength()};Autodesk.Viewing.Viewer3D.prototype.getSelection=function(){return this.impl.selector.getSelection()};
Autodesk.Viewing.Viewer3D.prototype.hide=function(a){this.model&&this.model.is2d()?console.warn("Autodesk.Viewing.Viewer3D.hide is not yet implemented for 2D"):Array.isArray(a)?this.impl.visibilityManager.hideMultiple(a):this.impl.visibilityManager.hide(a)};
Autodesk.Viewing.Viewer3D.prototype.hideById=function(a){this.model&&this.model.is2d()?console.warn("Autodesk.Viewing.Viewer3D.hideById is not yet implemented for 2D"):(a=this.model?this.model.getNodesByIds(Array.isArray(a)?a:[a]):null)&&0<a.length&&this.hide(a)};Autodesk.Viewing.Viewer3D.prototype.show=function(a){this.model&&this.model.is2d()?console.warn("Autodesk.Viewing.Viewer3D.show is not yet implemented for 2D"):Array.isArray(a)?this.impl.visibilityManager.showMultiple(a):this.impl.visibilityManager.show(a)};
Autodesk.Viewing.Viewer3D.prototype.showAll=function(){this.impl.visibilityManager.isolateNone();this.model.is2d()&&this.setLayerVisible(null,!0)};Autodesk.Viewing.Viewer3D.prototype.toggleVisibility=function(a){this.model&&this.model.is2d()?console.warn("Autodesk.Viewing.Viewer3D.toggleVisibility is not yet implemented for 2D"):this.impl.visibilityManager.toggleVisibility(a)};Autodesk.Viewing.Viewer3D.prototype.areAllVisible=function(){return this.impl.visibilityManager.areAllVisible()};
Autodesk.Viewing.Viewer3D.prototype.explode=function(a){this.model&&this.model.is2d()?console.warn("Autodesk.Viewing.Viewer3D.explode is not applicable to 2D"):this.impl.explode(a)};Autodesk.Viewing.Viewer3D.prototype.getExplodeScale=function(){return this.model&&this.model.is2d()?(console.warn("Autodesk.Viewing.Viewer3D.getExplodeScale is not applicable to 2D"),0):this.impl.getExplodeScale()};
Autodesk.Viewing.Viewer3D.prototype.setQualityLevel=function(a,b){this.model&&this.model.is2d()?console.warn("Autodesk.Viewing.Viewer3D.setQualityLevel is not applicable to 2D"):(this.prefs.set("ambientShadows",a),this.prefs.set("antialiasing",b),this.impl.togglePostProcess(a,b))};Autodesk.Viewing.Viewer3D.prototype.setEnvironmentMap=function(a){this.model&&this.model.is2d()?console.warn("Autodesk.Viewing.Viewer3D.setEnvironmentMap is not applicable to 2D"):this.impl.setCubeMap(a)};
Autodesk.Viewing.Viewer3D.prototype.setGhosting=function(a){this.model&&this.model.is2d()?console.warn("Autodesk.Viewing.Viewer3D.setGhosting is not applicable to 2D"):(this.prefs.set("ghosting",a),this.impl.toggleGhosting(a))};Autodesk.Viewing.Viewer3D.prototype.setGroundShadow=function(a){this.model&&this.model.is2d()?console.warn("Autodesk.Viewing.Viewer3D.setGroundShadow is not applicable to 2D"):(this.prefs.set("groundShadow",a),this.impl.toggleGroundShadow(a))};
Autodesk.Viewing.Viewer3D.prototype.setProgressiveRendering=function(a){this.prefs.set("progressiveRendering",a);this.impl.toggleProgressive(a)};Autodesk.Viewing.Viewer3D.prototype.setOptimizeNavigation=function(a){this.model&&this.model.is2d()?console.warn("Autodesk.Viewing.Viewer3D.setOptimizeNaviation is not applicable to 2D"):(this.prefs.set("optimizeNavigation",a),this.impl.setOptimizeNavigation(a))};
Autodesk.Viewing.Viewer3D.prototype.getNavigationMode=function(){console.warn("Autodesk.Viewing.Viewer3D.getNavigationMode is deprecated. Please use Autodesk.Viewing.Viewer3D.getActiveNavigationTool instead.");return this.getActiveNavigationTool()};
Autodesk.Viewing.Viewer3D.prototype.setNavigationMode=function(a){console.warn("Autodesk.Viewing.Viewer3D.setNavigationMode is deprecated. Please use Autodesk.Viewing.Viewer3D.setActiveNavigationTool instead.");var b=null;switch(a){case Autodesk.Viewing.NAVIGATION_MODE.ORBIT:b="orbit";break;case Autodesk.Viewing.NAVIGATION_MODE.PAN:b="pan";break;case Autodesk.Viewing.NAVIGATION_MODE.DOLLY:b="dolly"}this.setActiveNavigationTool(b)};
Autodesk.Viewing.Viewer3D.prototype.setActiveNavigationTool=function(a){if(a===this._pushedTool||!a&&!this._pushedTool)return!0;if(this._pushedTool){if(!this.impl.controls.deactivateTool(this._pushedTool))return!1;this._pushedTool=null}return a&&a!==this.getDefaultNavigationToolName()||null!==this._pushedTool?this.impl.controls.activateTool(a)?(this._pushedTool=a,this.fireEvent({type:Autodesk.Viewing.NAVIGATION_MODE_CHANGED_EVENT,id:this._pushedTool}),!0):!1:(this.fireEvent({type:Autodesk.Viewing.NAVIGATION_MODE_CHANGED_EVENT,
id:this.getDefaultNavigationToolName()}),!0)};Autodesk.Viewing.Viewer3D.prototype.getActiveNavigationTool=function(){return this._pushedTool?this._pushedTool:this._defaultNavigationTool};
Autodesk.Viewing.Viewer3D.prototype.setDefaultNavigationTool=function(a){this._defaultNavigationTool&&this.impl.controls.deactivateTool(this._defaultNavigationTool);this._pushedTool&&this.impl.controls.deactivateTool(this._pushedTool);this.impl.controls.activateTool(a);this._defaultNavigationTool=a;this._pushedTool&&this.impl.controls.activateTool(this._pushedTool)};Autodesk.Viewing.Viewer3D.prototype.getDefaultNavigationToolName=function(){return this._defaultNavigationTool};
Autodesk.Viewing.Viewer3D.prototype.getFOV=function(){return this.navigation.getVerticalFov()};Autodesk.Viewing.Viewer3D.prototype.setFOV=function(a){this.navigation.setVerticalFov(a,!0)};Autodesk.Viewing.Viewer3D.prototype.getFocalLength=function(){return this.navigation.getFocalLength()};Autodesk.Viewing.Viewer3D.prototype.setFocalLength=function(a){this.navigation.setFocalLength(a,!0)};
Autodesk.Viewing.Viewer3D.prototype.hideLines=function(a){this.prefs.set("lineRendering",!a);if(!this.impl.hideLines(a)){var b=this,c=function(){b.impl.hideLines(a);b.removeEventListener(Autodesk.Viewing.GEOMETRY_LOADED_EVENT,c)};this.addEventListener(Autodesk.Viewing.GEOMETRY_LOADED_EVENT,c)}};Autodesk.Viewing.Viewer3D.prototype.applyCamera=function(a,b){this.impl.applyCamera(a,b)};
Autodesk.Viewing.Viewer3D.prototype.fitToView=function(a){var b=this,c=!0,d=function(){var g=null;if(Array.isArray(a)&&0<a.length){for(var k=new THREE.Box3,l=new THREE.Box3,m=[],p=0;p<a.length;p++)b.model.getNodeFragments(a[p],m);for(p=0;p<m.length;p++)if(void 0!==m[p]){var n=b.impl.getRenderProxy(b.model,m[p]);l.copy(n.geometry.boundingBox).applyMatrix4(n.matrixWorld);k.union(l)}k.empty()||(g=k)}if(!g||g.empty())g=b.impl.getFitBounds();b.navigation.fitBounds(!1,g);b.removeEventListener(Autodesk.Viewing.OBJECT_TREE_CREATED_EVENT,
f);b.removeEventListener(Autodesk.Viewing.GEOMETRY_LOADED_EVENT,d);return c},f=function(){b.model&&b.model.isLoadDone()?d():(c=!1,b.addEventListener(Autodesk.Viewing.GEOMETRY_LOADED_EVENT,d))},g=this.model.getData().propertydb,g=g&&0<g.attrs.length;!this.model.is2d()&&g&&null!==a&&void 0!==a?this.model&&this.model.isObjectTreeCreated()?f():(c=!1,this.addEventListener(Autodesk.Viewing.OBJECT_TREE_CREATED_EVENT,f)):this.navigation.fitBounds(!1,this.impl.getFitBounds(!0))};
Autodesk.Viewing.Viewer3D.prototype.setClickConfig=function(a,b,c){var d=this.clickHandler?this.clickHandler.getClickBehavior():this.impl.controls.getClickBehavior();return a in d&&(a=d[a],b in a)?(a[b]=c,!0):!1};Autodesk.Viewing.Viewer3D.prototype.getClickConfig=function(a,b){var c=this.clickHandler?this.clickHandler.getClickBehavior():this.impl.controls.getClickBehavior();return a in c&&(c=c[a],b in c)?c[b]:null};
Autodesk.Viewing.Viewer3D.prototype.setClickToSetCOI=function(a,b){!1!==b&&this.prefs.set("clickToSetCOI",a);var c=this.getClickConfig("click","onObject");a?-1===c.indexOf("setCOI")&&this.setClickConfig("click","onObject",["setCOI"]):0<=c.indexOf("setCOI")&&this.setClickConfig("click","onObject",["selectOnly"])};
Autodesk.Viewing.Viewer3D.prototype.setModelStructurePanel=function(a){var b=this;if(a instanceof Autodesk.Viewing.UI.ModelStructurePanel||null===a){this.modelstructure&&(this.modelstructure.setVisible(!1),this.removePanel(this.modelstructure),this.modelstructure.uninitialize());if(this.modelstructure=a)this.addPanel(this.modelstructure),b.model&&b.model.getObjectTree(function(a){b.modelstructure.setModel(a)});return!0}return!1};
Autodesk.Viewing.Viewer3D.prototype.setLayersPanel=function(a){return this.model&&!this.model.is2d()?(console.warn("Autodesk.Viewing.Viewer3D.setLayersPanel is not yet implemented for 3D"),!1):a instanceof Autodesk.Viewing.UI.LayersPanel||!a?(this.layersPanel&&(this.layersPanel.setVisible(!1),this.removePanel(this.layersPanel),this.layersPanel.uninitialize()),(this.layersPanel=a)&&this.addPanel(a),!0):!1};
Autodesk.Viewing.Viewer3D.prototype.setPropertyPanel=function(a){return a instanceof Autodesk.Viewing.UI.PropertyPanel||!a?(this.propertygrid&&(this.propertygrid.setVisible(!1),this.removePanel(this.propertygrid),this.propertygrid.uninitialize()),(this.propertygrid=a)&&this.addPanel(a),!0):!1};
Autodesk.Viewing.Viewer3D.prototype.setSettingsPanel=function(a){return a instanceof Autodesk.Viewing.UI.SettingsPanel||!a?(this.viewerSettingsPanel&&(this.viewerSettingsPanel.setVisible(!1),this.removePanel(this.viewerSettingsPanel),this.viewerSettingsPanel.uninitialize()),(this.viewerSettingsPanel=a)&&this.addPanel(a),!0):!1};
Autodesk.Viewing.Viewer3D.prototype.initSettings=function(){var a=isIOSDevice()||isAndroidDevice();this.prefs.load({ambientShadows:!a,antialiasing:!a,groundShadow:!0,progressiveRendering:!0,environmentMap:!1,openPropertiesOnSelect:!1,ghosting:!0,viewCube:!a,lineRendering:!0,lightPreset:Autodesk.Viewing.Private.DefaultLightPreset,backgroundColorPreset:null,reverseMouseZoomDir:!1,reverseHorizontalLookDirection:!1,reverseVerticalLookDirection:!1,alwaysUsePivot:!1,zoomTowardsPivot:!1,orbitPastWorldPoles:!0,
leftHandedMouseSetup:!1,clickToSetCOI:a,optimizeNavigation:!1});this.prefs.tag("3d");this.prefs.tag("2d");this.prefs.untag("2d","viewCube alwaysUsePivot zoomTowardsPivot reverseHorizontalLookDirection reverseVerticalLookDirection orbitPastWorldPoles clickToSetCOI ghosting optimizeNavigation ambientShadows antialiasing groundShadow lineRendering lightPreset".split(" "));this.setQualityLevel(this.prefs.ambientShadows,this.prefs.antialiasing);this.setGroundShadow(this.prefs.groundShadow);this.setGhosting(this.prefs.ghosting);
this.setProgressiveRendering(this.prefs.progressiveRendering);this.setClickToSetCOI(this.prefs.clickToSetCOI);this.setOptimizeNavigation(this.prefs.optimizeNavigation);this.hideLines(!this.prefs.lineRendering);this.navigation.setUsePivotAlways(this.prefs.alwaysUsePivot);this.navigation.setReverseZoomDirection(this.prefs.reverseMouseZoomDir);this.navigation.setReverseHorizontalLookDirection(this.prefs.reverseHorizontalLookDirection);this.navigation.setReverseVerticalLookDirection(this.prefs.reverseVerticalLookDirection);
this.navigation.setZoomTowardsPivot(this.prefs.zoomTowardsPivot);this.navigation.setOrbitPastWorldPoles(this.prefs.orbitPastWorldPoles);this.navigation.setUseLeftHandedInput(this.prefs.leftHandedMouseSetup);if(a=this.prefs.backgroundColorPreset)try{var b=JSON.parse(a);this.impl.setClearColors(b[0],b[1],b[2],b[3],b[4],b[5])}catch(c){this.prefs.set("backgroundColorPreset",null)}this.impl.setLightPreset(this.prefs.lightPreset)};
Autodesk.Viewing.Viewer3D.prototype.setLightPreset=function(a){this.model&&this.model.is2d()?console.warn("Autodesk.Viewing.Viewer3D.setLightPreset is not applicable to 2D"):(this.prefs.set("lightPreset",a),this.impl.setLightPreset(a))};Autodesk.Viewing.Viewer3D.prototype.setUsePivotAlways=function(a){this.prefs.set("alwaysUsePivot",a);this.navigation.setUsePivotAlways(a)};Autodesk.Viewing.Viewer3D.prototype.setReverseZoomDirection=function(a){this.prefs.set("reverseMouseZoomDir",a);this.navigation.setReverseZoomDirection(a)};
Autodesk.Viewing.Viewer3D.prototype.setReverseHorizontalLookDirection=function(a){this.model&&this.model.is2d()?console.warn("Autodesk.Viewing.Viewer3D.setReverseHorizontalLookDirection is not applicable to 2D"):(this.prefs.set("reverseHorizontalLookDirection",a),this.navigation.setReverseHorizontalLookDirection(a))};
Autodesk.Viewing.Viewer3D.prototype.setReverseVerticalLookDirection=function(a){this.model&&this.model.is2d()?console.warn("Autodesk.Viewing.Viewer3D.setReverseVerticalLookDirection is not applicable to 2D"):(this.prefs.set("reverseVerticalLookDirection",a),this.navigation.setReverseVerticalLookDirection(a))};Autodesk.Viewing.Viewer3D.prototype.setZoomTowardsPivot=function(a){this.prefs.set("zoomTowardsPivot",a);this.navigation.setZoomTowardsPivot(a)};
Autodesk.Viewing.Viewer3D.prototype.setOrbitPastWorldPoles=function(a){this.model&&this.model.is2d()?console.warn("Autodesk.Viewing.Viewer3D.setOrbitPastWorldPoles is not applicable to 2D"):(this.prefs.set("orbitPastWorldPoles",a),this.navigation.setOrbitPastWorldPoles(a))};Autodesk.Viewing.Viewer3D.prototype.setUseLeftHandedInput=function(a){this.prefs.set("leftHandedMouseSetup",a);this.navigation.setUseLeftHandedInput(a)};
Autodesk.Viewing.Viewer3D.prototype.preContextMenuShow=function(a){var b=this.impl.castRay(a.clientX,a.clientY).node,c;b?this.impl.selector.isSelectedOrParentIsSelected(b)||(a.ctrlKey||a.metaKey||a.shiftKey?(c=this.impl.selector.getSelection(),c.push(b)):c=[b]):c=[];c&&this.impl.selector.setSelection(c);return!0};
Autodesk.Viewing.Viewer3D.prototype.setLayerVisible=function(a,b,c){function d(a,b){var c=[];if(a.isLayer)c.push(a.index);else for(var f=a.children,m=0;m<f.length;++m)c=c.concat(d(f[m]));return c}if(this.model&&!this.model.is2d())console.warn("Autodesk.Viewing.Viewer3D.setLayerVisible is not yet implemented for 3D");else{var f=this.model.getLayersRoot();if(f&&0!==f.childCount){null===a&&(a=[f]);Array.isArray(a)||(a=[a]);c&&(this.impl.setLayerVisible(d(f),!1),b=!0);c=[];for(f=0;f<a.length;++f)c=c.concat(d(a[f]));
this.impl.setLayerVisible(c,b);this.fireEvent({type:Autodesk.Viewing.LAYER_VISIBILITY_CHANGED_EVENT})}}};Autodesk.Viewing.Viewer3D.prototype.isLayerVisible=function(a){return this.model&&!this.model.is2d()?(console.warn("Autodesk.Viewing.Viewer3D.isLayerVisible is not yet implemented for 3D"),!1):!!(a&&a.isLayer&&this.impl.isLayerVisible(a.index))};
Autodesk.Viewing.Viewer3D.prototype.anyLayerHidden=function(){function a(c){if(c.isLayer)return!b.impl.isLayerVisible(c.index);c=c.children;for(var f=0;f<c.length;++f)if(a(c[f]))return!0;return!1}if(this.model&&!this.model.is2d())return console.warn("Autodesk.Viewing.Viewer3D.anyLayerHidden is not yet implemented for 3D"),0;var b=this,c=b.model.getLayersRoot();return!(!c||!a(c))};Autodesk.Viewing.BaseViewer3D=Autodesk.Viewing.Viewer3D;AutodeskNamespace("Autodesk.Viewing");
Autodesk.Viewing.ErrorCodes={UNKNOWN_FAILURE:1,BAD_DATA:2,NETWORK_FAILURE:3,NETWORK_ACCESS_DENIED:4,NETWORK_FILE_NOT_FOUND:5,NETWORK_SERVER_ERROR:6,NETWORK_UNHANDLED_RESPONSE_CODE:7,BROWSER_WEBGL_NOT_SUPPORTED:8,BAD_DATA_NO_VIEWABLE_CONTENT:9,BROWSER_WEBGL_DISABLED:10,RTC_ERROR:11};AutodeskNamespace("Autodesk.Viewing");Autodesk.Viewing.Viewer2D=function(a,b){Autodesk.Viewing.Viewer.call(this,a,b);b||(b={});b.domElement=this.container;this.impl=new Autodesk.Viewing.Private.Viewer2DImpl(this,b)};
Autodesk.Viewing.Viewer2D.prototype=Object.create(Autodesk.Viewing.Viewer.prototype);Autodesk.Viewing.Viewer2D.prototype.constructor=Autodesk.Viewing.Viewer2D;Autodesk.Viewing.Viewer2D.prototype.initialize=function(){Autodesk.Viewing.Viewer.prototype.initialize.call(this);return this.impl.initialize()};Autodesk.Viewing.Viewer2D.prototype.load=function(a,b,c,d){if(this.impl.load(a))return c&&c(),!0;d&&d();return!1};
Autodesk.Viewing.Viewer2D.prototype.uninitialize=function(){this.impl.uninitialize();Autodesk.Viewing.Viewer.prototype.uninitialize.call(this)};Autodesk.Viewing.Viewer2D.prototype.resize=function(){Autodesk.Viewing.Viewer.prototype.resize.call(this);this.impl.resize()};Autodesk.Viewing.Viewer2D.prototype.setViewFromFile=function(){this.impl.goHome()};AutodeskNamespace("Autodesk.Viewing");Autodesk.Viewing.HTTP_REQUEST_HEADERS={};Autodesk.Viewing.ACM_SESSION_ID;
Autodesk.Viewing.Document=function(a,b){function c(a){if(a){var b=a.children?a.children.length:0;if("geometry"===a.type&&b){for(var d=0,l=0;l<b;l++){var m=a.children[l];m&&"view"===m.type&&(f.myViewGeometry[m.guid]=a,d++)}f.myNumViews[a.guid]=d}else if("application/autodesk-db"==a.mime&&a.urn)f.myPropertyDb=a.urn.substr(0,a.urn.lastIndexOf("/")+1);else if(0<b)for(l=0;l<b;l++)c(a.children[l])}}function d(a,b,c){if(a){var f=a.guid;if(f){c.apply(this,[f,b]);b=a.children?a.children.length:0;for(var m=
0;m<b;m++)d(a.children[m],f,c)}}}this.myPath=b;this.myData=a;this.myViewGeometry={};this.myNumViews={};this.myPropertyDb=null;var f=this;c(a);this.parents={};d(this.myData,null,function(a,b){f.parents[a]=b})};Autodesk.Viewing.Document.prototype.constructor=Autodesk.Viewing.Document;
Autodesk.Viewing.Document.load=function(a,b,c,d){function f(a){var b={},c;for(c in a)-1!=c.indexOf("x-ads-acm")&&(b[c]=a[c]);return b}function g(a){for(var b in a)if("oauth2AccessToken"===b)return a[b];return null}function h(a,b){a.application="autodesk";var d=new XMLHttpRequest;d.open("POST",ACM_SESSION_URL,!0);d.setRequestHeader("Content-Type","application/json");d.setRequestHeader("Authorization","Bearer "+b);d.onload=function(){200===d.status&&(Autodesk.Viewing.ACM_SESSION_ID=JSON.parse(d.responseText).acmsession);
m()};d.onerror=c;d.ontimeout=c;d.send(JSON.stringify(a));delete a.application}function k(a){return-1===a.indexOf("urn:")?(0!==a.indexOf("/")&&(a="/"+a),window.location.protocol+"//"+window.location.host+a):a}function l(a){var b=[],c=null;if(!a||!a.children)return b;if(a=1===a.children.length?a.children[0]:null)c=a.messages;a=c?c.length:0;for(var d=0;d<a;d++)b.push(c[d]);return b}function m(){var d=k(a);try{(new Autodesk.Viewing.Private.ViewingServiceXhr(VIEWING_URL,"bubbles",{encodeUrn:!1})).get(d,
function(a){if(/<[^>]*script/.test(a))c&&c(Autodesk.Viewing.ErrorCodes.BAD_DATA,"Malicious document content detected. Abort loading.");else{a="string"===typeof a?JSON.parse(a):a;a=new Autodesk.Viewing.Document(a,d);var f=Autodesk.Viewing.Document.getSubItemsWithProperties(a.getRootItem(),{type:"folder",role:"viewable"},!0)[0];0<Autodesk.Viewing.Document.getSubItemsWithProperties(f,{type:"geometry"},!0).length?(f=l(a.getRootItem()),b&&b(a,f)):c&&(f=l(a.getRootItem()),c(Autodesk.Viewing.ErrorCodes.BAD_DATA_NO_VIEWABLE_CONTENT,
"No viewable content.",f))}},function(a,b,d){"string"===typeof d&&JSON.parse(d);d=l(d);c&&(b="Error: "+a+" ("+b+")",a=Autodesk.Viewing.Private.ErrorHandler.getErrorCode(a),c(a,b,d))},{headers:Autodesk.Viewing.HTTP_REQUEST_HEADERS})}catch(f){c&&c(Autodesk.Viewing.ErrorCodes.UNKNOWN_FAILURE,"An exception occurred while loading the document: "+f.toString(),null)}}"function"!==typeof b&&(console.log("Autodesk.Viewing.Document.load called with deprecated (auth) parameter"),"function"===typeof c&&(b=c),
"function"===typeof d&&(c=d));if(d){var p=f(d);d=g(d);Autodesk.Viewing.HTTP_REQUEST_HEADERS=p;h(p,d)}else m()};Autodesk.Viewing.Document.prototype.getFullPath=function(a){if(!a)return a;var b=a;0===a.indexOf("urn")?b=VIEWING_URL+"/items/"+a:0===a.indexOf("$file$")&&-1!==this.myPath.indexOf("/output/bubble.json")&&(b=this.myPath.replace("/output/bubble.json","")+a.replace("$file$",""));return b};
Autodesk.Viewing.Document.prototype.getThumbnailPath=function(a,b,c){b=b?b:200;c=c?c:200;a=VIEWING_URL+"/thumbnails/"+this.myData.urn+"?guid="+encodeURIComponent(a.guid)+"&width="+b+"&height="+c;Autodesk.Viewing.ACM_SESSION_ID&&(a+="&acmsession="+Autodesk.Viewing.ACM_SESSION_ID);return a};
Autodesk.Viewing.Document.prototype.getViewablePath=function(a){if("geometry"===a.type){var b=[];"3d"===a.role?b=Autodesk.Viewing.Document.getSubItemsWithProperties(a,{mime:"application/autodesk-svf"},!1):"2d"===a.role&&(b=Autodesk.Viewing.Document.getSubItemsWithProperties(a,{mime:"application/autodesk-f2d"},!1),0==b.length&&(b=Autodesk.Viewing.Document.getSubItemsWithProperties(a,{role:"tileRoot"},!0)));if(0<b.length)return this.getFullPath(b[0].urn)}else if("view"===a.type&&(a=this.getViewGeometry(a)))return this.getViewablePath(a);
return""};Autodesk.Viewing.Document.prototype.getPropertyDbPath=function(){return this.myPropertyDb};Autodesk.Viewing.Document.prototype.getRootItem=function(){return this.myData};Autodesk.Viewing.Document.prototype.getPath=function(){return this.myPath};Autodesk.Viewing.Document.prototype.getItemById=function(a){function b(c){if(!c)return null;for(var d in c){var f=c[d];if("guid"===d&&f===a)return c;if(null!==f&&"object"===typeof f&&(f=b(f)))return f}return null}return b(this.myData)};
Autodesk.Viewing.Document.getSubItemsWithProperties=function(a,b,c){var d=[];if(!a)return[];for(var f=a.children?a.children.length:0,g=0;g<f;g++){var h=a.children[g],k;a:{k=b;var l=void 0;for(l in k)if(!(l in h)||k[l]!==h[l]){k=!1;break a}k=!0}k&&d.push(h);c&&d.push.apply(d,Autodesk.Viewing.Document.getSubItemsWithProperties(h,b,c))}return d};Autodesk.Viewing.Document.prototype.getViewGeometry=function(a){return this.myViewGeometry[a.guid]};
Autodesk.Viewing.Document.prototype.getNumViews=function(a){return this.myNumViews[a.guid]||0};Autodesk.Viewing.Document.prototype.getParentId=function(a){return this.parents[a]};Autodesk.Viewing.Document.prototype.getMessages=function(a,b){var c=[];if(!a)return c;var d=null;b&&(d=this.getRootItem().guid);for(var f=a,g=this.parents[f];f&&(!b||g!==d);){if((f=this.getItemById(f))&&f.messages)for(var h=0;h<f.messages.length;h++)c.push(f.messages[h]);f=g;g=this.parents[f]}return c};AutodeskNamespace("Autodesk.Viewing");
Autodesk.Viewing.ModelUnits={METER:"m",CENTIMETER:"cm",MILLIMETER:"mm",FOOT:"ft",INCH:"in"};Autodesk.Viewing.Model=function(a){this.myData=a;this.myLoader=this.propWorker=this.sharedPath=null};Autodesk.Viewing.Model.prototype=Object.create(THREE.EventDispatcher.prototype);Autodesk.Viewing.Model.prototype.constructor=Autodesk.Viewing.Model;Autodesk.Viewing.Model.prototype.setData=function(a){this.myData=a};Autodesk.Viewing.Model.prototype.getData=function(){return this.myData};
Autodesk.Viewing.Model.prototype.setLoader=function(a){this.myLoader=a};Autodesk.Viewing.Model.prototype.getRoot=function(){return this.is2d()?(console.warn("Autodesk.Viewing.Model.getRoot is not yet implemented for 2D"),null):this.myData?this.myData.instanceTree:null};Autodesk.Viewing.Model.prototype.getRootId=function(){return this.is2d()?(console.warn("Autodesk.Viewing.Model.getRootId is not yet implemented for 2D"),null):this.myData&&this.myData.instanceTree?this.myData.instanceTree.dbId:null};
Autodesk.Viewing.Model.prototype.getBoundingBox=function(){return this.myData?this.myData.bbox:null};Autodesk.Viewing.Model.prototype.getUnitScale=function(){switch(this.getMetadata("distance unit","value",null)){case "meter":case "m":return 1;case "foot":case "ft":return 0.3048;case "inch":case "in":return 0.0254;case "centimeter":case "cm":return 0.01;case "millimeter":case "mm":return 0.0010;default:return 1}};
Autodesk.Viewing.Model.prototype.getUnitString=function(){switch(this.getMetadata("distance unit","value",null)){case "meter":case "m":return Autodesk.Viewing.ModelUnits.METER;case "foot":case "ft":return Autodesk.Viewing.ModelUnits.FOOT;case "inch":case "in":return Autodesk.Viewing.ModelUnits.INCH;case "centimeter":case "cm":return Autodesk.Viewing.ModelUnits.CENTIMETER;case "millimeter":case "mm":return Autodesk.Viewing.ModelUnits.MILLIMETER;default:return null}};
Autodesk.Viewing.Model.prototype.getNodeById=function(a){function b(c){if(!c)return null;if(c.dbId&&c.dbId===a)return c;if(c.children&&0<c.children.length)for(var d=0;d<c.children.length;d++){var f=b(c.children[d]);if(f)return f}return null}return this.is2d()?(console.warn("Autodesk.Viewing.Model.getNodeById is not yet implemented for 2D"),null):b(this.getRoot())};
Autodesk.Viewing.Model.prototype.getNodesByIds=function(a){function b(a,d,f){if(0===a.length)return f;var g=a.indexOf(d.dbId);-1!==g&&(f.push(d),a.splice(g,1));if(d.children)for(g=0;g<d.children.length;g++)b(a,d.children[g],f);return f}a=a.slice(0);return b(a,this.getRoot(),[])};
Autodesk.Viewing.Model.prototype.getNodeFragments=function(a,b){function c(a,b){var d=a.fragIds;if(void 0!==d){Array.isArray(d)||(d=[d]);for(var k=0;k<d.length;++k)b.push(d[k])}if(a.children)for(d=0;d<a.children.length;d++)c(a.children[d],b)}var d=this.getNodeById(a);c(d,b)};Autodesk.Viewing.Model.prototype.getMetadata=function(a,b,c){if(this.myData){var d=this.myData.metadata;if(d&&(a=d[a],void 0!==a))if(b){if(b=a[b],void 0!==b)return b}else return a}return c};
Autodesk.Viewing.Model.prototype.getDefaultCamera=function(){var a=this.myData;if(!a)return null;var b=null,c=a.cameras?a.cameras.length:0;if(0<c){var d=this.getMetadata("default camera","index",null);if(null!==d&&a.cameras[d])b=a.cameras[d];else{for(d=0;d<c;d++){var f=a.cameras[d];if(f.isPerspective){b=f;break}}b||(b=a.cameras[0])}}return b};Autodesk.Viewing.Model.prototype.getUpVector=function(){return this.getMetadata("world up vector","XYZ",null)};
Autodesk.Viewing.Model.prototype.geomPolyCount=function(){return this.myData?this.myData.geomPolyCount:null};Autodesk.Viewing.Model.prototype.instancePolyCount=function(){return this.myData?this.myData.instancePolyCount:null};Autodesk.Viewing.Model.prototype.getLayersRoot=function(){return this.is2d()?this.myData?this.myData.layersRoot:null:(console.warn("Autodesk.Viewing.Model.getLayersRoot is not yet implemented for 3D"),null)};
Autodesk.Viewing.Model.prototype.is2d=function(){return!(!this.myData||!this.myData.is2d)};Autodesk.Viewing.Model.prototype.isLoadDone=function(){return!(!this.myData||!this.myData.loadDone)};Autodesk.Viewing.Model.prototype.isObjectTreeCreated=function(){return!(!this.myData||!this.myData.fragToNodeDone)};Autodesk.Viewing.Model.prototype.getProperties=function(a,b,c){this.myData&&this.myLoader&&this.myLoader.getProperties(a,b,c)};
Autodesk.Viewing.Model.prototype.getObjectTree=function(a,b){this.myData&&this.myLoader&&this.myLoader.getObjectTree(a,b)};Autodesk.Viewing.Model.prototype.search=function(a,b,c){var d=this;this.isLoadDone()?this.myLoader.searchProperties(a,b,c):this.getObjectTree(function(f){d.myLoader.searchProperties(a,b,c)})};AutodeskNamespace("Autodesk.Viewing");
Autodesk.Viewing.Navigation=function(a){this.__options={dollyToPivot:!1,orbitPastPoles:!0,reverseDolly:!1,reverseHorizontalLook:!1,reverseVerticalLook:!1,useLeftHandedInput:!1,usePivotAlways:!1,lockNavigation:!1};this.__transitionActive=this.__homeViewRequested=this.__fitToViewRequested=this.__pivotIsSetFlag=!1;this.__destinationView=null;this.__isTouchDevice=this.__is2D=!1;this.__kEpsilon=1E-6;var b=null,c={left:0,top:0,width:1,height:1};this.uninitialize=function(){this.setCamera(null)};this.setCamera=
function(a){a!==b&&(b=a)&&(a.hasOwnProperty("target")||(a.target=new THREE.Vector3(0,0,0)),a.hasOwnProperty("pivot")||(a.pivot=new THREE.Vector3(0,0,0)),a.worldup=a.up.clone(),a.dirty=!0)};this.getCamera=function(){return b};this.setScreenViewport=function(a){c=a};this.getScreenViewport=function(){return c};this.__setUp=function(a){return a&&b&&0!==a.clone().normalize().sub(b.worldup).lengthSq()?(b.worldup.copy(a).normalize(),b.dirty=!0):!1};this.__getUp=function(){return b?b.worldup:new THREE.Vector3(0,
1,0)};this.setView=function(a,c){b&&a&&c&&!this.__options.lockNavigation&&(b.position.copy(a),b.target.copy(c),b.dirty=!0)};this.orientCameraUp=function(){b&&!this.__options.lockNavigation&&(b.up.copy(this.getAlignedUpVector()),b.dirty=!0)};this.getPivotPoint=function(){return b?b.pivot.clone():new THREE.Vector3(0,0,0)};this.setPivotPoint=function(a){b&&a&&!this.__options.lockNavigation&&(b.pivot.copy(a),b.dirty=!0)};this.getPosition=function(){return b?b.position.clone():new THREE.Vector3(0,0,1)};
this.setPosition=function(a){b&&a&&!this.__options.lockNavigation&&(b.position.copy(a),b.dirty=!0)};this.setTarget=function(a){b&&a&&!this.__options.lockNavigation&&(b.target.copy(a),b.dirty=!0)};this.getTarget=function(){return b?b.target.clone():new THREE.Vector3(0,0,0)};this.getEyeVector=function(){return b?b.target.clone().sub(b.position):new THREE.Vector3(0,0,-1)};this.getFovMin=function(){return 6.88};this.getFovMax=function(){return 100};this.isPointVisible=function(a){return(new THREE.Frustum).setFromMatrix(b.projectionMatrix.clone().multiply(b.matrixWorldInverse)).containsPoint(a)};
this.setVerticalFov=function(a,c){if(!b||b.isPerspective)if(6.88>a?a=6.88:100<a&&(a=100),b&&!this.__options.lockNavigation&&!(1E-6>=Math.abs(b.fov-a))){if(c){var g=this.__pivotIsSetFlag&&this.isPointVisible(this.getPivotPoint()),h=this.getPosition(),k=this.getEyeVector(),l=THREE.Math.degToRad(b.fov),m=THREE.Math.degToRad(a),p=g?this.getPivotPlaneDistance():k.length(),l=p*Math.tan(0.5*l)/Math.tan(0.5*m),k=k.normalize().multiplyScalar(p-l);this.setPosition(h.add(k));g&&this.setTarget(this.getTarget().add(k))}b.setFov(a);
b.dirty=!0}};this.computeFit=function(a,b,c,h){if(!h||h.empty())return{position:a,target:b};var k=h.center();h=h.size();h=0.5*Math.sqrt(h.x*h.x+h.y*h.y+h.z*h.z);0===h&&(h=1);if(!this.getIs2D()){var l=Math.max(1,0.9+c/100*0.5);h*=l}a=a.clone().sub(b).normalize();c=h/Math.tan(THREE.Math.degToRad(0.5*c));a.multiplyScalar(c);return{position:k.clone().add(a),target:k}};this.computeOrthogonalUp=function(a,b){var c=this.__getUp(),h=b.clone().sub(a);if(0===h.lengthSq())return h.copy(c);var k=h.clone().cross(c);
0===k.lengthSq()&&(c.z>c.y?h.y-=1E-4:h.z-=1E-4,k.crossVectors(h,c));return k.cross(h).normalize()};this.fitBounds=function(a,c,g){var h=this.getTarget(),k=this.getPosition();if(this.__options.lockNavigation||!c||c.empty())return{position:k,target:h};var l=this.getVerticalFov();c=this.computeFit(k,h,l,c);g=g?this.computeOrthogonalUp(k,h):b.up;a?(b.up.copy(g),this.setView(c.position,c.target)):this.setRequestTransitionWithUp(!0,c.position,c.target,l,g);this.setPivotPoint(c.target);this.setPivotSetFlag(!0);
return c};this.updateCamera=function(){b&&(b.updateProjectionMatrix(),this.orient(b,b.target,b.position,b.up),b.dirty=!1)};this.setCamera(a)};Autodesk.Viewing.Navigation.prototype.constructor=Autodesk.Viewing.Navigation;Autodesk.Viewing.Navigation.prototype.setIs2D=function(a){this.__is2D=!!a};Autodesk.Viewing.Navigation.prototype.getIs2D=function(){return this.__is2D};Autodesk.Viewing.Navigation.prototype.setIsTouchDevice=function(a){this.__isTouchDevice=!!a};
Autodesk.Viewing.Navigation.prototype.getIsTouchDevice=function(){return this.__isTouchDevice};
Autodesk.Viewing.Navigation.prototype.orient=function(){var a=new THREE.Matrix4,b=new THREE.Vector3,c=new THREE.Vector3,d=new THREE.Vector3;return function(f,g,h,k){var l=a.elements;d.subVectors(h,g).normalize();0===d.lengthSq()&&(d.z=1);b.crossVectors(k,d).normalize();0===b.lengthSq()&&(k.z>k.y?d.y-=1E-4:d.z+=1E-4,b.crossVectors(k,d).normalize());c.crossVectors(d,b);l[0]=b.x;l[4]=c.x;l[8]=d.x;l[1]=b.y;l[5]=c.y;l[9]=d.y;l[2]=b.z;l[6]=c.z;l[10]=d.z;f.setRotationFromMatrix(a)}}();
Autodesk.Viewing.Navigation.prototype.fov2fl=function(a){a=THREE.Math.degToRad(a);0>=a&&(a=1E-4);return Math.round(12/Math.tan(0.5*a))};Autodesk.Viewing.Navigation.prototype.fl2fov=function(a){0>=a&&(a=1E-4);a=2*Math.atan(12/a);return THREE.Math.radToDeg(a)};Autodesk.Viewing.Navigation.prototype.setCameraUpVector=function(a){if(!this.__options.lockNavigation){var b=this.getCamera();b.up.copy(a);b.dirty=!0}};
Autodesk.Viewing.Navigation.prototype.getCameraUpVector=function(){var a=this.getCameraRightVector(!1),b=this.getEyeVector();return a.cross(b).normalize()};Autodesk.Viewing.Navigation.prototype.getAlignedUpVector=function(){var a=this.getCameraRightVector(!0),b=this.getEyeVector();return a.cross(b).normalize()};
Autodesk.Viewing.Navigation.prototype.getCameraRightVector=function(a){var b=new THREE.Vector3;a=a?this.getWorldUpVector():this.getCamera().up;var c=this.getEyeVector();b.crossVectors(c,a);0===b.lengthSq()&&(a.z>a.y?c.y-=1E-4:c.z+=1E-4,b.crossVectors(c,a));return b.normalize()};Autodesk.Viewing.Navigation.prototype.setWorldUpVector=function(a,b){this.__options.lockNavigation||(this.__setUp(a),b&&this.orientCameraUp())};Autodesk.Viewing.Navigation.prototype.getWorldUpVector=function(){return this.__getUp().clone()};
Autodesk.Viewing.Navigation.prototype.getWorldRightVector=function(){var a=new THREE.Vector3;a.copy(this.__getUp());Math.abs(a.z)<=Math.abs(a.y)?a.set(a.y,-a.x,0):0<=a.z?a.set(a.z,0,-a.x):a.set(-a.z,0,a.x);return a.normalize()};Autodesk.Viewing.Navigation.prototype.getVerticalFov=function(){return this.getCamera().fov};Autodesk.Viewing.Navigation.prototype.getHorizontalFov=function(){var a=this.getScreenViewport();return this.getCamera().fov*(a.width/a.height)};
Autodesk.Viewing.Navigation.prototype.getFocalLength=function(){return this.fov2fl(this.getVerticalFov())};Autodesk.Viewing.Navigation.prototype.setFocalLength=function(a,b){this.setVerticalFov(this.fl2fov(a),b)};Autodesk.Viewing.Navigation.prototype.setReverseZoomDirection=function(a){this.__options.reverseDolly=!!a};
Autodesk.Viewing.Navigation.prototype.setReverseHorizontalLookDirection=function(a){this.getIs2D()?console.warn("Autodesk.Viewing.Navigation.setReverseHorizontalLookDirection is not applicable to 2D"):this.__options.reverseHorizontalLookDirection=!!a};Autodesk.Viewing.Navigation.prototype.setReverseVerticalLookDirection=function(a){this.getIs2D()?console.warn("Autodesk.Viewing.Navigation.setReverseVerticalLookDirection is not applicable to 2D"):this.__options.reverseVerticalLookDirection=!!a};
Autodesk.Viewing.Navigation.prototype.getReverseZoomDirection=function(){return this.__options.reverseDolly};Autodesk.Viewing.Navigation.prototype.getReverseHorizontalLookDirection=function(){return this.getIs2D()?(console.warn("Autodesk.Viewing.Navigation.getReverseHorizontalLookDirection is not applicable to 2D"),!1):this.__options.reverseHorizontalLookDirection};
Autodesk.Viewing.Navigation.prototype.getReverseVerticalLookDirection=function(){return this.getIs2D()?(console.warn("Autodesk.Viewing.Navigation.getReverseVerticalLookDirection is not applicable to 2D"),!1):this.__options.reverseVerticalLookDirection};Autodesk.Viewing.Navigation.prototype.setZoomTowardsPivot=function(a){this.__options.dollyToPivot=!!a};Autodesk.Viewing.Navigation.prototype.getZoomTowardsPivot=function(){return this.__options.dollyToPivot};
Autodesk.Viewing.Navigation.prototype.setOrbitPastWorldPoles=function(a){this.getIs2D()?console.warn("Autodesk.Viewing.Navigation.setOrbitPastWorldPoles is not applicable to 2D"):this.__options.orbitPastPoles=!!a};Autodesk.Viewing.Navigation.prototype.getOrbitPastWorldPoles=function(){return this.getIs2D()?(console.warn("Autodesk.Viewing.Navigation.orbitPastWorldPoles is not applicable to 2D"),!1):this.__options.orbitPastPoles};
Autodesk.Viewing.Navigation.prototype.setUsePivotAlways=function(a){this.__options.usePivotAlways=!!a};Autodesk.Viewing.Navigation.prototype.getUsePivotAlways=function(){return this.__options.usePivotAlways};Autodesk.Viewing.Navigation.prototype.setUseLeftHandedInput=function(a){this.__options.useLeftHandedInput=!!a};Autodesk.Viewing.Navigation.prototype.getUseLeftHandedInput=function(){return this.__options.useLeftHandedInput};
Autodesk.Viewing.Navigation.prototype.setIsLocked=function(a){this.__options.lockNavigation=!!a};Autodesk.Viewing.Navigation.prototype.getIsLocked=function(){return this.__options.lockNavigation};Autodesk.Viewing.Navigation.prototype.setPivotSetFlag=function(a){this.__options.lockNavigation||(this.__pivotIsSetFlag=!!a)};Autodesk.Viewing.Navigation.prototype.getPivotSetFlag=function(){return this.__pivotIsSetFlag};
Autodesk.Viewing.Navigation.prototype.setRequestFitToView=function(a){this.__options.lockNavigation||(this.__fitToViewRequested=!!a)};Autodesk.Viewing.Navigation.prototype.getRequestFitToView=function(){return this.__fitToViewRequested};Autodesk.Viewing.Navigation.prototype.setRequestHomeView=function(a){this.__options.lockNavigation||(this.__homeViewRequested=!!a)};Autodesk.Viewing.Navigation.prototype.getRequestHomeView=function(){return this.__homeViewRequested};
Autodesk.Viewing.Navigation.prototype.setRequestTransition=function(a,b,c,d,f){this.__destinationView=a?{position:b.clone(),coi:c.clone(),fov:d,up:this.getCamera().up.clone(),worldUp:this.getWorldUpVector(),reorient:f}:null};Autodesk.Viewing.Navigation.prototype.setRequestTransitionWithUp=function(a,b,c,d,f,g){this.__destinationView=a?{position:b.clone(),coi:c.clone(),fov:d,up:f.clone(),worldUp:g?g:this.getWorldUpVector(),reorient:!1}:null};
Autodesk.Viewing.Navigation.prototype.getRequestTransition=function(){return this.__destinationView};Autodesk.Viewing.Navigation.prototype.setTransitionActive=function(a){this.__transitionActive=!!a};Autodesk.Viewing.Navigation.prototype.getTransitionActive=function(){return this.__transitionActive};
Autodesk.Viewing.Navigation.prototype.getWorldSize=function(a){var b=this.getScreenViewport(),b=b.width/b.height;a=2*a*Math.tan(THREE.Math.degToRad(0.5*this.getCamera().fov));return new THREE.Vector2(a*b,a)};
Autodesk.Viewing.Navigation.prototype.getWorldPoint=function(a,b){a=2*a-1;b=2*(1-b)-1;var c=this.getCamera(),d;c.isPerspective&&(d=new THREE.Vector3(a,b,1),d=d.unproject(c));var f=this.getEyeVector(),g=this.getPosition();if(!c.isPerspective||isNaN(d.x)){var h=this.getWorldSize(f.length());d=this.getCameraRightVector(!1).multiplyScalar(0.5*a*h.x);h=this.getCameraUpVector().multiplyScalar(0.5*b*h.y);d=f.clone().add(d).add(h).normalize()}else d=d.sub(g).normalize();h=this.getPivotPoint();this.__pivotIsSetFlag&&
(this.getIs2D()||c.isPerspective&&this.isPointVisible(h))?(c=d.dot(f),f=0!==c?Math.abs(h.sub(g).dot(f))/c:h.sub(g).length()):f=c.isPerspective?0.5*(c.near+c.far):c.orthoScale;return d.multiplyScalar(f).add(g)};Autodesk.Viewing.Navigation.prototype.getPivotPlaneDistance=function(){var a=this.getPivotPoint(),b=this.getEyeVector(),c=this.getPosition();return a.sub(c).dot(b.normalize())};
Autodesk.Viewing.Navigation.prototype.panRelative=function(a,b,c){c=this.getWorldSize(c);a*=c.x;b*=c.y;a=this.getCameraRightVector(!1).multiplyScalar(a);b=this.getCameraUpVector().multiplyScalar(b);b=a.add(b);this.setView(this.getPosition().add(b),this.getTarget().add(b))};
Autodesk.Viewing.Navigation.prototype.dollyFromPoint=function(a,b){if(!(Math.abs(a)<=this.__kEpsilon)){var c=this.getPosition(),c=b.clone().sub(c),d=c.length(),f=d+a,g=10*this.__kEpsilon;f<g&&(f=g);d=f/d;Math.abs(d-1)>this.__kEpsilon&&(c.multiplyScalar(d),c.set(-c.x,-c.y,-c.z),c=c.add(b),f=this.getEyeVector(),this.getCamera().isPerspective||f.multiplyScalar(d),this.setView(c,f.add(c)))}};
Autodesk.Viewing.Navigation.prototype.toPerspective=function(){if(this.getIs2D())console.warn("Autodesk.Viewing.Navigation.toPerspective is not applicable to 2D");else{var a=this.getCamera();this.__options.lockNavigation||a.isPerspective||(a.toPerspective(),a.dirty=!0)}};Autodesk.Viewing.Navigation.prototype.toOrthographic=function(){var a=this.getCamera();!this.__options.lockNavigation&&a.isPerspective&&(a.toOrthographic(),a.dirty=!0)};"use strict";AutodeskNamespace("Autodesk.Viewing");
Autodesk.Viewing.ViewingApplication=function(a,b){this.appContainerId=a;this.container=document.getElementById(a);this.options=b;this.myRegisteredViewers={};this.urn=this.myCurrentViewer=this.myDocument=null};Autodesk.Viewing.ViewingApplication.prototype.k3D="3D";Autodesk.Viewing.ViewingApplication.prototype.k2D="2D";
Autodesk.Viewing.ViewingApplication.prototype.registerViewer=function(a,b,c){c=c||{};this.options&&this.options.hasOwnProperty("disableBrowserContextMenu")&&!c.hasOwnProperty("disableBrowserContextMenu")&&(c.disableBrowserContextMenu=this.options.disableBrowserContextMenu);this.myRegisteredViewers[a]={};this.myRegisteredViewers[a].class=b;this.myRegisteredViewers[a].config=c};
Autodesk.Viewing.ViewingApplication.prototype.getViewerClass=function(a){return this.myRegisteredViewers.hasOwnProperty(a)?this.myRegisteredViewers[a].class:null};Autodesk.Viewing.ViewingApplication.prototype.getViewerContainer=function(){return document.getElementById(this.appContainerId)};
Autodesk.Viewing.ViewingApplication.prototype.getViewer=function(a,b,c){if(a in this.myRegisteredViewers){var d={},f=this.myRegisteredViewers[a].config,g;for(g in f)f.hasOwnProperty(g)&&(d[g]=f[g]);for(g in b)if(b.hasOwnProperty(g)){var f=b[g],h=Array.isArray(f),k=d[g],l=Array.isArray(k);h&&l?(f?h||(f=[f]):f=[],k?l||(k=[k]):k=[],d[g]=k.concat(f)):d[g]=f}a=this.myRegisteredViewers[a].class;if(this.myCurrentViewer&&this.myCurrentViewer.__proto__.constructor===a)return this.myCurrentViewer.tearDown(),
this.myCurrentViewer.setUp(d),this.myCurrentViewer;this.setCurrentViewer(null);for(b=this.getViewerContainer();b.hasChildNodes();)b.removeChild(b.lastChild);d=new a(b,d);a=d.start();if(0===a)return this.setCurrentViewer(d),d;c&&c(a,"Viewer failed to initialize.")}return null};Autodesk.Viewing.ViewingApplication.prototype.setCurrentViewer=function(a){this.myCurrentViewer&&this.myCurrentViewer.finish();this.myCurrentViewer=a};Autodesk.Viewing.ViewingApplication.prototype.getCurrentViewer=function(){return this.myCurrentViewer};
Autodesk.Viewing.ViewingApplication.prototype.loadDocument=function(a,b,c,d){var f=this;Autodesk.Viewing.Document.load(a,function(a,c){f.myDocument=a;f.onDocumentLoaded(a,c);b&&b(a,c)},function(a,b,d){f.onDocumentFailedToLoad(b,a,d);c&&c(a,b,d)},d)};Autodesk.Viewing.ViewingApplication.prototype.onDocumentLoaded=function(a,b){console.log(a,b)};Autodesk.Viewing.ViewingApplication.prototype.onDocumentFailedToLoad=function(a,b,c){console.log(a,b,c)};
Autodesk.Viewing.ViewingApplication.prototype.selectItem=function(a,b,c){var d=this.myDocument.getViewablePath(a);if(d){var f,g,h;if("geometry"===a.type&&"3d"===a.role)f=this.k3D,h=a.name;else if("view"===a.type&&"3d"===a.role){g=a;f=this.k3D;var k=this.myDocument.getViewGeometry(a);k&&(h=k.name)}else"geometry"===a.type&&"2d"===a.role?(f=0<Autodesk.Viewing.Document.getSubItemsWithProperties(a,{mime:"application/autodesk-f2d"},!1).length?this.k3D:this.k2D,h=a.name):"view"===a.type&&"2d"===a.role&&
(g=a,f=this.k3D,k=this.myDocument.getViewGeometry(a))&&(h=k.name);Autodesk.Viewing.Private.logger&&Autodesk.Viewing.Private.logger.log({viewer_current_time:Date.now(),viewer_event_type:"switch sheet",viewer_sheet_title:h});var l=this.myDocument.getMessages(a.guid,!0);if(f){var m=this,p=this.myCurrentViewer&&this.urn===d,k=null,k=g&&g.camera?function(){m.myCurrentViewer.setViewFromArray(g.camera,g.name);b&&b(m.myCurrentViewer,a,l)}:g&&g.viewbox?function(){m.myCurrentViewer.setViewFromViewBox(g.viewbox,
g.name);b&&b(m.myCurrentViewer,a,l)}:p?function(){m.myCurrentViewer.setViewFromFile();b&&b(m.myCurrentViewer,a,l)}:function(){b&&b(m.myCurrentViewer,a,l)},n=function(a,b){c&&c(a,b,l)},q=!1;p?(k&&k(),q=!0):(this.urn=null,h={defaultModelStructureTitle:h,viewableName:h},a.hasOwnProperty("extensions")&&(h.extensions=Array.isArray(a.extensions)?a.extensions:[a.extensions]),(f=this.getViewer(f,h,c))&&f.load(this.myDocument.getFullPath(d),this.myDocument.getPropertyDbPath(),k,n)&&(this.urn=d,q=!0));if(q)return this.onItemSelected(a),
!0}}return!1};Autodesk.Viewing.ViewingApplication.prototype.onItemSelected=function(a){console.log("Selected URL: http://"+location.host+location.pathname+"?document=urn:"+this.myDocument.getRootItem().guid+"&item="+encodeURIComponent(a.guid));if(this.itemSelectedObservers){a=this.getCurrentViewer();for(var b=0;b<this.itemSelectedObservers.length;++b){var c=this.itemSelectedObservers[b];c.onItemSelected&&c.onItemSelected(a)}}};
Autodesk.Viewing.ViewingApplication.prototype.addItemSelectedObserver=function(a){this.itemSelectedObservers||(this.itemSelectedObservers=[]);this.itemSelectedObservers.push(a)};Autodesk.Viewing.ViewingApplication.prototype.selectItemById=function(a,b,c){return(a=this.myDocument.getItemById(a))?this.selectItem(a,b,c):!1};"use strict";AutodeskNamespace("Autodesk.Viewing.Private");
Autodesk.Viewing.Private.GuiViewer3D=function(a,b){b||(b={});this.customizeConfig(b);Autodesk.Viewing.Viewer3D.call(this,a,b)};Autodesk.Viewing.Private.GuiViewer3D.prototype=Object.create(Autodesk.Viewing.Viewer3D.prototype);Autodesk.Viewing.Private.GuiViewer3D.prototype.constructor=Autodesk.Viewing.Private.GuiViewer3D;Autodesk.Viewing.Private.GuiViewer3D.prototype.customizeConfig=function(a){a||(a={});a.startOnInitialize=!1;a.hasOwnProperty("docStructureConfig")||(a.docStructureConfig=Autodesk.Viewing.Private.GuiViewer3D.kDefaultDocStructureConfig)};
Autodesk.Viewing.Private.GuiViewer3D.prototype.resize=function(){Autodesk.Viewing.Viewer3D.prototype.resize.call(this);this.container.clientWidth<(isTouchDevice()?560:600)?(this.toolbar.collapse(!0),isTouchDevice()||this.hidePanels(!0)):(this.toolbar.collapse(!1),isTouchDevice()||this.hidePanels(!1))};Autodesk.Viewing.Private.GuiViewer3D.kDefaultDocStructureConfig={click:{onObject:["isolate"]},clickCtrl:{onObject:["toggleVisibility"]}};
Autodesk.Viewing.Private.GuiViewer3D.prototype.initialize=function(){var a=Autodesk.Viewing.Viewer3D.prototype.initialize.call(this);if(0<a)return a;var b=this;if(this.toolController){var a=new Autodesk.Viewing.HotGestureTool(this),c=new Autodesk.Viewing.FovTool(this),d=new Autodesk.Viewing.WorldUpTool(this.impl,this);this.toolController.registerTool(a);this.toolController.registerTool(c);this.toolController.registerTool(d);this.toolController.activateTool(a.getName())}a=b.container;this.setDefaultNavigationTool("orbit");
this.initializeToolbar(a);this.initFocalLengthOverlay();this.addEventListener(Autodesk.Viewing.FULLSCREEN_MODE_EVENT,function(a){b.resizePanels({viewer:b});b.updateScreenModeButton(a.mode)});this.contextMenu||this.setContextMenu(new Autodesk.Viewing.Extensions.ViewerObjectContextMenu(this));this.progressbar=new Autodesk.Viewing.Private.ProgressBar(this.container);this.addEventListener(Autodesk.Viewing.PROGRESS_UPDATE_EVENT,function(a){void 0!==a.percent&&b.progressbar.setPercent(a.percent)},!1);this.selectionActive=
!1;this.addEventListener(Autodesk.Viewing.SELECTION_CHANGED_EVENT,function(a){b.selectionActive=0<a.dbIdArray.length;b.prefs.openPropertiesOnSelect&&b.getPropertyPanel(!0).setVisible(b.selectionActive)});this.addEventListener(Autodesk.Viewing.ISOLATE_EVENT,function(a){(b.prefs.openPropertiesOnSelect||a.nodeIdArray[0]===b.model.getRoot())&&b.propertygrid&&b.propertygrid.setVisible(0<a.nodeIdArray.length||b.selectionActive)});this.addEventListener(Autodesk.Viewing.VIEWER_STATE_RESTORED_EVENT,function(a){b.renderoptions&&
b.renderoptions.syncUI();(a=b.getSettingsPanel(!0))&&a.syncUI()});this.initEscapeHandlers();this.updateScreenModeButton(this.getScreenMode());this.localize();this.run();return 0};
Autodesk.Viewing.Private.GuiViewer3D.prototype.uninitialize=function(){this.viewerSettingsPanel&&(this.viewerSettingsPanel.uninitialize(),this.viewerSettingsPanel=null);this.modelstructure&&(this.modelstructure.uninitialize(),this.modelstructure=null);this.layersPanel&&(this.layersPanel.uninitialize(),this.layersPanel=null);this.propertygrid&&(this.propertygrid.uninitialize(),this.propertygrid=null);this.renderoptions&&(this.renderoptions.uninitialize(),this.renderoptions=null);Autodesk.Viewing.theHotkeyManager.popHotkeys("Autodesk.ROLL");
Autodesk.Viewing.theHotkeyManager.popHotkeys("Autodesk.FOV");this.explodeslider&&this.removeEventListener(Autodesk.Viewing.VIEWER_RESIZE_EVENT,this.moveExplodeSliderToButton);this.searchMenu=this.debugMenu=this.navTools=this.modelTools=this.minTools=this.progressbar=null;Autodesk.Viewing.Viewer3D.prototype.uninitialize.call(this)};
Autodesk.Viewing.Private.GuiViewer3D.prototype.setUp=function(a){a||(a={});this.customizeConfig(a);this.initializeToolbar(this.container);Autodesk.Viewing.Viewer3D.prototype.setUp.call(this,a)};Autodesk.Viewing.Private.GuiViewer3D.prototype.tearDown=function(){Autodesk.Viewing.Viewer3D.prototype.tearDown.call(this)};
Autodesk.Viewing.Private.GuiViewer3D.prototype.initializeToolbar=function(a){a=this.getToolbar(!0);if(this.canChangeScreenMode()){this.minToolsId="minTools";this.minTools=a.addSubToolbar(this.minToolsId,!1);var b=this;this.minTools.minfullscreenbutton=this.addMenuButton(this.minToolsId,"toolbar-minfullscreenTool","Full screen",function(a){b.nextScreenMode()})}this.navTools=a.getSubToolbarById(Autodesk.Viewing.TOOLBAR.NAVTOOLSID);this.modelTools=a.getSubToolbarById(Autodesk.Viewing.TOOLBAR.MODELTOOLSID)};
Autodesk.Viewing.Private.GuiViewer3D.prototype.loadModel=function(a,b,c,d,f){var g=this,h=function(){g.displayViewCube(g.prefs.viewCube);g.removeEventListener(Autodesk.Viewing.GEOMETRY_LOADED_EVENT,h)};-1!=a.indexOf(".f2d")?(this.createUI("2d"),this.unloadExtension("Autodesk.Beeline"),this.setDefaultNavigationTool("pan"),this.setClickToSetCOI(!1,!1),this.displayViewCube(!1,!1)):(this.createUI("3d"),this.loadExtension("Autodesk.Beeline",null),this.loadExtension("Autodesk.Viewing.Oculus",null),this.setDefaultNavigationTool("orbit"),
this.addEventListener(Autodesk.Viewing.GEOMETRY_LOADED_EVENT,h));return Autodesk.Viewing.Viewer3D.prototype.loadModel.call(this,a,b,c,d,f)};Autodesk.Viewing.Private.GuiViewer3D.prototype.setModelStructurePanel=function(a){var b=this;return Autodesk.Viewing.Viewer3D.prototype.setModelStructurePanel.call(b,a)?(a&&a.addVisibilityListener(function(c){if(c)b.onPanelVisible(a,b);b.setStructureButtonEnabled(c)}),!0):!1};
Autodesk.Viewing.Private.GuiViewer3D.prototype.setPropertyPanel=function(a){var b=this;return Autodesk.Viewing.Viewer3D.prototype.setPropertyPanel.call(b,a)?(a&&a.addVisibilityListener(function(c){if(c)b.onPanelVisible(a,b);b.setPropertiesButtonEnabled(c)}),!0):!1};
Autodesk.Viewing.Private.GuiViewer3D.prototype.setLayersPanel=function(a){var b=this;Autodesk.Viewing.Viewer3D.prototype.setLayersPanel.call(b,a);a&&a.addVisibilityListener(function(c){if(c)b.onPanelVisible(a,b);b.modelTools.select(b.modelTools.layerButton.id,c)});return!0};
Autodesk.Viewing.Private.GuiViewer3D.prototype.createUI=function(a){this.initHotkeys(a);this.initNavTools(a);this.initCameraStateMachine(a);this.initModelTools(a);ENABLE_DEBUG&&this.initDebugTools();this.fireEvent({type:Autodesk.Viewing.TOOLBAR_CREATED_EVENT});this.initSearchBox();this.initInfoButton();this.initHomeButton();this.explodeslider&&(this.showExplodeSlider(!1),this.explodeslider.style.display="")};
Autodesk.Viewing.Private.GuiViewer3D.prototype.addOptionToggle=function(a,b,c,d,f){var g=f?this.prefs[f]:null;c="boolean"===typeof g?g:c;g=document.createElement("li");g.className="toolbar-submenu-listitem";var h=document.createElement("input");h.className="toolbar-submenu-checkbox";h.type="checkbox";h.id=b;g.appendChild(h);var k=document.createElement("label");k.setAttribute("for",b);k.setAttribute("data-i18n",b);k.textContent=Autodesk.Viewing.i18n.translate(b);g.appendChild(k);a.appendChild(g);
h.checked=c;h.addEventListener("touchstart",touchStartToClick);k.addEventListener("touchstart",touchStartToClick);g.addEventListener("touchstart",touchStartToClick);h.addEventListener("click",function(a){d(h.checked);a.stopPropagation()});k.addEventListener("click",function(a){a.stopPropagation()});g.addEventListener("click",function(a){d(!h.checked);a.stopPropagation()});f&&this.prefs.addListeners(f,function(a){h.checked=a},function(a){h.checked=a;d(a)});return h};
Autodesk.Viewing.Private.GuiViewer3D.prototype.addOptionList=function(a,b,c,d,f,g){var h=this.prefs[g];d="number"===typeof h?h:d;var k=document.createElement("select");k.className="optionDropDown";k.id="selectMenu_"+b;for(h=0;h<c.length;h++){var l=document.createElement("option");l.value=h;l.setAttribute("data-i18n",c[h]);l.textContent=Autodesk.Viewing.i18n.translate(c[h]);k.add(l)}c=document.createElement("li");c.className="toolbar-submenu-select";h=document.createElement("div");h.className="toolbar-submenu-selectlabel";
h.setAttribute("for",b);h.setAttribute("data-i18n",b);h.textContent=Autodesk.Viewing.i18n.translate(b);c.appendChild(h);c.appendChild(k);a.appendChild(c);k.selectedIndex=d;k.onchange=function(a){f(a.target.selectedIndex);a.stopPropagation()};k.addEventListener("touchstart",function(a){a.stopPropagation()});k.addEventListener("click",function(a){a.stopPropagation()});g&&this.prefs.addListeners(g,function(a){k.selectedIndex=a},function(a){k.selectedIndex=a;f(a)});return k};
Autodesk.Viewing.Private.GuiViewer3D.prototype.addMenuButton=function(a,b,c,d){b=Autodesk.Viewing.UI.Toolbar.createMenuButton(b,c,d);this.toolbar.addToSubToolbar(a,b);return b};Autodesk.Viewing.Private.GuiViewer3D.prototype.removeMenuButton=function(a,b){this.toolbar.removeFromSubToolbar(a,b)};
Autodesk.Viewing.Private.GuiViewer3D.prototype.initExplodeSlider=function(a){var b=this,c=this.container;if(!this.explodeslider){var d=this.explodeslider=document.createElement("input");d.className="explode-slider";d.id="explode-slider";d.type="range";d.min="0";d.max="100";d.style.display="none";c.appendChild(d);d.addEventListener("input",function(a){b.explode(d.value/100)});d.addEventListener("change",function(a){b.explode(d.value/100)});d.addEventListener("keyup",function(a){27===a.keyCode&&b.canvas.focus()})}this.explodeslider.value=
"0";this.explodebutton=this.addMenuButton(a,"toolbar-explodeTool","Explode model",function(a){a=b.explodeslider.classList.contains("collapsed");b.showExplodeSlider(a);if(a=Autodesk.Viewing.UI.Toolbar.getToolButton("toolbar-measureTool"))b.toolController.deactivateTool("measure"),Autodesk.Viewing.UI.SubToolbar.setToolState(a.id,Autodesk.Viewing.UI.SubToolbar.STATE_NOTACTIVE)});this.hasEventListener(Autodesk.Viewing.VIEWER_RESIZE_EVENT,this.moveExplodeSliderToButton)||this.addEventListener(Autodesk.Viewing.VIEWER_RESIZE_EVENT,
this.moveExplodeSliderToButton)};Autodesk.Viewing.Private.GuiViewer3D.prototype.moveExplodeSliderToButton=function(){if(this.explodeslider.classList.contains("collapsed")){var a=this.explodebutton.getBoundingClientRect(),b=this.container.getBoundingClientRect(),c=a.top-b.top;this.explodeslider.style.left=(a.left-b.left+a.width/4).toString()+"px";this.explodeslider.style.top=c.toString()+"px"}};
Autodesk.Viewing.Private.GuiViewer3D.prototype.showExplodeSlider=function(a){this.explodeslider&&(a?(this.explodeslider.classList.remove("collapsed"),this.explodeslider.style.top="",this.explodeslider.style.left=""):(this.explodeslider.classList.add("collapsed"),this.moveExplodeSliderToButton()),Autodesk.Viewing.UI.SubToolbar.setToolState(this.explodebutton.id,a?Autodesk.Viewing.UI.SubToolbar.STATE_ACTIVE:Autodesk.Viewing.UI.SubToolbar.STATE_NOTACTIVE))};
Autodesk.Viewing.Private.GuiViewer3D.prototype.showViewer3dOptions=function(a){var b=this.getSettingsPanel(!0);a&&b.isVisible()&&b.setVisible(!1);b.setVisible(a)};Autodesk.Viewing.Private.GuiViewer3D.prototype.showRenderingOptions=function(a){this.renderoptions.setVisible(a)};Autodesk.Viewing.Private.GuiViewer3D.prototype.showLayerManager=function(a){this.layersPanel.setVisible(a)};
Autodesk.Viewing.Private.GuiViewer3D.prototype.initHotkeys=function(a){var b=this,c=Autodesk.Viewing.theHotkeyManager.KEYCODES;if("3d"===a){var d;Autodesk.Viewing.theHotkeyManager.pushHotkeys("Autodesk.FOV",[{keycodes:[c.CONTROL,c.SHIFT],onPress:function(){if(b.toolController.getIsLocked())return!1;d=b.getActiveNavigationTool();b.setActiveNavigationTool("fov");return!0},onRelease:function(){if(b.toolController.getIsLocked())return!1;b.setActiveNavigationTool(d);return!0}}],{tryUntilSuccess:!0})}var f;
Autodesk.Viewing.theHotkeyManager.pushHotkeys("Autodesk.ROLL",[{keycodes:[c.ALT,c.SHIFT],onPress:function(){if(b.toolController.getIsLocked())return!1;f=b.getActiveNavigationTool();b.setActiveNavigationTool("worldup");return!0},onRelease:function(){if(b.toolController.getIsLocked())return!1;b.setActiveNavigationTool(f);return!0}}],{tryUntilSuccess:!0})};
Autodesk.Viewing.Private.GuiViewer3D.prototype.initNavTools=function(a){var b=this,c=Autodesk.Viewing.TOOLBAR.NAVTOOLSID;"3d"===a&&(this.navTools.orbitbutton=this.addMenuButton(c,"toolbar-orbitTool","Orbit",function(a){a=Autodesk.Viewing.UI.SubToolbar.getToolState(b.navTools.orbitbutton.id);a===Autodesk.Viewing.UI.SubToolbar.STATE_NOTACTIVE?b.setActiveNavigationTool("orbit"):a===Autodesk.Viewing.UI.SubToolbar.STATE_ACTIVE&&b.setActiveNavigationTool()}));this.navTools.panbutton=this.addMenuButton(c,
"toolbar-panTool","Pan",function(a){a=Autodesk.Viewing.UI.SubToolbar.getToolState(b.navTools.panbutton.id);a===Autodesk.Viewing.UI.SubToolbar.STATE_NOTACTIVE?b.setActiveNavigationTool("pan"):a===Autodesk.Viewing.UI.SubToolbar.STATE_ACTIVE&&b.setActiveNavigationTool()});this.navTools.dollybutton=this.addMenuButton(c,"toolbar-zoomTool","Zoom",function(a){a=Autodesk.Viewing.UI.SubToolbar.getToolState(b.navTools.dollybutton.id);a===Autodesk.Viewing.UI.SubToolbar.STATE_NOTACTIVE?b.setActiveNavigationTool("dolly"):
a===Autodesk.Viewing.UI.SubToolbar.STATE_ACTIVE&&b.setActiveNavigationTool()});var d=Autodesk.Viewing.UI.Toolbar.createMenuButton("toolbar-cameraSubmenuTool","Camera interactions",null,{onToolStateChangedCB:function(){Autodesk.Viewing.UI.SubToolbar.getToolState("toolbar-cameraSubmenuTool")===Autodesk.Viewing.UI.SubToolbar.STATE_NOTACTIVE&&(Autodesk.Viewing.UI.SubToolbar.setToolState("toolbar-fitToViewTool",Autodesk.Viewing.UI.SubToolbar.STATE_NOTACTIVE),Autodesk.Viewing.UI.SubToolbar.setToolState("toolbar-rollTool",
Autodesk.Viewing.UI.SubToolbar.STATE_NOTACTIVE))}});d.style.position="relative";this.toolbar.addToSubToolbar(c,d);a=this.createCameraSubmenu(a);this.toolbar.attachSubMenu(d,a)};
Autodesk.Viewing.Private.GuiViewer3D.prototype.createCameraSubmenu=function(a){var b=document.createElement("ul");b.style.width="48px";b.style.position="absolute";b.style.left="2px";b.style.paddingBottom="2px";var c=Autodesk.Viewing.UI.Toolbar.createMenuButton,d=this,f={};isTouchDevice()&&(f.defaultTooltipValue="Home",this.navTools.homeButton=c("toolbar-homeTool","Home",function(){d.navigation.setRequestHomeView(!0)},f),this.navTools.homeButton.style.marginLeft="2px",this.navTools.homeButton.style.marginTop=
"2px",b.appendChild(this.navTools.homeButton));f={defaultTooltipValue:"Fit to view (F)"};this.navTools.fittoviewbutton=c("toolbar-fitToViewTool","Fit to view",function(b){d.fitToView("3d"===a?d.getSelection().map(function(a){return a.dbId}):void 0)},f);this.navTools.fittoviewbutton.style.marginLeft="2px";this.navTools.fittoviewbutton.style.marginTop="2px";b.appendChild(this.navTools.fittoviewbutton);"3d"===a&&(f.defaultTooltipValue="Focal length (Ctrl+Shift drag)",this.navTools.fovbutton=c("toolbar-focalLengthTool",
"Focal length",function(a){a=Autodesk.Viewing.UI.SubToolbar.getToolState(d.navTools.fovbutton.id);a===Autodesk.Viewing.UI.SubToolbar.STATE_NOTACTIVE?d.setActiveNavigationTool("fov"):a===Autodesk.Viewing.UI.SubToolbar.STATE_ACTIVE&&d.setActiveNavigationTool()},f),this.navTools.fovbutton.style.marginLeft="2px",this.navTools.fovbutton.style.marginTop="2px",b.appendChild(this.navTools.fovbutton));f.defaultTooltipValue="Roll (Alt+Shift drag)";this.navTools.rollbutton=c("toolbar-rollTool","Roll",function(a){a=
Autodesk.Viewing.UI.SubToolbar.getToolState(d.navTools.rollbutton.id);a===Autodesk.Viewing.UI.SubToolbar.STATE_NOTACTIVE?d.setActiveNavigationTool("worldup"):a===Autodesk.Viewing.UI.SubToolbar.STATE_ACTIVE&&d.setActiveNavigationTool()},f);this.navTools.rollbutton.style.marginLeft="2px";this.navTools.rollbutton.style.marginTop="2px";b.appendChild(this.navTools.rollbutton);return b};
Autodesk.Viewing.Private.GuiViewer3D.prototype.initCameraStateMachine=function(a){var b=this;b.addEventListener(Autodesk.Viewing.NAVIGATION_MODE_CHANGED_EVENT,function(a){a=b.getActiveNavigationTool();var d={orbit:b.navTools.orbitbutton,dolly:b.navTools.dollybutton,pan:b.navTools.panbutton,fov:b.navTools.fovbutton,worldup:b.navTools.rollbutton},f;for(f in d)d[f]&&Autodesk.Viewing.UI.SubToolbar.setToolState(d[f].id,Autodesk.Viewing.UI.SubToolbar.STATE_NOTACTIVE);d[a]&&Autodesk.Viewing.UI.SubToolbar.setToolState(d[a].id,
Autodesk.Viewing.UI.SubToolbar.STATE_ACTIVE)});b.addEventListener(Autodesk.Viewing.TOOL_CHANGE_EVENT,function(a){"fov"===a.toolName&&b.showFocalLengthOverlay(a.active)})};Autodesk.Viewing.Private.GuiViewer3D.prototype.getPropertyPanel=function(a){!this.propertygrid&&a&&this.setPropertyPanel(new Autodesk.Viewing.Extensions.ViewerPropertyPanel(this));return this.propertygrid};
Autodesk.Viewing.Private.GuiViewer3D.prototype.getSettingsPanel=function(a){!this.viewerSettingsPanel&&a&&this.setSettingsPanel(new Autodesk.Viewing.Extensions.ViewerSettingsPanel(this,this.model.is2d()?"2d":"3d"));return this.viewerSettingsPanel};
Autodesk.Viewing.Private.GuiViewer3D.prototype.initModelTools=function(a){var b=this,c=Autodesk.Viewing.TOOLBAR.MODELTOOLSID,d=null;"3d"===a?(this.modelTools.structurebutton=this.addMenuButton(c,"toolbar-modelStructureTool","Model structure",function(a){b.modelstructure||b.setModelStructurePanel(new Autodesk.Viewing.Extensions.ViewerModelStructurePanel(b,"Model Structure Loading",{docStructureConfig:b.config.docStructureConfig}));b.showModelStructurePanel(!b.modelstructure.isVisible())}),this.initExplodeSlider(c),
d="Reset model"):(this.modelTools.layerButton=this.addMenuButton(c,"toolbar-layersTool","Layer Manager",function(a){b.layersPanel||(b.setLayersPanel(new Autodesk.Viewing.Extensions.ViewerLayersPanel(b)),b.showLayerManager(!b.layersPanel.isVisible()))}),d="Reset drawing");this.modelTools.resetModelButton=this.addMenuButton(c,"toolbar-resetTool",d,function(a){b.fireEvent({type:Autodesk.Viewing.RESET_EVENT})});b.addEventListener(Autodesk.Viewing.RESET_EVENT,function(){b.model&&!b.model.is2d()&&(b.explode(0),
b.explodeslider.value=0);b.showAll()});this.modelTools.propertiesbutton=this.addMenuButton(c,"toolbar-propertiesTool","Properties",function(a){a=b.getPropertyPanel(!0);a.setVisible(!a.isVisible())});this.modelTools.setToolVisibility(this.modelTools.propertiesbutton.id,!b.prefs.openPropertiesOnSelect);d=new Autodesk.Viewing.Extensions.ViewerSettingsPanel(this,a);this.setSettingsPanel(d);this.viewerOptionButton=this.addMenuButton(c,"toolbar-settingsTool","",null);this.createViewerOptionsMenu(a);ENABLE_DEBUG&&
"3d"===a&&(this.renderoptions=new Autodesk.Viewing.Private.RenderOptionsPanel(this),this.addPanel(this.renderoptions),this.renderoptionsbutton=this.addMenuButton(c,"toolbar-renderOptionsTool","Rendering options",function(a){b.showRenderingOptions(!b.renderoptions.isVisible())}));this.canChangeScreenMode()&&(this.modelTools.fullscreenbutton=this.addMenuButton(c,"toolbar-fullscreenTool","Full screen",function(a){b.nextScreenMode()}))};
Autodesk.Viewing.Private.GuiViewer3D.prototype.setPropertiesOnSelect=function(a){a?this.modelTools.setToolVisibility(this.modelTools.propertiesbutton.id,!1):this.modelTools.setToolVisibility(this.modelTools.propertiesbutton.id,!0)};Autodesk.Viewing.Private.GuiViewer3D.prototype.addDivider=function(a){var b=document.createElement("li");b.className="toolbar-submenu-horizontal-divider";a.appendChild(b);return b};
Autodesk.Viewing.Private.GuiViewer3D.prototype.createViewerOptionsMenu=function(a){function b(a){var b=c.getSettingsPanel(!0);b.isVisible()&&b.isTabSelected(a)?c.showViewer3dOptions(!1):(c.showViewer3dOptions(!0),b.selectTab(a))}var c=this;this.viewerOptionButton.subMenu=document.createElement("ul");this.viewerOptionButton.subMenu.className="toolbar-submenu";this.viewerOptionButton.subMenu.style.minWidth="310px";this.viewerOptionButton.subMenu.mode=a;this.viewerOptionButton.subMenu.id="toolbar-settingsToolSubmenu";
this.container.appendChild(this.viewerOptionButton.subMenu);if("3d"===a){a=[];for(var d=0;d<Autodesk.Viewing.Private.LightPresets.length;d++)a.push(Autodesk.Viewing.Private.LightPresets[d].name);this.viewerOptionButton.envList=this.addOptionList(this.viewerOptionButton.subMenu,"Background and lighting",a,4,function(a){c.blockEvent||c.setLightPreset(a)},"lightPreset");this.selectLightPreset=function(a){c.blockEvent=!0;c.viewerOptionButton.envList&&(c.viewerOptionButton.envList.selectedIndex=c.impl.currentLightPreset());
c.blockEvent=!1};c.addEventListener(Autodesk.Viewing.RENDER_OPTION_CHANGED_EVENT,this.selectLightPreset);this.viewerOptionButton.displayLines=this.addOptionToggle(this.viewerOptionButton.subMenu,"Display Lines",!0,function(a){c.hideLines(!a)},"lineRendering");this.addDivider(this.viewerOptionButton.subMenu)}a=document.createElement("li");a.className="toolbar-submenu-listitem";d=document.createElement("label");d.setAttribute("data-i18n","Performance and appearance settings");d.textContent=Autodesk.Viewing.i18n.translate("Performance and appearance settings");
a.appendChild(d);this.show3dOptionsPerformanceTab=function(){b(Autodesk.Viewing.Extensions.ViewerSettingTab.Performance)};this.viewerOptionButton.performanceOption=a;this.viewerOptionButton.performanceOption.addEventListener("touchstart",touchStartToClick);this.viewerOptionButton.performanceOption.addEventListener("click",this.show3dOptionsPerformanceTab);this.viewerOptionButton.subMenu.appendChild(this.viewerOptionButton.performanceOption);this.addDivider(this.viewerOptionButton.subMenu);a=document.createElement("li");
a.className="toolbar-submenu-listitem";d=document.createElement("label");d.setAttribute("data-i18n","Navigation and selection settings");d.textContent=Autodesk.Viewing.i18n.translate("Navigation and selection settings");a.appendChild(d);this.show3dOptionsNavigationTab=function(){b(Autodesk.Viewing.Extensions.ViewerSettingTab.Navigation)};this.viewerOptionButton.navigationOption=a;this.viewerOptionButton.navigationOption.addEventListener("touchstart",touchStartToClick);this.viewerOptionButton.navigationOption.addEventListener("click",
this.show3dOptionsNavigationTab);this.viewerOptionButton.subMenu.appendChild(a);this.viewerOptionButton.subMenu.style.width=this.viewerOptionButton.subMenu.getBoundingClientRect().width+"px";this.container.removeChild(this.viewerOptionButton.subMenu);this.toolbar.attachSubMenu(this.viewerOptionButton,this.viewerOptionButton.subMenu)};
Autodesk.Viewing.Private.GuiViewer3D.prototype.removeViewerOptionsMenu=function(a){this.viewerOptionButton.removeChild(this.viewerOptionButton.subMenu);"3d"===a&&(this.removeEventListener(Autodesk.Viewing.RENDER_OPTION_CHANGED_EVENT,this.selectLightPreset),this.viewerOptionButton.envList=null);this.viewerOptionButton.navigationOption.removeEventListener("touchstart",touchStartToClick);this.viewerOptionButton.navigationOption.removeEventListener("click",this.show3dOptionsNavigationTab);this.viewerOptionButton.navigationOption=
null;this.viewerOptionButton.performanceOption.removeEventListener("touchstart",touchStartToClick);this.viewerOptionButton.performanceOption.removeEventListener("click",this.show3dOptionsPerformanceTab);this.viewerOptionButton.performanceOption=null};Autodesk.Viewing.Private.GuiViewer3D.prototype.initDebugTools=function(){this.debugMenu=this.toolbar.addSubToolbar("debugTools",!1);this.debugMenu.debugSubMenuButton=this.addMenuButton("debugTools","toolbar-debugTool","",null);this.createDebugSubmenu(this.debugMenu.debugSubMenuButton)};
Autodesk.Viewing.Private.GuiViewer3D.prototype.createDebugSubmenu=function(a){function b(){c.localize()}var c=this;this.debugMenu.subMenu=document.createElement("ul");this.debugMenu.subMenu.className="toolbar-submenu";this.debugMenu.subMenu.style.minWidth="180px";this.container.appendChild(this.debugMenu.subMenu);this.initModelStats();this.addDivider(this.debugMenu.subMenu);this.addOptionToggle(this.debugMenu.subMenu,"Show search bar",!1,function(a){c.searchMenu.setVisibility(a)});this.addDivider(this.debugMenu.subMenu);
var d="en ru ja ko zh-Hant sp".split(" ");this.addOptionList(this.debugMenu.subMenu,"Language","English Russian Japanese Korean Chinese Spanish(unsupported)".split(" "),c.selectedLanguage?c.selectedLanguage:0,function(a){var f=d[a];c.selectedLanguage=a;Autodesk.Viewing.Private.setLanguage(f,b)},null).parentNode.style.paddingBottom="15px";this.addDivider(this.debugMenu.subMenu);this.addOptionList(this.debugMenu.subMenu,"Error","UNKNOWN FAILURE; BAD DATA;NETWORK ERROR;NETWORK ACCESS DENIED;NETWORK FILE NOT FOUND; NETWORK SERVER ERROR;NETWORK UNHANDLED RESPONSE CODE;BROWSER WEBGL NOT SUPPORTED;BAD DATA NO VIEWABLE CONTENT".split(";"),
0,function(a){Autodesk.Viewing.Private.ErrorHandler.reportError(c.container,a+1,"")},null).parentNode.style.paddingBottom="15px";this.debugMenu.subMenu.style.width=this.debugMenu.subMenu.getBoundingClientRect().width+"px";this.container.removeChild(this.debugMenu.subMenu);this.toolbar.attachSubMenu(a,this.debugMenu.subMenu);a=this.debugMenu.subMenu.getBoundingClientRect().right;var f=this.container.getBoundingClientRect().right;a>f&&(this.debugMenu.subMenu.style.left=-(a-f+10)+"px")};
Autodesk.Viewing.Private.GuiViewer3D.prototype.initModelStats=function(){function a(a){var b=c.impl,g="",h=c.model;h&&(g+="Geom&nbsp;polys:&nbsp;"+h.geomPolyCount()+"<br>",g+="Instance&nbsp;polys:&nbsp;"+h.instancePolyCount()+"<br>",g+="Scenes:&nbsp;"+b.modelQueue().getSceneCount()+"<br>");c.modelStats.innerHTML=g+("# "+(a||""))}function b(){c.modelStats=document.createElement("div");c.modelStats.className="statspanel";c.container.appendChild(c.modelStats);c.addEventListener(Autodesk.Viewing.PROGRESS_UPDATE_EVENT,
function(b){b.message&&a(b.message)})}var c=this;this.addOptionToggle(this.debugMenu.subMenu,"Model statistics",!1,function(d){d&&!c.modelStats&&(b(),a(""));c.modelStats.style.visibility=d?"visible":"hidden"})};
Autodesk.Viewing.Private.GuiViewer3D.prototype.initEscapeHandlers=function(){var a=this;this.addEventListener(Autodesk.Viewing.ESCAPE_EVENT,function(b){if(!a.contextMenu||!a.contextMenu.hide())if(a.renderoptions&&a.renderoptions.isVisible())a.renderoptions.setVisible(!1);else if(a.explodeslider&&!a.explodeslider.classList.contains("collapsed"))a.showExplodeSlider(!1);else if(a.getActiveNavigationTool()!==a.getDefaultNavigationToolName())a.toolController&&a.toolController.setIsLocked(!1),a.setActiveNavigationTool(),
Autodesk.Viewing.Private.HudMessage.dismiss();else if(a.selectionActive)a.clearSelection();else if(!a.areAllVisible())a.showAll();else if(!Autodesk.Viewing.Private.AlertBox.dismiss()){for(b=0;b<a.dockingPanels.length;++b){var c=a.dockingPanels[b];if("none"!==c.container.style.display&&""!==c.container.style.display){c.container===a.modelstructure?a.showModelStructurePanel(!1):c.setVisible(!1);return}}a.escapeScreenMode()}})};
Autodesk.Viewing.Private.GuiViewer3D.prototype.initHomeButton=function(){if(!(0<document.getElementsByClassName("homeViewWrapper").length)){var a=document.createElement("div");a.className="homeViewWrapper";a.style.cursor="pointer";this.container.appendChild(a);this.homeViewContainer=a;var b=this;a.addEventListener("click",function(a){b.navigation.setRequestHomeView(!0)});this.initHomeMenu(a)}};
Autodesk.Viewing.Private.GuiViewer3D.prototype.initHomeMenu=function(a){function b(a){h.style.display="none";document.removeEventListener("click",b)}var c=this.autocam,d=this,f=document.createElement("div");f.className="homeViewMenuHandle";var g=document.createElement("img");g.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsSAAALEgHS3X78AAAAIGNIUk0AAH7FAACLdgAA9UcAAIsOAABxUAAA6BUAADlYAAAfBMec4XAAAAEBSURBVHja7JcxCsIwFIb/V3oFx04v4iB4A3ev4Ak9iOABOhQcageHDh7iuVSwpW1eYmIFEwiFQvN9SZP/ERIRLNkyLNySQBLIhy+I6AhgE5F5FZHTpACAbV3X61h0Zs5nVwBAJiL0rd+eNuHvnQIArTEmplhrE7gAWEUUePSO/Vg1jJgFvQyYWoFoWTDMgLlNWDFzIyIUqjNzA6DSCpwBlMaYW4iZd+OU3bh2ARG5h5J4h3fj6nIghIQNbg2iTyQ0cFUS+kho4eoodpFwgTvVAo2EK9y5GM1J+MC9quGYhC98shaoPiQqAOwB7Hzhrxn1umMrABy6pxeT0t3w7wWeAwD5qe4YizvzugAAAABJRU5ErkJggg==";
g.width=g.height=18;f.appendChild(g);f.addEventListener("mouseover",function(a){g.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsSAAALEgHS3X78AAAAIGNIUk0AAH7FAACLdgAA9UcAAIsOAABxUAAA6BUAADlYAAAfBMec4XAAAAEVSURBVHja7JcxDoJAEEX/rvY2HMEb6AEsaTDxBngKIzfgDBR6AxJtiI0egN7Ght6GWBIYGzVKQHaQDYU7yYSwxb5HMvs3CCJCnyXRcxkBIzAsLwyWpx0ARyNzn29m81oBAE60mmqj237smBkwAl9PAfIssv3Y1kbMs+j9VZQvIyHEGMBI40enRHSpFdCcBR8ZUJcD2rKgnAH1Q5gmnu3HXcOBNPGUBIrQDbqUeMKL0A2UBIjo2pXEO5yIrso50IVEE7wxiH6RUIErJWEbCVW4chRzJDhw1l2gIsGFPzdmNQBLLrZr6R7pcL69WrpHkovtGoDF2o8rUCXRFt5aoCzRFl4pwCwLwOTxBGOeXi3Mv+HfC9wHAAIQ03ZDDGqmAAAAAElFTkSuQmCC"});
f.addEventListener("mouseleave",function(a){g.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsSAAALEgHS3X78AAAAIGNIUk0AAH7FAACLdgAA9UcAAIsOAABxUAAA6BUAADlYAAAfBMec4XAAAAEBSURBVHja7JcxCsIwFIb/V3oFx04v4iB4A3ev4Ak9iOABOhQcageHDh7iuVSwpW1eYmIFEwiFQvN9SZP/ERIRLNkyLNySQBLIhy+I6AhgE5F5FZHTpACAbV3X61h0Zs5nVwBAJiL0rd+eNuHvnQIArTEmplhrE7gAWEUUePSO/Vg1jJgFvQyYWoFoWTDMgLlNWDFzIyIUqjNzA6DSCpwBlMaYW4iZd+OU3bh2ARG5h5J4h3fj6nIghIQNbg2iTyQ0cFUS+kho4eoodpFwgTvVAo2EK9y5GM1J+MC9quGYhC98shaoPiQqAOwB7Hzhrxn1umMrABy6pxeT0t3w7wWeAwD5qe4YizvzugAAAABJRU5ErkJggg=="});
a.appendChild(f);var h=document.createElement("div");h.className="homeViewMenu";this.container.appendChild(h);var k=document.createElement("div");k.className="homeViewMenuItem";k.textContent=Autodesk.Viewing.i18n.translate("Set current view as Home");h.appendChild(k);k.addEventListener("click",function(a){c.setCurrentViewAsHome(!1);b(a)});k=document.createElement("div");k.className="homeViewMenuItem";k.textContent=Autodesk.Viewing.i18n.translate("Focus and set as Home");h.appendChild(k);k.addEventListener("click",
function(a){c.setCurrentViewAsHome(!0);b(a)});k=document.createElement("div");k.className="homeViewMenuItem";k.textContent=Autodesk.Viewing.i18n.translate("Reset Home");h.appendChild(k);k.addEventListener("click",function(a){c.resetHome();b(a)});a.addEventListener("mouseover",function(a){if(d.model&&d.model.is2d()||d.prefs&&!d.prefs.viewCube)f.style.display="block"});a.addEventListener("mouseleave",function(a){f.style.display="none"});f.addEventListener("click",function(a){if(d.model&&d.model.is2d()||
d.prefs&&!d.prefs.viewCube)h.style.display="block",document.addEventListener("click",b);a.stopPropagation()});a.addEventListener("contextmenu",function(a){if(d.model&&d.model.is2d()||d.prefs&&!d.prefs.viewCube)h.style.display="block",document.addEventListener("click",b)})};
Autodesk.Viewing.Private.GuiViewer3D.prototype.initInfoButton=function(){if(!(0<document.getElementsByClassName("infoButton").length)){this.infoButton=document.createElement("div");this.infoButton.className="infoButton";this.infoButton.style.cursor="pointer";this.container.appendChild(this.infoButton);var a=this;this.infoButton.addEventListener("click",function(b){b=a.getPropertyPanel(!0);var c=!b.areDefaultPropertiesShown()||!b.isVisible();c&&b.showDefaultProperties();c!==b.isVisible()&&b.setVisible(c)})}};
Autodesk.Viewing.Private.GuiViewer3D.prototype.displayViewCube=function(a,b){!1!==b&&this.prefs.set("viewCube",a);if(a&&!this.cube)this.viewcube=document.createElement("div"),this.viewcube.className="viewcube",this.container.appendChild(this.viewcube),this.cube=new Autocam.ViewCube("cube",this.autocam,this.viewcube,LOCALIZATION_REL_PATH);else if(!this.cube)return;this.viewcube.style.display=a?"block":"none";if(this.homeViewContainer){var c=this.homeViewContainer.getBoundingClientRect(),d=this.viewcube.getBoundingClientRect(),
f=this.infoButton.getBoundingClientRect(),g=this.container.getBoundingClientRect();this.homeViewContainer.style.right=a?g.width+g.left-d.left-c.width+"px":g.width+g.left-f.left+c.width/2+"px"}a&&this.autocam.refresh()};
Autodesk.Viewing.Private.GuiViewer3D.prototype.initSearchBox=function(){this.searchMenu=this.toolbar.addSubToolbar("searchBox",!1);this.searchMenu.setVisibility(!1);var a=document.createElement("li"),b=document.createElement("input");b.type="search";b.results=5;b.placeholder=Autodesk.Viewing.i18n.translate("Search");b.incremental="incremental";b.autosave=this.container.id+"search_autosave";b.setAttribute("data-i18n","[placeholder]Search");a.appendChild(b);this.toolbar.addToSubToolbar("searchBox",
a);var c=this;b.addEventListener("change",function(a){stderr("search "+b.value);c.search(b.value,function(a){c.isolateById(a)})});b.addEventListener("keypress",function(a){27===a.keyCode&&setTimeout(function(){""!==b.value&&(b.value="")},0)});this.toolbar.addEventListener("mouseleave",function(a){function f(){clearTimeout(g)}var g;c.toolbar.addEventListener("mouseenter",f);g=setTimeout(function(){c.toolbar&&c.toolbar.removeEventListener("mouseenter",f);document.activeElement===b&&c.canvas.focus()},
2E3)})};Autodesk.Viewing.Private.GuiViewer3D.prototype.setPropertiesButtonEnabled=function(a){this.modelTools.select(this.modelTools.propertiesbutton.id,a)};Autodesk.Viewing.Private.GuiViewer3D.prototype.setStructureButtonEnabled=function(a){this.modelTools.select(this.modelTools.structurebutton.id,a)};Autodesk.Viewing.Private.GuiViewer3D.prototype.showModelStructurePanel=function(a){this.modelstructure.setVisible(a)};
Autodesk.Viewing.Private.GuiViewer3D.prototype.onPanelVisible=function(a,b){b||(b=this);b.dockingPanels.splice(b.dockingPanels.indexOf(a),1);b.dockingPanels.splice(0,0,a)};
Autodesk.Viewing.Private.GuiViewer3D.prototype.initFocalLengthOverlay=function(){var a=this.focallength=document.createElement("div");a.className="focallength";var b=document.createElement("table"),c=document.createElement("tbody");b.appendChild(c);a.appendChild(b);this.container.appendChild(a);b=c.insertRow(-1);c=b.insertCell(0);c.setAttribute("data-i18n","Focal Length");c.textContent=Autodesk.Viewing.i18n.translate("Focal Length");c=b.insertCell(1);c.textContent="";c.style.width="4em";c.style.textAlign=
"right";this.fovCell=c;a.style.visibility="hidden"};
Autodesk.Viewing.Private.GuiViewer3D.prototype.showFocalLengthOverlay=function(a){function b(a){a?Autodesk.Viewing.Private.HudMessage.displayMessage(g.container,{msgTitleKey:"Orthographic View Set",messageKey:"The view is set to Orthographic",messageDefaultValue:"The view is set to Orthographic. Changing the focal length will switch to Perspective."}):Autodesk.Viewing.Private.HudMessage.dismiss()}function c(a){a&&d();g.focallength&&(g.focallength.style.visibility=a?"visible":"hidden")}function d(){var a=
g.getFocalLength();h!==a&&(h=a,g.fovCell.textContent=a.toString()+" mm")}function f(a){d();"fov"===g.toolController.getActiveToolName()&&(a=(a=g.navigation.getCamera())&&!a.isPerspective,c(!a),b(a))}var g=this,h=0,k=g.navigation.getCamera(),k=k&&!k.isPerspective;c(a&&!k);b(a&&k);a?this.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,f):this.removeEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,f)};
Autodesk.Viewing.Private.GuiViewer3D.prototype.updateScreenModeButton=function(a){this.container.classList.remove("screenMode-kFullBrowser");this.container.classList.remove("screenMode-kFullScreen");var b;switch(a){case Autodesk.Viewing.Viewer.prototype.ScreenMode.kNormal:this.isScreenModeSupported(Autodesk.Viewing.Viewer.prototype.ScreenMode.kFullBrowser)||(b="screenMode-kFullBrowser");break;case Autodesk.Viewing.Viewer.prototype.ScreenMode.kFullBrowser:b=this.isScreenModeSupported(Autodesk.Viewing.Viewer.prototype.ScreenMode.kFullScreen)?
"screenMode-kFullBrowser":"screenMode-kFullScreen";break;case Autodesk.Viewing.Viewer.prototype.ScreenMode.kFullScreen:b="screenMode-kFullScreen"}b&&this.container.classList.add(b)};
Autodesk.Viewing.Private.GuiViewer3D.prototype.localize=function(){Autodesk.Viewing.i18n.localize();if(this.viewerOptionButton&&this.viewerOptionButton.subMenu){var a=this.viewerOptionButton.subMenu.mode;this.removeViewerOptionsMenu(a);this.createViewerOptionsMenu(a)}this.debugMenu&&this.debugMenu.debugSubMenuButton&&(this.debugMenu.debugSubMenuButton.removeChild(this.debugMenu.subMenu),this.createDebugSubmenu(this.debugMenu.debugSubMenuButton));Autodesk.Viewing.Private.ErrorHandler.localize()};
Autodesk.Viewing.Private.GuiViewer3D.prototype.hidePanels=function(a){for(var b=this.dockingPanels,c=0;c<b.length;++c){var d=b[c],f=d.container;f.classList.contains("dockingPanelVisible")&&(f.style.display=a?"none":"block",d.visibilityChanged())}};
Autodesk.Viewing.Private.GuiViewer3D.prototype.resizePanels=function(a){var b={};a&&(b=a);a=document.getElementsByClassName("toolbar-menu")[0].getBoundingClientRect().height;var c=this.getDimensions(),d=c.height;b.dimensions&&b.dimensions.height?d=b.dimensions.height:b.dimensions={height:c.height,width:c.width};b.dimensions.height=d-a;Autodesk.Viewing.Viewer.prototype.resizePanels.call(this,b)};"use strict";AutodeskNamespace("Autodesk.Viewing.Private");
Autodesk.Viewing.Private.GuiViewer2D=function(a,b){Autodesk.Viewing.Viewer2D.call(this,a,b)};Autodesk.Viewing.Private.GuiViewer2D.prototype=Object.create(Autodesk.Viewing.Viewer2D.prototype);Autodesk.Viewing.Private.GuiViewer2D.prototype.constructor=Autodesk.Viewing.Private.GuiViewer2D;
Autodesk.Viewing.Private.GuiViewer2D.prototype.initialize=function(){var a=Autodesk.Viewing.Viewer2D.prototype.initialize.call(this);if(0<a)return a;this.toolbar=new Autodesk.Viewing.UI.Toolbar(this.container);this.initNavTools();this.initModelTools();this.initEscapeHandlers();this.initHomeButton();var b=this;this.addEventListener(Autodesk.Viewing.FULLSCREEN_MODE_EVENT,function(a){b.updateScreenModeButton(a.mode)});this.updateScreenModeButton(Autodesk.Viewing.Viewer.prototype.ScreenMode.kNormal);
this.localize();this.fireEvent({type:Autodesk.Viewing.TOOLBAR_CREATED_EVENT});return 0};
Autodesk.Viewing.Private.GuiViewer2D.prototype.initNavTools=function(){var a=this;this.navTools=this.toolbar.addSubToolbar("navTools",!0);this.navTools.panbutton=this.addMenuButton("navTools","toolbar-panTool","Pan",function(b){a.impl.setNavigationMode(VIEWER2D_NAVIGATION_MODE.PAN)});this.navTools.dollybutton=this.addMenuButton("navTools","toolbar-zoomTool","Zoom",function(b){a.impl.setNavigationMode(VIEWER2D_NAVIGATION_MODE.ZOOM)});this.navTools.select(this.navTools.panbutton.id);this.addEventListener(Autodesk.Viewing.NAVIGATION_MODE_CHANGED_EVENT,
function(b){a.navTools.deselectAll();switch(b.value){case VIEWER2D_NAVIGATION_MODE.PAN:a.navTools.select(a.navTools.panbutton.id);a.impl.container.style.cursor="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAABHVBMVEUAAABPTk4AAAAAAAAJCQkRERE0MzQQEBAODg4QEBB4d3dbWlo9PDw/Pj4vLy8sLCwZGBgWFhYcHBwKCgoSEhIAAAAKCgoICAgKCgoQEBAODg4EBAQICAgPDw8REREMDAx2dnY0NDQvLy9QUFAaGhomJSYjIyM7OjokJCQNDA0mJiYNDQ0AAAAUFBQJCQkQEBAEBAQNDQ0PDw8VFRX///+amJkAAAD5+fnz8/PKycn9/f339vbi4eLR0dDNzMyAgIB8e3xycHH7+/vw7+/o6OjX1ta7urq4t7iwsLCnp6eioqKbmppva21OTk74+Pjl5eXc3Nzb29vLy8vDw8PDwsKrqqqdnZ2WlpaSkpKTkZKMiouEg4NkZGRISEgxLzBpgbsEAAAANHRSTlMA+fiQXgngKSYG/vX17uvBuqackpCNg3BpUkpAPBwTDvj18+vl0s/NwrOwoZZ+TDg4NBkBGrzX8QAAAP5JREFUKM99j9Vuw0AQRdeuKZyGkyZNmbnXDLHDVGb8/8/oy7paK1bO0+oc7WiGnGiaxq+QRTQAOh8f9Jv4H/Ge8PZPrCdlvkxfYluUT2WyyCq3mZ7unwlKVLcqOzA/Mf71j0TWJ/Ym6rPeca05Ni4iIevYc7yoUD2zQFhq71BdI9nvBeBabFDSPe8DswlUc1Riw3VxbH0NHBUPQ0jrbDnPYDjALQBMq9E7nkC5y7VDKTZlUg8Q0lmjvl74zlYErgvKa42GPKf3/a0kQmYCDY1SYMDosqMoiWrGwz/uAbNvc/fNon4kXRKGq+PUo2Mb96afV0iUxqGU2s4VBbKUP65NL/LKF+7ZAAAAAElFTkSuQmCC, auto";
break;case VIEWER2D_NAVIGATION_MODE.ZOOM:a.navTools.select(a.navTools.dollybutton.id);a.impl.container.style.cursor="url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAAAgVBMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8mJiYAAADNzc2/v7+fn59paWlPT08MDAwICAj6+vqpqak7Ozv29vby8vLp6em2traAgIBkZGRZWVlAQEAaGhpISEgkS7tbAAAAFHRSTlMAOvhpZD8mkQWegMy9qY1YVE01EYiqlE0AAADZSURBVCjPbY9ZloMgEAAbEbfsmRZZXbJn7n/AAX2RQVN/VD26AXLOeZLDGo6IbfI9tHq8cdxuj1HwvgCoaiHqKoRk+M3hB9jueUW8PnfsE/bJ3vms7nCkq7NoE3s99AXxoh8vFoXCpknrn5faAuJCenT0xPkYqnxQFJaU0gdZrsKm8aHZrAIffBj40mc1jsTfIJRWegq6opTMvlfqLqYg7kr1ZB7jFgeaMC59N//8O4WZ1IiPF8b5wMHcJn8zB4g4mc77zpxgAbMSUVoGK4iV0hL4wrksz+H0Bw5+E+HrniDQAAAAAElFTkSuQmCC), auto";
break;default:a.impl.container.style.cursor="auto"}});this.impl.setNavigationMode(VIEWER2D_NAVIGATION_MODE.PAN)};Autodesk.Viewing.Private.GuiViewer2D.prototype.uninitialize=function(){this.toolbar=this.navTools=this.modelTools=null;Autodesk.Viewing.Viewer2D.prototype.uninitialize.call(this)};
Autodesk.Viewing.Private.GuiViewer2D.prototype.initModelTools=function(){if(this.canChangeScreenMode()){this.modelTools=this.toolbar.addSubToolbar("modelTools",!1);var a=this;this.modelTools.fullscreenbutton=this.addMenuButton("modelTools","toolbar-fullscreenTool","viewer-toolbar:Full screen",function(b){a.nextScreenMode()})}};
Autodesk.Viewing.Private.GuiViewer2D.prototype.initEscapeHandlers=function(){var a=this;this.addEventListener(Autodesk.Viewing.ESCAPE_EVENT,function(b){a.impl.setNavigationMode(VIEWER2D_NAVIGATION_MODE.PAN)||a.escapeScreenMode()},!1)};
Autodesk.Viewing.Private.GuiViewer2D.prototype.initHomeButton=function(){var a=this,b=this.homeViewContainer=document.createElement("div");b.className="homeViewWrapper";var c=document.createElement("img");c.className="homeView";c.src=Autodesk.Viewing.Private.getResourceUrl("icons/resetview_icon.png");c.style.cursor="pointer";b.appendChild(c);b.style.width="auto";this.container.appendChild(b);c.addEventListener("click",function(){a.impl.goHome()})};
Autodesk.Viewing.Private.GuiViewer2D.prototype.addMenuButton=function(a,b,c,d){b=Autodesk.Viewing.UI.Toolbar.createMenuButton(b,c,d);this.toolbar.addToSubToolbar(a,b);return b};
Autodesk.Viewing.Private.GuiViewer2D.prototype.updateScreenModeButton=function(a){this.container.classList.remove("screenMode-kFullBrowser");this.container.classList.remove("screenMode-kFullScreen");var b;switch(a){case Autodesk.Viewing.Viewer.prototype.ScreenMode.kNormal:this.isScreenModeSupported(Autodesk.Viewing.Viewer.prototype.ScreenMode.kFullBrowser)||(b="screenMode-kFullBrowser");break;case Autodesk.Viewing.Viewer.prototype.ScreenMode.kFullBrowser:b=this.isScreenModeSupported(Autodesk.Viewing.Viewer.prototype.ScreenMode.kFullScreen)?
"screenMode-kFullBrowser":"screenMode-kFullScreen";break;case Autodesk.Viewing.Viewer.prototype.ScreenMode.kFullScreen:b="screenMode-kFullScreen"}b&&this.container.classList.add(b)};AutodeskNamespace("Autodesk.Viewing.Extensions");
Autodesk.Viewing.Extensions.ViewerPanelMixin=function(){this.getContainerBoundingRect=function(){var a=this.parentContainer.getBoundingClientRect(),b={height:0,width:0,left:0,bottom:0,right:0,top:0},c=document.getElementsByClassName("toolbar-menu");c&&0<c.length&&(b=c[0].getBoundingClientRect());return{height:a.height-b.height,width:a.width,left:a.left,bottom:a.bottom-b.height,right:a.right,top:a.top}}};AutodeskNamespace("Autodesk.Viewing.Extensions");
Autodesk.Viewing.Extensions.ViewerModelStructurePanel=function(a,b,c){this.viewer=a;Autodesk.Viewing.UI.ModelStructurePanel.call(this,a.container,a.container.id+"ViewerModelStructurePanel",b,c);this.clickConfig=c&&c.docStructureConfig?c.docStructureConfig:null;this.isMac=-1!==navigator.userAgent.search("Mac OS")};Autodesk.Viewing.Extensions.ViewerModelStructurePanel.prototype=Object.create(Autodesk.Viewing.UI.ModelStructurePanel.prototype);
Autodesk.Viewing.Extensions.ViewerModelStructurePanel.prototype.constructor=Autodesk.Viewing.Extensions.ViewerModelStructurePanel;Autodesk.Viewing.Extensions.ViewerPanelMixin.call(Autodesk.Viewing.Extensions.ViewerModelStructurePanel.prototype);
Autodesk.Viewing.Extensions.ViewerModelStructurePanel.prototype.initialize=function(){Autodesk.Viewing.UI.ModelStructurePanel.prototype.initialize.call(this);var a=this;a.addEventListener(a.viewer,Autodesk.Viewing.SELECTION_CHANGED_EVENT,function(b){a.setSelection(b.nodeArray.slice())});a.addEventListener(a.viewer,Autodesk.Viewing.ISOLATE_EVENT,function(b){a.setIsolation(b.nodeIdArray.slice())});a.addEventListener(a.viewer,Autodesk.Viewing.HIDE_EVENT,function(b){a.setHidden(b.nodeIdArray.slice(),
!0)});a.addEventListener(a.viewer,Autodesk.Viewing.SHOW_EVENT,function(b){a.setHidden(b.nodeIdArray.slice(),!1)})};Autodesk.Viewing.Extensions.ViewerModelStructurePanel.prototype.uninitialize=function(){this.viewer=null;Autodesk.Viewing.UI.ModelStructurePanel.prototype.uninitialize.call(this)};
Autodesk.Viewing.Extensions.ViewerModelStructurePanel.prototype.handleAction=function(a,b){for(var c in a)switch(a[c]){case "selectOnly":this.viewer.select([b.dbId]);break;case "deselectAll":this.viewer.select([]);break;case "selectToggle":this.viewer.toggleSelect(b.dbId);break;case "isolate":this.viewer.isolate(b);break;case "showAll":this.viewer.isolate(null);break;case "focus":this.viewer.fitToView();break;case "hide":this.viewer.hide(b);break;case "show":this.viewer.show(b);break;case "toggleVisibility":this.viewer.toggleVisibility(b)}};
Autodesk.Viewing.Extensions.ViewerModelStructurePanel.prototype.ctrlDown=function(a){return this.isMac&&a.metaKey||!this.isMac&&a.ctrlKey};Autodesk.Viewing.Extensions.ViewerModelStructurePanel.prototype.onClick=function(a,b){if(!this.isMac||!b.ctrlKey){var c="click";this.ctrlDown(b)&&(c+="Ctrl");b.shiftKey&&(c+="Shift");b.altKey&&(c+="Alt");this.clickConfig&&this.clickConfig[c]?this.handleAction(this.clickConfig[c].onObject,a):this.viewer.select([a.dbId])}};
Autodesk.Viewing.Extensions.ViewerModelStructurePanel.prototype.onDoubleClick=function(a,b){this.handleAction(["focus"],a)};
Autodesk.Viewing.Extensions.ViewerModelStructurePanel.prototype.onRightClick=function(a,b){if(this.isMac&&b.ctrlKey&&0===b.button)return this.clickConfig&&this.clickConfig.clickCtrl?this.handleAction(this.clickConfig.clickCtrl.onObject,a):this.viewer.select([a.dbId]),null;var c=[],d=!0;if(b.shiftKey||this.isMac&&b.metaKey||b.ctrlKey&&(this.isMac||2===b.button))for(var f=this.viewer.impl.selector.getSelection(),g=0;g<f.length;++g)f[g].dbId!==a.dbId?c.push(f[g].dbId):d=!1;d&&c.push(a.dbId);this.viewer.select(c);
return this.viewer.contextMenu.show(b)};Autodesk.Viewing.Extensions.ViewerModelStructurePanel.prototype.setHidden=function(a,b){function c(a,c){c.classList.toggle("dim",b);c.classList.toggle("visible",!b)}for(var d=0;d<a.length;++d)this.tree.iterate(a[d],c)};
Autodesk.Viewing.Extensions.ViewerModelStructurePanel.prototype.setIsolation=function(a){this.tree.iterate(this.modelRoot,function(a,b){b.classList.remove("dim");b.classList.remove("visible")});if(0<a.length&&(1!==a.length||a[0]!==this.modelRoot)){this.setHidden([this.modelRoot],!0);for(var b=0;b<a.length;++b)this.setHidden([a[b]],!1)}};AutodeskNamespace("Autodesk.Viewing.Extensions");
Autodesk.Viewing.Extensions.ViewerPropertyPanel=function(a){this.viewer=a;this.currentNodeIds=[];this.isSelection=!1;this.isDirty=!0;this.propertyNodeId=null;Autodesk.Viewing.UI.PropertyPanel.call(this,a.container,"ViewerPropertyPanel","Object Properties Loading...")};Autodesk.Viewing.Extensions.ViewerPropertyPanel.prototype=Object.create(Autodesk.Viewing.UI.PropertyPanel.prototype);Autodesk.Viewing.Extensions.ViewerPropertyPanel.prototype.constructor=Autodesk.Viewing.Extensions.ViewerPropertyPanel;
Autodesk.Viewing.Extensions.ViewerPanelMixin.call(Autodesk.Viewing.Extensions.ViewerPropertyPanel.prototype);
Autodesk.Viewing.Extensions.ViewerPropertyPanel.prototype.initialize=function(){function a(a){for(var b=[],f=0;f<a.length;f++){var g=a[f].dbId;g&&b.push(g)}return b}Autodesk.Viewing.UI.PropertyPanel.prototype.initialize.call(this);var b=this;b.addEventListener(b.viewer,Autodesk.Viewing.SELECTION_CHANGED_EVENT,function(a){b.currentNodeIds=a.dbIdArray;b.isSelection=0<a.dbIdArray.length;b.isDirty=!0;b.requestProperties()});b.addEventListener(b.viewer,Autodesk.Viewing.ISOLATE_EVENT,function(c){0==c.nodeIdArray.length&&
b.isSelection||(b.currentNodeIds=a(c.nodeIdArray),b.isDirty=!0,b.requestProperties())});b.addEventListener(b.viewer,Autodesk.Viewing.HIDE_EVENT,function(a){b.isDirty=!0;b.requestProperties()});b.addEventListener(b.viewer,Autodesk.Viewing.SHOW_EVENT,function(a){b.isDirty=!0;b.requestProperties()});this.currentNodeIds=a(b.viewer.getSelection());0===this.currentNodeIds.length?this.currentNodeIds=a(b.viewer.getIsolatedNodes()):this.isSelection=!0};
Autodesk.Viewing.Extensions.ViewerPropertyPanel.prototype.setTitle=function(a,b){a||(a="Object Properties",b=b||{},b.localizeTitle=!0);Autodesk.Viewing.UI.PropertyPanel.prototype.setTitle.call(this,a,b)};Autodesk.Viewing.Extensions.ViewerPropertyPanel.prototype.setVisible=function(a){Autodesk.Viewing.UI.DockingPanel.prototype.setVisible.call(this,a);this.requestProperties()};
Autodesk.Viewing.Extensions.ViewerPropertyPanel.prototype.visibilityChanged=function(){Autodesk.Viewing.UI.DockingPanel.prototype.visibilityChanged.call(this);this.isVisible()&&this.requestProperties()};Autodesk.Viewing.Extensions.ViewerPropertyPanel.prototype.requestProperties=function(){this.isVisible()&&this.isDirty&&(0<this.currentNodeIds.length?this.setNodeProperties(this.currentNodeIds[this.currentNodeIds.length-1]):this.showDefaultProperties(),this.isDirty=!1)};
Autodesk.Viewing.Extensions.ViewerPropertyPanel.prototype.setNodeProperties=function(a){var b=this;this.propertyNodeId=a;b.viewer.getProperties(a,function(a){b.setTitle(a.name);b.setProperties(a.properties);b.highlight(b.viewer.searchText);b.resizeToContent();if(b.isVisible()){var d=b.viewer.toolController;a=d.lastClickX;var d=d.lastClickY,f=b.container.getBoundingClientRect(),g=f.left,h=f.top,k=f.width,f=f.height,l=b.viewer.canvas.getBoundingClientRect(),m=l.left,p=l.top,n=l.width,l=l.height;g<=
a&&a<g+k&&h<=d&&d<h+f&&(a<g+k/2&&a+k<m+n?(b.container.style.left=Math.round(a-m)+"px",b.container.dockRight=!1):m<=a-k?(b.container.style.left=Math.round(a-m-k)+"px",b.container.dockRight=!1):a+k<m+n?(b.container.style.left=Math.round(a-m)+"px",b.container.dockRight=!1):d+f<p+l?(b.container.style.top=Math.round(d-p)+"px",b.container.dockBottom=!1):p<=d-f&&(b.container.style.top=Math.round(d-p-f)+"px",b.container.dockBottom=!1))}})};
Autodesk.Viewing.Extensions.ViewerPropertyPanel.prototype.showDefaultProperties=function(){var a=this.viewer.model.getRoot()?this.viewer.model.getRootId():null;null!==a?this.setNodeProperties(a):(this.propertyNodeId=null,this.setTitle("Model Properties",{localizeTitle:!0}),Autodesk.Viewing.UI.PropertyPanel.prototype.showDefaultProperties.call(this))};
Autodesk.Viewing.Extensions.ViewerPropertyPanel.prototype.areDefaultPropertiesShown=function(){var a=this.viewer.model.getRootId();return this.propertyNodeId===a};Autodesk.Viewing.Extensions.ViewerPropertyPanel.prototype.uninitialize=function(){Autodesk.Viewing.UI.PropertyPanel.prototype.uninitialize.call(this);this.viewer=null};
Autodesk.Viewing.Extensions.ViewerPropertyPanel.prototype.onCategoryClick=function(a,b){Autodesk.Viewing.UI.PropertyPanel.prototype.onCategoryClick.call(this,a,b);this.viewer.getDimensions();this.resizeToContent()};Autodesk.Viewing.Extensions.ViewerPropertyPanel.prototype.onCategoryIconClick=function(a,b){Autodesk.Viewing.UI.PropertyPanel.prototype.onCategoryIconClick.call(this,a,b);this.viewer.getDimensions();this.resizeToContent()};AutodeskNamespace("Autodesk.Viewing.Extensions");
Autodesk.Viewing.Extensions.ViewerLayersPanel=function(a){var b=a.container;Autodesk.Viewing.UI.LayersPanel.call(this,a,b,b.id+"ViewerLayersPanel")};Autodesk.Viewing.Extensions.ViewerLayersPanel.prototype=Object.create(Autodesk.Viewing.UI.LayersPanel.prototype);Autodesk.Viewing.Extensions.ViewerLayersPanel.prototype.constructor=Autodesk.Viewing.Extensions.ViewerLayersPanel;Autodesk.Viewing.Extensions.ViewerPanelMixin.call(Autodesk.Viewing.Extensions.ViewerLayersPanel.prototype);
Autodesk.Viewing.Extensions.ViewerLayersPanel.prototype.onClick=function(a,b){this.isMac&&b.ctrlKey||this.setLayerVisible(a,!(b.shiftKey||b.metaKey||b.ctrlKey))};Autodesk.Viewing.Extensions.ViewerLayersPanel.prototype.onRightClick=function(a,b){this.setLayerVisible(a,!(b.shiftKey||b.metaKey||b.ctrlKey))};Autodesk.Viewing.Extensions.ViewerLayersPanel.prototype.onImageClick=function(a,b){this.isMac&&b.ctrlKey||this.setLayerVisible(a)};
Autodesk.Viewing.Extensions.ViewerLayersPanel.prototype.onTitleClick=function(a){this.viewer.setLayerVisible(null,!0)};Autodesk.Viewing.Extensions.ViewerLayersPanel.prototype.onTitleDoubleClick=function(a){this.viewer.fitToView()};AutodeskNamespace("Autodesk.Viewing.Extensions");Autodesk.Viewing.Extensions.ViewerSettingTab={Navigation:"navigationtab",Performance:"performancetab"};
Autodesk.Viewing.Extensions.ViewerSettingsPanel=function(a,b){this.viewer=a;this.is3dMode="3d"===b;Autodesk.Viewing.UI.SettingsPanel.call(this,a.container,"ViewerSettingsPanel","Settings",{heightAdjustment:155});this.addTab("navigationtab","Navigation and selection",{className:"navigation"});this.addTab("performancetab","Performance and appearance",{className:"performance"});this.restoreDiv=document.createElement("div");this.restoreDiv.className="viewer-restore-defaults";this.restoreDiv.setAttribute("data-i18n",
"Restore settings defaults");this.restoreDiv.textContent=Autodesk.Viewing.i18n.translate("Restore settings defaults");this.addEventListener(this.restoreDiv,"touchstart",touchStartToClick);this.addEventListener(this.restoreDiv,"click",function(){var b=a.model.is2d()?"2d":"3d";a.prefs.reset(b)},!1);this.container.appendChild(this.restoreDiv);this.createNavigationPanel();this.createPerformancePanel()};Autodesk.Viewing.Extensions.ViewerSettingsPanel.prototype=Object.create(Autodesk.Viewing.UI.SettingsPanel.prototype);
Autodesk.Viewing.Extensions.ViewerSettingsPanel.prototype.constructor=Autodesk.Viewing.Extensions.ViewerSettingsPanel;Autodesk.Viewing.Extensions.ViewerPanelMixin.call(Autodesk.Viewing.Extensions.ViewerSettingsPanel.prototype);Autodesk.Viewing.Extensions.ViewerSettingsPanel.prototype.uninitialize=function(){this.viewer=null;Autodesk.Viewing.UI.SettingsPanel.prototype.uninitialize.call(this)};
Autodesk.Viewing.Extensions.ViewerSettingsPanel.prototype.addCheckbox=function(a,b,c,d,f){var g=this.viewer,h=g.prefs[f];a=Autodesk.Viewing.UI.SettingsPanel.prototype.addCheckbox.call(this,a,b,"boolean"===typeof h?h:c,function(a){g.prefs.set(f,a);d(a)});var k=this.getControl(a);k.saveKey=f;g.prefs.addListeners(f,function(a){k.setValue(a)},function(a){k.setValue(a);d(a)});return k};
Autodesk.Viewing.Extensions.ViewerSettingsPanel.prototype.removeCheckbox=function(a){this.viewer.prefs.removeListeners(a.saveKey);this.removeEventListener(a,"change",a.changeListener);return Autodesk.Viewing.UI.SettingsPanel.prototype.removeCheckbox.call(this,a)};
Autodesk.Viewing.Extensions.ViewerSettingsPanel.prototype.createNavigationPanel=function(){var a=this.viewer,b=Autodesk.Viewing.Extensions.ViewerSettingTab.Navigation;this.is3dMode&&(this.addCheckbox(b,"Show ViewCube",!0,function(b){a.displayViewCube(b)},"viewCube"),this.addCheckbox(b,"ViewCube acts on pivot",!1,function(b){a.setUsePivotAlways(b)},"alwaysUsePivot"),this.addCheckbox(b,"Zoom towards pivot",!1,function(b){a.setZoomTowardsPivot(b)},"zoomTowardsPivot"),this.addCheckbox(b,"Set pivot with left mouse button",
!1,function(b){a.setClickToSetCOI(b)},"clickToSetCOI"));this.addCheckbox(b,"Reverse mouse zoom direction",!1,function(b){a.setReverseZoomDirection(b)},"reverseMouseZoomDir");this.is3dMode&&this.addCheckbox(b,"Orbit past world poles",!0,function(b){a.setOrbitPastWorldPoles(b)},"orbitPastWorldPoles");this.addCheckbox(b,"Open properties on select",!0,function(b){a.setPropertiesOnSelect(b)},"openPropertiesOnSelect");this.addCheckbox(b,"Left handed mouse setup",!1,function(b){a.setUseLeftHandedInput(b)},
"leftHandedMouseSetup")};
Autodesk.Viewing.Extensions.ViewerSettingsPanel.prototype.createPerformancePanel=function(){var a=this.viewer,b=Autodesk.Viewing.Extensions.ViewerSettingTab.Performance;this.is3dMode&&(this.ghosthiddenChkBoxId=this.addCheckbox(b,"Ghost hidden objects",!0,function(b){a.setGhosting(b)},"ghosting"),this.optimizeNavigationhkBoxId=this.addCheckbox(b,"Smooth navigation",!1,function(b){a.setOptimizeNavigation(b)},"optimizeNavigation"),this.ambientshadowsChkBoxId=this.addCheckbox(b,"Ambient shadows",!0,function(b){a.setQualityLevel(b,
a.prefs.antialiasing)},"ambientShadows"),this.groundShadowChkBoxId=this.addCheckbox(b,"Ground shadow",!0,function(b){a.setGroundShadow(b)},"groundShadow"),this.antialiasingChkBoxId=this.addCheckbox(b,"Anti-aliasing",!0,function(b){a.setQualityLevel(a.prefs.ambientShadows,b)},"antialiasing"));this.progressiveRenderChkBoxId=this.addCheckbox(b,"Progressive model display",!0,function(b){a.setProgressiveRendering(b)},"progressiveRendering")};
Autodesk.Viewing.Extensions.ViewerSettingsPanel.prototype.syncUI=function(){var a=this.viewer,b=this.getControl(this.antialiasingChkBoxId);b&&b.setValue(a.prefs.antialiasing);(b=this.getControl(this.ambientshadowsChkBoxId))&&b.setValue(a.prefs.ambientShadows);(b=this.getControl(this.groundShadowChkBoxId))&&b.setValue(a.prefs.groundShadow);(b=this.getControl(this.progressiveRenderChkBoxId))&&b.setValue(a.prefs.progressiveRendering);(b=this.getControl(this.ghosthiddenChkBoxId))&&b.setValue(a.prefs.ghosting)};
AutodeskNamespace("Autodesk.Viewing.Extensions.RaaS");
Autodesk.Viewing.Extensions.RaaS.RaaSPanel=function(a){var b=this;this.viewer=a;Autodesk.Viewing.UI.DockingPanel.call(this,a.container,"RaaSPanel","Gallery");this.thumbnailPanel=document.createElement("div");this.thumbnailPanel.id="thumbnailPanel";this.imageNum=0;this.thumbList=[];this.imageList=[];this.imageIndex=0;this.container.style.width="140px";this.container.style.top="200px";this.container.style.left="150px";this.container.style.height="560px";this.container.dockRight=!0;this.container.style.display=
"none";this.addEventListener(this.viewer,Autodesk.Viewing.GEOMETRY_LOADED_EVENT,function(){b.syncUI()});this.addVisibilityListener(function(){b.resizeToContent({maxHeight:b.parentContainer.offsetHeight-75})})};Autodesk.Viewing.Extensions.RaaS.RaaSPanel.prototype=Object.create(Autodesk.Viewing.UI.DockingPanel.prototype);Autodesk.Viewing.Extensions.RaaS.RaaSPanel.prototype.constructor=Autodesk.Viewing.Extensions.RaaSPanel;Autodesk.Viewing.Extensions.RaaS.RaaSPanel.prototype.syncUI=function(){};
Autodesk.Viewing.Extensions.RaaS.RaaSPanel.prototype.screenCapture=function(a){return a.impl.renderer().screenCapture()};
Autodesk.Viewing.Extensions.RaaS.RaaSPanel.prototype.addImage=function(){var a=this,b=new Image;b.src=this.screenCapture(this.viewer);b.className="thumbnail";b.style.top=130*this.imageNum+"px";b.index=this.imageNum;var c=this.viewer.getCamera();b.cameraPosition=c.position.clone();b.cameraTarget=c.target.clone();b.cameraUp=c.up.clone();this.thumbList.push(b);this.thumbnailPanel.appendChild(this.thumbList[this.imageNum]);b=new Image;b.src="";b.status="progress";this.imageList.push(b);this.imageNum++;
this.container.appendChild(this.thumbnailPanel);this.imageIndex=this.imageNum-1;this.addEventListener(this.thumbList[this.imageIndex],"click",function(){"progress"==a.imageList[this.index].status?a.imageIndex=this.index:"complete"==a.imageList[this.index].status?(a.imageIndex=this.index,a.displayImage(a.imageList[a.imageIndex],a.imageIndex)):"error"==a.imageList[this.index].status&&(a.imageIndex=this.index)});this.zoomin();a.resizeToContent({maxHeight:a.parentContainer.offsetHeight-75})};
Autodesk.Viewing.Extensions.RaaS.RaaSPanel.prototype.loadThumbnail=function(a,b){this.thumbList[b-1].src=a};Autodesk.Viewing.Extensions.RaaS.RaaSPanel.prototype.loadImage=function(a,b){this.imageList[b-1].src=a;this.imageList[b-1].status="complete"};Autodesk.Viewing.Extensions.RaaS.RaaSPanel.prototype.imageError=function(a){this.imageList[a-1].status="error"};
Autodesk.Viewing.Extensions.RaaS.RaaSPanel.prototype.displayImage=function(a,b){if(0!=document.getElementsByClassName("imageContainer").length){var c=document.getElementsByClassName("imageContainer")[0];c.parentNode.removeChild(c)}var d=this.viewer.container,f=document.createElement("div");f.className="imageContainer";f.style.width=d.style.width;f.style.height=d.style.height;d.parentNode.appendChild(f);var g=document.createElement("canvas");f.appendChild(g);g.style.width=d.style.width;g.style.height=
d.style.height;g.width=this.viewer.canvas.width;g.height=this.viewer.canvas.height;this.addEventListener(g,"click",function(){d.style.zIndex="";null!=f.parentNode&&f.parentNode.removeChild(f)});d.style.zIndex=-1;f.style.zIndex=1;a.complete?toggleAnim(g,a):a.onload=function(){toggleAnim(g,a)};c=this.viewer.getCamera();c.position=this.thumbList[b].cameraPosition.clone();c.target=this.thumbList[b].cameraTarget.clone();c.up=this.thumbList[b].cameraUp.clone();c.updateProjectionMatrix()};
Autodesk.Viewing.Extensions.RaaS.RaaSPanel.prototype.uninitialize=function(){this.imageIndex=this.imageList=this.thumbList=this.imageNum=this.thumbnailPanel=this.viewer=null;Autodesk.Viewing.UI.DockingPanel.prototype.uninitialize.call(this)};Autodesk.Viewing.Extensions.RaaS.RaaSPanel.prototype.getContentSize=function(){return{height:130*this.thumbList.length+45,width:130}};
Autodesk.Viewing.Extensions.RaaS.RaaSPanel.prototype.zoomin=function(){var a=this,b=new Image;b.src=this.screenCapture(this.viewer);var c=this.viewer.container,d=document.createElement("div");d.id="imageTemp";d.style.width=c.style.width;d.style.height=c.style.height;c.parentNode.appendChild(d);b.style.width=c.style.width;b.style.height=c.style.height;d.appendChild(b);c.style.zIndex=-1;d.style.zIndex=1;setTimeout(function(){var b=(a.thumbList[a.imageIndex].getBoundingClientRect().left+a.thumbList[a.imageIndex].getBoundingClientRect().right)/
2-(d.getBoundingClientRect().left+d.getBoundingClientRect().right)/2,g=a.thumbList[a.imageIndex].getBoundingClientRect().bottom<=a.thumbnailPanel.getBoundingClientRect().bottom?(a.thumbList[a.imageIndex].getBoundingClientRect().top+a.thumbList[a.imageIndex].getBoundingClientRect().bottom)/2-(d.getBoundingClientRect().top+d.getBoundingClientRect().bottom)/2:a.thumbnailPanel.getBoundingClientRect().bottom-a.thumbList[a.imageIndex].offsetHeight/2-(d.getBoundingClientRect().top+d.getBoundingClientRect().bottom)/
2,h=a.thumbList[a.imageIndex].clientWidth/c.clientWidth,k=a.thumbList[a.imageIndex].clientHeight/c.clientHeight;d.style.webkitTransform="translate("+b+"px,"+g+"px) scale("+h+","+k+")";d.style.transform="translate("+b+"px,"+g+"px) scale("+h+","+k+")"},10);setTimeout(function(){d.parentNode.removeChild(d);c.style.zIndex=""},500)};
function toggleAnim(a,b){function c(){var g=d+=f,h=a,k=b,l=h.getContext("2d");l.mozImageSmoothingEnabled=!1;l.webkitImageSmoothingEnabled=!1;l.imageSmoothingEnabled=!1;var m=0.01*g,g=h.width*m,m=h.height*m;l.drawImage(k,0,0,g,m);l.drawImage(h,0,0,g,m,0,0,h.width,h.height);100>=d&&requestAnimationFrame(c)}var d=0,f=0.5;c();window.requestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(a){window.setTimeout(a,
1E3/60)}}()}"use strict";AutodeskNamespace("Autodesk.Viewing.Extensions.RaaS");Autodesk.Viewing.Extensions.RaaS.RaaSExtension=function(a,b){Autodesk.Viewing.Extension.call(this,a,b)};Autodesk.Viewing.Extensions.RaaS.RaaSExtension.prototype=Object.create(Autodesk.Viewing.Extension.prototype);Autodesk.Viewing.Extensions.RaaS.RaaSExtension.prototype.constructor=Autodesk.Viewing.Extensions.RaaS.RaaSExtension;
Autodesk.Viewing.Extensions.RaaS.RaaSExtension.prototype.load=function(){function a(a){f.loadThumbnail(a.thumbnail,a.imageNo);f.loadImage(a.image,a.imageNo);var b=new Image;b.src=a.image;f.displayImage(b,a.imageNo-1)}function b(a){a.imageNo&&f.imageError(a.imageNo)}var c=this,d=this.viewer;this.raaSTools=d.getToolbar(!0).addSubToolbar("raaSTools",!1);var f=this.raaSPanel=new Autodesk.Viewing.Extensions.RaaS.RaaSPanel(d);d.addPanel(this.raaSPanel);this.raaSTools.renderButton=d.addMenuButton(this.raaSTools.id,
"toolbar-raaSTool","RaaS",function(f){c.showRaaSPanel(!0);c.raaSPanel.addImage();d.impl.svfloader.svfToSpdTranslator(d,c.raaSPanel.imageNum,a,b)});this.raaSTools.galleryButton=d.addMenuButton(this.raaSTools.id,"toolbar-raaSThumbnailTool","Gallery",function(a){c.showRaaSPanel(!f.isVisible())});return!0};Autodesk.Viewing.Extensions.RaaS.RaaSExtension.prototype.showRaaSPanel=function(a){this.raaSPanel&&this.raaSPanel.setVisible(a)};
Autodesk.Viewing.Extensions.RaaS.RaaSExtension.prototype.unload=function(){var a=this.viewer;a.removePanel(this.raaSPanel);if(a=a.getToolbar(!1))a.removeFromSubToolbar(this.raaSTools.id,this.raaSTools.renderButton),a.removeFromSubToolbar(this.raaSTools.id,this.raaSTools.galleryButton),a.removeSubToolbar(this.raaSTools);this.raaSPanel.uninitialize();this.raaSTools=this.raaSPanel=null};Autodesk.Viewing.theExtensionManager.registerExtension("Autodesk.RaaS",Autodesk.Viewing.Extensions.RaaS.RaaSExtension);
AutodeskNamespace("Autodesk.Viewing.Extensions");Autodesk.Viewing.Extensions.ViewerObjectContextMenu=function(a){Autodesk.Viewing.UI.ObjectContextMenu.call(this,a)};Autodesk.Viewing.Extensions.ViewerObjectContextMenu.prototype=Object.create(Autodesk.Viewing.UI.ObjectContextMenu.prototype);Autodesk.Viewing.Extensions.ViewerObjectContextMenu.prototype.constructor=Autodesk.Viewing.Extensions.ViewerObjectContextMenu;
Autodesk.Viewing.Extensions.ViewerObjectContextMenu.prototype.buildMenu=function(a,b){var c=this,d=[],f=this.viewer.model.is2d();!f&&b.hasSelected&&(d.push({title:"Isolate",target:function(){var a=c.viewer.getSelection();c.viewer.clearSelection();c.viewer.isolate(a)}}),b.hasVisible&&d.push({title:"Hide Selected",target:function(){var a=c.viewer.getSelection();c.viewer.clearSelection();c.viewer.hide(a)}}),b.hasHidden&&d.push({title:"Show Selected",target:function(){var a=c.viewer.getSelection();c.viewer.clearSelection();
c.viewer.show(a)}}));f?d.push({title:"Show All Layers",target:function(){c.viewer.setLayerVisible(null,!0)}}):d.push({title:"Show All Objects",target:function(){c.viewer.showAll()}});!f&&b.hasSelected&&d.push({title:"Focus",target:function(){var a=c.viewer.getSelection().map(function(a){return a.dbId});c.viewer.fitToView(a)}});b.hasSelected&&d.push({title:"Clear Selection",target:function(){c.viewer.clearSelection()}});return d};"use strict";AutodeskNamespace("Autodesk.Viewing.Extensions.CAM360");
Autodesk.Viewing.Extensions.CAM360.CAM360Extension=function(a,b){Autodesk.Viewing.Extension.call(this,a,b)};Autodesk.Viewing.Extensions.CAM360.CAM360Extension.prototype=Object.create(Autodesk.Viewing.Extension.prototype);Autodesk.Viewing.Extensions.CAM360.CAM360Extension.prototype.constructor=Autodesk.Viewing.Extensions.CAM360.CAM360Extension;
Autodesk.Viewing.Extensions.CAM360.CAM360Extension.prototype.load=function(){function a(){b.setLightPreset(0);b.removeEventListener(Autodesk.Viewing.GEOMETRY_LOADED_EVENT,a)}var b=this.viewer,c=new Autodesk.Viewing.Extensions.CAM360.CAMModelStructurePanel(this.viewer,"CAM Model Structure Loading",this.options);b.setModelStructurePanel(c);b.hideLines(!1);b.setGhosting(!1);b.setQualityLevel(!1,!0);b.addEventListener(Autodesk.Viewing.GEOMETRY_LOADED_EVENT,a);return!0};
Autodesk.Viewing.Extensions.CAM360.CAM360Extension.prototype.unload=function(){this.viewer.setModelStructurePanel(null)};Autodesk.Viewing.theExtensionManager.registerExtension("Autodesk.CAM360",Autodesk.Viewing.Extensions.CAM360.CAM360Extension);"use strict";AutodeskNamespace("Autodesk.Viewing.Extensions.CAM360");Autodesk.Viewing.Extensions.CAM360.CAMModelStructurePanel=function(a,b,c){Autodesk.Viewing.Extensions.ViewerModelStructurePanel.call(this,a,b,c);this.viewer=a};
Autodesk.Viewing.Extensions.CAM360.CAMModelStructurePanel.prototype=Object.create(Autodesk.Viewing.Extensions.ViewerModelStructurePanel.prototype);Autodesk.Viewing.Extensions.CAM360.CAMModelStructurePanel.prototype.constructor=Autodesk.Viewing.Extensions.CAM360.CAMModelStructurePanel;
Autodesk.Viewing.Extensions.CAM360.CAMModelStructurePanel.prototype.sortCamNodes=function(a,b){function c(a){if(a.children)for(var b=0;b<a.children.length;b++){var d=a.children[b];h.push(d);c(d)}}function d(a,b){g.viewer.getProperties(a.dbId,function(c){a:{c=c.properties;for(var d=0;d<c.length;++d){var f=c[d];if("9429B915-D020-4CEB-971B-6ADD0A5D4BFA"===f.displayName){c=f.displayValue;break a}}c=null}c?("CAM_Setup"==c?g.camSetupNodes.push(a):"CAM_Operation"==c?g.camOperationNodes.push(a):"CAM_Tool"===
c?g.camToolNodes.push(a):"CAM_Stock"===c?g.camStockNodes.push(a):"CAM_Folder"==c&&g.camFolderNodes.push(a),g.camNodes.push(a)):g.camModelNodes.push(a);b()},function(a,c,d){b()})}function f(){0<h.length?d(h.shift(),f):b()}this.camNodes=[];this.camModelNodes=[];this.camSetupNodes=[];this.camStockNodes=[];this.camOperationNodes=[];this.camToolNodes=[];this.camFolderNodes=[];var g=this,h=[];c(a);f()};
Autodesk.Viewing.Extensions.CAM360.CAMModelStructurePanel.prototype.setModel=function(a,b){var c=this;c.sortCamNodes(a,function(){Autodesk.Viewing.Extensions.ViewerModelStructurePanel.prototype.setModel.call(c,a,b);c.SetCAMNodeVisible(!1);c.setVisible(!0);c.ExpandSetupNodes();c.resizeToContent()})};
Autodesk.Viewing.Extensions.CAM360.CAMModelStructurePanel.prototype.initialize=function(){function a(c){b.SetCAMNodeVisible(!1);b.removeEventListener(b.viewer,Autodesk.Viewing.GEOMETRY_LOADED_EVENT,a)}Autodesk.Viewing.Extensions.ViewerModelStructurePanel.prototype.initialize.call(this);var b=this;this.viewer.model&&this.viewer.model.isLoadDone()||b.addEventListener(b.viewer,Autodesk.Viewing.GEOMETRY_LOADED_EVENT,a);b.addEventListener(b.viewer,Autodesk.Viewing.SHOW_EVENT,function(a){if(a=a.nodeIdArray)for(var d=
0;d<a.length;d++)b.setCamNodeVisibility(a[d])});b.addEventListener(b.viewer,Autodesk.Viewing.SELECTION_CHANGED_EVENT,function(a){if(a=a.nodeArray)for(var d=0;d<a.length;d++)b.HideHightlightCAMNode(a[d])});b.addEventListener(b.viewer,Autodesk.Viewing.ISOLATE_EVENT,function(a){if(a=a.nodeIdArray)if(0==a.length)b.SetModelVisible(),b.SetCAMNodeVisible(!0);else for(var d=0;d<a.length;d++)b.setCamNodeVisibility(a[d])})};
Autodesk.Viewing.Extensions.CAM360.CAMModelStructurePanel.prototype.IsCAMNode=function(a){return-1!==this.camNodes.indexOf(a)};Autodesk.Viewing.Extensions.CAM360.CAMModelStructurePanel.prototype.IsCAMSetupNode=function(a){return-1!==this.camSetupNodes.indexOf(a)};Autodesk.Viewing.Extensions.CAM360.CAMModelStructurePanel.prototype.IsCAMStockNode=function(a){return-1!==this.camStockNodes.indexOf(a)};
Autodesk.Viewing.Extensions.CAM360.CAMModelStructurePanel.prototype.IsCAMToolNode=function(a){return-1!==this.camToolNodes.indexOf(a)};Autodesk.Viewing.Extensions.CAM360.CAMModelStructurePanel.prototype.IsCAMOperationNode=function(a){return-1!==this.camOperationNodes.indexOf(a)};Autodesk.Viewing.Extensions.CAM360.CAMModelStructurePanel.prototype.IsCAMFolderNode=function(a){return-1!==this.camFolderNodes.indexOf(a)};
Autodesk.Viewing.Extensions.CAM360.CAMModelStructurePanel.prototype.shouldInclude=function(a){return!this.IsCAMStockNode(a)};Autodesk.Viewing.Extensions.CAM360.CAMModelStructurePanel.prototype.isGroupNode=function(a){return this.IsCAMOperationNode(a)?!1:Autodesk.Viewing.Extensions.ViewerModelStructurePanel.prototype.isGroupNode.call(this,a)};Autodesk.Viewing.Extensions.CAM360.CAMModelStructurePanel.prototype.setNodeVisibility=function(a,b){b?this.viewer.show(a):this.viewer.hide(a)};
Autodesk.Viewing.Extensions.CAM360.CAMModelStructurePanel.prototype.SetModelVisible=function(){if(this.camModelNodes)for(var a=0;a<this.camModelNodes.length;a++)this.setNodeVisibility(this.camModelNodes[a],!0)};Autodesk.Viewing.Extensions.CAM360.CAMModelStructurePanel.prototype.SetCAMNodeVisible=function(a){if(this.camNodes){for(var b=0;b<this.camNodes.length;b++)this.setNodeVisibility(this.camNodes[b],a);this.SetToolNodeVisible(!1)}};
Autodesk.Viewing.Extensions.CAM360.CAMModelStructurePanel.prototype.SetToolNodeVisible=function(a){if(this.camToolNodes)for(var b=0;b<this.camToolNodes.length;b++)this.setNodeVisibility(this.camToolNodes[b],a)};
Autodesk.Viewing.Extensions.CAM360.CAMModelStructurePanel.prototype.HideHightlightNode=function(a){var b=this.viewer.impl,c=this;(function f(a){var h=a.fragIds;if("undefined"!=typeof h){Array.isArray(h)||(h=[h]);for(var k=0;k<h.length;++k)b.highlightFragment(c.modelRoot,h[k],!1)}if(a.children)for(h=0;h<a.children.length;h++)f(a.children[h])})(a)};
Autodesk.Viewing.Extensions.CAM360.CAMModelStructurePanel.prototype.HideHightlightCAMNode=function(a){var b=this.IsCAMSetupNode(a),c=this.IsCAMOperationNode(a),d=this.IsCAMFolderNode(a);if(b)for(b=0;b<a.children.length;b++)c=a.children[b],this.IsCAMStockNode(c)||this.HideHightlightNode(c);else if(c)for(b=0;b<a.children.length;b++)c=a.children[b],this.IsCAMToolNode(c)&&this.HideHightlightNode(c);else if(d)for(b=0;b<a.children.length;b++)this.HideHightlightNode(a.children[b])};
Autodesk.Viewing.Extensions.CAM360.CAMModelStructurePanel.prototype.setCamNodeVisibility=function(a){var b=this.IsCAMSetupNode(a),c=this.IsCAMOperationNode(a),d=this.IsCAMFolderNode(a);if(b)for(b=0;b<a.children.length;b++)c=a.children[b],this.IsCAMStockNode(c)?this.setNodeVisibility(c,!0):this.setNodeVisibility(c,!1);else if(c)for(b=0;b<a.children.length;b++)c=a.children[b],this.IsCAMToolNode(c)&&this.setNodeVisibility(c,!1);else if(d)for(b=0;b<a.children.length;b++)this.setNodeVisibility(a.children[b],
!1)};Autodesk.Viewing.Extensions.CAM360.CAMModelStructurePanel.prototype.onClick=function(a,b){Autodesk.Viewing.Extensions.ViewerModelStructurePanel.prototype.onClick.call(this,a,b);this.SetModelVisible();this.setCamNodeVisibility(a);this.viewer.fitToView()};Autodesk.Viewing.Extensions.CAM360.CAMModelStructurePanel.prototype.ExpandSetupNodes=function(){if(this.camSetupNodes)for(var a=0;a<this.camSetupNodes.length;a++)this.tree.setCollapsed(this.camSetupNodes[a].dbId,!1)};"use strict";AutodeskNamespace("Autodesk.Viewing.Extensions.Fusion360");
Autodesk.Viewing.Extensions.Fusion360.AnimationExtension=function(a,b){Autodesk.Viewing.Extension.call(this,a,b);this.viewer=a;this.animTools=null;this.animToolsId="animationTools";this.resetButton=this.playButton=null;this.prevExplodeValue=0;this.prevAnimationTime=-1};Autodesk.Viewing.Extensions.Fusion360.AnimationExtension.prototype=Object.create(Autodesk.Viewing.Extension.prototype);Autodesk.Viewing.Extensions.Fusion360.AnimationExtension.prototype.constructor=Autodesk.Viewing.Extensions.Fusion360.AnimationExtension;
Autodesk.Viewing.Extensions.Fusion360.AnimationExtension.prototype.load=function(){function a(a,b){var c=a.getElementsByClassName("toolbar-button")[0],d=a.getElementsByClassName("toolbar-tooltip")[0];c&&d&&(c.id=b?"toolbar-animationPlayButton":"toolbar-animationPauseButton",d.textContent=b?Autodesk.Viewing.i18n.translate("Play"):Autodesk.Viewing.i18n.translate("Pause"))}function b(){p.toolbar.container.className="toolbar-menuplacer";m.animTools.setVisibility(!1)}function c(a,b){p.model.is2d()||0===
p.getExplodeScale()||(m.prevExplodeValue=p.explodeslider.value,b&&(p.explodeslider.value=a),p.explode(a))}function d(a){var b=a.value;a.style.background="-webkit-linear-gradient(left,#ffffff "+b+"%, #393939 "+b+"%)";a.style.background="-moz-linear-gradient(left,#ffffff "+b+"%, #393939 "+b+"%)";a.style.background="-ms-linear-gradient(left,#ffffff "+b+"%, #393939 "+b+"%)";a.style.background="-o-linear-gradient(left,#ffffff "+b+"%, #393939 "+b+"%)";a.style.background="linear-gradient(to right,#ffffff "+
b+"%, #393939 "+b+"%)"}function f(a){var b="";0>a&&(b="-",a=-a);var c=~~(a/3600),d=~~(a%3600/60);a%=60;0<c&&(b+=c+":"+(10>d?"0":""));return b=b+(d+":"+(10>a?"0":""))+a.toFixed(2)}function g(k){p.removeEventListener(Autodesk.Viewing.TOOLBAR_CREATED_EVENT,g);p.modelTools.resetModelButton&&p.modelTools.setToolVisibility(p.modelTools.resetModelButton.id,!1);m.animTools=p.toolbar.addSubToolbar(m.animToolsId,!1);m.animTools.setVisibility(!1);m.playButton=p.addMenuButton(p.modelToolsId,"toolbar-animationPlay",
"Play",function(b){c(0);var g=p.impl.keyFrameAnimator;void 0!==g&&g&&(0<m.prevAnimationTime&&(g.goto(m.prevAnimationTime),m.prevAnimationTime=-1),g.play(0,function(b){n.value=b;l.value=f(g.currentTime);w.value=f(g.currentTime-g.duration);100<=b&&a(m.playButton,!0);d(n)}),a(m.playButton,g.isPaused),p.toolbar.container.className="toolbar-animationMenuplacer",m.animTools.setVisibility(!0),m.animTools.isPositionAdjusted||(h(),m.animTools.isPositionAdjusted=!0))});p.modelTools.insertToolAtIndex(m.playButton,
0);m.onExplodeChange=function(){var c=p.impl.keyFrameAnimator;void 0!==c&&c&&(0!==c.currentTime&&(m.prevAnimationTime=c.currentTime,c.goto(0)),a(m.playButton,!0));b()};p.addEventListener(Autodesk.Viewing.EXPLODE_CHANGE_EVENT,m.onExplodeChange);m.resetButton=p.addMenuButton(p.modelToolsId,"toolbar-resetTool","Reset model",function(b){p.showAll();b=p.impl.keyFrameAnimator;void 0!==b&&b&&(b.goto(0),n.value=0,l.value=f(0),w.value=f(-b.duration),a(m.playButton,!0));c(0,!0);d(n)});p.modelTools.insertToolAtIndex(m.resetButton,
3);m.animTools.backwardButton=p.addMenuButton(m.animToolsId,"toolbar-animationBackward","Previous keyframe",function(b){b=p.impl.keyFrameAnimator;void 0!==b&&b&&(b.prev(),n.value=0<b.duration?b.currentTime/b.duration*100:0,l.value=f(b.currentTime),w.value=f(b.currentTime-b.duration),a(m.playButton,b.isPaused),d(n))});if(k=m.animTools.backwardButton.getElementsByClassName("toolbar-button")[0])k.className="toolbar-animationButton";m.animTools.forwardButton=p.addMenuButton(m.animToolsId,"toolbar-animationForward",
"Next keyframe",function(b){b=p.impl.keyFrameAnimator;void 0!==b&&b&&(b.next(),n.value=0<b.duration?b.currentTime/b.duration*100:0,l.value=f(b.currentTime),w.value=f(b.currentTime-b.duration),a(m.playButton,b.isPaused),d(n))});if(k=m.animTools.forwardButton.getElementsByClassName("toolbar-button")[0])k.className="toolbar-animationButton";m.animTools.timeText=p.addMenuButton(m.animToolsId,"toolbar-animationTimeline","",null);var l=document.createElement("input");l.type="text";l.value="0";l.className=
"animationTimeLapse";l.disabled=!0;m.animTools.timeText.appendChild(l);m.animTools.timeline=p.addMenuButton(m.animToolsId,"toolbar-animationTimeline","",null);var n=m.animTools.input=document.createElement("input");n.type="range";n.value="0";n.className="animationTimeline";m.animTools.timeline.appendChild(n);n.addEventListener("input",function(b){b=p.impl.keyFrameAnimator;if(void 0!==b&&b){var c=n.value*b.duration/100;l.value=f(c);w.value=f(c-b.duration);b.goto(c);a(m.playButton,b.isPaused);d(n)}});
var s=document.createElement("div");s.className="toolbar-tooltip";s.textContent=Autodesk.Viewing.i18n.translate("Click-drag to scrub");m.animTools.timeline.appendChild(s);n.addEventListener("mouseover",function(a){a.target===n&&(s.style.visibility="visible")});n.addEventListener("mouseout",function(a){a.target===n&&(s.style.visibility="hidden")});m.animTools.timeLeftText=p.addMenuButton(m.animToolsId,"toolbar-animationTimeline","",null);var w=document.createElement("input");w.type="text";w.value=
"0";w.className="animationTimeLapse";w.disabled=!0;m.animTools.timeLeftText.appendChild(w);m.animTools.closeButton=p.addMenuButton(m.animToolsId,"toolbar-animationClose","Close animation timeline",function(a){b()});if(k=m.animTools.closeButton.getElementsByClassName("toolbar-button")[0])k.className="toolbar-animationCloseButton";m.onEscape=function(c){c=p.impl.keyFrameAnimator;void 0!==c&&c&&(c.isPaused?b():c.pause(),a(m.playButton,c.isPaused))};p.addEventListener(Autodesk.Viewing.ESCAPE_EVENT,m.onEscape);
m.onCameraChange=function(){if(p.toolController.cameraUpdated){var a=p.impl.keyFrameAnimator;void 0!==a&&a&&(!a.isPlaying||a.isPaused||a.areCameraAnimationsPaused||a.pauseCameraAnimations())}};p.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,m.onCameraChange)}function h(){m.animTools.subtoolbar.className="toolbar-animationSubtoolbar";m.animTools.subtoolbar.style.left="0px";var a=m.animTools.subtoolbar.getBoundingClientRect().left-p.modelTools.subtoolbar.getBoundingClientRect().left+10,a=p.navTools.subtoolbar.getBoundingClientRect().width+
a;m.animTools.subtoolbar.style.left=-a+"px";a=p.navTools.subtoolbar.getBoundingClientRect().width+p.modelTools.subtoolbar.getBoundingClientRect().width+10-(3*m.animTools.backwardButton.getBoundingClientRect().width+2*m.animTools.timeLeftText.getBoundingClientRect().width+(m.animTools.timeline.getBoundingClientRect().width-m.animTools.input.getBoundingClientRect().width)+2);m.animTools.input.style.width=a+"px"}function k(){var a=p.model.getData();if(a&&a.animations){var b=a.animations.animations,a=
n.keyFrameAnimator=new Autodesk.Viewing.Private.KeyFrameAnimator(n,a.animations.duration),c;for(c in b)a.add(b[c]);a.goto(0);n.toggleGhosting(!1);p.removeEventListener(Autodesk.Viewing.GEOMETRY_LOADED_EVENT,k);p.removeEventListener(Autodesk.Viewing.OBJECT_TREE_CREATED_EVENT,l)}}function l(){p.model&&p.model.isLoadDone()?k():p.addEventListener(Autodesk.Viewing.GEOMETRY_LOADED_EVENT,k)}var m=this,p=this.viewer,n=p.impl;this.viewer.toolbar&&0<this.viewer.toolbar.getSubToolbars().length?g():this.viewer.addEventListener(Autodesk.Viewing.TOOLBAR_CREATED_EVENT,
g);p.model&&p.model.isObjectTreeCreated()?l():p.addEventListener(Autodesk.Viewing.OBJECT_TREE_CREATED_EVENT,l);return!0};
Autodesk.Viewing.Extensions.Fusion360.AnimationExtension.prototype.unload=function(){var a=this.viewer,b=a.impl.keyFrameAnimator;b&&b.stop();a.impl.keyFrameAnimator=null;a.removeMenuButton(a.modelToolsId,this.playButton);a.removeMenuButton(a.modelToolsId,this.resetButton);a.removeMenuButton(this.animToolsId,this.animTools.timeText);a.removeMenuButton(this.animToolsId,this.animTools.timeline);a.removeMenuButton(this.animToolsId,this.animTools.timeLeftText);a.removeMenuButton(this.animToolsId,this.animTools.forwardButton);
a.removeMenuButton(this.animToolsId,this.animTools.playbutton);a.removeMenuButton(this.animToolsId,this.animTools.backwardButton);a.removeMenuButton(this.animToolsId,this.animTools.closeButton);a.toolbar.removeSubToolbar(this.animToolsId);a.removeEventListener(Autodesk.Viewing.EXPLODE_CHANGE_EVENT,this.onExplodeChange);a.removeEventListener(Autodesk.Viewing.ESCAPE_EVENT,this.onEscape);a.removeEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,this.onCameraChange);a.modelTools.resetModelButton&&a.modelTools.setToolVisibility(a.modelTools.resetModelButton.id,
!0);return!0};Autodesk.Viewing.theExtensionManager.registerExtension("Autodesk.Fusion360.Animation",Autodesk.Viewing.Extensions.Fusion360.AnimationExtension);AutodeskNamespace("Autodesk.Viewing.Extensions.Markers");
Autodesk.Viewing.Extensions.Markers.createEditFrame=function(a,b){var c=document.createElement("div");c.className="markers-edit-frame";c.id="markers-edit-frame";c.style.left=0;c.style.top=0;c.style.right=0;c.style.bottom=0;c.style.backgroundColor="transparent";c.style.position="absolute";c.style.zIndex=10;var d=document.createElement("div");d.className="markers-edit-frame-message-container";d.textContent=Autodesk.Viewing.i18n.translate(a);d.setAttribute("data-i18n",a);c.appendChild(d);d=document.createElement("div");
d.className="markers-edit-frame-separator";c.appendChild(d);d=document.createElement("reset");d.className="markers-edit-frame-cancel-button";d.textContent=Autodesk.Viewing.i18n.translate("Cancel");d.setAttribute("data-i18n","Cancel");d.addEventListener("mousemove",function(a){a.cancelBubble=!0;a.preventDefault()});d.addEventListener("mouseup",function(a){a.cancelBubble=!0;a.preventDefault();b&&b()});c.appendChild(d);return c};
Autodesk.Viewing.Extensions.Markers.showToolsAndPanels=function(a){a.displayViewCube(!0,!1);a.homeViewContainer&&(a.homeViewContainer.style.display="block");a.infoButton&&(a.infoButton.style.display="block");a.toolbar.container&&(a.toolbar.container.style.display="block")};
Autodesk.Viewing.Extensions.Markers.hideToolsAndPanels=function(a){a.displayViewCube(!1,!1);a.homeViewContainer&&(a.homeViewContainer.style.display="none");a.infoButton&&(a.infoButton.style.display="none");a.toolbar.container&&(a.toolbar.container.style.display="none")};Autodesk.Viewing.Extensions.Markers.getMousePosition=function(a){var b=(a.target||a.srcElement).getBoundingClientRect();return new THREE.Vector2(a.clientX-b.left,a.clientY-b.top)};
Autodesk.Viewing.Extensions.Markers.worldToViewport=function(a,b){var c=new THREE.Vector4;c.x=a.x;c.y=a.y;c.z=a.z;c.w=1;c.applyMatrix4(b.impl.camera.matrixWorldInverse);c.applyMatrix4(b.impl.camera.projectionMatrix);0<c.w&&(c.x/=c.w,c.y/=c.w,c.z/=c.w);return c};
Autodesk.Viewing.Extensions.Markers.worldToClient=function(a,b){var c=Autodesk.Viewing.Extensions.Markers.worldToViewport(a,b),c=b.impl.viewportToClient(c.x,c.y);c.x=Math.floor(c.x)+0.5;c.y=Math.floor(c.y)+0.5;var d=b.impl.canvas.getBoundingClientRect();c.x-=d.left;c.y-=d.top;return c};Autodesk.Viewing.Extensions.Markers.drawLine=function(a,b,c,d,f,g){a.beginPath();a.moveTo(b,c);a.lineTo(d,f);a.strokeStyle=g;a.stroke()};
Autodesk.Viewing.Extensions.Markers.drawCircle=function(a,b,c,d,f){a.beginPath();a.arc(b,c,d,0,2*Math.PI,!1);a.fillStyle=f;a.fill()};Autodesk.Viewing.Extensions.Markers.drawCircumference=function(a,b,c,d,f){a.beginPath();a.arc(b,c,d,0,2*Math.PI,!1);a.strokeStyle=f;a.stroke()};Autodesk.Viewing.Extensions.Markers.getPixelOffset=function(a){return 0==a%2?0:0.5};AutodeskNamespace("Autodesk.Viewing.Extensions.Markers");
Autodesk.Viewing.Extensions.Markers.ViewerMarkers=function(a){Autodesk.Viewing.Extension.call(this,a)};Autodesk.Viewing.Extensions.Markers.ViewerMarkers.prototype=Object.create(Autodesk.Viewing.Extension.prototype);Autodesk.Viewing.Extensions.Markers.ViewerMarkers.prototype.constructor=Autodesk.Viewing.Extensions.Markers.ViewerMarkers;
Autodesk.Viewing.Extensions.Markers.ViewerMarkers.prototype.load=function(){if(!(this.viewer instanceof Autodesk.Viewing.Viewer3D))return!1;this.markerGroups=[];this.modelMarkers=[];this.lines=[];this.markersVisible=!0;this.minimumGroupMarkerWidth=80;this.overlaysGraphicsLayers=[];this.markersWrap=document.createElement("div");this.markersWrap.id="markers-wrap";this.markersWrap.style.left=0;this.markersWrap.style.top=0;this.markersWrap.style.right=0;this.markersWrap.style.bottom=0;this.markersWrap.style.width=
"100%";this.markersWrap.style.height="100%";this.markersWrap.style.backgroundColor="transparent";this.markersWrap.style.position="absolute";this.markerLines=document.createElement("canvas");this.markerLines.id="markers-lines";this.markerLines.style.left=0;this.markerLines.style.top=0;this.markerLines.style.right=0;this.markerLines.style.bottom=0;this.markerLines.style.width="100%";this.markerLines.style.height="100%";this.markerLines.style.backgroundColor="transparent";this.markerLines.style.position=
"absolute";this.container=this.viewer.container;this.container.firstChild?this.container.insertBefore(this.markersWrap,this.container.firstChild):this.container.appendChild(this.markersWrap);this.markersWrap.appendChild(this.markerLines);this.markersWrap.style.pointerEvents="none";this.highlightedMeshes={};this.materialBase=new THREE.MeshBasicMaterial({color:16777215,opacity:0.25,transparent:!1});this.materialTop=new THREE.MeshBasicMaterial({color:16777215,opacity:0.01,shading:THREE.NoShading,transparent:!0});
this.viewer.impl.createOverlayScene("markers",this.materialBase,this.materialTop);this.htmlBounds=new THREE.Box2;this.viewerBounds=new THREE.Box2;this.modelMarkersBoundingBox=new THREE.Box2;this.modelMarkersBoundingBox.min.x=-1E5;this.modelMarkersBoundingBox.min.y=-1E5;this.gizmosColor="#4078A8";this.gizmosBorderColor="#FFFFFF";this.gizmosBorderWidth=5.3;this.gizmosLineWidth=3;this.gizmosCircleRadio=4;this.gizmosCircleBorderRadio=5.3;this.onCameraChange=function(){this.update()}.bind(this);this.onExplodeChange=
function(){this.update()}.bind(this);this.onViewerResize=function(){this.clientWidth=this.container.offsetWidth;this.clientHeight=this.container.offsetHeight;this.viewerBounds.min.x=0;this.viewerBounds.min.y=0;this.viewerBounds.max.x=this.clientWidth;this.viewerBounds.max.y=this.clientHeight;this.htmlBounds.min.x=this.viewerBounds.min.x+50;this.htmlBounds.min.y=this.viewerBounds.min.y+50;this.htmlBounds.max.x=this.viewerBounds.max.x-50;this.htmlBounds.max.y=this.viewerBounds.max.y-50;this.viewer.impl.updateCameraMatrices();
this.update()}.bind(this);var a=this,b=function(){a.viewer.removeEventListener(Autodesk.Viewing.TOOLBAR_CREATED_EVENT,b);a.viewer.prefs.add("showCommentMarkers",!0,["2d","3d"]);var c=a.viewer.getSettingsPanel(!1);a.optionsCheckboxId=c.addCheckbox(Autodesk.Viewing.Extensions.ViewerSettingTab.Navigation,"Show Comment Markers",!0,function(b){a.updateMarkersVisibility();a.update()},"showCommentMarkers")};this.viewer.getSettingsPanel(!1)?b():this.viewer.addEventListener(Autodesk.Viewing.TOOLBAR_CREATED_EVENT,
b);this.viewer.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,this.onCameraChange);this.viewer.addEventListener(Autodesk.Viewing.EXPLODE_CHANGE_EVENT,this.onExplodeChange);this.viewer.addEventListener(Autodesk.Viewing.VIEWER_RESIZE_EVENT,this.onViewerResize);this.onViewerResize();return!0};
Autodesk.Viewing.Extensions.Markers.ViewerMarkers.prototype.unload=function(){this.viewer.removeEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,this.onCameraChange);this.viewer.removeEventListener(Autodesk.Viewing.EXPLODE_CHANGE_EVENT,this.onExplodeChange);this.viewer.removeEventListener(Autodesk.Viewing.VIEWER_RESIZE_EVENT,this.onViewerResize);this.viewer.prefs.remove("showCommentMarkers");this.viewer.getSettingsPanel(!1).removeCheckbox(this.optionsCheckboxId);this.markerGroups.splice(0,this.markerGroups.length);
this.modelMarkers.splice(0,this.markerGroups.length);this.lines.splice(0,this.lines.length);this.markersWrap.parentNode.removeChild(this.markersWrap);this.viewer.impl.removeOverlayScene("markers");this.materialBase.dispose();this.materialTop.dispose();this.overlaysGraphicsLayers=[];return!0};
Autodesk.Viewing.Extensions.Markers.ViewerMarkers.prototype.update=function(){if(this.visible&&this.viewer.model){if(this.isModelHightlighted){for(var a=[],b=this.viewer.model.getData().fragments.fragId2dbId.length,c=0;c<b;++c)a.push(c);this.viewer.model.getRoot().fragIds=a;this.highlightNode(this.viewer.model.getRoot(),-1)}this.markerLines.width=this.markerLines.clientWidth;this.markerLines.height=this.markerLines.clientHeight;if(a=this.markerLines.getContext("2d"))a.clearRect(0,0,this.markerLines.width,
this.markerLines.height),b=this.getModelBoundingRectangle(this.viewer.model),this.updateModelMarkers(),this.updateMarkerGroups(a,b),this.drawLines(a),this.updateOverlayGraphicsLayers(a)}};
Autodesk.Viewing.Extensions.Markers.ViewerMarkers.prototype.updateMarkerGroups=function(a,b){if(this.markersVisible&&this.viewer.prefs.showCommentMarkers){this.updateProxiesCenters();this.sortMarkerGroups();for(var c=this.getModelCenter(this.viewer.model),d=this.markerGroups,f=d.length,g=b.min.x,h=b.max.x,k=0;k<f;++k)this.updateMarkerGroup(d[k],c,g,h);this.resolveMarkersCollisions(c,g,h);for(k=0;k<f;++k)if(g=c=d[k],h=g.length,c.clipped){var l=g[0].html;l.data.setDirection(c.flip?"outside_right":"outside_left");
l.style.display=c.visible?"":"none";l.style.left=c.flip?Math.round(c.x-l.offsetWidth)+"px":Math.round(c.x)+"px";l.style.top=Math.round(c.y-0.5*l.offsetHeight)+"px";for(var m=1;m<h;++m)l=g[m].html,l.style.display="none"}else{this.drawLine(a,c.proxyCenter.x,c.proxyCenter.y,c.x,c.y);for(var p=c.flip?"left":"right",n=c.flip?1:-1,m=0;m<h;++m){l=g[m].html;l.data.setDirection(0==m?p:"");l.style.display="";var q=c.y-0.5*l.offsetHeight;l.style.left=Math.round(c.x-0.5*l.offsetWidth+l.offsetWidth*m*n)+"px";
l.style.top=Math.round(q)+"px"}}}};
Autodesk.Viewing.Extensions.Markers.ViewerMarkers.prototype.updateModelMarkers=function(){var a=this.modelMarkers,b=a.length;if(0!=b){var c=10;if(this.markersVisible&&this.viewer.prefs.showCommentMarkers)for(var d=0;d<b;++d){var f=a[d].html;f.style.display="";f.style.left=c+"px";f.style.top="10px";c+=parseInt(f.offsetWidth+5);this.modelMarkersBoundingBox.max.x=c;this.modelMarkersBoundingBox.max.y=10+f.offsetHeight}else{for(d=0;d<b;++d)f=a[d].html,f.style.display="none";this.modelMarkersBoundingBox.max.x=
c;this.modelMarkersBoundingBox.max.y=10}}};Autodesk.Viewing.Extensions.Markers.ViewerMarkers.prototype.drawLines=function(a){for(var b=this.viewer,c=this.lines,d=c.length,f=0;f<d;++f){var g=c[f],h=-1!=g.fragId?this.getProxyCenter(g.fragId,g.centerOffset):Autodesk.Viewing.Extensions.Markers.worldToClient(g.centerOffset,b);this.drawLine(a,h.x,h.y,g.x,g.y)}};
Autodesk.Viewing.Extensions.Markers.ViewerMarkers.prototype.clearMarkers=function(){var a,b;a=this.markerGroups;b=a.length;for(var c=0;c<b;++c)this.removeMarker(a[c].id);a=this.modelMarkers;b=a.length;for(c=0;c<b;++c)this.removeMarker(a[c].id);this.update()};
Autodesk.Viewing.Extensions.Markers.ViewerMarkers.prototype.setNodeMarker=function(a,b,c,d){var f=this.getFragmentId(b);if(-1==f&&!d||!c)return!1;var g={id:a,html:c};c.style.display=this.markersVisible&&this.viewer.prefs.showCommentMarkers?"block":"none";c=(d=d?d:new THREE.Vector3(0,0,0))?-1:this.getIndexFromId(b,this.markerGroups);-1!=c?(b=this.markerGroups[c],a=this.getIndexFromId(a,b),b.centerOffset=d,-1!=a?(this.markersWrap.removeChild(b[a].html),b.splice(a,1,g)):b.push(g)):(a=[g],a.id=b,a.fragId=
f,a.x=0,a.y=0,a.flip=!1,a.proxyCenter=new THREE.Vector2,a.htmlOffset=new THREE.Vector2,a.htmlSize=new THREE.Vector2,a.distanceFromCenter=0,a.wholeBoundingBox=new THREE.Box2,a.htmlBoundingBox=new THREE.Box2,a.centerOffset=d,this.markerGroups.push(a));this.markersWrap.appendChild(g.html);this.update();return!0};
Autodesk.Viewing.Extensions.Markers.ViewerMarkers.prototype.setModelMarker=function(a,b){if(!b)return!1;var c={id:a,html:b};b.style.display=this.markersVisible&&this.viewer.prefs.showCommentMarkers?"block":"none";var d=this.getIndexFromId(a,this.modelMarkers);-1!=d?(this.markersWrap.removeChild(this.modelMarkers[d].html),this.modelMarkers.splice(d,1,c)):this.modelMarkers.push(c);this.markersWrap.appendChild(c.html);this.update();return!0};
Autodesk.Viewing.Extensions.Markers.ViewerMarkers.prototype.removeMarker=function(a){for(var b=this.markerGroups,c=b.length,d=0;d<c;++d){var f=b[d],g=this.getIndexFromId(a,f);if(-1!=g){this.markersWrap.removeChild(f[g].html);f.splice(g,1);0==f.length&&b.splice(d,1);break}}a=this.getIndexFromId(a,this.modelMarkers);-1!=a&&(this.markersWrap.removeChild(this.modelMarkers[a].html),this.modelMarkers.splice(a,1));this.update()};
Autodesk.Viewing.Extensions.Markers.ViewerMarkers.prototype.setLineToMarker=function(a,b,c,d){for(var f=-1,g=null,h=this.markerGroups,k=h.length,l=0;l<k;++l)for(var m=h[l],p=m.length,n=0;n<p;++n)if(m[n].id==b){f=m.id;g=m.centerOffset;break}if(-1==f&&!g||!this.setLine(a,f,c,d,g))return!1;this.update();return!0};
Autodesk.Viewing.Extensions.Markers.ViewerMarkers.prototype.setLine=function(a,b,c,d,f){b={id:a,nodeId:b,fragId:this.getFragmentId(b),x:c,y:d,centerOffset:f?f.clone():new THREE.Vector3(0,0,0)};a=this.getIndexFromId(a,this.lines);-1!=a?this.lines.splice(a,1,b):this.lines.push(b);this.update();return!0};Autodesk.Viewing.Extensions.Markers.ViewerMarkers.prototype.removeLine=function(a){a=this.getIndexFromId(a,this.lines);-1!=a&&this.lines.splice(a,1);this.update()};
Autodesk.Viewing.Extensions.Markers.ViewerMarkers.prototype.__defineGetter__("visible",function(){return"block"==this.markersWrap.style.display||""==this.markersWrap.style.display});Autodesk.Viewing.Extensions.Markers.ViewerMarkers.prototype.show=function(){this.markersWrap.style.display="block";this.update()};Autodesk.Viewing.Extensions.Markers.ViewerMarkers.prototype.hide=function(){this.markersWrap.style.display="none"};
Autodesk.Viewing.Extensions.Markers.ViewerMarkers.prototype.setMarkersVisible=function(a){a!=this.markersVisible&&(this.markersVisible=a,this.updateMarkersVisibility(),this.update())};Autodesk.Viewing.Extensions.Markers.ViewerMarkers.prototype.updateMarkersVisibility=function(){for(var a=this.markersVisible&&this.viewer.prefs.showCommentMarkers?"block":"none",b=this.markerGroups,c=b.length,d=0;d<c;++d)for(var f=b[d],g=f.length,h=0;h<g;++h)f[h].html.style.display=a};
Autodesk.Viewing.Extensions.Markers.ViewerMarkers.prototype.getFragmentId=function(a){if(null===this.viewer.model)return-1;for(var b=this.viewer.model.getData().fragments.fragId2dbId,c=b.length,d=0;d<c;++d)if(b[d]==a)return d;return-1};Autodesk.Viewing.Extensions.Markers.ViewerMarkers.prototype.getIndexFromId=function(a,b){for(var c=b.length,d=0;d<c;++d)if(b[d].id==a)return d;return-1};
Autodesk.Viewing.Extensions.Markers.ViewerMarkers.prototype.getModelCenter=function(a){a=a.getBoundingBox().center();return Autodesk.Viewing.Extensions.Markers.worldToClient(a,this.viewer)};
Autodesk.Viewing.Extensions.Markers.ViewerMarkers.prototype.getModelBoundingRectangle=function(a){var b=a.getBoundingBox().min;a=a.getBoundingBox().max;for(var b=[new THREE.Vector3(b.x,b.y,b.z),new THREE.Vector3(b.x,a.y,b.z),new THREE.Vector3(a.x,b.y,b.z),new THREE.Vector3(a.x,a.y,b.z),new THREE.Vector3(b.x,b.y,a.z),new THREE.Vector3(b.x,a.y,a.z),new THREE.Vector3(a.x,b.y,a.z),new THREE.Vector3(a.x,a.y,a.z)],c=a=Number.POSITIVE_INFINITY,d=Number.NEGATIVE_INFINITY,f=Number.NEGATIVE_INFINITY,g=b.length,
h=0;h<g;++h){var k=Autodesk.Viewing.Extensions.Markers.worldToClient(b[h],this.viewer);a=Math.min(a,k.x);c=Math.min(c,k.y);d=Math.max(d,k.x);f=Math.max(f,k.y)}return new THREE.Box2(new THREE.Vector2(a,c),new THREE.Vector2(d,f))};
Autodesk.Viewing.Extensions.Markers.ViewerMarkers.prototype.getProxyCenter=function(a,b){if(-1==a)return Autodesk.Viewing.Extensions.Markers.worldToClient(b,this.viewer);var c=this.viewer.impl.getRenderProxy(this.viewer.model,a),d=c.geometry.boundingBox.center();b&&d.add(b);d.applyMatrix4(c.matrixWorld);return Autodesk.Viewing.Extensions.Markers.worldToClient(d,this.viewer)};
Autodesk.Viewing.Extensions.Markers.ViewerMarkers.prototype.setModelHighlight=function(a){this.viewer.model&&!this.viewer.model.is2d()&&(this.clearHighlightedNodes(),a&&this.highlightNode(this.viewer.model.getRoot()))};
Autodesk.Viewing.Extensions.Markers.ViewerMarkers.prototype.highlightNode=function(a){var b;if(a===this.viewer.model.getRoot()){a=a.dbId;var c=this.viewer.model.getData().fragments.fragId2dbId.length;b=Array(c);for(var d=0;d<c;++d)b[d]=d}else b=a.fragIds,a=a.dbId,Array.isArray(b)||(b=[b]);c=[];for(d=0;d<b.length;++d){var f=this.viewer.impl.getRenderProxy(this.viewer.model,b[d]);f&&!f.markupHighlightProxy&&(f.markupHighlightProxy=new THREE.Mesh(f.geometry,f.material,!0),f.markupHighlightProxy.matrixWorld=
f.matrixWorld,this.viewer.impl.addOverlay("markers",f.markupHighlightProxy),c.push(f))}c.length&&(this.highlightedMeshes[a]=c)};Autodesk.Viewing.Extensions.Markers.ViewerMarkers.prototype.clearHighlightedNode=function(a){if(a===this.viewer.model.getRoot())this.clearHighlightedNodes();else{var b=this.highlightedMeshes[a.dbId];if(Array.isArray(b)){for(var c=0,d=b.length;c<d;++c){var f=b[c];this.viewer.impl.removeOverlay("markers",f.markupHighlightProxy);delete f.markupHighlightProxy}delete this.highlightedMeshes[a.dbId]}}};
Autodesk.Viewing.Extensions.Markers.ViewerMarkers.prototype.clearHighlightedNodes=function(){for(var a in this.highlightedMeshes)for(var b=this.highlightedMeshes[a],c=0,d=b.length;c<d;++c){var f=b[c];this.viewer.impl.removeOverlay("markers",f.markupHighlightProxy);f.markupHighlightProxy=null}this.highlightedMeshes={}};
Autodesk.Viewing.Extensions.Markers.ViewerMarkers.prototype.addOverlayGraphicsLayer=function(a,b,c){this.overlaysGraphicsLayers.push({id:a,index:b,drawCallback:c});this.overlaysGraphicsLayers.sort(function(a,b){return a.index<b.index?-1:a.index>b.index?1:0})};Autodesk.Viewing.Extensions.Markers.ViewerMarkers.prototype.removeOverlayGraphicsLayer=function(a){a=this.getIndexFromId(a,this.overlaysGraphicsLayers);-1!=a&&this.overlaysGraphicsLayers.splice(a,1)};
Autodesk.Viewing.Extensions.Markers.ViewerMarkers.prototype.updateOverlayGraphicsLayers=function(a){for(var b=this.overlaysGraphicsLayers,c=b.length,d=0;d<c;++d)b[d].drawCallback(a)};
Autodesk.Viewing.Extensions.Markers.ViewerMarkers.prototype.drawLine=function(a,b,c,d,f){a.lineWidth=this.gizmosBorderWidth;Autodesk.Viewing.Extensions.Markers.drawLine(a,b,c,d,f,this.gizmosBorderColor);Autodesk.Viewing.Extensions.Markers.drawCircle(a,b,c,this.gizmosCircleBorderRadio,this.gizmosBorderColor);a.lineWidth=this.gizmosLineWidth;Autodesk.Viewing.Extensions.Markers.drawLine(a,b,c,d,f,this.gizmosColor);Autodesk.Viewing.Extensions.Markers.drawCircle(a,b,c,this.gizmosCircleRadio,this.gizmosColor)};
Autodesk.Viewing.Extensions.Markers.ViewerMarkers.prototype.drawBoundingBox=function(a,b,c,d){a.globalAlpha=d;a.beginPath();a.rect(b.min.x,b.min.y,b.max.x-b.min.x,b.max.y-b.min.y);a.fillStyle=c;a.fill();a.globalAlpha=1};
Autodesk.Viewing.Extensions.Markers.ViewerMarkers.prototype.updateMarkerGroup=function(a,b,c,d){a.clipped?(a.x=a.proxyCenter.x,a.y=a.proxyCenter.y,this.restrainToViewerBounds(a)):(this.placeOutsideModelBoundingBox(a,b,c,d),this.hasMinimumLength(a)||this.placeOutsideModelBoundingBox(a,b,c,d,!a.flip))};
Autodesk.Viewing.Extensions.Markers.ViewerMarkers.prototype.updateProxiesCenters=function(){for(var a=this.container.offsetWidth,b=this.container.offsetHeight,c=this.markerGroups,d=c.length,f=0;f<d;++f){var g=c[f],h=this.getProxyCenter(g.fragId,g.centerOffset);g.proxyCenter=h;g.visible=0<=h.y&&h.y<=b;g.clipped=0>h.x||h.x>a||0>h.y||h.y>b}a=this.lines;b=a.length;for(f=0;f<b;++f)c=a[f],c.proxyCenter=this.getProxyCenter(c.fragId,c.centerOffset)};
Autodesk.Viewing.Extensions.Markers.ViewerMarkers.prototype.updateMarkerGroupBoundingBoxes=function(a){var b=a.htmlBoundingBox,c=a.wholeBoundingBox,d,f;d=b.min;f=b.max;d.x=Math.round(a.x+a.htmlOffset.x);d.y=Math.round(a.y+a.htmlOffset.y);f.x=d.x+a.htmlSize.x;f.y=d.y+a.htmlSize.y;b.width=f.x-d.x;b.height=f.y-d.y;c.set(d,f);c.expandByPoint(a.proxyCenter);d=c.min;f=c.max;c.width=f.x-d.x;c.height=f.y-d.y};
Autodesk.Viewing.Extensions.Markers.ViewerMarkers.prototype.resolveMarkersCollisions=function(a,b,c){for(var d=this.markerGroups,f=d.length,g=[],h=0;h<f;++h){this.getMarkerGroupColliders(d[h],g,!1);for(var k=0;k<g.length;++k){var l=d[h],m=g[k];this.placeOutsideModelBoundingBox(l,a,b,c,!l.flip);if(!this.hasMinimumLength(l)||this.isMarkerGroupColliding(l,!1)||this.isMarkerGroupColliding(m,!1))this.placeOutsideModelBoundingBox(l,a,b,c,!l.flip),this.placeOutsideModelBoundingBox(m,a,b,c,!m.flip),(!this.hasMinimumLength(m)||
this.isMarkerGroupColliding(l,!1)||this.isMarkerGroupColliding(m,!1))&&this.placeOutsideModelBoundingBox(m,a,b,c,!m.flip)}}for(h=0;h<f;++h)for(this.getMarkerGroupColliders(d[h],g,!1),k=0;k<g.length;++k){var l=d[h],m=g[k],p;a=this.getPushDeltaPosition(l,!0);b=this.getPushDeltaPosition(m,!0);c=Math.abs(a);p=Math.abs(b);if(0<c||0<p)c<p?(l.x+=a,this.setFlip(l,l.x>l.proxyCenter.x)):(m.x+=b,this.setFlip(m,m.x>m.proxyCenter.x));else if(a=this.getPushDeltaPosition(l,!1),b=this.getPushDeltaPosition(m,!1),
c=Math.abs(a),p=Math.abs(b),0<c||0<p)c<p?(l.x+=a,this.setFlip(l,l.x>l.proxyCenter.x)):(m.x+=b,this.setFlip(m,m.x>m.proxyCenter.x))}};
Autodesk.Viewing.Extensions.Markers.ViewerMarkers.prototype.setFlip=function(a,b){a.flip=b;var c=a[0].html;a.htmlSize.x=c.offsetWidth*a.length;a.htmlSize.y=c.offsetHeight;a.htmlOffset.x=a.flip?0.5*-c.offsetWidth:0.5*c.offsetWidth-a.htmlSize.x;a.htmlOffset.y=0.5*-c.offsetHeight;a.htmlSize.x=c.offsetWidth*a.length;a.htmlSize.y=c.offsetHeight;a.htmlOffset.x=a.flip?0.5*-c.offsetWidth:0.5*c.offsetWidth-a.htmlSize.x;a.htmlOffset.y=0.5*-c.offsetHeight;this.updateMarkerGroupBoundingBoxes(a)};
Autodesk.Viewing.Extensions.Markers.ViewerMarkers.prototype.getPushDeltaPosition=function(a,b){for(var c=(b?1:-1)*(a.flip?1:-1)*20,d=0;;){a.x+=c;d+=c;this.updateMarkerGroupBoundingBoxes(a);if(this.isHtmlOutsideBounds(a))return a.x-=d,this.updateMarkerGroupBoundingBoxes(a),0;if(this.hasMinimumLength(a)&&!this.isMarkerGroupColliding(a,!0))return a.x-=d,this.updateMarkerGroupBoundingBoxes(a),d}};
Autodesk.Viewing.Extensions.Markers.ViewerMarkers.prototype.isHtmlOutsideBounds=function(a){var b=this.htmlBounds,c=a.htmlBoundingBox,d=b.min.x,b=b.max.x;a.htmlBoundingBox.isIntersectionBox(this.modelMarkersBoundingBox)&&(d=this.modelMarkersBoundingBox.max.x);return c.max.x>b||c.min.x<d?!0:!1};
Autodesk.Viewing.Extensions.Markers.ViewerMarkers.prototype.restrainToViewerBounds=function(a){var b=this.viewerBounds;a.proxyCenter.x<b.min.x?(a.x=b.min.x,this.setFlip(a,!1)):a.proxyCenter.x>b.max.x&&(a.x=b.max.x,this.setFlip(a,!0))};
Autodesk.Viewing.Extensions.Markers.ViewerMarkers.prototype.placeOutsideModelBoundingBox=function(a,b,c,d,f){a.distanceFromCenter=Math.abs(a.proxyCenter.x-b.x);b=0.5*a.distanceFromCenter+d;var g=0.5*-a.distanceFromCenter+c;void 0===f&&(f=c<this.htmlBounds.min.x||d>this.htmlBounds.max.x?c<this.htmlBounds.min.x:Math.abs(a.proxyCenter.x-b)<Math.abs(a.proxyCenter.x-g));a.x=f?b:g;a.y=a.proxyCenter.y;this.setFlip(a,f);this.hasMinimumLength(a)||(a.x=a.proxyCenter.x+(this.minimumGroupMarkerWidth+a.htmlSize.x)*
(a.flip?1:-1),this.updateMarkerGroupBoundingBoxes(a));this.restrainToHtmlBounds(a)};Autodesk.Viewing.Extensions.Markers.ViewerMarkers.prototype.restrainToHtmlBounds=function(a){var b=this.htmlBounds,c=a.htmlBoundingBox,d=b.min.x,b=b.max.x;a.htmlBoundingBox.isIntersectionBox(this.modelMarkersBoundingBox)&&(d=this.modelMarkersBoundingBox.max.x);c.max.x>b?(a.x=b-a.htmlOffset.x-a.htmlSize.x,this.updateMarkerGroupBoundingBoxes(a)):c.min.x<d&&(a.x=d-a.htmlOffset.x,this.updateMarkerGroupBoundingBoxes(a))};
Autodesk.Viewing.Extensions.Markers.ViewerMarkers.prototype.hasMinimumLength=function(a){return a.clipped||a.wholeBoundingBox.width-a.htmlBoundingBox.width>=this.minimumGroupMarkerWidth};Autodesk.Viewing.Extensions.Markers.ViewerMarkers.prototype.sortMarkerGroups=function(){this.markerGroups.sort(function(a,b){return a.proxyCenter.y<b.proxyCenter.y?-1:a.proxyCenter.y>b.proxyCenter.y?1:0})};
Autodesk.Viewing.Extensions.Markers.ViewerMarkers.prototype.getMarkerGroupColliders=function(a,b,c){var d=this.markerGroups,f=d.length;b.splice(0,b.length);if(!a.clipped)for(var g=0;g<f;++g){var h=d[g];h!==a&&(h.clipped||(c?h.htmlBoundingBox.isIntersectionBox(a.htmlBoundingBox)&&b.push(h):h.wholeBoundingBox.isIntersectionBox(a.wholeBoundingBox)&&b.push(h)))}};
Autodesk.Viewing.Extensions.Markers.ViewerMarkers.prototype.isMarkerGroupColliding=function(a,b){var c=this.markerGroups,d=c.length;if(a.clipped)return!1;for(var f=0;f<d;++f){var g=c[f];if(g!==a&&!g.clipped)if(b){if(g.htmlBoundingBox.isIntersectionBox(a.htmlBoundingBox))return!0}else if(g.wholeBoundingBox.isIntersectionBox(a.wholeBoundingBox))return!0}return!1};Autodesk.Viewing.theExtensionManager.registerExtension("Autodesk.Markers",Autodesk.Viewing.Extensions.Markers.ViewerMarkers);AutodeskNamespace("Autodesk.Viewing.Extensions.Markers");
Autodesk.Viewing.Extensions.Markers.ViewerMarkups=function(a){Autodesk.Viewing.Extension.call(this,a);this.EVENT_LEAVE_EDIT_MODE="ViewerMarkups_leave_edit_mode";this.EVENT_SELECTION_CHANGED="ViewerMarkups_selection_changed";this.DRAW_RESULT_NONE=-1;this.DRAW_RESULT_MARKUP_NEW=1;this.DRAW_RESULT_MARKUP_REPLACED=2;this.ID_MARKER_AREA="Autodesk.Markers.Area";this.SUPPORTED_MARKER_IDS=[this.ID_MARKER_AREA]};Autodesk.Viewing.Extensions.Markers.ViewerMarkups.prototype=Object.create(Autodesk.Viewing.Extension.prototype);
Autodesk.Viewing.Extensions.Markers.ViewerMarkups.prototype.constructor=Autodesk.Viewing.Extensions.Markers.ViewerMarkups;
Autodesk.Viewing.Extensions.Markers.ViewerMarkups.prototype.load=function(){if(!(this.viewer instanceof Autodesk.Viewing.Viewer3D))return!1;var a=function(){this.cancelEditMode();this.viewer.fireEvent({type:this.EVENT_LEAVE_EDIT_MODE,target:this})}.bind(this);this.editFrameDiv=Autodesk.Viewing.Extensions.Markers.createEditFrame("Click and drag to select an area you would like to comment on.",a);this.editFrameDiv.addEventListener("mousemove",this.onMouseMove.bind(this));this.editFrameDiv.addEventListener("mousedown",
this.onMouseDown.bind(this));this.editFrameDiv.addEventListener("mouseup",this.onMouseUp.bind(this));this.markups=[];this.lines=[];this.container=this.viewer.container;this.drawing=this.editMode=!1;this.currentMarkupIndex=0;this.markupsBorderWidth=this.currentStrokeWidth=3;this.currentStrokeColor="#4078A8";this.markupsBorderColor="#FFFFFF";this.markupsCreationColor="#CC0000";this.gizmosColor="#4078A8";this.gizmosBorderColor="#FFFFFF";this.gizmosBorderWidth=5.3;this.gizmosLineWidth=3;this.currentMarkupIndex=
-1;this.currentRectangleIniPoint=new THREE.Vector2;this.previousMarkups=[];this.previousToolsCollapsed=!1;a=function(a){this.clientWidth=this.container.offsetWidth;this.clientHeight=this.container.offsetHeight;this.drawLines(a,this.gizmosBorderWidth,this.gizmosBorderColor);this.drawMarkups(a);this.drawLines(a,this.gizmosLineWidth,this.drawing?this.markupsCreationColor:this.gizmosColor)}.bind(this);this.markers.addOverlayGraphicsLayer("markups-overlay",1,a);this.onViewerResize=function(){this.clientWidth=
this.container.offsetWidth;this.clientHeight=this.container.offsetHeight}.bind(this);this.viewer.addEventListener(Autodesk.Viewing.VIEWER_RESIZE_EVENT,this.onViewerResize);return!0};
Autodesk.Viewing.Extensions.Markers.ViewerMarkups.prototype.unload=function(){this.editFrameDiv.parentNode&&this.editFrameDiv.parentNode.removeChild(this.editFrameDiv);this.viewer.removeEventListener(Autodesk.Viewing.VIEWER_RESIZE_EVENT,this.onViewerResize);this.markers&&this.markers.removeOverlayGraphicsLayer("markups-overlay");return!0};Autodesk.Viewing.Extensions.Markers.ViewerMarkups.prototype.clear=function(){0!=this.markups.length&&(this.markups.splice(0,this.markups.length),this.markers.update())};
Autodesk.Viewing.Extensions.Markers.ViewerMarkups.prototype.handleKeyDown=function(a){a.keyCode===Autodesk.Viewing.theHotkeyManager.KEYCODES.ESCAPE&&this.editMode&&(this.cancelEditMode(),this.viewer.fireEvent({type:this.EVENT_LEAVE_EDIT_MODE,target:this}))};Autodesk.Viewing.Extensions.Markers.ViewerMarkups.prototype.drawMarkups=function(a){for(var b=this.markups,c=this.markups.length,d=0;d<c;++d)this.drawMarkup(a,b[d])};
Autodesk.Viewing.Extensions.Markers.ViewerMarkups.prototype.drawLines=function(a,b,c){var d=this.markups?this.markups[0]:null,f=this.lines,g=f.length;if(0!=g&&d)for(var h=this.clientWidth,k=this.clientHeight,l=this.getDepthScale(),m=this.viewer,p=0;p<g;++p){var n=f[p],q=d.path,r=Autodesk.Viewing.Extensions.Markers.worldToClient(d.origin,m),v=this.homogeneousToClient(q[1].x,q[1].y,h,k),s=this.homogeneousToClient(q[q.length-2].x,q[q.length-2].y,h,k),q=0.5*(v.x+s.x),v=0.5*(v.y+s.y),s=Autodesk.Viewing.Extensions.Markers.getPixelOffset(d.strokeWidth),
q=Math.floor(q*l+r.x)+s+0.5,v=Math.floor(v*l+r.y)+s;a.lineWidth=b;Autodesk.Viewing.Extensions.Markers.drawLine(a,q,v,n.x,n.y,c)}};
Autodesk.Viewing.Extensions.Markers.ViewerMarkups.prototype.enterEditMode=function(){if(!this.viewer||!this.viewer.model||this.editMode)return!1;this.editMode=!0;this.previousMarkups=this.markups.slice();this.clear();this.container.appendChild(this.editFrameDiv);this.handleKeyDownBinded=this.handleKeyDown.bind(this);window.addEventListener("keydown",this.handleKeyDownBinded,!1);this.previousToolsCollapsed=this.viewer.toolbar.isCollapsed();this.previousToolsCollapsed||(this.viewer.toolbar.collapse(!0),
this.viewer.hidePanels(!0));Autodesk.Viewing.Extensions.Markers.hideToolsAndPanels(this.viewer);return!0};
Autodesk.Viewing.Extensions.Markers.ViewerMarkups.prototype.leaveEditMode=function(){if(!this.editMode)return!1;this.endDrawing();this.editFrameDiv.parentNode.removeChild(this.editFrameDiv);this.editMode=!1;window.removeEventListener("keydown",this.handleKeyDownBinded);this.handleKeyDownBinded=null;this.previousToolsCollapsed||(this.viewer.toolbar.collapse(!1),this.viewer.hidePanels(!1));Autodesk.Viewing.Extensions.Markers.showToolsAndPanels(this.viewer);return!0};
Autodesk.Viewing.Extensions.Markers.ViewerMarkups.prototype.cancelEditMode=function(){if(!this.leaveEditMode())return!1;this.clear();for(var a=this.previousMarkups,b=a.length,c=0;c<b;++c)this.markups.push(a[c]);this.previousMarkups=[];this.markers.update();return!0};Autodesk.Viewing.Extensions.Markers.ViewerMarkups.prototype.setLineToMarkups=function(a,b){var c={x:a,y:b},d=this.lines;0<d.length?d[0]=c:d.push(c);this.markers.update();return!0};
Autodesk.Viewing.Extensions.Markers.ViewerMarkups.prototype.removeLineToMarkups=function(){this.lines=[];this.markers.update()};Autodesk.Viewing.Extensions.Markers.ViewerMarkups.prototype.startRectangle=function(a,b,c){this.editMode&&this.startDrawing(a,b,c)&&(this.currentMarkupIndex=-1)};Autodesk.Viewing.Extensions.Markers.ViewerMarkups.prototype.startDrawing=function(a,b){if(this.drawing)return!1;this.drawing=!0;this.currentMarkupIndex=-1;this.currentStrokeWidth=a;this.currentStrokeColor=b;return!0};
Autodesk.Viewing.Extensions.Markers.ViewerMarkups.prototype.endDrawing=function(){if(!this.drawing)return!1;this.drawing=!1;this.currentMarkupIndex=-1;this.markers.update();return!0};
Autodesk.Viewing.Extensions.Markers.ViewerMarkups.prototype.setRectangularMarkup=function(a,b,c,d,f,g,h){function k(a,b,c,d){var f=d.impl.canvas.getBoundingClientRect();a+=f.left;b+=f.top;a=d.impl.clientToViewport(a,b);a.z=c;a.unproject(d.impl.camera);return a}function l(a,b,c,d){c=1/c;d=1/d;return new THREE.Vector2(d/c*c*a,-b*d)}if(0>a||0==d||0==f)return this.DRAW_RESULT_NONE;var m=this.getDepthScale();if(0==m)return this.DRAW_RESULT_NONE;d/=m;f/=m;b={origin:function(a,b,c){var d;d=k(a,b,-1,c);a=
k(a,b,1,c);a.sub(d);a.normalize();d=new THREE.Ray(d,a);return d.direction.multiplyScalar(c.impl.camera.near).add(d.origin)}(b,c,this.viewer),path:["M",l(0,0,this.clientWidth,this.clientHeight),"L",l(d,0,this.clientWidth,this.clientHeight),"L",l(d,f,this.clientWidth,this.clientHeight),"L",l(0,f,this.clientWidth,this.clientHeight),"z"],strokeWidth:g+this.markupsBorderWidth,strokeColor:h};if(a<this.markups.length)return this.markups[a]=b,this.DRAW_RESULT_MARKUP_REPLACED;this.markups.push(b);return this.DRAW_RESULT_MARKUP_NEW};
Autodesk.Viewing.Extensions.Markers.ViewerMarkups.prototype.removeMarkupAt=function(a){this.markups.splice(a,1);this.markers.update()};
Autodesk.Viewing.Extensions.Markers.ViewerMarkups.prototype.drawMarkup=function(a,b){var c=Autodesk.Viewing.Extensions.Markers.worldToClient(b.origin,this.viewer),d=this.getDepthScale();if(0<d){a.beginPath();for(var f=this.clientWidth,g=this.clientHeight,h=Autodesk.Viewing.Extensions.Markers.getPixelOffset(b.strokeWidth),k=b.path,l=k.length-1,m=0;m<l;m+=2){var p=this.homogeneousToClient(k[m+1].x,k[m+1].y,f,g);p.x=Math.floor(p.x*d+c.x)+h;p.y=Math.floor(p.y*d+c.y)+h;switch(k[m]){case "M":a.moveTo(p.x,
p.y);break;case "L":a.lineTo(p.x,p.y)}}}a.closePath();a.globalAlpha=1;a.lineWidth=this.markupsBorderWidth;a.strokeStyle=this.markupsBorderColor;a.stroke();a.globalAlpha=1;a.save();a.clip();this.drawing?(a.lineWidth=b.strokeWidth,a.strokeStyle=this.markupsCreationColor):(a.globalAlpha=0.5,a.lineWidth=b.strokeWidth,a.fillStyle=b.strokeColor,a.strokeStyle=b.strokeColor,a.fill(),a.lineWidth=b.strokeWidth,a.strokeStyle=b.strokeColor,a.globalAlpha=1);a.stroke();a.restore()};
Autodesk.Viewing.Extensions.Markers.ViewerMarkups.prototype.getDepthScale=function(){var a=this.viewer.impl.camera,a=a.isPerspective?1:a.top;return 0<a?1/a:0};Autodesk.Viewing.Extensions.Markers.ViewerMarkups.prototype.homogeneousToClient=function(a,b,c,d){return new THREE.Vector2(d/c*a*c,-b*d)};
Autodesk.Viewing.Extensions.Markers.ViewerMarkups.prototype.onMouseMove=function(a){if(-1==this.currentMarkupIndex)return this.DRAW_RESULT_NONE;a=Autodesk.Viewing.Extensions.Markers.getMousePosition(a);var b=a.x,c=a.y;a=Math.min(this.currentRectangleIniPoint.x,b);var d=Math.min(this.currentRectangleIniPoint.y,c),b=Math.abs(this.currentRectangleIniPoint.x-b),c=Math.abs(this.currentRectangleIniPoint.y-c);a=this.setRectangularMarkup(this.currentMarkupIndex,a,d,b,c,this.currentStrokeWidth,this.currentStrokeColor);
this.markers.update();return a};Autodesk.Viewing.Extensions.Markers.ViewerMarkups.prototype.onMouseDown=function(a){-1==this.currentMarkupIndex&&(this.clear(),this.startRectangle(this.currentStrokeWidth,this.currentStrokeColor),a=Autodesk.Viewing.Extensions.Markers.getMousePosition(a),this.currentRectangleIniPoint=new THREE.Vector2(a.x,a.y),this.currentMarkupIndex=0)};
Autodesk.Viewing.Extensions.Markers.ViewerMarkups.prototype.onMouseUp=function(a){a=this.onMouseMove(a);this.endDrawing();this.viewer.fireEvent({type:this.EVENT_SELECTION_CHANGED,target:this,drawResult:a})};
Autodesk.Viewing.Extensions.Markers.ViewerMarkups.prototype.getState=function(a){a.objectSet||(a.objectSet=[]);for(var b=this.markups,c=this.markups.length,d=0;d<c;++d){for(var f=b[d],g=f.path,h=g.length,k="O "+f.origin.x.toString()+" "+f.origin.y.toString()+" "+f.origin.z.toString(),l=0;l<h;++l)var m=g[l],k="L"===m||"M"===m||"z"===m?k+(" "+m):k+(" "+m.x.toString()+" "+m.y.toString());f={id:[this.ID_MARKER_AREA],path:k,strokeColor:f.strokeColor,strokeWidth:f.strokeWidth};a.objectSet.push(f)}};
Autodesk.Viewing.Extensions.Markers.ViewerMarkups.prototype.isSupportedMarkupId=function(a){return Array.isArray(a)&&0<a.length?-1!==this.SUPPORTED_MARKER_IDS.indexOf(a[0]):!1};
Autodesk.Viewing.Extensions.Markers.ViewerMarkups.prototype.restoreState=function(a,b){if(!a.objectSet)return!0;this.markups.splice(0,this.markups.length);for(var c=a.objectSet,d=c.length,f=0;f<d;++f){var g=c[f];if(this.isSupportedMarkupId(g.id)){if(!g.path||!g.strokeColor||!g.strokeWidth)return this.markups.splice(0,this.markups.length),!1;for(var h=g.path.split(" "),k=h.length,l=[],m=new THREE.Vector3,p=0;p<k;)switch(h[p]){case "O":p++;m.set(parseFloat(h[p++]),parseFloat(h[p++]),parseFloat(h[p++]));
break;case "M":case "L":case "z":l.push(h[p++]);break;default:l.push(new THREE.Vector3(parseFloat(h[p++]),parseFloat(h[p++])))}this.markups.push({origin:m,path:l,strokeWidth:g.strokeWidth,strokeColor:g.strokeColor})}}return!0};Autodesk.Viewing.Extensions.Markers.ViewerMarkups.prototype.__defineGetter__("markers",function(){return this.viewer.loadedExtensions["Autodesk.Markers"]});Autodesk.Viewing.theExtensionManager.registerExtension("Autodesk.Markups",Autodesk.Viewing.Extensions.Markers.ViewerMarkups);
AutodeskNamespace("Autodesk.Viewing.Extensions.Markers");Autodesk.Viewing.Extensions.Markers.ViewerPinTool=function(a){Autodesk.Viewing.Extension.call(this,a);this.EVENT_LEAVE_EDIT_MODE="ViewerPinTool_leave_edit_mode";this.EVENT_SELECTION_CHANGED="ViewerPinTool_selection_changed"};Autodesk.Viewing.Extensions.Markers.ViewerPinTool.prototype=Object.create(Autodesk.Viewing.Extension.prototype);Autodesk.Viewing.Extensions.Markers.ViewerPinTool.prototype.constructor=Autodesk.Viewing.Extensions.Markers.ViewerPinTool;
Autodesk.Viewing.Extensions.Markers.ViewerPinTool.prototype.load=function(){if(!(this.viewer instanceof Autodesk.Viewing.Viewer3D))return!1;var a=function(){this.cancelEditMode();this.viewer.fireEvent({type:this.EVENT_LEAVE_EDIT_MODE,target:this})}.bind(this);this.editFrameDiv=Autodesk.Viewing.Extensions.Markers.createEditFrame("Click over the model to select a point to comment on.",a);this.editFrameDiv.addEventListener("mouseout",this.onMouseOut.bind(this));this.editFrameDiv.addEventListener("mousemove",
this.onMouseMove.bind(this));this.editFrameDiv.addEventListener("mousedown",this.onMouseDown.bind(this));this.hasSelection=this.editMode=!1;this.selectedNodeId=-1;this.selectedNodeOffset=new THREE.Vector3;this.selectedFragmentId=-1;this.container=this.viewer.container;this.gizmoInvalidColor="#FF0000";this.gizmoSuccessColor="#49C1E4";this.gizmoCollision={fragmentId:-1,point:new THREE.Vector3};this.raycaster=new THREE.Raycaster;a=function(a){this.editMode&&(this.updateGizmo(a),this.updateSelectionMark(a))}.bind(this);
this.markers.addOverlayGraphicsLayer("pintool-overlay",0,a);return!0};Autodesk.Viewing.Extensions.Markers.ViewerPinTool.prototype.handleKeyDown=function(a){a.keyCode===Autodesk.Viewing.theHotkeyManager.KEYCODES.ESCAPE&&this.editMode&&(this.cancelEditMode(),this.viewer.fireEvent({type:this.EVENT_LEAVE_EDIT_MODE,target:this}))};
Autodesk.Viewing.Extensions.Markers.ViewerPinTool.prototype.unload=function(){this.editFrameDiv.parentNode&&this.editFrameDiv.parentNode.removeChild(this.editFrameDiv);this.markers&&this.markers.removeOverlayGraphicsLayer("pintool-overlay");return!0};
Autodesk.Viewing.Extensions.Markers.ViewerPinTool.prototype.enterEditMode=function(){if(this.viewer&&this.viewer.model&&!this.editMode)return this.editMode=!0,this.container.appendChild(this.editFrameDiv),this.handleKeyDownBinded=this.handleKeyDown.bind(this),window.addEventListener("keydown",this.handleKeyDownBinded,!1),this.previousToolsCollapsed=this.viewer.toolbar.isCollapsed(),this.previousToolsCollapsed||(this.viewer.toolbar.collapse(!0),this.viewer.hidePanels(!0)),Autodesk.Viewing.Extensions.Markers.hideToolsAndPanels(this.viewer),
!0};Autodesk.Viewing.Extensions.Markers.ViewerPinTool.prototype.leaveEditMode=function(){if(!this.editMode)return!1;this.clearSelection();this.editFrameDiv.parentNode.removeChild(this.editFrameDiv);this.editMode=!1;window.removeEventListener("keydown",this.handleKeyDownBinded);this.handleKeyDownBinded=null;this.previousToolsCollapsed||(this.viewer.toolbar.collapse(!1),this.viewer.hidePanels(!1));Autodesk.Viewing.Extensions.Markers.showToolsAndPanels(this.viewer);this.markers.update();return!0};
Autodesk.Viewing.Extensions.Markers.ViewerPinTool.prototype.cancelEditMode=function(){return this.leaveEditMode()?!0:!1};
Autodesk.Viewing.Extensions.Markers.ViewerPinTool.prototype.updateGizmo=function(a){function b(a,b,c,d){var f=d.impl.canvas.getBoundingClientRect();a+=f.left;b+=f.top;a=d.impl.clientToViewport(a,b);a.z=c;a.unproject(d.impl.camera);return a}var c=(this.gizmoOverGeometry=function(a,c,d,f,m){var p=f.model.getData();if(f.model.is2d&&p.hidePaper)return m.fragmentId=-1,m.point.copy(b(a,c,-1,f)),!0;for(var n=f.model.getData().fragments.fragId2dbId.length,p=Array(n),q=0;q<n;++q){var r=f.impl.getRenderProxy(f.model,
q);r&&(p[q]=r)}n=b(a,c,-1,f);a=b(a,c,1,f);a.sub(n);a.normalize();a=new THREE.Ray(n,a);d.set(a.origin,a.direction);d=d.intersectObjects(p,!1);0==d.length?(m.fragmentId=-1,m.point.set(0,0,0)):(d=d[0],m.fragmentId=d.object.fragId,m.point.copy(d.point));return-1!=m.fragmentId}(this.canvasX,this.canvasY,this.raycaster,this.viewer,this.gizmoCollision))?this.gizmoSuccessColor:this.gizmoInvalidColor,d=this.canvasX+0.5,f=this.canvasY+0.5;a.lineWidth=1;a.globalAlpha=1;Autodesk.Viewing.Extensions.Markers.drawLine(a,
d,f,d,0,c);Autodesk.Viewing.Extensions.Markers.drawLine(a,d,f,d,1E5,c);Autodesk.Viewing.Extensions.Markers.drawLine(a,d,f,0,f,c);Autodesk.Viewing.Extensions.Markers.drawLine(a,d,f,1E5,f,c);a.globalAlpha=1;Autodesk.Viewing.Extensions.Markers.drawCircle(a,d,f,4,c)};
Autodesk.Viewing.Extensions.Markers.ViewerPinTool.prototype.updateSelection=function(){this.hasSelection=this.gizmoOverGeometry;this.selectedNodeId=function(a,c){if(-1==a)return-1;var d=c.model.getData().fragments.fragId2dbId[a];return d instanceof Number?d:-1}(this.gizmoCollision.fragmentId,this.viewer);var a=this.markers.getFragmentId(this.selectedNodeId);this.selectedNodeOffset=function(a,c,d){if(-1==c)return a.clone();c=d.impl.getRenderProxy(d.model,c);d=new THREE.Matrix4;a=a.clone();d.getInverse(c.matrixWorld);
a.applyMatrix4(d);a.sub(c.geometry.boundingBox.center());return a}(this.gizmoCollision.point,a,this.viewer);this.selectedFragmentId=a};Autodesk.Viewing.Extensions.Markers.ViewerPinTool.prototype.clearSelection=function(){this.selectedNodeId=-1;this.selectedNodeOffset.set(0,0,0);this.selectedFragmentId=-1;this.hasSelection=!1};
Autodesk.Viewing.Extensions.Markers.ViewerPinTool.prototype.updateSelectionMark=function(a){if(this.hasSelection){var b=this.selectedNodeOffset.clone(),c=this.selectedFragmentId;if(-1!=c){var c=this.viewer.impl.getRenderProxy(this.viewer.model,c),d=c.matrixWorld;b.add(c.geometry.boundingBox.center());b.applyMatrix4(d)}b=Autodesk.Viewing.Extensions.Markers.worldToClient(b,this.viewer);b.x=Math.floor(b.x)+0.5;b.y=Math.floor(b.y)+0.5;Autodesk.Viewing.Extensions.Markers.drawCircle(a,b.x,b.y,4,this.gizmoSuccessColor)}};
Autodesk.Viewing.Extensions.Markers.ViewerPinTool.prototype.onMouseOut=function(a){this.canvasY=this.canvasX=-1E5;this.editMode&&this.markers.update()};Autodesk.Viewing.Extensions.Markers.ViewerPinTool.prototype.onMouseMove=function(a){a=Autodesk.Viewing.Extensions.Markers.getMousePosition(a);this.canvasX=a.x;this.canvasY=a.y;this.editMode&&this.markers.update()};
Autodesk.Viewing.Extensions.Markers.ViewerPinTool.prototype.onMouseDown=function(a){a=Autodesk.Viewing.Extensions.Markers.getMousePosition(a);this.canvasX=a.x;this.canvasY=a.y;this.updateSelection();this.editMode&&this.markers.update();this.viewer.fireEvent({type:this.EVENT_SELECTION_CHANGED,target:this})};Autodesk.Viewing.Extensions.Markers.ViewerPinTool.prototype.__defineGetter__("markers",function(){return this.viewer.loadedExtensions["Autodesk.Markers"]});
Autodesk.Viewing.theExtensionManager.registerExtension("Autodesk.PinTool",Autodesk.Viewing.Extensions.Markers.ViewerPinTool);AutodeskNamespace("Autodesk.Viewing.Extensions.Markers");
Autodesk.Viewing.Extensions.Markers.ViewerSelector=function(a){Autodesk.Viewing.Extension.call(this,a);this.EVENT_LEAVE_EDIT_MODE="ViewerSelector_leave_edit_mode";this.EVENT_SELECTION_CHANGED="ViewerSelector_selection_changed";var b;this.load=function(){if(!(this.viewer instanceof Autodesk.Viewing.Viewer3D))return!1;this.editFrameDiv=Autodesk.Viewing.Extensions.Markers.createEditFrame("Click over the model to select an object.",this.onCancel.bind(this));this.editFrameDiv.addEventListener("mousedown",
this.onMouseDown.bind(this));this.editFrameDiv.addEventListener("keydown",this.handleKeyDown.bind(this));this.editMode=!1;this.selectedNodeId=-1;this.container=this.viewer.container;this.raycaster=new THREE.Raycaster;return!0};this.handleKeyDown=function(a){a.keyCode===Autodesk.Viewing.theHotkeyManager.KEYCODES.ESCAPE&&this.editMode&&(this.cancelEditMode(),this.viewer.fireEvent({type:this.EVENT_LEAVE_EDIT_MODE,target:this}))};this.unproject=function(a,b,f){var g=this.viewer.impl.canvas.getBoundingClientRect();
a+=g.left;b+=g.top;a=this.viewer.impl.clientToViewport(a,b);a.z=f;a.unproject(this.viewer.impl.camera);return a};this.getMouseRay=function(a,b){var f=this.unproject(a,b,-1),g=this.unproject(a,b,1);g.sub(f);g.normalize();return new THREE.Ray(f,g)};this.getNodeId=function(a){return-1==a?-1:this.viewer.model.getData().fragments.fragId2dbId[a]};this.onCancel=function(){this.cancelEditMode();this.viewer.fireEvent({type:this.EVENT_LEAVE_EDIT_MODE,target:this})};this.onMouseDown=function(b){var d=Autodesk.Viewing.Extensions.Markers.getMousePosition(b);
b=d.x;for(var f=d.y,g=this.viewer.model.getData().fragments.fragId2dbId.length,d=Array(g),h=0;h<g;++h){var k=a.impl.getRenderProxy(a.model,h);k&&(d[h]=k)}b=this.getMouseRay(b,f);this.raycaster.set(b.origin,b.direction);d=this.raycaster.intersectObjects(d,!1);b=this.selectedNodeId;0==d.length?(this.viewer.clearSelection(),this.selectedNodeId=-1):(d=this.getNodeId(d[0].object.fragId),this.viewer.clearSelection(),d===this.selectedNodeId?this.selectedNodeId=-1:(this.selectedNodeId=d,this.viewer.select(d)));
b!==this.selectedNodeId&&this.viewer.fireEvent({type:this.EVENT_SELECTION_CHANGED,target:this})};this.unload=function(){this.cancelEditMode();this.editFrameDiv.parentNode&&this.editFrameDiv.parentNode.removeChild(this.editFrameDiv);return!0};this.enterEditMode=function(){this.viewer&&this.viewer.model&&!this.editMode&&(this.editMode=!0,this.selectedNodeId=-1,this.viewer.clearSelection(),b=this.handleKeyDown.bind(this),window.addEventListener("keydown",b,!1),this.container.appendChild(this.editFrameDiv),
this.previousToolsCollapsed=this.viewer.toolbar.isCollapsed(),this.previousToolsCollapsed||(this.viewer.toolbar.collapse(!0),this.viewer.hidePanels(!0)),Autodesk.Viewing.Extensions.Markers.hideToolsAndPanels(this.viewer))};this.leaveEditMode=function(){if(!this.editMode)return!1;this.editFrameDiv.parentNode.removeChild(this.editFrameDiv);this.editMode=!1;window.removeEventListener("keydown",b);b=null;this.previousToolsCollapsed||(this.viewer.toolbar.collapse(!1),this.viewer.hidePanels(!1));Autodesk.Viewing.Extensions.Markers.showToolsAndPanels(this.viewer);
return!0};this.cancelEditMode=function(){-1!==this.selectedNodeId&&(this.selectedNodeId=-1,this.viewer.clearSelection());this.leaveEditMode()}};Autodesk.Viewing.Extensions.Markers.ViewerSelector.prototype=Object.create(Autodesk.Viewing.Extension.prototype);Autodesk.Viewing.Extensions.Markers.ViewerSelector.prototype.constructor=Autodesk.Viewing.Extensions.Markers.ViewerSelector;Autodesk.Viewing.theExtensionManager.registerExtension("Autodesk.ViewerSelector",Autodesk.Viewing.Extensions.Markers.ViewerSelector);
WarpShader={uniforms:{tDiffuse:{type:"t",value:null},scale:{type:"v2",value:new THREE.Vector2(1,1)},scaleIn:{type:"v2",value:new THREE.Vector2(1,1)},lensCenter:{type:"v2",value:new THREE.Vector2(0,0)},hmdWarpParam:{type:"v4",value:new THREE.Vector4(1,0.22,0.24,0)},chromAbParam:{type:"v4",value:new THREE.Vector4(0.996,-0.0040,1.014,0)}},defines:{},vertexShader:"varying vec2 vUv;\nvoid main() {\nvUv = uv;\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D tDiffuse;\nuniform vec2 scale;\nuniform vec2 scaleIn;\nuniform vec2 lensCenter;\nuniform vec4 hmdWarpParam;\nuniform vec4 chromAbParam;\nvarying vec2 vUv;\nvec4 sampleColor() {\nvec2 uv = (vUv*2.0)-1.0;\nvec2 theta = (uv-lensCenter)*scaleIn;\nfloat rSq = theta.x*theta.x + theta.y*theta.y;\nvec2 rvector = theta*(hmdWarpParam.x + hmdWarpParam.y*rSq + hmdWarpParam.z*rSq*rSq + hmdWarpParam.w*rSq*rSq*rSq);\n  vec2 rBlue = rvector * (chromAbParam.z + chromAbParam.w * rSq);\n  vec2 tcBlue = (lensCenter + scale * rBlue);\n  tcBlue = (tcBlue+1.0)/2.0;\n  if (any(bvec2(clamp(tcBlue, vec2(0.0,0.0), vec2(1.0,1.0))-tcBlue)))\n    return vec4(0.0, 0.0, 0.0, 1.0);\n  vec2 tcGreen = lensCenter + scale * rvector;\n  tcGreen = (tcGreen+1.0)/2.0;\n  vec2 rRed = rvector * (chromAbParam.x + chromAbParam.y * rSq);\n  vec2 tcRed = lensCenter + scale * rRed;\n  tcRed = (tcRed+1.0)/2.0;\n  return vec4(texture2D(tDiffuse, tcRed).r, texture2D(tDiffuse, tcGreen).g, texture2D(tDiffuse, tcBlue).b, 1);\n}\nvoid main() {\nvec4 texel = sampleColor();\ngl_FragColor = texel;\n}"};
AutodeskNamespace("Autodesk.Viewing.Extensions.Oculus");
Autodesk.Viewing.Extensions.Oculus.StereoRenderContext=function(a){var b,c,d,f,g,h,k,l,m,p,n=a?a.useWarp:!0,q=a&&a.HMD?a.HMD:{hResolution:1920,vResolution:1080,hScreenSize:0.12576,vScreenSize:0.07074,interpupillaryDistance:0.0635,lensSeparationDistance:0.0635,eyeToScreenDistance:0.041,distortionK:[1,0.22,0.24,0],chromaAbParameter:[0.996,-0.0040,1.014,0]},r,v,s=1,w=0,z=100,D=1;this.init=function(a,b,c){g=a;h=b;k=c;l=g.devicePixelRatio;D=q.hResolution/(2*q.vResolution);a=-1-4*(q.hScreenSize/4-q.lensSeparationDistance/
2)/q.hScreenSize;s=q.distortionK[0]+q.distortionK[1]*Math.pow(a,2)+q.distortionK[2]*Math.pow(a,4)+q.distortionK[3]*Math.pow(a,6);z=THREE.Math.radToDeg(2*Math.atan2(q.vScreenSize*s,2*q.eyeToScreenDistance));w=4*(q.hScreenSize/4-q.interpupillaryDistance/2)/q.hScreenSize;a=4*(q.hScreenSize/4-q.lensSeparationDistance/2)/q.hScreenSize;r=new THREE.Vector2(a,0);v=new THREE.Vector2(-a,0);d=new RenderContext;f=new RenderContext;d.settings.sao=f.settings.sao=!1;d.settings.antialias=f.settings.antialias=!1;
d.settings.customPresentPass=f.settings.customPresentPass=n;d.init(g,h/2*s/l,k*s/l);f.init(g,k/2*s/l,k*s/l);this.settings=d.settings;if(n){m=new THREE.ShaderPass(WarpShader);p=new THREE.ShaderPass(WarpShader);a=[m,p];for(b=0;2>b;b++)a[b].material.blending=THREE.NoBlending,a[b].material.depthWrite=!1,a[b].material.depthTest=!1,a[b].uniforms.hmdWarpParam.value.set(q.distortionK[0],q.distortionK[1],q.distortionK[2],q.distortionK[3]),a[b].uniforms.chromAbParam.value.set(q.chromaAbParameter[0],q.chromaAbParameter[1],
q.chromaAbParameter[2],q.chromaAbParameter[3]),a[b].uniforms.scaleIn.value.set(1,1/D),a[b].uniforms.scale.value.set(1/s,1*D/s);a[0].uniforms.lensCenter.value.copy(r);a[1].uniforms.lensCenter.value.copy(v)}};this.beginScene=function(a,g,h,k){b=g.clone();c=g.clone();b.aspect=c.aspect=D;b.fov=c.fov=z;var l=1/d.getUnitScale();g=g.target.clone().sub(g.position).cross(g.up).normalize();g.multiplyScalar(0.5*q.interpupillaryDistance*l);b.position.sub(g);c.position.add(g);b.target.sub(g);c.target.add(g);b.toPerspective();
c.toPerspective();b.projectionMatrix.elements[12]+=w;c.projectionMatrix.elements[12]-=w;d.beginScene(a,b,h,k);f.beginScene(a,c,h,k)};this.renderScenePart=function(a,b,c,g){d.renderScenePart(a,b,c,g);f.renderScenePart(a,b,c,g)};this.sceneDirty=function(a,b){d.sceneDirty(a,b);f.sceneDirty(a,b)};this.endScene=function(){d.endScene();f.endScene()};this.clearAllOverlays=function(){d.clearAllOverlays();f.clearAllOverlays()};this.renderOverlays=function(a){d.renderOverlays(a);f.renderOverlays(a)};this.composeFinalFrame=
function(a){d.composeFinalFrame(a,!0);f.composeFinalFrame(a,!0);g.setViewport(0,0,h/2,k);d.presentBuffer(m);g.setViewport(h/2,0,h/2,k);f.presentBuffer(p);g.setViewport(0,0,h,k)};this.cleanup=function(){d.cleanup();f.cleanup()};this.setSize=function(a,b,c){h=a;k=b;d.setSize(h/2*s/l,k*s/l,c);f.setSize(h/2*s/l,k*s/l,c);g.setSize(a,b)};this.getMaxAnisotropy=function(){return d.getMaxAnisotropy()};this.hasMRT=function(){return d.hasMRT()};this.initPostPipeline=function(a,b,c){c=b=a=!1;d.initPostPipeline(a,
b,c);f.initPostPipeline(a,b,c)};this.setClearColors=function(a,b){d.setClearColors(a,b);f.setClearColors(a,b)};this.setAOOptions=function(a,b){d.setAOOptions(a,b);f.setAOOptions(a,b)};this.getAORadius=function(){return d.getAORadius()};this.getAOIntensity=function(){return d.getAOIntensity()};this.setExposureBias=function(a){d.setExposureBias(a);f.setExposureBias(a)};this.getExposureBias=function(){return d.getExposureBias()};this.setTonemapMethod=function(a){d.setTonemapMethod(a);f.setTonemapMethod(a)};
this.getToneMapMethod=function(){return d.getToneMapMethod()};this.toggleTwoSided=function(a){d.toggleTwoSided(a);f.toggleTwoSided(a)};this.enter2DMode=function(a){d.enter2DMode(a);f.enter2DMode(a)};this.idAtPixel=function(a,b){console.warn("idAtPixel not implemented in stereo context.");return 0};this.rolloverObjectViewport=function(a,b){console.warn("rolloverObjectViewport not implemented in stereo context")};this.screenCapture=function(){console.warn("Screen capture not implemented by stereo render context");
return null};this.setUnitScale=function(a){d.setUnitScale(a);f.setUnitScale(a)};this.getUnitScale=function(){return d.getUnitScale()}};AutodeskNamespace("Autodesk.Viewing.Extensions.Oculus");
(function(){function a(a){function b(){s.copy(d.matrixWorld);s.elements[12]=0;s.elements[13]=0;s.elements[14]=0;z&&v.set(z[1],z[2],z[3])}function c(){var a=new WebSocket("ws://localhost:8888/ws");a.onopen=function(){console.log("### Oculus Connected ####")};a.onmessage=function(a){a=a.data;try{z=JSON.parse(a)}catch(b){console.log(a)}};a.onclose=function(){console.log("### Oculus Connection Closed ####")};F=a}var d,f=new THREE.Vector3(0,0,0),n=new THREE.Quaternion,q=new THREE.Quaternion,r=new THREE.Matrix4,
v=new THREE.Vector3(0,0,0),s=new THREE.Matrix4,w=new THREE.Matrix4,z,D=0,A=1,E=10,N=-1,H=0,J=0,G=0,I=0,M=0,C=0,K=0,F;g?z=[0,0,0,0,0,0,0,0]:c();this.getNames=function(){return["headtracker"]};this.getName=function(){return"headtracker"};this.activate=function(c){d=a.navigation.getCamera();b();a.model&&(A=1/a.model.getUnitScale(),E=1E-4*a.model.getBoundingBox().size().length())};this.deactivate=function(a){d=null};this.update=function(b){0>N&&(N=b);var c=b-N;d.isPerspective||a.navigation.toPerspective();
if(g){var k=g.getState();z[0]=D+1;k.orientation&&(z[4]=k.orientation.x,z[5]=k.orientation.y,z[6]=k.orientation.z,z[7]=k.orientation.w);k.position&&(z[1]=k.position.x,z[2]=k.position.y,z[3]=k.position.z)}if(z){k=z[0];if(k>D){d.position.sub(f);f.set(z[1],z[2],z[3]);f.sub(v);f.multiplyScalar(A);f.applyMatrix4(s);d.position.add(f);H+=(C-K)*c*0.0010;q.setFromAxisAngle(d.worldup,H);n.set(z[4],z[5],z[6],z[7]);q.multiply(n);w.makeRotationFromQuaternion(q);r.multiplyMatrices(s,w);var l=r.elements,P=new THREE.Vector3(-l[8],
-l[9],-l[10]),ba=d.target.clone().sub(d.position).length();d.up.set(l[4],l[5],l[6]);var l=new THREE.Vector3(l[0],l[1],l[2]),U=P.clone().multiplyScalar((J-I)*c*E);d.position.add(U);c=l.multiplyScalar((M-G)*c*E);d.position.add(c);d.target.set(d.position.x,d.position.y,d.position.z);d.target.add(P.multiplyScalar(ba))}D=k}F&&1===F.readyState&&F.send("get\n");N=b;return!0};this.handleSingleClick=function(a,b){return!1};this.handleDoubleClick=function(a,b){return!1};this.handleSingleTap=function(a){return!1};
this.handleDoubleTap=function(a,b){return!1};this.handleKeyDown=function(a,b){switch(b){case 38:case 87:J=1;break;case 40:case 83:I=1;break;case 37:case 65:G=1;break;case 39:case 68:M=1;break;case 81:C=1;break;case 69:K=1}return!1};this.handleKeyUp=function(a,c){switch(c){case 38:case 87:J=0;break;case 40:case 83:I=0;break;case 37:case 65:G=0;break;case 39:case 68:M=0;break;case 81:C=0;break;case 69:K=0;break;case 32:b()}return!1};this.handleWheelInput=function(a){return!1};this.handleButtonDown=
function(a,b){return!1};this.handleButtonUp=function(a,b){return!1};this.handleMouseMove=function(a){return!1};this.handleGesture=function(a,b){return!1};this.handleTouchChange=function(a,b){return!1};this.handleBlur=function(a){return!1};this.handleResize=function(){}}var b=Autodesk.Viewing,c=b.Extensions,d=c.Oculus,f=null,g=null;d.Oculus=function(a,c){b.Extension.call(this,a,c);this.viewer=a;this.context=null;this.initialized=!1};d.Oculus.prototype=Object.create(b.Extension.prototype);d.Oculus.prototype.constructor=
c.Oculus;d.Oculus.prototype.toggleOculus=function(b){var c=this.viewer;b?this.context||(this.context=new d.StereoRenderContext({useWarp:!f}),c.impl.setUserRenderContext(this.context),c.resize(c.canvas.clientWidth,c.canvas.clientHeight),c.displayViewCube(!1,!1),c.navigation.isPerspective||c.navigation.toPerspective(),f?launchFullscreen(c.impl.canvas,{vrDisplay:f}):launchFullscreen(c.impl.canvas),this.headTracker||(this.headTracker=new a(c),c.toolController.registerTool(this.headTracker)),c.toolController.activateTool("headtracker")):
this.context&&(this.context=null,c.impl.setUserRenderContext(null),c.displayViewCube(c.prefs.get("viewCube"),!1),c.toolController.deactivateTool("headtracker"),exitFullscreen())};d.Oculus.prototype.createUI=function(){var a=this,c=this.viewer;this.oculusButton=b.UI.Toolbar.createMenuButton("toolbar-oculusTool","Oculus VR Mode",function(b){a.toggleOculus(!a.context)});this.oculusButton.classList.add("oculusIcon");var d=c.modelTools.getTool("toolbar-settingsTool");d?c.modelTools.insertToolBefore(this.oculusButton,
d):c.modelTools.addTool(this.oculusButton)};d.Oculus.prototype.load=function(){function a(c){d.removeEventListener(b.TOOLBAR_CREATED_EVENT,a);m.createUI()}function c(k){for(var n=0;n<k.length;++n)if(k[n]instanceof HMDVRDevice){f=k[n];break}if(f){for(n=0;n<k.length;++n)if(k[n]instanceof PositionSensorVRDevice&&k[n].hardwareUnitId==f.hardwareUnitId){g=k[n];break}f&&g?d.modelTools&&0<d.modelTools.getToolCount()?m.createUI():d.addEventListener(b.TOOLBAR_CREATED_EVENT,a):stderr("Didn't find a HMD and sensor!");
m.initialized=!0}}var d=this.viewer,m=this;navigator.getVRDevices?navigator.getVRDevices().then(c):navigator.mozGetVRDevices?navigator.mozGetVRDevices(c):this.initialized=!0;return!0};d.Oculus.prototype.unload=function(){this.toggleOculus(!1);return!0};b.theExtensionManager.registerExtension("Autodesk.Viewing.Oculus",d.Oculus)})();AutodeskNamespace("Autodesk.Viewing.Private.Collaboration");
(function(){var a=Autodesk.Viewing,b=a.Private,c=b.Collaboration;c.InteractionInterceptor=function(a){this.getNames=function(){return["intercept"]};this.getName=function(){return"intercept"};this.activate=function(a){};this.deactivate=function(a){};this.update=function(a){return!1};this.handleSingleClick=function(a,b){return!1};this.handleDoubleClick=function(a,b){return!1};this.handleSingleTap=function(a){return!1};this.handleDoubleTap=function(a,b){return!1};this.handleKeyDown=function(a,b){return!1};
this.handleKeyUp=function(a,b){return!1};this.handleWheelInput=function(b){a.takeControl();return!1};this.handleButtonDown=function(b,c){a.takeControl();return!1};this.handleButtonUp=function(a,b){return!1};this.handleMouseMove=function(b){a.updatePointer(b);return!1};this.handleGesture=function(b){a.takeControl();return!1};this.handleBlur=function(a){return!1};this.handleResize=function(){}};c.ViewTransceiver=function(c){function f(a){r=!0;a=JSON.parse(a.data.msg);N.restoreState(a);q.impl.invalidate(!0,
!1,!0);r=!1}function g(a){for(var b=0;b<a.length;b++)a[b]=Math.round(1E3*a[b])/1E3}function h(a){var b=a.data.msg;!0===b[1]||s||(b[0]!=w&&(w=b[0],a.data.lastInControl=b[0],n.dispatchEvent({type:"controlChange",channelId:n.channelId,data:a.data})),v=!1,q.navigation.setView((new THREE.Vector3).set(b[2],b[3],b[4]),(new THREE.Vector3).set(b[5],b[6],b[7])),q.navigation.setCameraUpVector((new THREE.Vector3).set(b[8],b[9],b[10])))}function k(a){if(v||s)a=a.camera,a=[a.position.x,a.position.y,a.position.z,
a.target.x,a.target.y,a.target.z,a.up.x,a.up.y,a.up.z],g(a),a.unshift(s),a.unshift(c.getLocalId()),z.sendMessage("camera",a,n.channelId),w!=a[0]&&(w=a[0],n.dispatchEvent({type:"controlChange",channelId:n.channelId,data:{lastInControl:w}}))}function l(a,b,c){a&&!A&&(A=document.createElement("div"),A.classList.add("collabPointer"));a&&!E?(q.container.appendChild(A),E=!0):!a&&E&&(q.container.removeChild(A),E=!1);a&&(A.style.left=b-4+"px",A.style.top=c-4+"px")}function m(a){v||s||(a=a.data.msg,D.origin.set(a[1],
a[2],a[3]),D.direction.set(a[4],a[5],a[6]),a=D.at(q.getCamera().near),a.project(q.getCamera()),a=q.impl.viewportToClient(a.x,a.y),l(!0,a.x,a.y))}function p(a){r||(a=N.getState(H),c.sendMessage("state",JSON.stringify(a),n.channelId))}var n=this,q=this.viewer=null,r=!1,v=!1,s=!1,w,z=this.client=c,D=new THREE.Ray,A=null,E=!1;this.channelId=null;var N,H={seedURN:!1,objectSet:!0,viewport:!1,renderOptions:{environment:!1,ambientOcclusion:!1,toneMap:{exposure:!1},appearance:!1}};this.takeControl=function(){v=
!0;l(!1)};this.updatePointer=function(a){v&&(a=q.impl.clientToViewport(a.canvasX,a.canvasY),q.impl.viewportToRay(a,D),a=[D.origin.x,D.origin.y,D.origin.z,D.direction.x,D.direction.y,D.direction.z],g(a),a.unshift(c.getLocalId()),z.sendMessage("pointer",a,n.channelId))};this.connectCamera=function(a){s=!a};this.attach=function(c){q&&this.detach();this.viewer=q=c;N=new b.ViewerState(q);z.addEventListener("cameraChange",h);z.addEventListener("pointerMove",m);z.addEventListener("viewerState",f);q.hasEventListener(a.CAMERA_CHANGE_EVENT,
k)||q.addEventListener(a.CAMERA_CHANGE_EVENT,k);q.hasEventListener(a.SELECTION_CHANGED_EVENT,p)||(q.addEventListener(a.SELECTION_CHANGED_EVENT,p),q.addEventListener(a.ISOLATE_EVENT,p),q.addEventListener(a.HIDE_EVENT,p),q.addEventListener(a.SHOW_EVENT,p),q.addEventListener(a.HIGHLIGHT_EVENT,p),q.addEventListener(a.EXPLODE_CHANGE_EVENT,p),q.addEventListener(a.LAYER_VISIBILITY_CHANGED_EVENT,p))};this.detach=function(){z&&(z.removeEventListener("cameraChange",h),z.removeEventListener("viewerState",f));
q&&(q.removeEventListener(a.CAMERA_CHANGE_EVENT,k),q.removeEventListener(a.SELECTION_CHANGED_EVENT,p),q.removeEventListener(a.ISOLATE_EVENT,p),q.removeEventListener(a.HIDE_EVENT,p),q.removeEventListener(a.SHOW_EVENT,p),q.removeEventListener(a.HIGHLIGHT_EVENT,p),q.removeEventListener(a.EXPLODE_CHANGE_EVENT,p),q.removeEventListener(a.LAYER_VISIBILITY_CHANGED_EVENT,p),N=this.viewer=q=null)}};c.ViewTransceiver.prototype.constructor=c.ViewTransceiver;THREE.EventDispatcher.prototype.apply(c.ViewTransceiver.prototype)})();
AutodeskNamespace("Autodesk.Viewing.Private.Collaboration");
(function(){function a(a,b,c){function k(b){b=b.data.msg;l.x=b.x1;l.y=b.y1;m.x=b.x2;m.y=b.y2;p=b.explode;b.command&&("gohome"==b.command?(l.x=l.y=0,m.x=m.y=0,a.navigation.setRequestHomeView(!0),a.showAll(),a.impl.selector.clearSelection(),a.explode(0),n=null):"select"==b.command?(b=a.impl.hitTestViewport(new THREE.Vector3(0,0,0)))&&b.node?a.impl.selector.toggleSelection(b.node):a.impl.selector.clearSelection():"hide"==b.command?(b=a.impl.hitTestViewport(new THREE.Vector3(0,0,0)))&&b.node&&a.hide(b.node):
"fly"==b.command?n=n?null:q.target.clone().sub(q.position).normalize():"savepoint"==b.command?(b=v.getState(z),s.push(b),alertify.success("Savepoint created.")):"nextsavepoint"==b.command&&s.length&&(w>=s.length&&(w=0),v.restoreState(s[w++])))}var l=new THREE.Vector2,m=new THREE.Vector2,p=0,n=null,q,r=a,v,s=[],w=0,z={seedURN:!1,objectSet:!0,viewport:!0,renderOptions:{environment:!1,ambientOcclusion:!1,toneMap:{exposure:!1},appearance:!1}};this.getNames=function(){return["joystick"]};this.getName=
function(){return"joystick"};this.activate=function(a){b.addEventListener("joystick",k);c.addEventListener("joystick",k);q=r.navigation.getCamera();r.model&&(r.model.getBoundingBox().size().length(),v=new d.ViewerState(r))};this.deactivate=function(a){b.removeEventListener("joystick",k);c.removeEventListener("joystick",k);v=q=null;s.length=0};this.update=function(b){q.isPerspective||a.navigation.toPerspective();n&&(b=n.clone().multiplyScalar(40),q.position.add(b),q.target.add(b));0!=p&&(b=a.getExplodeScale()+
0.01*p,1<b&&(b=1),0>b&&(b=0),a.explode(b));if(0==l.x&&0==l.y&&0==m.x&&0==m.y)return!(!n&&!p);var c=q.target.clone().sub(q.position);b=c.length();c.multiplyScalar(1/b);var d=c.clone().cross(q.up).normalize(),g=c.clone().multiplyScalar(200*l.y);q.position.add(g);q.target.add(g);g=d.clone().multiplyScalar(200*l.x);q.position.add(g);q.target.add(g);g=new THREE.Quaternion;g.setFromAxisAngle(d,0.05*m.y);c=c.clone().applyQuaternion(g);q.up.applyQuaternion(g);d=new THREE.Quaternion;d.setFromAxisAngle(q.worldup,
0.05*-m.x);c.applyQuaternion(d);q.up.applyQuaternion(d);c.multiplyScalar(b);q.target.copy(q.position).add(c);return!0};this.handleSingleClick=function(a,b){return!1};this.handleDoubleClick=function(a,b){return!1};this.handleSingleTap=function(a){return!1};this.handleDoubleTap=function(a,b){return!1};this.handleKeyDown=function(a,b){return!1};this.handleKeyUp=function(a,b){return!1};this.handleWheelInput=function(a){return!1};this.handleButtonDown=function(a,b){return!1};this.handleButtonUp=function(a,
b){return!1};this.handleMouseMove=function(a){return!1};this.handleGesture=function(a,b){return!1};this.handleTouchChange=function(a,b){return!1};this.handleBlur=function(a){return!1};this.handleResize=function(){}}var b=Autodesk.Viewing,c=b.Extensions,d=b.Private;c.RemoteControl=function(c,g){b.Extension.call(this,c,g);this.viewer=c;this.client=d.MessageClient.GetInstance();this.p2p=new d.P2PClient(this.client);this.controllerTool=new a(c,this.client,this.p2p);c.toolController.registerTool(this.controllerTool)};
c.RemoteControl.prototype=Object.create(b.Extension.prototype);c.RemoteControl.prototype.constructor=c.RemoteControl;c.RemoteControl.prototype.createUI=function(){var a=this,c=this.viewer;this.controlButton=b.UI.Toolbar.createMenuButton("toolbar-remoteControlTool","Pair with controller device",function(b){a.client.isConnected()?(a.p2p.hangup(),a.client.disconnect(),c.toolController.deactivateTool(a.controllerTool.getName()),c.modelTools.deselect(a.controlButton.id),a.removeCrosshair()):(c.model&&
(c.model.getData(),a.client.addEventListener("connectSucceeded",function(b){stderr("connect succeeded");b=b.data.id+"rc";a.client.join(b);alertify.alert('To connect your device visit this URL <a href="http://goo.gl/SXymnv">http://goo.gl/SXymnv</a><br> And enter this code when prompted: <br><p class="remoteCode">'+b+'</p> or scan this QR code with the device:<br><img src="'+("http://chart.googleapis.com/chart?cht=qr&chs=256x256&choe=UTF-8&chld=H|0&chl="+((RESOURCE_ROOT.length?RESOURCE_ROOT:window.location.origin+
"/")+"rc.html?sessionId="+b))+'"></img>');var c=function(b){alertify.hide();a.p2p.removeEventListener(c);alertify.success("Successfully paired remote device.",1E3);a.addCrosshair()};a.p2p.addEventListener("dataChannelAdded",c)}),c.navigation.toPerspective(),a.client.connect()),c.toolController.activateTool(a.controllerTool.getName()),c.modelTools.select(a.controlButton.id))});this.controlButton.classList.add("controllerIcon");var d=c.modelTools.getTool("toolbar-settingsTool");d?c.modelTools.insertToolBefore(this.controlButton,
d):c.modelTools.addTool(this.controlButton)};c.RemoteControl.prototype.load=function(){function a(d){b.removeEventListener(Autodesk.Viewing.TOOLBAR_CREATED_EVENT,a);c.createUI()}var b=this.viewer,c=this;b.modelTools&&0<b.modelTools.getToolCount()?c.createUI():b.addEventListener(Autodesk.Viewing.TOOLBAR_CREATED_EVENT,a);return!0};c.RemoteControl.prototype.unload=function(){var a=this.viewer;this.p2p.hangup();this.client.disconnect();a.toolController.deactivateTool(this.controllerTool.getName());this.panel&&
(this.panel.reset(),this.panel.setVisible(!1),this.panel=null);a.modelTools.removeTool(this.controlButton);return!0};c.RemoteControl.prototype.addCrosshair=function(){var a=this.viewer.container;this.hdiv=document.createElement("div");this.hdiv.style.position="absolute";this.hdiv.style.width="40px";this.hdiv.style.height="1px";this.hdiv.style.top="50%";this.hdiv.style.left="calc(50% - 20px)";this.hdiv.style.backgroundColor="#00ff00";a.appendChild(this.hdiv);this.vdiv=document.createElement("div");
this.vdiv.style.position="absolute";this.vdiv.style.width="1px";this.vdiv.style.height="40px";this.vdiv.style.top="calc(50% - 20px)";this.vdiv.style.left="50%";this.vdiv.style.backgroundColor="#00ff00";a.appendChild(this.vdiv)};c.RemoteControl.prototype.removeCrosshair=function(){this.viewer.container.removeChild(this.hdiv);this.viewer.container.removeChild(this.vdiv)};b.theExtensionManager.registerExtension("Autodesk.Viewing.RemoteControl",c.RemoteControl)})();AutodeskNamespace("Autodesk.Viewing.Private.Collaboration");
(function(){function a(a,c,d,f){this.viewer=a;this.client=c;this.p2p=d;this.viewtx=f;b.UI.DockingPanel.call(this,a.container,"CollabPanel","Collaboration");this.container.classList.add("collabPanel");this.container.style.height="auto";this.container.dockRight=!0;this.content=document.createElement("div");this.container.appendChild(this.content);this.content.classList.add("collabPanelContent");this.tableContainer=document.createElement("div");this.tableContainer.classList.add("userListTable","dockingPanelScroll");
this.table=document.createElement("table");this.table.classList.add("tftable");this.tbody=document.createElement("tbody");this.table.appendChild(this.tbody);this.tableContainer.appendChild(this.table);this.content.appendChild(this.tableContainer);this.chatHistory=document.createElement("div");this.chatHistory.classList.add("chatHistory");this.chatHistory.classList.add("textEntry");this.chatHistory.classList.add("dockingPanelScroll");this.content.appendChild(this.chatHistory);this.chatPanel=document.createElement("div");
this.chatPanel.classList.add("chatPanel");this.textInput=document.createElement("input");this.textInput.type="text";this.textInput.classList.add("textEntry");this.textInput.placeholder="Type a message...";this.chatPanel.appendChild(this.textInput);this.content.appendChild(this.chatPanel);this.isCameraConnected=!0;var m=this;this.addEventListener(c,"userListChange",function(a){a.channelId&&a.channelId!==m.viewtx.channelId||(a=m.client.getChannelInfo(m.viewtx.channelId))&&m.updateUsers(a.users)});this.addEventListener(this.viewtx,
"controlChange",function(a){a.channelId===m.viewtx.channelId&&m.updateUserInControl(a.data.lastInControl)});this.addEventListener(c,"chatReceived",function(a){a.channelId===m.viewtx.channelId&&m.updateChatHistory(a)});this.textInput.onkeyup=function(a){m.handleChatInput(a)};this.addEventListener(this.p2p,"remoteStreamAdded",function(a){m.videoPanel||m.createVideoPanel();m.remoteVideo.src=window.URL.createObjectURL(a.data)});this.addEventListener(this.p2p,"localStreamAdded",function(a){m.videoPanel||
m.createVideoPanel();m.localVideo.src=window.URL.createObjectURL(a.data)});this.addEventListener(this.p2p,"remoteHangup",function(a){m.removeVideoPanel()})}var b=Autodesk.Viewing,c=b.Extensions,d=b.Private,f=d.Collaboration;a.prototype=Object.create(b.UI.DockingPanel.prototype);a.prototype.constructor=a;a.prototype.updateUsers=function(a){for(var b=document.createElement("tbody"),c=0;c<a.length;c++){var d=b.insertRow(-1);d.id=a[c].id;var f=d.insertCell(0);f.style.width="14px";f.style.cursor="default";
var p=document.createElement("div");p.classList.add("statusBase");p.classList.add("statusNormal");p.innerHTML="&#9679";f.appendChild(p);d.insertCell(1).textContent=a[c].name}this.table.replaceChild(b,this.tbody);this.tbody=b;this.fixComponentPlacement()};a.prototype.updateUserInControl=function(a){for(var b=0;b<this.tbody.rows.length;b++){var c=this.tbody.rows[b],d=c.cells[0].childNodes[0];c.id==a?(d.classList.remove("statusNormal"),d.classList.add("statusInControl"),d.innerHTML="&#9784"):(d.classList.remove("statusInControl"),
d.classList.add("statusNormal"),d.innerHTML="&#9679")}};a.prototype.updateChatHistory=function(a){var b=this.client.getUserById(a.data.from,a.channelId);if("/"!=a.data.msg.charAt(0)){if(this.chatHistory.lastUser!=b.name){var c=document.createElement("p"),d=document.createElement("div");d.classList.add("heading");d.style.float="left";d.textContent=b.name;c.appendChild(d);d=document.createElement("div");d.classList.add("heading");d.style.textAlign="right";d.textContent=(new Date).toLocaleTimeString();
c.appendChild(d);this.chatHistory.appendChild(c);this.chatHistory.lastUser=b.name}else b=document.createElement("br"),this.chatHistory.appendChild(b);b=document.createElement("span");b.classList.add("messageText");b.textContent=a.data.msg;this.chatHistory.appendChild(b);this.chatHistory.scrollTop=this.chatHistory.scrollHeight}};a.prototype.handleChatInput=function(a){13==a.which&&0!=this.textInput.value.length&&(this.client.sendChatMessage(this.textInput.value,this.viewtx.channelId),this.textInput.value=
"",this.textInput.placeholder="")};a.prototype.fixComponentPlacement=function(a){a=this.tableContainer.offsetHeight+this.chatPanel.offsetHeight;this.videoPanel&&(a+=this.videoPanel.offsetHeight);this.chatHistory.style.height="calc(100% - "+a+"px)"};a.prototype.createVideoPanel=function(a){this.videoPanel=document.createElement("div");this.videoPanel.classList.add("videoPanel");this.localVideo=document.createElement("video");this.localVideo.autoplay=!0;this.localVideo.muted=!0;this.localVideo.classList.add("videoInset");
this.videoPanel.appendChild(this.localVideo);this.remoteVideo=document.createElement("video");this.remoteVideo.autoplay=!0;this.remoteVideo.classList.add("videoMain");this.videoPanel.appendChild(this.remoteVideo);var b=this;a=document.createElement("div");a.classList.add("dockingPanelClose");a.innerHTML="&times";a.title="End video call";a.onclick=function(a){b.p2p.hangup();b.removeVideoPanel()};this.videoPanel.appendChild(a);this.content.insertBefore(this.videoPanel,this.chatHistory);this.fixComponentPlacement()};
a.prototype.removeVideoPanel=function(){this.videoPanel&&this.content.removeChild(this.videoPanel);this.videoPanel=null};a.prototype.reset=function(a){this.tbody&&(a=document.createElement("tbody"),this.table.replaceChild(a,this.tbody),this.tbody=a);this.chatHistory.textContent="";this.textInput.value="";this.removeVideoPanel()};c.Collaboration=function(a,c){b.Extension.call(this,a,c);this.viewer=a};c.Collaboration.prototype=Object.create(b.Extension.prototype);c.Collaboration.prototype.constructor=
c.Collaboration;c.Collaboration.prototype.initNetwork=function(a){if(!this.p2p||a)this.viewtx=new f.ViewTransceiver(this.client),this.interceptor=new f.InteractionInterceptor(this.viewtx),this.viewer.toolController.registerTool(this.interceptor),this.p2p=new d.P2PClient(this.client)};c.Collaboration.prototype.createUI=function(){var c=this,d=this.viewer;this.initNetwork(!1);this.panel=new a(this.viewer,this.client,this.p2p,this.viewtx);this.collabButton=b.UI.Toolbar.createMenuButton("toolbar-collaborateTool",
"Collaborate",function(a){c.panel.isVisible()?(c.panel.setVisible(!1,!0),c.panel.reset()):c.panel.setVisible(!0,!0)});this.collabButton.classList.add("collabIcon");this.panel.addVisibilityListener(function(a){a?(d.model&&(a=d.model.getData(),c.viewtx.channelId=a.basePath,c.viewtx.attach(d),c.client.connect(c.viewtx.channelId),c.client.join(c.viewtx.channelId)),d.toolController.activateTool(c.interceptor.getName()),d.modelTools.select(c.collabButton.id)):(c.p2p.hangup(),c.viewtx.detach(d),c.viewtx.channelId=
null,c.client.disconnect(),c.panel.reset(),d.toolController.deactivateTool(c.interceptor.getName()),d.modelTools.deselect(c.collabButton.id))});var f=d.modelTools.getTool("toolbar-settingsTool");f?d.modelTools.insertToolBefore(this.collabButton,f):d.modelTools.addTool(this.collabButton)};c.Collaboration.prototype.close=function(){this.panel.setVisible(!1,!0);this.panel.reset()};c.Collaboration.prototype.load=function(){function a(d){b.removeEventListener(Autodesk.Viewing.TOOLBAR_CREATED_EVENT,a);
c.createUI()}var b=this.viewer,c=this;this.client=d.MessageClient.GetInstance(this.options.messageServerURL);this.client.addEventListener("socketError",function(a){d.ErrorHandler.reportError(b.container,Autodesk.Viewing.ErrorCodes.RTC_ERROR,a.data);c.close()});this.presenceChannelId=window.location.host;this.client.isConnected();b.modelTools&&0<b.modelTools.getToolCount()?c.createUI():b.addEventListener(Autodesk.Viewing.TOOLBAR_CREATED_EVENT,a);return!0};c.Collaboration.prototype.unload=function(){var a=
this.viewer;this.p2p.hangup();this.viewtx.detach(a);this.client.disconnect();a.toolController.deactivateTool(this.interceptor.getName());this.panel&&(this.panel.reset(),this.panel.setVisible(!1),this.panel.uninitialize(),this.panel=null);a.modelTools.removeTool(this.collabButton);this.collabButton=null;return!0};b.theExtensionManager.registerExtension("Autodesk.Viewing.Collaboration",c.Collaboration)})();"use strict";AutodeskNamespace("Autodesk.Viewing.Extensions.Beeline");
Autodesk.Viewing.Extensions.Beeline.BeelineExtension=function(a,b){Autodesk.Viewing.Extension.call(this,a,b)};Autodesk.Viewing.Extensions.Beeline.BeelineExtension.prototype=Object.create(Autodesk.Viewing.Extension.prototype);Autodesk.Viewing.Extensions.Beeline.BeelineExtension.prototype.constructor=Autodesk.Viewing.Extensions.Beeline.BeelineExtension;
Autodesk.Viewing.Extensions.Beeline.BeelineExtension.prototype.load=function(){var a=this,b=this.viewer,c=b.getToolbar(!0);this.tool=new Autodesk.Viewing.Extensions.Beeline.BeelineTool(b.impl,b);b.toolController.registerTool(this.tool);this.createUI(c);var d;this.HOTKEYS_ID="Autodesk.Beeline.Hotkeys";c=[];c.push({keycodes:[Autodesk.Viewing.theHotkeyManager.KEYCODES.CONTROL,Autodesk.Viewing.theHotkeyManager.KEYCODES.ALT],onPress:function(){d=b.getActiveNavigationTool();b.setActiveNavigationTool(a.tool.getName());
return!0},onRelease:function(){b.setActiveNavigationTool(d?d:b.defaultNavigationToolName);return!0}});Autodesk.Viewing.theHotkeyManager.pushHotkeys(this.HOTKEYS_ID,c);this.onToolChanged=function(b){-1!==b.toolName.indexOf("beeline")&&Autodesk.Viewing.UI.SubToolbar.setToolState(a.beelineButton.id,b.active?Autodesk.Viewing.UI.SubToolbar.STATE_ACTIVE:Autodesk.Viewing.UI.SubToolbar.STATE_NOTACTIVE)};b.addEventListener(Autodesk.Viewing.TOOL_CHANGE_EVENT,this.onToolChanged);return!0};
Autodesk.Viewing.Extensions.Beeline.BeelineExtension.prototype.createUI=function(a){a=a.getSubToolbarById(Autodesk.Viewing.TOOLBAR.NAVTOOLSID);var b=this.viewer;this.beelineButton=Autodesk.Viewing.UI.Toolbar.createMenuButton("toolbar-beelineTool","Walk to",function(a){a=Autodesk.Viewing.UI.SubToolbar.getToolState("toolbar-beelineTool");a===Autodesk.Viewing.UI.SubToolbar.STATE_NOTACTIVE?b.setActiveNavigationTool("beeline"):a===Autodesk.Viewing.UI.SubToolbar.STATE_ACTIVE&&b.setActiveNavigationTool()},
{defaultTooltipValue:"Walk to (double-click to Walk through)"});var c=a.getTool("toolbar-cameraSubmenuTool");c?a.insertToolBefore(this.beelineButton,c):a.addTool(this.beelineButton);var d=this,f=function(){b.removeEventListener(Autodesk.Viewing.TOOLBAR_CREATED_EVENT,f);var a=Autodesk.Viewing.Extensions.ViewerSettingTab.Navigation,c=b.getSettingsPanel(!0);d.viewerOption_LookHorId=c.addCheckbox(a,"Reverse horizontal look direction",!1,function(a){b.setReverseHorizontalLookDirection(a)},"reverseHorizontalLookDirection");
d.viewerOption_LookVertId=c.addCheckbox(a,"Reverse vertical look direction",!1,function(a){b.setReverseVerticalLookDirection(a)},"reverseVerticalLookDirection")};this.viewer.getSettingsPanel(!1)?f():this.viewer.addEventListener(Autodesk.Viewing.TOOLBAR_CREATED_EVENT,f)};
Autodesk.Viewing.Extensions.Beeline.BeelineExtension.prototype.unload=function(){var a=this.viewer;a.removeEventListener(Autodesk.Viewing.TOOL_CHANGE_EVENT,this.onToolChanged);this.onToolChanged=void 0;Autodesk.Viewing.theHotkeyManager.popHotkeys(this.HOTKEYS_ID);var b=a.getToolbar(!1);b&&b.removeFromSubToolbar(Autodesk.Viewing.TOOLBAR.NAVTOOLSID,this.beelineButton);this.beelineButton=null;this.viewer.getSettingsPanel(!1).removeCheckbox(this.viewerOption_LookHorId);this.viewer.getSettingsPanel(!1).removeCheckbox(this.viewerOption_LookVertId);
a.toolController.deregisterTool(this.tool);this.tool=null;return!0};Autodesk.Viewing.theExtensionManager.registerExtension("Autodesk.Beeline",Autodesk.Viewing.Extensions.Beeline.BeelineExtension);AutodeskNamespace("Autodesk.Viewing.Extensions.Beeline");
Autodesk.Viewing.Extensions.Beeline.BeelineTool=function(a,b){function c(){k.revertToStartState()}function d(a){var b={};b.target=a.target.clone();b.worldup=a.worldup.clone();b.position=a.position.clone();b.up=a.up.clone();for(var c="isPerspective fov zoom aspect left right top bottom".split(" "),d=0;d<c.length;d++)b[c[d]]=a[c[d]];return b}function f(b){var c=new THREE.Vector3(b.x,b.y,1);b=a.hitTestViewport(c.clone(),!1);if(!b.intersectPoint)return[];var d=b.node.fragIds instanceof Array?b.node.fragIds:
[b.node.fragIds];b=[];for(var f=0;f<d.length;f++){var g=a.getRenderProxy(this.model,d[f]);g&&b.push(g)}d=new THREE.Raycaster;c=c.clone();f=a.camera;g=new THREE.Vector3(c.x,c.y,1);c.z=-1;c=c.unproject(f);g=g.unproject(f);g.sub(c).normalize();d.set(p.isPerspective?f.position:c,g);return d.intersectObjects(b,!1)}function g(){p.isPerspective||(p.toPerspective(),n.activatePivot(!1));p.getFocalLength()>h&&p.setFocalLength(h,!0)}var h=28,k=this,l=b.container,m=b.autocam,p=b.navigation,n=b.utilities,q=["beeline"],
r=0,v=!1,s=0,w=null,z=null,D=new THREE.Vector3,A=new THREE.Vector3,E=new THREE.Vector3,N=new THREE.Vector3,H=!1,J=new THREE.Vector3,G=new THREE.Vector3,I=null,M=null;this.getNames=function(){return q};this.getName=function(){return q[0]};this.activate=function(a){s=0;b.addEventListener(Autodesk.Viewing.FULLSCREEN_MODE_EVENT,c);m.userLookSpeed=0.8;this.showHUDMessage(!0)};this.deactivate=function(){b.removeEventListener(Autodesk.Viewing.FULLSCREEN_MODE_EVENT,c);this.revertToStartState();this.showHUDMessage(!1)};
this.getCursor=function(){return v?"url(data:image/x-icon;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAQAAADYBBcfAAAACXBIWXMAABYlAAAWJQFJUiTwAAADGGlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjaY2BgnuDo4uTKJMDAUFBUUuQe5BgZERmlwH6egY2BmYGBgYGBITG5uMAxIMCHgYGBIS8/L5UBFTAyMHy7xsDIwMDAcFnX0cXJlYE0wJpcUFTCwMBwgIGBwSgltTiZgYHhCwMDQ3p5SUEJAwNjDAMDg0hSdkEJAwNjAQMDg0h2SJAzAwNjCwMDE09JakUJAwMDg3N+QWVRZnpGiYKhpaWlgmNKflKqQnBlcUlqbrGCZ15yflFBflFiSWoKAwMD1A4GBgYGXpf8EgX3xMw8BSMDVQYqg4jIKAUICxE+CDEESC4tKoMHJQODAIMCgwGDA0MAQyJDPcMChqMMbxjFGV0YSxlXMN5jEmMKYprAdIFZmDmSeSHzGxZLlg6WW6x6rK2s99gs2aaxfWMPZ9/NocTRxfGFM5HzApcj1xZuTe4FPFI8U3mFeCfxCfNN45fhXyygI7BD0FXwilCq0A/hXhEVkb2i4aJfxCaJG4lfkaiQlJM8JpUvLS19QqZMVl32llyfvIv8H4WtioVKekpvldeqFKiaqP5UO6jepRGqqaT5QeuA9iSdVF0rPUG9V/pHDBYY1hrFGNuayJsym740u2C+02KJ5QSrOutcmzjbQDtXe2sHY0cdJzVnJRcFV3k3BXdlD3VPXS8Tbxsfd99gvwT//ID6wIlBS4N3hVwMfRnOFCEXaRUVEV0RMzN2T9yDBLZE3aSw5IaUNak30zkyLDIzs+ZmX8xlz7PPryjYVPiuWLskq3RV2ZsK/cqSql01jLVedVPrHzbqNdU0n22VaytsP9op3VXUfbpXta+x/+5Em0mzJ/+dGj/t8AyNmf2zvs9JmHt6vvmCpYtEFrcu+bYsc/m9lSGrTq9xWbtvveWGbZtMNm/ZarJt+w6rnft3u+45uy9s/4ODOYd+Hmk/Jn58xUnrU+fOJJ/9dX7SRe1LR68kXv13fc5Nm1t379TfU75/4mHeY7En+59lvhB5efB1/lv5dxc+NH0y/fzq64Lv4T8Ffp360/rP8f9/AA0ADzT6lvFdAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAEtSURBVHja7JQxTkJBFEXPQ/xQEDG0ljRYSU1iLN2AtSWlC7Gw04QtGF2ApQVLIDY2hlgIDagJwWCOhf74JXxRYumbaib3ZO7c9zIhq1WBfzAfjJViDWPdYBq/w0pKITjhd7eGJwQkDu2I8rOFHYcmkqgDz4wfoeGZA01BHXtsbSla89ixZsH3an2LtpRUOQde28xFm17PgyPvVK1bl5yYEOtuq3rnyMQCXNJgiiTchuHCnhrGbYBMaXAJULGqlJz54O43bcFdH5xZUqpWJJWW7duza/tDmTWJbbv27Fs2PS2m1iZRNeGcI/aAEevOgCKnbAI7DNjjhUmk1ouf7xgHbLgF3MSzT7wCaxxSiW3hnsf4OngLotj3ILO74CoWTWzOIGcTXab4/6z+CnwbAGjXSZC++vLvAAAAAElFTkSuQmCC), wait":
1>=s?"url(data:image/x-icon;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAACXBIWXMAAAsTAAALEwEAmpwYAAAKT2lDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVNnVFPpFj333vRCS4iAlEtvUhUIIFJCi4AUkSYqIQkQSoghodkVUcERRUUEG8igiAOOjoCMFVEsDIoK2AfkIaKOg6OIisr74Xuja9a89+bN/rXXPues852zzwfACAyWSDNRNYAMqUIeEeCDx8TG4eQuQIEKJHAAEAizZCFz/SMBAPh+PDwrIsAHvgABeNMLCADATZvAMByH/w/qQplcAYCEAcB0kThLCIAUAEB6jkKmAEBGAYCdmCZTAKAEAGDLY2LjAFAtAGAnf+bTAICd+Jl7AQBblCEVAaCRACATZYhEAGg7AKzPVopFAFgwABRmS8Q5ANgtADBJV2ZIALC3AMDOEAuyAAgMADBRiIUpAAR7AGDIIyN4AISZABRG8lc88SuuEOcqAAB4mbI8uSQ5RYFbCC1xB1dXLh4ozkkXKxQ2YQJhmkAuwnmZGTKBNA/g88wAAKCRFRHgg/P9eM4Ors7ONo62Dl8t6r8G/yJiYuP+5c+rcEAAAOF0ftH+LC+zGoA7BoBt/qIl7gRoXgugdfeLZrIPQLUAoOnaV/Nw+H48PEWhkLnZ2eXk5NhKxEJbYcpXff5nwl/AV/1s+X48/Pf14L7iJIEyXYFHBPjgwsz0TKUcz5IJhGLc5o9H/LcL//wd0yLESWK5WCoU41EScY5EmozzMqUiiUKSKcUl0v9k4t8s+wM+3zUAsGo+AXuRLahdYwP2SycQWHTA4vcAAPK7b8HUKAgDgGiD4c93/+8//UegJQCAZkmScQAAXkQkLlTKsz/HCAAARKCBKrBBG/TBGCzABhzBBdzBC/xgNoRCJMTCQhBCCmSAHHJgKayCQiiGzbAdKmAv1EAdNMBRaIaTcA4uwlW4Dj1wD/phCJ7BKLyBCQRByAgTYSHaiAFiilgjjggXmYX4IcFIBBKLJCDJiBRRIkuRNUgxUopUIFVIHfI9cgI5h1xGupE7yAAygvyGvEcxlIGyUT3UDLVDuag3GoRGogvQZHQxmo8WoJvQcrQaPYw2oefQq2gP2o8+Q8cwwOgYBzPEbDAuxsNCsTgsCZNjy7EirAyrxhqwVqwDu4n1Y8+xdwQSgUXACTYEd0IgYR5BSFhMWE7YSKggHCQ0EdoJNwkDhFHCJyKTqEu0JroR+cQYYjIxh1hILCPWEo8TLxB7iEPENyQSiUMyJ7mQAkmxpFTSEtJG0m5SI+ksqZs0SBojk8naZGuyBzmULCAryIXkneTD5DPkG+Qh8lsKnWJAcaT4U+IoUspqShnlEOU05QZlmDJBVaOaUt2ooVQRNY9aQq2htlKvUYeoEzR1mjnNgxZJS6WtopXTGmgXaPdpr+h0uhHdlR5Ol9BX0svpR+iX6AP0dwwNhhWDx4hnKBmbGAcYZxl3GK+YTKYZ04sZx1QwNzHrmOeZD5lvVVgqtip8FZHKCpVKlSaVGyovVKmqpqreqgtV81XLVI+pXlN9rkZVM1PjqQnUlqtVqp1Q61MbU2epO6iHqmeob1Q/pH5Z/YkGWcNMw09DpFGgsV/jvMYgC2MZs3gsIWsNq4Z1gTXEJrHN2Xx2KruY/R27iz2qqaE5QzNKM1ezUvOUZj8H45hx+Jx0TgnnKKeX836K3hTvKeIpG6Y0TLkxZVxrqpaXllirSKtRq0frvTau7aedpr1Fu1n7gQ5Bx0onXCdHZ4/OBZ3nU9lT3acKpxZNPTr1ri6qa6UbobtEd79up+6Ynr5egJ5Mb6feeb3n+hx9L/1U/W36p/VHDFgGswwkBtsMzhg8xTVxbzwdL8fb8VFDXcNAQ6VhlWGX4YSRudE8o9VGjUYPjGnGXOMk423GbcajJgYmISZLTepN7ppSTbmmKaY7TDtMx83MzaLN1pk1mz0x1zLnm+eb15vft2BaeFostqi2uGVJsuRaplnutrxuhVo5WaVYVVpds0atna0l1rutu6cRp7lOk06rntZnw7Dxtsm2qbcZsOXYBtuutm22fWFnYhdnt8Wuw+6TvZN9un2N/T0HDYfZDqsdWh1+c7RyFDpWOt6azpzuP33F9JbpL2dYzxDP2DPjthPLKcRpnVOb00dnF2e5c4PziIuJS4LLLpc+Lpsbxt3IveRKdPVxXeF60vWdm7Obwu2o26/uNu5p7ofcn8w0nymeWTNz0MPIQ+BR5dE/C5+VMGvfrH5PQ0+BZ7XnIy9jL5FXrdewt6V3qvdh7xc+9j5yn+M+4zw33jLeWV/MN8C3yLfLT8Nvnl+F30N/I/9k/3r/0QCngCUBZwOJgUGBWwL7+Hp8Ib+OPzrbZfay2e1BjKC5QRVBj4KtguXBrSFoyOyQrSH355jOkc5pDoVQfujW0Adh5mGLw34MJ4WHhVeGP45wiFga0TGXNXfR3ENz30T6RJZE3ptnMU85ry1KNSo+qi5qPNo3ujS6P8YuZlnM1VidWElsSxw5LiquNm5svt/87fOH4p3iC+N7F5gvyF1weaHOwvSFpxapLhIsOpZATIhOOJTwQRAqqBaMJfITdyWOCnnCHcJnIi/RNtGI2ENcKh5O8kgqTXqS7JG8NXkkxTOlLOW5hCepkLxMDUzdmzqeFpp2IG0yPTq9MYOSkZBxQqohTZO2Z+pn5mZ2y6xlhbL+xW6Lty8elQfJa7OQrAVZLQq2QqboVFoo1yoHsmdlV2a/zYnKOZarnivN7cyzytuQN5zvn//tEsIS4ZK2pYZLVy0dWOa9rGo5sjxxedsK4xUFK4ZWBqw8uIq2Km3VT6vtV5eufr0mek1rgV7ByoLBtQFr6wtVCuWFfevc1+1dT1gvWd+1YfqGnRs+FYmKrhTbF5cVf9go3HjlG4dvyr+Z3JS0qavEuWTPZtJm6ebeLZ5bDpaql+aXDm4N2dq0Dd9WtO319kXbL5fNKNu7g7ZDuaO/PLi8ZafJzs07P1SkVPRU+lQ27tLdtWHX+G7R7ht7vPY07NXbW7z3/T7JvttVAVVN1WbVZftJ+7P3P66Jqun4lvttXa1ObXHtxwPSA/0HIw6217nU1R3SPVRSj9Yr60cOxx++/p3vdy0NNg1VjZzG4iNwRHnk6fcJ3/ceDTradox7rOEH0x92HWcdL2pCmvKaRptTmvtbYlu6T8w+0dbq3nr8R9sfD5w0PFl5SvNUyWna6YLTk2fyz4ydlZ19fi753GDborZ752PO32oPb++6EHTh0kX/i+c7vDvOXPK4dPKy2+UTV7hXmq86X23qdOo8/pPTT8e7nLuarrlca7nuer21e2b36RueN87d9L158Rb/1tWeOT3dvfN6b/fF9/XfFt1+cif9zsu72Xcn7q28T7xf9EDtQdlD3YfVP1v+3Njv3H9qwHeg89HcR/cGhYPP/pH1jw9DBY+Zj8uGDYbrnjg+OTniP3L96fynQ89kzyaeF/6i/suuFxYvfvjV69fO0ZjRoZfyl5O/bXyl/erA6xmv28bCxh6+yXgzMV70VvvtwXfcdx3vo98PT+R8IH8o/2j5sfVT0Kf7kxmTk/8EA5jz/GMzLdsAAAAgY0hSTQAAeiUAAICDAAD5/wAAgOkAAHUwAADqYAAAOpgAABdvkl/FRgAAAQdJREFUeNq0k0GOgzAMRZ+jHI4VO4410qzam0aCjbsoaS1PUgfoWIqAEPnZ3z8AN0DNWoFfVeUbC0BtrOtaISNhC3tvGkC2P7ZtY1kWgHul90JEtCYTkVqo7O844LPyeZ51RJ5atQ3biZeolFJ0miYd1d4nd5A/gB+g7E++AFB7VqzWIkKkfdW/d27P8RpE4p8jRy7Z9ZBOpSEgRRb0MAv0lmxZNEXJj0IACTvwrfeksJBW9a0Z6NEh+vl4UI6qHzHBJ4nyFQv6YoaG3Ls80X7vTIqS1W+vdWvArfuSG/pplPzTBRy6ybaLkSSHAFcThoCe/c6C81n7jUY6a78rHQigftBnQY8BAEubfpuApyq2AAAAAElFTkSuQmCC), wait":
null};this.update=function(){var a=p.getCamera(),c=v=!1;if(1===s){var f=J.clone().sub(G);if(0!==f.x||0!==f.y){v=!0;G.x+=0.7*f.x;G.y+=0.7*f.y;var c=p.getWorldUpVector().dot(p.getCameraUpVector()),g=b.prefs.reverseHorizontalLookDirection?-1:1,h=b.prefs.reverseVerticalLookDirection?-1:1;f.x*=0>c?-g:g;f.y*=h;m.sync(p.getCamera());m.look(f);c=!0;I=d(a)}}return c};this.revertToStartState=function(){n.pivotActive(!1);r=0;H=!0};this.attemptFlight=function(a,b){var c=f(a);0<c.length&&(D=c[0].point,A=c[c.length-
1].point,k.fly(1E3,b))};this.fly=function(a,b){n.setPivotPoint(0===b?D:A,!0,!0);g();E=p.getPosition();z=a;switch(b){case 0:N=E.clone().lerp(D,0.8);break;case 1:var c=2*m.camera.near,d=A.clone().sub(E).length(),c=c/d;n.setPivotPoint(E.clone().lerp(A,1+10*c),!0,!0);N=E.clone().lerp(A,1+c);break;default:return}r=1;H=!1;w=null;requestAnimationFrame(k.step)};this.step=function(a){var b=p.getCamera();if(!H){if(null===w)I=d(b),w=a;else{var c;a:if(c=I,b.target.equals(c.target)&&b.position.equals(c.position)&&
b.worldup.equals(c.worldup)&&b.up.equals(c.up)){for(var f="isPerspective fov zoom aspect left right top bottom".split(" "),g=0;g<f.length;g++)if(b[f[g]]!==c[f[g]]){c=!1;break a}c=!0}else c=!1;if(!c){k.revertToStartState();return}}a-=w;c=a<z?a/z:1;c=E.clone().lerp(N,c);f=p.getEyeVector();f.multiplyScalar(p.getPivotPoint().sub(p.getPosition()).length()/f.length());p.setView(c,f.add(c));I=d(b);n.activatePivot(!1);a<z?requestAnimationFrame(k.step):k.revertToStartState()}};this.handleGesture=function(a){switch(a.type){case "dragstart":return M=
"drag",this.handleButtonDown(a,0);case "dragmove":return"drag"===M?this.handleMouseMove(a):!1;case "dragend":if("drag"===M)return this.handleButtonUp(a,0),M=null,!0}return!1};this.handleButtonDown=function(a,b){s+=1<<b;return 0===b?(G.x=J.x=a.canvasX,G.y=J.y=a.canvasY,!0):!1};this.handleButtonUp=function(a,b){s-=1<<b;return 0===b?!0:!1};this.handleSingleClick=function(a,b){if(0===b){var c={x:a.normalizedX,y:a.normalizedY};switch(r){case 0:k.attemptFlight(c,0);break;case 1:k.revertToStartState()}}else return this.revertToStartState(),
!1;return!0};this.handleSingleTap=function(a){return this.handleSingleClick(a,0)};this.handleDoubleTap=function(a){return a.pointers&&1===a.pointers.length?(k.attemptFlight({x:a.normalizedX,y:a.normalizedY},1),!0):!1};this.handleDoubleClick=function(a,b){return 0===b?(k.attemptFlight({x:a.normalizedX,y:a.normalizedY},1),!0):!1};this.handleMouseMove=function(a){J.x=a.canvasX;J.y=a.canvasY;return 1===s?(g(),!0):!1};this.handleBlur=function(a){this.revertToStartState();return!1};this.showOrthoWarningMessage=
function(){Autodesk.Viewing.Private.HudMessage.displayMessage(l,{msgTitleKey:"Orthographic View Set",messageKey:"The view is set to Orthographic Beeline",messageDefaultValue:"The view is set to Orthographic. Using this tool will switch to Perspective."})};this.showFocalWarningMessage=function(){Autodesk.Viewing.Private.HudMessage.displayMessage(l,{msgTitleKey:"Long Focal Length View Set",messageKey:"The view is set to a long focal length",messageDefaultValue:"This view has a long focal length. Using this tool will set a short focal length."})};
this.watchCamera=function(a){if(b.toolController.getActiveToolName()===q[0]||b.toolController.getActiveToolName()===q[1]){a=(a=p.getCamera())&&!a.isPerspective;var c=p.getFocalLength()>h;a?k.showOrthoWarningMessage():c?k.showFocalWarningMessage():Autodesk.Viewing.Private.HudMessage.dismiss()}};this.showHUDMessage=function(a){var c=p.getCamera(),c=c&&!c.isPerspective,d=p.getFocalLength()>h;a&&c?k.showOrthoWarningMessage():a&&d?k.showFocalWarningMessage():Autodesk.Viewing.Private.HudMessage.dismiss();
a?b.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,k.watchCamera):b.removeEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,k.watchCamera)}};"use strict";AutodeskNamespace("Autodesk.Viewing.Extensions.Measure");Autodesk.Viewing.Extensions.Measure.MeasureExtension=function(a,b){Autodesk.Viewing.Extension.call(this,a,b)};Autodesk.Viewing.Extensions.Measure.MeasureExtension.prototype=Object.create(Autodesk.Viewing.Extension.prototype);
Autodesk.Viewing.Extensions.Measure.MeasureExtension.prototype.constructor=Autodesk.Viewing.Extensions.Measure.MeasureExtension;
Autodesk.Viewing.Extensions.Measure.MeasureExtension.prototype.load=function(){function a(){c.createUI()}var b=this,c=this.viewer;this.escapeHotkeyId="Autodesk.Measure.Hotkeys.Escape";if(!c.toolController)return!1;this.tool=new Autodesk.Viewing.Extensions.Measure.MeasureTool(c,{onCloseCallback:function(a){b.enableMeasureTool(!1)}});c.toolController.registerTool(this.tool);this.tool.register();this.viewer.toolbar?0<this.viewer.toolbar.getSubToolbarById(Autodesk.Viewing.TOOLBAR.MODELTOOLSID).getToolCount()?
this.createUI():this.viewer.addEventListener(Autodesk.Viewing.TOOLBAR_CREATED_EVENT,a):this.viewer.addEventListener(Autodesk.Viewing.TOOLBAR_CREATED_EVENT,a);return!0};Autodesk.Viewing.Extensions.Measure.MeasureExtension.prototype.unload=function(){var a=this.viewer;this.destroyUI();this.tool.deregister();a.toolController.deregisterTool(this.tool);this.tool=null;return!0};
Autodesk.Viewing.Extensions.Measure.MeasureExtension.prototype.enableMeasureTool=function(a){if(this.tool){var b=this.viewer.toolController,c=this.tool.isActive();if(a&&!c)return b.activateTool("measure"),Autodesk.Viewing.UI.SubToolbar.setToolState(this.measureToolButton.id,Autodesk.Viewing.UI.SubToolbar.STATE_ACTIVE),!0;if(!a&&c)return b.deactivateTool("measure"),Autodesk.Viewing.UI.SubToolbar.setToolState(this.measureToolButton.id,Autodesk.Viewing.UI.SubToolbar.STATE_NOTACTIVE),!0}return!1};
Autodesk.Viewing.Extensions.Measure.MeasureExtension.prototype.createUI=function(){var a=this,b=this.viewer;this.inspectToolsButton=this.measureToolButton=null;if(b.model&&!b.model.is2d()){var c=b.getToolbar(!0),d=c.getSubToolbarById(Autodesk.Viewing.TOOLBAR.MODELTOOLSID),f=Autodesk.Viewing.UI.Toolbar.createMenuButton,g=b.modelTools.getTool("toolbar-explodeTool"),h=this.measureToolButton=f("toolbar-measureTool","Measure",function(c){a.enableMeasureTool(!a.tool.isActive());g&&a.tool.isActive()&&(b.explodeslider.classList.contains("slider-anim-in")&&
b.showExplodeSlider(!1),Autodesk.Viewing.UI.SubToolbar.setToolState(g.id,Autodesk.Viewing.UI.SubToolbar.STATE_NOTACTIVE))});g&&(this.inspectToolsButton=f("toolbar-inspectTools","Inspect",null),this.inspectToolsButton.style.position="relative",h=document.createElement("ul"),h.style.width="46px",h.style.position="absolute",h.style.padding="2px 0px 2px 2px",d.removeTool(g),h.appendChild(this.measureToolButton),h.appendChild(g),g.children[0].style.left="110%",g.children[0].style.bottom="10%",c.attachSubMenu(this.inspectToolsButton,
h),h=this.inspectToolsButton);(c=b.modelTools.getTool("toolbar-resetTool"))?d.insertToolBefore(h,c):d.addTool(h);Autodesk.Viewing.theHotkeyManager.pushHotkeys(this.escapeHotkeyId,[{keycodes:[Autodesk.Viewing.theHotkeyManager.KEYCODES.ESCAPE],onRelease:function(){return a.enableMeasureTool(!1)}}])}};
Autodesk.Viewing.Extensions.Measure.MeasureExtension.prototype.destroyUI=function(){var a=this.viewer;a.model.is2d()||((a=a.getToolbar(!1))&&a.getSubToolbarById(Autodesk.Viewing.TOOLBAR.MODELTOOLSID)&&(this.inspectToolsButton?a.removeFromSubToolbar(Autodesk.Viewing.TOOLBAR.MODELTOOLSID,this.inspectToolsButton.id):this.measureToolButton&&a.removeFromSubToolbar(Autodesk.Viewing.TOOLBAR.MODELTOOLSID,this.measureToolButton.id),this.inspectToolsButton=this.measureToolButton=null),Autodesk.Viewing.theHotkeyManager.popHotkeys(this.escapeHotkeyId))};
Autodesk.Viewing.theExtensionManager.registerExtension("Autodesk.Measure",Autodesk.Viewing.Extensions.Measure.MeasureExtension);AutodeskNamespace("Autodesk.Viewing.Extensions.Measure");
Autodesk.Viewing.Extensions.Measure.MeasureTool=function(a,b){function c(){D.updateLabelPositions()}function d(){g.clearMeasurement()}function f(a){var b=this,c=!1,d=null,f=null,k={first:{},second:{}},l={xyz:{axis:!1,color:"FF0000"},x:{axis:!0,color:"FF0000"},y:{axis:!0,color:"00FF00"},z:{axis:!0,color:"0000FF"}},m=4;this.showFirst=function(a,b){this.showEndPoint("first",a,b)};this.showSecond=function(a,b){this.showEndPoint("second",a,b)};this.showEndPoint=function(a,b,c){d||(d=new THREE.MeshPhongMaterial({color:16711680,
ambient:16711680,opacity:1,transparent:!0}),f=new THREE.MeshPhongMaterial({color:16711680,ambient:16711680,opacity:1,transparent:!0}),h.impl.createOverlayScene("MeasureTool-endPoint",d,f));a=k[a];var g=a.mesh;g||(a.geometry=new THREE.SphereGeometry(1),g=a.mesh=new THREE.Mesh(a.geometry,f),h.impl.addOverlay("MeasureTool-endPoint",g));d.opacity=1;f.opacity=1;g.scale.x=c;g.scale.y=c;g.scale.z=c;g.position.set(b.x,b.y,b.z);g.visible=!0;h.impl.invalidate(!1,!1,!0)};this.updateLabelPositions=function(){function a(b,
c,d){var f=h.navigation.getCamera(),g=h.navigation.getScreenViewport();b=new THREE.Vector3(b,c,d);b=b.project(f);return{x:Math.round((b.x+1)/2*g.width),y:Math.round((-b.y+1)/2*g.height)}}function b(c){var d=c.p1,f=c.p2,g=a(d.x,d.y,d.z),h=a(f.x,f.y,f.z),d=h.x-g.x,g=h.y-g.y,h=a(f.x,f.y,f.z),f=h.x,h=h.y;c=c.label.getBoundingClientRect();h=0<g?h+m:h-(c.height+m);f=0>d||0<g?f-(c.width+m):f+m;return{x:f,y:h}}function c(b,d){var f=b.p1,g=b.p2,g=a(f.x+(g.x-f.x)/2,f.y+(g.y-f.y)/2,f.z+(g.z-f.z)/2),f=g.x,g=
g.y,h=d.p1,k=d.p2,h=a(h.x,h.y,h.z),l=a(k.x,k.y,k.z),k=f-(f+h.x+l.x)/3,h=g-(g+h.y+l.y)/3,m=b.label.getBoundingClientRect(),l=m.width/2,m=m.height/2,f=f-l,g=g-m;return{x:0<k?f+l:f-l,y:0<h?g+m:g-m}}for(var d in l)if(l.hasOwnProperty(d)){var f=l[d],g=f.label;g&&(f=f.axis?c(f,l.xyz):b(f),g.style.top=f.y+"px",g.style.left=f.x+"px")}};this.drawLine=function(a,d){function f(a,d,g,k,m,n,p){var q=l[a],r=q.line,s=q.label;d=new THREE.Vector3(d,g,k);m=new THREE.Vector3(m,n,p);r&&(r.visible=!1);s&&s.classList.remove("visible");
0<d.distanceTo(m)&&(n=q.geometry,p="xyz"===a||!c,r||(q.material=new THREE.LineBasicMaterial({color:parseInt(q.color,16),linewidth:1}),q.overlayName="MeasureTool-"+a,h.impl.createOverlayScene(q.overlayName,q.material,q.material),n=q.geometry=new THREE.Geometry,n.dynamic=!0,r=q.line=new THREE.Line(n,q.material),h.impl.addOverlay(q.overlayName,r)),n.vertices.length=0,n.vertices.push(d),n.vertices.push(m),n.verticesNeedUpdate=!0,r.visible=p,q.p1=d,q.p2=m,s||(s=q.label=document.createElement("div"),s.className=
"measure-length","xyz"===a?(s.style.cursor="pointer",s.addEventListener("click",function(a){A.toggle()},!0)):s.style.pointerEvents="none",q.axis&&(s.style.color="#"+q.color,s.style.backgroundColor="transparent",s.textContent=a),h.container.appendChild(s)),q.axis||b.updateDistance(),s.classList.toggle("visible",p))}f("xyz",a.x,a.y,a.z,d.x,d.y,d.z);var g=h.navigation.getAlignedUpVector(),k=Math.abs(g.x),m=Math.abs(g.y),g=Math.abs(g.z);g>k&&g>m?(f("x",a.x,a.y,a.z,d.x,a.y,a.z),f("y",d.x,a.y,a.z,d.x,d.y,
a.z),f("z",d.x,d.y,a.z,d.x,d.y,d.z)):m>k&&m>g?(f("x",a.x,a.y,a.z,d.x,a.y,a.z),f("z",d.x,a.y,a.z,d.x,a.y,d.z),f("y",d.x,a.y,d.z,d.x,d.y,d.z)):(f("y",a.x,a.y,a.z,a.x,d.y,a.z),f("z",a.x,d.y,a.z,a.x,d.y,d.z),f("x",a.x,d.y,d.z,d.x,d.y,d.z));this.updateLabelPositions()};this.updateDistance=function(){var a=l.xyz.label;a&&(a.textContent=g.getDistance("xyz"))};this.setSimple=function(a){if(c!=a){c=a;for(var b in l)if("xyz"!==b&&l.hasOwnProperty(b)){var d=l[b];d.line&&(d.line.visible=!a);d.label&&d.label.classList.toggle("visible",
!a)}h.impl.invalidate(!1,!1,!0)}};this.hide=function(){for(var a in k)if(k.hasOwnProperty(a)){var b=k[a];b.mesh&&(b.mesh.visible=!1)}for(a in l)l.hasOwnProperty(a)&&(b=l[a],b.line&&(b.line.visible=!1),b.label&&b.label.classList.remove("visible"));h.impl.invalidate(!1,!1,!0)};this.destroy=function(){for(var a in k)if(k.hasOwnProperty(a)){var b=k[a];b.mesh&&(h.impl.removeOverlay("MeasureTool-endPoint",b.mesh),b.mesh=b.geometry=null)}d&&(d=f=null,h.impl.removeOverlayScene("MeasureTool-endPoint"));for(a in l)l.hasOwnProperty(a)&&
(b=l[a],b.line&&(h.impl.removeOverlay(b.overlayName,b.line),h.impl.removeOverlayScene(b.overlayName),b.material=b.line=b.geometry=null),b.label&&(b.label.parentNode.removeChild(b.label),b.label=null),b.material=b.line=b.geometry=b.label=b.p1=b.p2=null)}}var g=this,h=a,k=["measure"],l=!1,m=null,p=null,n=!1,q=!1,r=0,v=!1,s="",w=3,z={},D=null,A=null;this.register=function(){A||(A=new Autodesk.Viewing.Extensions.Measure.MeasurePanel(g,h,"measure-panel","Measure",b),h.addPanel(A))};this.deregister=function(){this.deactivate();
h.removePanel(A);A.uninitialize()};this.isActive=function(){return l};this.getNames=function(){return k};this.getName=function(){return k[0]};this.getCursor=function(){return n&&!q?null:"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAACXBIWXMAAAsTAAALEwEAmpwYAAAKT2lDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVNnVFPpFj333vRCS4iAlEtvUhUIIFJCi4AUkSYqIQkQSoghodkVUcERRUUEG8igiAOOjoCMFVEsDIoK2AfkIaKOg6OIisr74Xuja9a89+bN/rXXPues852zzwfACAyWSDNRNYAMqUIeEeCDx8TG4eQuQIEKJHAAEAizZCFz/SMBAPh+PDwrIsAHvgABeNMLCADATZvAMByH/w/qQplcAYCEAcB0kThLCIAUAEB6jkKmAEBGAYCdmCZTAKAEAGDLY2LjAFAtAGAnf+bTAICd+Jl7AQBblCEVAaCRACATZYhEAGg7AKzPVopFAFgwABRmS8Q5ANgtADBJV2ZIALC3AMDOEAuyAAgMADBRiIUpAAR7AGDIIyN4AISZABRG8lc88SuuEOcqAAB4mbI8uSQ5RYFbCC1xB1dXLh4ozkkXKxQ2YQJhmkAuwnmZGTKBNA/g88wAAKCRFRHgg/P9eM4Ors7ONo62Dl8t6r8G/yJiYuP+5c+rcEAAAOF0ftH+LC+zGoA7BoBt/qIl7gRoXgugdfeLZrIPQLUAoOnaV/Nw+H48PEWhkLnZ2eXk5NhKxEJbYcpXff5nwl/AV/1s+X48/Pf14L7iJIEyXYFHBPjgwsz0TKUcz5IJhGLc5o9H/LcL//wd0yLESWK5WCoU41EScY5EmozzMqUiiUKSKcUl0v9k4t8s+wM+3zUAsGo+AXuRLahdYwP2SycQWHTA4vcAAPK7b8HUKAgDgGiD4c93/+8//UegJQCAZkmScQAAXkQkLlTKsz/HCAAARKCBKrBBG/TBGCzABhzBBdzBC/xgNoRCJMTCQhBCCmSAHHJgKayCQiiGzbAdKmAv1EAdNMBRaIaTcA4uwlW4Dj1wD/phCJ7BKLyBCQRByAgTYSHaiAFiilgjjggXmYX4IcFIBBKLJCDJiBRRIkuRNUgxUopUIFVIHfI9cgI5h1xGupE7yAAygvyGvEcxlIGyUT3UDLVDuag3GoRGogvQZHQxmo8WoJvQcrQaPYw2oefQq2gP2o8+Q8cwwOgYBzPEbDAuxsNCsTgsCZNjy7EirAyrxhqwVqwDu4n1Y8+xdwQSgUXACTYEd0IgYR5BSFhMWE7YSKggHCQ0EdoJNwkDhFHCJyKTqEu0JroR+cQYYjIxh1hILCPWEo8TLxB7iEPENyQSiUMyJ7mQAkmxpFTSEtJG0m5SI+ksqZs0SBojk8naZGuyBzmULCAryIXkneTD5DPkG+Qh8lsKnWJAcaT4U+IoUspqShnlEOU05QZlmDJBVaOaUt2ooVQRNY9aQq2htlKvUYeoEzR1mjnNgxZJS6WtopXTGmgXaPdpr+h0uhHdlR5Ol9BX0svpR+iX6AP0dwwNhhWDx4hnKBmbGAcYZxl3GK+YTKYZ04sZx1QwNzHrmOeZD5lvVVgqtip8FZHKCpVKlSaVGyovVKmqpqreqgtV81XLVI+pXlN9rkZVM1PjqQnUlqtVqp1Q61MbU2epO6iHqmeob1Q/pH5Z/YkGWcNMw09DpFGgsV/jvMYgC2MZs3gsIWsNq4Z1gTXEJrHN2Xx2KruY/R27iz2qqaE5QzNKM1ezUvOUZj8H45hx+Jx0TgnnKKeX836K3hTvKeIpG6Y0TLkxZVxrqpaXllirSKtRq0frvTau7aedpr1Fu1n7gQ5Bx0onXCdHZ4/OBZ3nU9lT3acKpxZNPTr1ri6qa6UbobtEd79up+6Ynr5egJ5Mb6feeb3n+hx9L/1U/W36p/VHDFgGswwkBtsMzhg8xTVxbzwdL8fb8VFDXcNAQ6VhlWGX4YSRudE8o9VGjUYPjGnGXOMk423GbcajJgYmISZLTepN7ppSTbmmKaY7TDtMx83MzaLN1pk1mz0x1zLnm+eb15vft2BaeFostqi2uGVJsuRaplnutrxuhVo5WaVYVVpds0atna0l1rutu6cRp7lOk06rntZnw7Dxtsm2qbcZsOXYBtuutm22fWFnYhdnt8Wuw+6TvZN9un2N/T0HDYfZDqsdWh1+c7RyFDpWOt6azpzuP33F9JbpL2dYzxDP2DPjthPLKcRpnVOb00dnF2e5c4PziIuJS4LLLpc+Lpsbxt3IveRKdPVxXeF60vWdm7Obwu2o26/uNu5p7ofcn8w0nymeWTNz0MPIQ+BR5dE/C5+VMGvfrH5PQ0+BZ7XnIy9jL5FXrdewt6V3qvdh7xc+9j5yn+M+4zw33jLeWV/MN8C3yLfLT8Nvnl+F30N/I/9k/3r/0QCngCUBZwOJgUGBWwL7+Hp8Ib+OPzrbZfay2e1BjKC5QRVBj4KtguXBrSFoyOyQrSH355jOkc5pDoVQfujW0Adh5mGLw34MJ4WHhVeGP45wiFga0TGXNXfR3ENz30T6RJZE3ptnMU85ry1KNSo+qi5qPNo3ujS6P8YuZlnM1VidWElsSxw5LiquNm5svt/87fOH4p3iC+N7F5gvyF1weaHOwvSFpxapLhIsOpZATIhOOJTwQRAqqBaMJfITdyWOCnnCHcJnIi/RNtGI2ENcKh5O8kgqTXqS7JG8NXkkxTOlLOW5hCepkLxMDUzdmzqeFpp2IG0yPTq9MYOSkZBxQqohTZO2Z+pn5mZ2y6xlhbL+xW6Lty8elQfJa7OQrAVZLQq2QqboVFoo1yoHsmdlV2a/zYnKOZarnivN7cyzytuQN5zvn//tEsIS4ZK2pYZLVy0dWOa9rGo5sjxxedsK4xUFK4ZWBqw8uIq2Km3VT6vtV5eufr0mek1rgV7ByoLBtQFr6wtVCuWFfevc1+1dT1gvWd+1YfqGnRs+FYmKrhTbF5cVf9go3HjlG4dvyr+Z3JS0qavEuWTPZtJm6ebeLZ5bDpaql+aXDm4N2dq0Dd9WtO319kXbL5fNKNu7g7ZDuaO/PLi8ZafJzs07P1SkVPRU+lQ27tLdtWHX+G7R7ht7vPY07NXbW7z3/T7JvttVAVVN1WbVZftJ+7P3P66Jqun4lvttXa1ObXHtxwPSA/0HIw6217nU1R3SPVRSj9Yr60cOxx++/p3vdy0NNg1VjZzG4iNwRHnk6fcJ3/ceDTradox7rOEH0x92HWcdL2pCmvKaRptTmvtbYlu6T8w+0dbq3nr8R9sfD5w0PFl5SvNUyWna6YLTk2fyz4ydlZ19fi753GDborZ752PO32oPb++6EHTh0kX/i+c7vDvOXPK4dPKy2+UTV7hXmq86X23qdOo8/pPTT8e7nLuarrlca7nuer21e2b36RueN87d9L158Rb/1tWeOT3dvfN6b/fF9/XfFt1+cif9zsu72Xcn7q28T7xf9EDtQdlD3YfVP1v+3Njv3H9qwHeg89HcR/cGhYPP/pH1jw9DBY+Zj8uGDYbrnjg+OTniP3L96fynQ89kzyaeF/6i/suuFxYvfvjV69fO0ZjRoZfyl5O/bXyl/erA6xmv28bCxh6+yXgzMV70VvvtwXfcdx3vo98PT+R8IH8o/2j5sfVT0Kf7kxmTk/8EA5jz/GMzLdsAAAAgY0hSTQAAeiUAAICDAAD5/wAAgOkAAHUwAADqYAAAOpgAABdvkl/FRgAAAKZJREFUeNrclLEKwzAQQ9+FgH/Nk7d8ViFT+6cG36IsNXgIdMg5kAoOIw8WSDoDvAEN04BdEhFjgCTR4e6klFxSIgDLSNydbdsAPgRCktRaUylFkfZ0Z2qtVTlnAfugGibwAur3JFrAxoBnYGEy1pGYmQCLLNB6Uqmw182M9eRS0yzqGo+y6D9rytSQR8vM7DKfbtHy4x+/xG8J+d4W9WAi8fxFOwYA8W0ypu2ZfcsAAAAASUVORK5CYII=), wait"};
this.activate=function(){l=!0;r=0;n=!1;if(!s){var a=h.model.getMetadata("distance unit","value",null);a?alertify.log('File metadata "distance unit"='+a):alertify.error('File metadata "distance unit" does not exist');s=h.model.getUnitString()}D||(D=new f(h));D.hide();A.setVisible(!0);h.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,c);h.addEventListener(Autodesk.Viewing.RESET_EVENT,d)};this.deactivate=function(){l=!1;m=p=null;z={};D&&(D.hide(),D.destroy());z={};A&&(A.setVisible(!1),A.updatePanel());
h.removeEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,c);h.removeEventListener(Autodesk.Viewing.RESET_EVENT,d)};this.update=function(){return!1};this.getUnits=function(){return s};this.setUnits=function(a){s!==a&&(s=a,D&&D.updateDistance())};this.getPrecision=function(){return w};this.setPrecision=function(a){w!==a&&(w=a,D&&D.updateDistance())};this.getDistance=function(a){a=Autodesk.Viewing.Private.convertUnits(h.model.getUnitString(),s,z[a]||0);return Autodesk.Viewing.Private.formatValueWithUnits(a,
s,3,w)};this.clearMeasurement=function(){m=p=null;z={};D.hide();A.updatePanel()};this.getIndicator=function(){return D};this._handleMouseEvent=function(a){return(a=h.impl.hitTest(a.clientX,a.clientY,!1))&&a.intersectPoint?(0===r&&(this.clearMeasurement(),r=1),1===r?(m=a.intersectPoint,D.showFirst(m,0.05)):2===r&&(p=a.intersectPoint,D.showSecond(p,0.05),z.xyz=m.distanceTo(p),z.x=Math.abs(m.x-p.x),z.y=Math.abs(m.y-p.y),z.z=Math.abs(m.z-p.z),A.updatePanel(),D.drawLine(m,p)),!0):!1};this.handleButtonDown=
function(a,b){n=!0;if(0===b&&!(a.ctrlKey||a.metaKey||a.shiftKey||a.altKey)){if(this._handleMouseEvent(a))return q=!0;this.clearMeasurement();r=0}return!1};this.handleMouseMove=function(a){return!q||a.ctrlKey||a.metaKey||a.shiftKey||a.altKey?!1:(1===r||2===r)&&this._handleMouseEvent(a)};this.handleButtonUp=function(a,b){n=!1;q&&(q=!1,v=!0,1===r||2===r)&&(this._handleMouseEvent(a),r=1===r?2:0);return!1};this.handleSingleClick=function(a,b){return v?(v=!1,!0):!1}};AutodeskNamespace("Autodesk.Viewing.Extensions.Measure");
Autodesk.Viewing.Extensions.Measure.MeasurePanel=function(a,b,c,d,f){function g(a,b,c,d,f){var g=document.createElement("select");g.className="optionDropDown";for(var h=0;h<c.length;h++){var k=document.createElement("option");k.value=h;k.setAttribute("data-i18n",c[h]);k.textContent=Autodesk.Viewing.i18n.translate(c[h]);g.add(k)}c=document.createElement("div");c.className="measure-submenu-select";h=document.createElement("div");h.className="measure-submenu-selectlabel";h.setAttribute("for",b);h.setAttribute("data-i18n",
b);h.textContent=Autodesk.Viewing.i18n.translate(b);c.appendChild(h);c.appendChild(g);a.appendChild(c);g.selectedIndex=d;g.onchange=function(a){f(a.target.selectedIndex)};return g}function h(a){var b=document.createElement("div");b.className="measure-horizontal-divider";a.appendChild(b);return b}function k(){for(;p.lastChild;)p.removeChild(p.lastChild);for(var a=l.measureTool.getUnits(),a="ft"===a||"in"===a||"fractional-in"===a?"1 1/2 1/4 1/8 1/16 1/32 1/64".split(" "):"0 0.1 0.01 0.001 0.0001 0.00001".split(" "),
b=0;b<a.length;++b){var c=document.createElement("option");c.value=b;c.textContent=a[b];p.appendChild(c)}b=l.measureTool.getPrecision();a.length<=b&&(b=precision.length-1,l.measureTool.setPrecision(b));p.selectedIndex=b}Autodesk.Viewing.UI.DockingPanel.call(this,b.container,c,d,f);this.kPanelExpandedHeight=310;this.kPanelCollapsedHeight=35;this.measureTool=a;this.viewer=b;this.parentContainer=b.container;this.container.classList.add("measurePanel");this.container.dockRight=!0;this.container.style.minWidth=
"325px";this.container.style.minHeight=this.kPanelCollapsedHeight+"px";this.container.style.height=this.kPanelExpandedHeight+"px";this.container.style.maxHeight=this.kPanelExpandedHeight+"px";this.container.style.top="200px";this.container.style.left="220px";this.container.style.resize="none";this.container.style.position="absolute";this.addEventListener(this.closer,"click",function(a){if(f&&f.onCloseCallback)f.onCloseCallback()});a=this.container.children[0];a.classList.add("measure-panelTitle");
a.classList.add("expanded");this.measureResults=document.createElement("div");this.container.appendChild(this.measureResults);var l=this,m=[{name:"Decimal feet",units:"decimal-ft"},{name:"Feet and fractional inches",units:"ft",matches:["ft","in"]},{name:"Decimal inches",units:"decimal-in"},{name:"Fractional inches",units:"fractional-in"},{name:"Meters",units:"m",matches:["m"]},{name:"Centimeters",units:"cm",matches:["cm"]},{name:"Millimeters",units:"mm",matches:["mm"]},{name:"Meters and centimeters",
units:"m-and-cm"}];a=function(){var a,b,c=l.measureTool.getUnits();for(a=0;a<m.length;++a){var d=m[a].matches;if(d)for(b=0;b<d.length;++b)if(d[b]===c)return a}return 0}();b=[];for(c=0;c<m.length;++c)b.push(m[c].name);g(this.measureResults,"Unit type",b,a,function(a){l.measureTool.setUnits(m[a].units);l.updatePanel();k()});var p=g(this.measureResults,"Precision",[],-1,function(a){l.measureTool.setPrecision(a);l.updatePanel()});p.parentNode.style.paddingBottom="15px";k();h(this.measureResults);a=document.createElement("div");
this.measureResults.appendChild(a);b=document.createElement("div");b.className="measure-result";b.setAttribute("data-i18n","Results");b.textContent=Autodesk.Viewing.i18n.translate("Results");a.appendChild(b);this.distanceDiv=document.createElement("div");this.distanceDiv.className="measure-results";a.appendChild(this.distanceDiv);b=document.createElement("div");b.className="measure-result-label";b.setAttribute("data-i18n","Distance = ");b.textContent=Autodesk.Viewing.i18n.translate("Distance = ");
this.distanceDiv.appendChild(b);b=document.createElement("div");b.className="measure-result-number";this.distanceDiv.appendChild(b);this.deltaXDiv=document.createElement("div");this.deltaXDiv.className="measure-results";a.appendChild(this.deltaXDiv);b=document.createElement("div");b.className="measure-result-label";b.setAttribute("data-i18n","Delta x = ");b.textContent=Autodesk.Viewing.i18n.translate("Delta x = ");this.deltaXDiv.appendChild(b);b=document.createElement("div");b.className="measure-result-number";
this.deltaXDiv.appendChild(b);this.deltaYDiv=document.createElement("div");this.deltaYDiv.className="measure-results";a.appendChild(this.deltaYDiv);b=document.createElement("div");b.className="measure-result-label";b.setAttribute("data-i18n","Delta y = ");b.textContent=Autodesk.Viewing.i18n.translate("Delta y = ");this.deltaYDiv.appendChild(b);b=document.createElement("div");b.className="measure-result-number";this.deltaYDiv.appendChild(b);this.deltaZDiv=document.createElement("div");this.deltaZDiv.className=
"measure-results";a.appendChild(this.deltaZDiv);a=document.createElement("div");a.className="measure-result-label";a.setAttribute("data-i18n","Delta z = ");a.textContent=Autodesk.Viewing.i18n.translate("Delta z = ");this.deltaZDiv.appendChild(a);a=document.createElement("div");a.className="measure-result-number";this.deltaZDiv.appendChild(a);h(this.measureResults);a=document.createElement("div");a.className="measure-restart";a.setAttribute("data-i18n","Restart measurement");a.textContent=Autodesk.Viewing.i18n.translate("Restart measurement");
a.addEventListener("click",function(){l.measureTool.clearMeasurement()},!1);this.measureResults.appendChild(a);this.updatePanel();this.addVisibilityListener(function(){l.resizeToContent({maxHeight:l.parentContainer.offsetHeight-75})})};Autodesk.Viewing.Extensions.Measure.MeasurePanel.prototype=Object.create(Autodesk.Viewing.UI.DockingPanel.prototype);Autodesk.Viewing.Extensions.Measure.MeasurePanel.prototype.constructor=Autodesk.Viewing.Extensions.Measure.MeasurePanel;Autodesk.Viewing.Extensions.ViewerPanelMixin.call(Autodesk.Viewing.Extensions.Measure.MeasurePanel.prototype);
Autodesk.Viewing.Extensions.Measure.MeasurePanel.prototype.uninitialize=function(){this.viewer=null;Autodesk.Viewing.UI.DockingPanel.prototype.uninitialize.call(this)};Autodesk.Viewing.Extensions.Measure.MeasurePanel.prototype.onTitleClick=function(a){this.toggle()};
Autodesk.Viewing.Extensions.Measure.MeasurePanel.prototype.collapse=function(a){var b=this.container.children[0];a?(b.classList.remove("expanded"),b.classList.add("collapsed"),this.measureResults.style.display="none"):(b.classList.remove("collapsed"),b.classList.add("expanded"),this.measureResults.style.display="block");this.measureTool.getIndicator().setSimple(a);this.resizeToContent({maxHeight:this.parentContainer.offsetHeight-75})};
Autodesk.Viewing.Extensions.Measure.MeasurePanel.prototype.toggle=function(){this.collapse(this.isExpanded())};Autodesk.Viewing.Extensions.Measure.MeasurePanel.prototype.isExpanded=function(){return this.container.children[0].classList.contains("expanded")};Autodesk.Viewing.Extensions.Measure.MeasurePanel.prototype.getContentSize=function(){return{height:this.isExpanded()?this.measureResults.clientHeight+46:0,width:this.measureResults.clientWidth}};
Autodesk.Viewing.Extensions.Measure.MeasurePanel.prototype.updatePanel=function(){function a(a,d){a.children[1].textContent=b.measureTool.getDistance(d)}var b=this;a(this.distanceDiv,"xyz");a(this.deltaXDiv,"x");a(this.deltaYDiv,"y");a(this.deltaZDiv,"z")};
(function(a,b){var c=a.document;"undefined"===typeof a.alertify&&(a.alertify=new function(){var d={},f=!1,g=[],h,k,l,m,p,n,q,r,v,s,w,z;z=function(){var a,d,f=!1,g=c.createElement("fakeelement"),h={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"otransitionend",transition:"transitionend"};for(a in h)if(g.style[a]!==b){d=h[a];f=!0;break}return{type:d,supported:f}};h=function(a){return c.getElementById(a)};d={labels:{ok:"OK",cancel:"Cancel"},delay:5E3,buttonReverse:!1,
buttonFocus:"ok",transition:b,addListeners:function(a){var b="undefined"!==typeof l,d="undefined"!==typeof k,f="undefined"!==typeof w,g="",h=this,n,q,r,s,v;n=function(b){"undefined"!==typeof b.preventDefault&&b.preventDefault();r(b);"undefined"!==typeof w&&(g=w.value);"function"===typeof a&&("undefined"!==typeof w?a(!0,g):a(!0));return!1};q=function(b){"undefined"!==typeof b.preventDefault&&b.preventDefault();r(b);"function"===typeof a&&a(!1);return!1};r=function(a){h.hide();h.unbind(c.body,"keyup",
s);h.unbind(m,"focus",v);b&&h.unbind(l,"click",n);d&&h.unbind(k,"click",q)};s=function(a){var b=a.keyCode;(32===b&&!f||f&&13===b)&&n(a);27===b&&d&&q(a)};v=function(a){f?w.focus():!d||h.buttonReverse?l.focus():k.focus()};this.bind(m,"focus",v);this.bind(p,"focus",v);b&&this.bind(l,"click",n);d&&this.bind(k,"click",q);this.bind(c.body,"keyup",s);this.transition.supported||this.setFocus()},bind:function(a,b,c){"function"===typeof a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent&&a.attachEvent("on"+
b,c)},handleErrors:function(){if("undefined"!==typeof a.onerror){var b=this;a.onerror=function(a,c,d){b.error("["+a+" on line "+d+" of "+c+"]",0)};return!0}return!1},appendButtons:function(a,b){return this.buttonReverse?b+a:a+b},build:function(a){var b=a.type,c=a.message,f=a.cssClass||"";a='<div class="alertify-dialog"><a id="alertify-resetFocusBack" class="alertify-resetFocus" href="#">Reset Focus</a>';"none"===d.buttonFocus&&(a+='<a href="#" id="alertify-noneFocus" class="alertify-hidden"></a>');
"prompt"===b&&(a+='<div id="alertify-form">');a+='<article class="alertify-inner">';a+='<p class="alertify-message">{{message}}</p>'.replace("{{message}}",c);"prompt"===b&&(a+='<div class="alertify-text-wrapper"><input type="text" class="alertify-text" id="alertify-text"></div>');a+='<nav class="alertify-buttons">{{buttons}}</nav>';a+="</article>";"prompt"===b&&(a+="</div>");a+='<a id="alertify-resetFocus" class="alertify-resetFocus" href="#">Reset Focus</a>';a+="</div>";switch(b){case "confirm":a=
a.replace("{{buttons}}",this.appendButtons('<button class="alertify-button alertify-button-cancel" id="alertify-cancel">{{cancel}}</button>','<button class="alertify-button alertify-button-ok" id="alertify-ok">{{ok}}</button>'));a=a.replace("{{ok}}",this.labels.ok).replace("{{cancel}}",this.labels.cancel);break;case "prompt":a=a.replace("{{buttons}}",this.appendButtons('<button class="alertify-button alertify-button-cancel" id="alertify-cancel">{{cancel}}</button>','<button type="submit" class="alertify-button alertify-button-ok" id="alertify-ok">{{ok}}</button>'));
a=a.replace("{{ok}}",this.labels.ok).replace("{{cancel}}",this.labels.cancel);break;case "alert":a=a.replace("{{buttons}}",'<button class="alertify-button alertify-button-ok" id="alertify-ok">{{ok}}</button>'),a=a.replace("{{ok}}",this.labels.ok)}v.className="alertify alertify-"+b+" "+f;r.className="alertify-cover";return a},close:function(a,b){var c=b&&!isNaN(b)?+b:this.delay,d=this,f,g;this.bind(a,"click",function(){f(a)});g=function(a){a.stopPropagation();d.unbind(this,d.transition.type,g);s.removeChild(this);
s.hasChildNodes()||(s.className+=" alertify-logs-hidden")};f=function(a){"undefined"!==typeof a&&a.parentNode===s&&(d.transition.supported?(d.bind(a,d.transition.type,g),a.className+=" alertify-log-hide"):(s.removeChild(a),s.hasChildNodes()||(s.className+=" alertify-logs-hidden")))};0!==b&&setTimeout(function(){f(a)},c)},dialog:function(a,b,d,h,k){q=c.activeElement;var l=function(){s&&null!==s.scrollTop&&r&&null!==r.scrollTop||l()};if("string"!==typeof a)throw Error("message must be a string");if("string"!==
typeof b)throw Error("type must be a string");if("undefined"!==typeof d&&"function"!==typeof d)throw Error("fn must be a function");this.init();l();g.push({type:b,message:a,callback:d,placeholder:h,cssClass:k});f||this.setup();return this},extend:function(a){if("string"!==typeof a)throw Error("extend method must have exactly one paramter");return function(b,c){this.log(b,a,c);return this}},hide:function(){var a,b=this;g.splice(0,1);0<g.length?this.setup(!0):(f=!1,a=function(c){c.stopPropagation();
b.unbind(v,b.transition.type,a)},this.transition.supported?(this.bind(v,this.transition.type,a),v.className="alertify alertify-hide alertify-hidden"):v.className="alertify alertify-hide alertify-hidden alertify-isHidden",r.className="alertify-cover alertify-cover-hidden",q.focus())},init:function(){c.createElement("nav");c.createElement("article");c.createElement("section");null==h("alertify-cover")&&(r=c.createElement("div"),r.setAttribute("id","alertify-cover"),r.className="alertify-cover alertify-cover-hidden",
c.body.appendChild(r));null==h("alertify")&&(f=!1,g=[],v=c.createElement("section"),v.setAttribute("id","alertify"),v.setAttribute("style","z-index : 999999999"),v.className="alertify alertify-hidden",c.body.appendChild(v));null==h("alertify-logs")&&(s=c.createElement("section"),s.setAttribute("id","alertify-logs"),s.className="alertify-logs alertify-logs-hidden",c.body.appendChild(s));c.body.setAttribute("tabindex","0");this.transition=z()},log:function(a,b,c){var d=function(){s&&null!==s.scrollTop||
d()};this.init();d();s.className="alertify-logs";this.notify(a,b,c);return this},notify:function(a,b,d){var f=c.createElement("article");f.className="alertify-log"+("string"===typeof b&&""!==b?" alertify-log-"+b:"");f.innerHTML=a;s.appendChild(f);setTimeout(function(){f.className+=" alertify-log-show"},50);this.close(f,d)},set:function(a){var b;if("object"!==typeof a&&a instanceof Array)throw Error("args must be an object");for(b in a)a.hasOwnProperty(b)&&(this[b]=a[b])},setFocus:function(){w?(w.focus(),
w.select()):n.focus()},setup:function(a){var c=g[0],q=this,r;f=!0;r=function(a){a.stopPropagation();q.setFocus();q.unbind(v,q.transition.type,r)};this.transition.supported&&!a&&this.bind(v,this.transition.type,r);v.innerHTML=this.build(c);m=h("alertify-resetFocus");p=h("alertify-resetFocusBack");l=h("alertify-ok")||b;k=h("alertify-cancel")||b;n="cancel"===d.buttonFocus?k:"none"===d.buttonFocus?h("alertify-noneFocus"):l;w=h("alertify-text")||b;h("alertify-form");"string"===typeof c.placeholder&&""!==
c.placeholder&&(w.value=c.placeholder);a&&this.setFocus();this.addListeners(c.callback)},unbind:function(a,b,c){"function"===typeof a.removeEventListener?a.removeEventListener(b,c,!1):a.detachEvent&&a.detachEvent("on"+b,c)}};return{alert:function(a,b,c){d.dialog(a,"alert",b,"",c);return this},confirm:function(a,b,c){d.dialog(a,"confirm",b,"",c);return this},extend:d.extend,init:d.init,log:function(a,b,c){d.log(a,b,c);return this},prompt:function(a,b,c,f){d.dialog(a,"prompt",b,c,f);return this},success:function(a,
b){d.log(a,"success",b);return this},error:function(a,b){d.log(a,"error",b);return this},set:function(a){d.set(a)},hide:function(a){d.hide(a)},labels:d.labels,debug:d.handleErrors}})})(this);AutodeskNamespace("Autodesk.Viewing");AutodeskNamespace("Autodesk.Viewing.Private");var auth=null,VIEWING_URL,ACM_SESSION_URL,RESOURCE_ROOT="",LOCALIZATION_REL_PATH="";Autodesk.Viewing.Private.env=null;Autodesk.Viewing.Private.logger=null;Autodesk.Viewing.Private.refreshToken=null;
Autodesk.Viewing.Private.EnvironmentConfigurations={Local:{VIEWING:"https://viewing-dev.api.autodesk.com/viewingservice/v1",ACM:"https://developer-dev.api.autodesk.com/oss-ext/v1/acmsessions"},Development:{VIEWING:"https://viewing-dev.api.autodesk.com/viewingservice/v1",ACM:"https://developer-dev.api.autodesk.com/oss-ext/v1/acmsessions"},Staging:{VIEWING:"https://viewing-staging.api.autodesk.com/viewingservice/v1",ACM:"https://developer-stg.api.autodesk.com/oss-ext/v1/acmsessions"},Production:{VIEWING:"https://viewing.api.autodesk.com/viewingservice/v1",
ACM:"https://developer.api.autodesk.com/oss-ext/v1/acmsessions"},AutodeskDevelopment:{VIEWING:"https://developer-dev.api.autodesk.com/viewingservice/v1",ACM:"https://developer-dev.api.autodesk.com/oss-ext/v1/acmsessions"},AutodeskStaging:{VIEWING:"https://developer-stg.api.autodesk.com/viewingservice/v1",ACM:"https://developer-stg.api.autodesk.com/oss-ext/v1/acmsessions"},AutodeskProduction:{VIEWING:"https://developer.api.autodesk.com/viewingservice/v1",ACM:"https://developer.api.autodesk.com/oss-ext/v1/acmsessions"}};
Autodesk.Viewing.Private.setAuthTokenInCookie=function(a,b,c){var d={oauth:{token:""}};d.oauth.token=a;a=new XMLHttpRequest;a.open("POST",VIEWING_URL+"/token",!0);a.setRequestHeader("Content-Type","application/json");a.withCredentials=!0;a.onload=b;a.onerror=c;a.ontimeout=c;a.send(JSON.stringify(d))};
Autodesk.Viewing.Private.setApigeeTokenInCookie=function(a,b,c){var d=new XMLHttpRequest,f=VIEWING_URL.substring(0,VIEWING_URL.indexOf("/viewingservice"));d.open("POST",f+"/utility/v1/settoken",!0);d.setRequestHeader("Content-Type","application/x-www-form-urlencoded");d.withCredentials=!0;d.onload=b;d.onerror=c;d.ontimeout=c;d.send("access-token="+a)};
Autodesk.Viewing.Private.initializeEnvironmentVariable=function(a){var b;a&&a.env&&(b=a.env);b||(b=Autodesk.Viewing.Private.getParameterByName("env"));if(!b)switch(window.location.hostname){case "viewing-dev.api.autodesk.com":b="Development";break;case "viewing-staging.api.autodesk.com":b="Staging";break;case "viewing.api.autodesk.com":b="Production";break;case "developer-dev.api.autodesk.com":b="AutodeskDevelopment";break;case "developer-stg.api.autodesk.com":b="AutodeskStaging";break;case "developer.api.autodesk.com":b=
"AutodeskProduction";break;case "ec2-23-20-101-198.compute-1.amazonaws.com":b="Development";break;case "localhost.autodesk.com":b="Local";break;case "":b="Local";break;case "127.0.0.1":b="Local";break;default:b="AutodeskProduction"}console.log("Host name : "+window.location.hostname);console.log("Environment initialized as : "+b);Autodesk.Viewing.Private.env=b};
Autodesk.Viewing.Private.initializeServiceEndPoints=function(a){var b=Autodesk.Viewing.Private,c=b.EnvironmentConfigurations[b.env];VIEWING_URL=c.VIEWING;ACM_SESSION_URL=c.ACM;a=a&&a.hasOwnProperty("libraryName")?a.libraryName:"viewer3D.min.js";b=b.getScriptUrl(a);a=b.indexOf(a);0<=a&&(b=b.substr(0,a));RESOURCE_ROOT=b};
Autodesk.Viewing.Private.initializeAuth=function(a,b){var c=Autodesk.Viewing.Private,d=b?b.shouldInitializeAuth:null;d||(d=Autodesk.Viewing.Private.getParameterByName("auth"));if("Local"==c.env&&!d)return setTimeout(a,0),auth=!1;auth=!0;c=Autodesk.Viewing.Private;b?(d=b.getAccessToken?b.getAccessToken():b.accessToken?b.accessToken:c.getParameterByName("accessToken"),c.refreshToken=b.refreshToken):d=c.getParameterByName("accessToken");d||(d="nRzW3Y7jubV+3v/oMd9aqLfnDpA=",console.log("Warning : no access token is provided. Use built in token : "+
d));0==c.env.indexOf("Autodesk")?c.setApigeeTokenInCookie(d,a):c.setAuthTokenInCookie(d,a);c.initializeLogger(d);setInterval(c.heartBeat,6E4);return auth};
Autodesk.Viewing.Private.initializeLogger=function(a){var b=Autodesk.Viewing.Private.logger=new Autodesk.Viewing.Private.Logger({console:!1,viewingservice:!0,webstorage:!1,endpoint:VIEWING_URL,flushThreshold:10});a={viewer_current_time:Date.now(),viewer_user_access_token:a,viewer_user_host_url:window.location.hostname,viewer_user_agent:navigator.userAgent};b.log(a)};Autodesk.Viewing.Private.heartBeat=function(){var a=Autodesk.Viewing.Private;6E4<Date.now()-a.logger.lastFlushTime&&a.logger.flush()};
Autodesk.Viewing.Private.getAuthObject=function(){return auth};Autodesk.Viewing.Private.getParameterByName=function(a){return Autodesk.Viewing.Private.getParameterByNameFromPath(a,window.location.href)};Autodesk.Viewing.Private.getParameterByNameFromPath=function(a,b){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var c=RegExp("[\\?&]"+a+"=([^&#]*)").exec(b);return null==c?"":decodeURIComponent(c[1].replace(/\+/g," "))};
Autodesk.Viewing.Private.getDemoDocumentURN=function(){var a;switch(Autodesk.Viewing.Private.env){case "Development":a="urn:dXJuOmFkc2suYTM2MGJldGFkZXY6ZnMuZmlsZTplbnRlcnByaXNlLmxtdnRlc3QuRFM1YTczMFFUYmYwMDIyZDA3NTFhYmE5MjZlZDZkMjJlZDY0P3ZlcnNpb249MQ==";break;case "Staging":a="urn:dXJuOmFkc2suczM6ZGVyaXZlZC5maWxlOlZpZXdpbmdTZXJ2aWNlVGVzdEFwcC91c2Vycy9NaWNoYWVsX0hhbicvTU0zNTAwQXNzZW1ibHkuZHdm";break;case "Production":a="FIXME";break;default:a="urn:dXJuOmFkc2suYTM2MGJldGFkZXY6ZnMuZmlsZTplbnRlcnByaXNlLmxtdnRlc3QuRFM1YTczMFFUYmYwMDIyZDA3NTFhYmE5MjZlZDZkMjJlZDY0P3ZlcnNpb249MQ=="}return a};
Autodesk.Viewing.Private.setLanguage=function(a,b){var c={lng:a,resGetPath:"res/locales/__lng__/__ns__.json",ns:{namespaces:["allstrings"],defaultNs:"allstrings"},fallbackLng:"en",debug:!1};LOCALIZATION_REL_PATH="res/locales/"+a+"/";Autodesk.Viewing.i18n.init(c,function(a){Autodesk.Viewing.i18n.localize();b&&b()})};Autodesk.Viewing.Private.initializeLocalization=function(){navigator.language.split("-");Autodesk.Viewing.Private.setLanguage("en")};
Autodesk.Viewing.Private.initializeUserInfo=function(a){a&&a.userInfo&&Autodesk.Viewing.Private.setUserName(a.userInfo.name)};function stderr(a){ENABLE_TRACE&&console.log(a)}Autodesk.Viewing.Private.getScriptUrl=function(a){a=a.toLowerCase();var b=document.getElementsByTagName("SCRIPT");if(b&&0<b.length)for(var c=0;c<b.length;++c)if(b[c].src&&-1!==b[c].src.toLowerCase().indexOf(a))return b[c].src;return""};Autodesk.Viewing.Private.theLibraryVersions={};
Autodesk.Viewing.Private.getResourceUrl=function(a,b){var c=Autodesk.Viewing.Private,d="";b&&b.hasOwnProperty("version")?d=b.version:(d=b&&b.hasOwnProperty("libraryName")?b.libraryName:"viewer3D.min.js",void 0===c.theLibraryVersions[d]&&(c.theLibraryVersions[d]=c.getParameterByNameFromPath("v",c.getScriptUrl(d))),d=c.theLibraryVersions[d]);return RESOURCE_ROOT+a+(d?"?v="+d:"")};
Autodesk.Viewing.Initializer=function(a,b){var c=Autodesk.Viewing.Private;c.WEBGL_HELP_LINK=a?a.webGLHelpLink:null;c.initializeEnvironmentVariable(a);c.initializeServiceEndPoints(a);c.initializeAuth(b,a);c.initializeLocalization();c.initializeUserInfo(a)};
